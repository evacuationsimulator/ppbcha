((self||window).webpackJsonp=(self||window).webpackJsonp||[]).push([[5],{133:function(e,t,i){var r,n;r=[i(9),i(8),i(10),i(17),i(76),i(1942),i(1943),i(1944),i(1945),i(1946),i(1947),i(306),i(210)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h){"use strict";function p(i){i=e(i,e.EMPTY_OBJECT);var r=e(i.translucent,!0),n=e(i.closed,!1),o=e(i.materialSupport,p.MaterialSupport.TEXTURED);this.material=t(i.material)?i.material:h.fromType(h.ColorType),this.translucent=r,this._vertexShaderSource=e(i.vertexShaderSource,o.vertexShaderSource),this._fragmentShaderSource=e(i.fragmentShaderSource,o.fragmentShaderSource),this._renderState=d.getDefaultRenderState(r,n,i.renderState),this._closed=n,this._materialSupport=o,this._vertexFormat=o.vertexFormat,this._flat=e(i.flat,!1),this._faceForward=e(i.faceForward,!n)}return i(p.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),p.prototype.getFragmentShaderSource=d.prototype.getFragmentShaderSource,p.prototype.isTranslucent=d.prototype.isTranslucent,p.prototype.getRenderState=d.prototype.getRenderState,p.MaterialSupport={BASIC:r({vertexFormat:n.POSITION_AND_NORMAL,vertexShaderSource:l,fragmentShaderSource:s}),TEXTURED:r({vertexFormat:n.POSITION_NORMAL_AND_ST,vertexShaderSource:c,fragmentShaderSource:u}),ALL:r({vertexFormat:n.ALL,vertexShaderSource:a,fragmentShaderSource:o})},p}.apply(t,r))||(e.exports=n)},134:function(e,t,i){var r,n;r=[i(16),i(22),i(9),i(8),i(10),i(20),i(11),i(84),i(25),i(80),i(189),i(122),i(102),i(75),i(182),i(143),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=new p(t.WHITE),v=new m(!0),y=new m(!0),x=new m(!1),w=new m(t.BLACK),T=new m(h.DISABLED),C=new m(new s),E=new m(d.BOTH);function A(e){var t=e.entity,i=e.geometryPropertyName;this._entity=t,this._scene=e.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new l,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=e.geometryOptions,this._geometryPropertyName=i,this._id=i+"-"+t.id,this._observedPropertyNames=e.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=f.supportsMaterialsforEntitiesOnTerrain(e.scene)}return n(A.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!r(this._entity.availability)&&_.isConstant(this._showProperty)&&_.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!r(this._entity.availability)&&_.isConstant(this._showProperty)&&_.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),A.prototype.isOutlineVisible=function(e){var t=this._entity,r=this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e);return i(r,!1)},A.prototype.isFilled=function(e){var t=this._entity,r=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e);return i(r,!1)},A.prototype.createFillGeometryInstance=a.throwInstantiationError,A.prototype.createOutlineGeometryInstance=a.throwInstantiationError,A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){o(this)},A.prototype._isHidden=function(e,t){var i=t.show;return r(i)&&i.isConstant&&!i.getValue(u.MINIMUM_VALUE)},A.prototype._isOnTerrain=function(e,t){return!1},A.prototype._getIsClosed=function(e){return!0},A.prototype._isDynamic=a.throwInstantiationError,A.prototype._setStaticOptions=a.throwInstantiationError,A.prototype._onEntityPropertyChanged=function(e,t,n,o){if(-1!==this._observedPropertyNames.indexOf(t)){var a=this._entity[this._geometryPropertyName];if(r(a)){var s=a.fill,l=!r(s)||!s.isConstant||s.getValue(u.MINIMUM_VALUE),d=a.outline,h=r(d);if(h&&d.isConstant&&(h=d.getValue(u.MINIMUM_VALUE)),l||h){var m=a.show;if(this._isHidden(e,a))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{this._materialProperty=i(a.material,g),this._fillProperty=i(s,y),this._showProperty=i(m,v),this._showOutlineProperty=i(a.outline,x),this._outlineColorProperty=h?i(a.outlineColor,w):void 0,this._shadowsProperty=i(a.shadows,T),this._distanceDisplayConditionProperty=i(a.distanceDisplayCondition,C),this._classificationTypeProperty=i(a.classificationType,E),this._fillEnabled=l;var f=this._isOnTerrain(e,a)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof p);if(h&&f&&(c(c.geometryOutlines),h=!1),this._onTerrain=f,this._outlineEnabled=h,this._isDynamic(e,a))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(e,a),this._isClosed=this._getIsClosed(this._options);var _=a.outlineWidth;this._outlineWidth=r(_)?_.getValue(u.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},A.prototype.createDynamicUpdater=function(e,t){return new this.constructor.DynamicGeometryUpdater(this,e,t)},A}.apply(t,r))||(e.exports=n)},165:function(e,t,i){var r,n;r=[i(33),i(16),i(8),i(20),i(11),i(170),i(133),i(74),i(112),i(90),i(75),i(198),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h){"use strict";function p(e,t,i){this._primitives=t,this._orderedGroundPrimitives=i,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=e,this._options=e._options,this._entity=e._entity,this._material=void 0}return p.prototype._isHidden=function(e,t,i){return!e.isShowing||!e.isAvailable(i)||!h.getValueOrDefault(t.show,i,!0)},p.prototype._setOptions=n.throwInstantiationError,p.prototype.update=function(e){var t=this._geometryUpdater,r=t._onTerrain,n=this._primitives,u=this._orderedGroundPrimitives;r?u.remove(this._primitive):(n.removeAndDestroy(this._primitive),n.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var p=this._entity,m=p[this._geometryUpdater._geometryPropertyName];if(this._setOptions(p,m,e),!this._isHidden(p,m,e)){var f=this._geometryUpdater.shadowsProperty.getValue(e),_=this._options;if(!i(m.fill)||m.fill.getValue(e)){var g,v=t.fillMaterialProperty,y=v instanceof c,x=t._getIsClosed(_);if(y)g=new s({closed:x,flat:r&&!t._supportsMaterialsforEntitiesOnTerrain});else{var w=d.getValue(e,v,this._material);this._material=w,g=new a({material:w,translucent:w.isTranslucent(),closed:x})}if(r)_.vertexFormat=s.VERTEX_FORMAT,this._primitive=u.add(new o({geometryInstances:this._geometryUpdater.createFillGeometryInstance(e),appearance:g,asynchronous:!1,shadows:f,classificationType:this._geometryUpdater.classificationTypeProperty.getValue(e)}),h.getValueOrUndefined(this._geometryUpdater.zIndex,e));else{_.vertexFormat=g.vertexFormat;var T=this._geometryUpdater.createFillGeometryInstance(e);y&&(g.translucent=255!==T.attributes.color.value[3]),this._primitive=n.add(new l({geometryInstances:T,appearance:g,asynchronous:!1,shadows:f}))}}if(!r&&i(m.outline)&&m.outline.getValue(e)){var C=this._geometryUpdater.createOutlineGeometryInstance(e),E=h.getValueOrDefault(m.outlineWidth,e,1);this._outlinePrimitive=n.add(new l({geometryInstances:C,appearance:new s({flat:!0,translucent:255!==C.attributes.color.value[3],renderState:{lineWidth:t._scene.clampLineWidth(E)}}),asynchronous:!1,shadows:f}))}}},p.prototype.getBoundingSphere=function(t){var r,n=this._entity,o=this._primitive,a=this._outlinePrimitive;return i(o)&&o.show&&o.ready&&(r=o.getGeometryInstanceAttributes(n),i(r)&&i(r.boundingSphere))?(e.clone(r.boundingSphere,t),u.DONE):i(a)&&a.show&&a.ready&&(r=a.getGeometryInstanceAttributes(n),i(r)&&i(r.boundingSphere))?(e.clone(r.boundingSphere,t),u.DONE):i(o)&&!o.ready||i(a)&&!a.ready?u.PENDING:u.FAILED},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){var e=this._primitives,t=this._orderedGroundPrimitives;this._geometryUpdater._onTerrain?t.remove(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),r(this)},p}.apply(t,r))||(e.exports=n)},1836:function(e,t,i){var r,n;r=[i(655),i(735),i(9)],void 0===(n=function(e,t,i){"use strict";return function(r){r=i(r,i.EMPTY_OBJECT);var n=i(r.style,t.AERIAL);return new e({assetId:n})}}.apply(t,r))||(e.exports=n)},1837:function(e,t,i){var r,n;r=[i(33),i(110),i(12),i(32),i(9),i(8),i(10),i(20),i(11),i(26),i(341),i(25),i(145),i(146),i(29),i(37),i(56),i(63),i(1838),i(1839),i(1840),i(18),i(1841),i(1842),i(1845),i(140),i(1846),i(44),i(102),i(284)],void 0===(n=function(e,t,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O){"use strict";function I(e){e=o(e,c.WGS84);var t=new d({ellipsoid:e}),r=new A;this._ellipsoid=e,this._imageryLayerCollection=r,this._surfaceShaderSet=new C,this._material=void 0,this._surface=new P({tileProvider:new E({terrainProvider:t,imageryLayers:r,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new h,M(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new _({url:i(1850)}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.showGroundAtmosphere=!0,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=D.RECEIVE_ONLY,this.splitDirection=S.NONE,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0}function M(e){var t=[],i=a(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),r=[w];!a(e._material)||i&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.uniformMap=void 0:(r.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.uniformMap=e._material._uniforms),r.push(y),e._surfaceShaderSet.baseVertexShaderSource=new g({sources:[w,x],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new g({sources:r,defines:t}),e._surfaceShaderSet.material=e._material}function N(t){return function(i,r){return e.distanceSquaredTo(i.data.pickBoundingSphere,t)-e.distanceSquaredTo(r.data.pickBoundingSphere,t)}}s(I.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return!a(this._surface)||this._surface.tileProvider.ready&&0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){a(e)||(e=f.clone(f.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),a(this._material)&&M(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,M(this))}}});var F=[],R={start:0,stop:0};I.prototype.pickWorldCoordinates=function(t,i,n){var o=i.mode,s=i.mapProjection,l=F;l.length=0;var u,c,d,h=this._surface._tilesToRender,m=h.length;for(c=0;c<m;++c){var f=(u=h[c]).data;if(a(f)){var _=f.pickBoundingSphere;if(o!==b.SCENE3D)f.pickBoundingSphere=_=e.fromRectangleWithHeights2D(u.rectangle,s,f.tileBoundingRegion.minimumHeight,f.tileBoundingRegion.maximumHeight,_),r.fromElements(_.center.z,_.center.x,_.center.y,_.center);else{if(!a(f.renderedMesh))continue;e.clone(f.renderedMesh.boundingSphere3D,_)}var g=p.raySphere(t,_,R);a(g)&&l.push(u)}}for(l.sort(N(t.origin)),m=l.length,c=0;c<m&&(d=l[c].data.pick(t,i.mode,i.mapProjection,!0,n),!a(d));++c);return d},I.prototype.pickTriangle=function(t,i,n){var o=i.mode,s=i.mapProjection,l=F;l.length=0;var u,c,d,h=this._surface._tilesToRender,m=h.length;for(c=0;c<m;++c){var f=(u=h[c]).data;if(a(f)){var _=f.pickBoundingSphere;o!==b.SCENE3D?(e.fromRectangleWithHeights2D(u.rectangle,s,f.minimumHeight,f.maximumHeight,_),r.fromElements(_.center.z,_.center.x,_.center.y,_.center)):e.clone(f.boundingSphere3D,_);var g=p.raySphere(t,_,R);a(g)&&l.push(u)}}for(l.sort(N(t.origin)),m=l.length,c=0;c<m;++c)if(d=l[c].data.pickTriangle(t,i.mode,i.mapProjection,!0,n),a(d)){d.tile=l[c];break}return d};var L=new n;I.prototype.pick=function(e,t,i){if(i=this.pickWorldCoordinates(e,t,i),a(i)&&t.mode!==b.SCENE3D){i=r.fromElements(i.y,i.z,i.x,i);var n=t.mapProjection.unproject(i,L);i=t.globe.ellipsoid.cartographicToCartesian(n,i)}return i};var V=new r,U=new r,z=new n,B=new m;function H(e,t){return f.contains(e.rectangle,t)?e:void 0}return I.prototype.getHeight=function(e){var t=this._surface._levelZeroTiles;if(a(t)){var i,n,s=t.length;for(n=0;n<s&&(i=t[n],!f.contains(i.rectangle,e));++n);if(!(n>=s)){for(;i._lastSelectionResult===O.REFINED;)i=H(i.southwestChild,e)||H(i.southeastChild,e)||H(i.northwestChild,e)||i.northeastChild;if(a(i.data)&&a(i.data.renderedMesh)){var l=this._surface._tileProvider.tilingScheme.ellipsoid,u=r.fromRadians(e.longitude,e.latitude,0,l,V),c=B,d=l.geodeticSurfaceNormal(u,c.direction),h=l.getSurfaceNormalIntersectionWithZAxis(u,11500,c.origin);if(!a(h)){var p;a(i.data.tileBoundingRegion)&&(p=i.data.tileBoundingRegion.minimumHeight);var m=Math.min(o(p,0),-11500),_=r.multiplyByScalar(d,Math.abs(m)+1,U);r.subtract(u,_,c.origin)}var g=i.data.pick(c,void 0,void 0,!1,U);if(a(g))return l.cartesianToCartographic(g,z).height}}}},I.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},I.prototype.beginFrame=function(e){var t=this._surface,i=t.tileProvider,r=this.terrainProvider,n=this.showWaterEffect&&r.ready&&r.hasWaterMask;if(n&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;var o=this._oceanNormalMapResource,s=o.url;if(a(s)){var l=this;T(o.fetchImage(),function(t){s===l._oceanNormalMapResource.url&&(l._oceanNormalMap=l._oceanNormalMap&&l._oceanNormalMap.destroy(),l._oceanNormalMap=new v({context:e.context,source:t}))})}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}var u=e.passes,c=e.mode;u.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,t.loadingDescendantLimit=this.loadingDescendantLimit,t.preloadAncestors=this.preloadAncestors,t.preloadSiblings=this.preloadSiblings,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=c===b.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=n,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.showGroundAtmosphere=this.showGroundAtmosphere,i.shadows=this.shadows,i.splitDirection=this.splitDirection,i.hueShift=this.atmosphereHueShift,i.saturationShift=this.atmosphereSaturationShift,i.brightnessShift=this.atmosphereBrightnessShift,i.fillHighlightColor=this.fillHighlightColor,t.beginFrame(e))},I.prototype.render=function(e){this.show&&(a(this._material)&&this._material.update(e.context),this._surface.render(e))},I.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),l(this)},I}.apply(t,r))||(e.exports=n)},1838:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_IMAGERY_CUTOUT\nuniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_COLOR_TO_ALPHA\nuniform vec4 u_colorsToAlpha[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\nuniform sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n\n#ifdef SPLIT_TERRAIN\nuniform float u_terrainSplitDirection;\n#endif\n\n#if defined(FOG) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING)) || defined(GROUND_ATMOSPHERE)\nuniform float u_minimumBrightness;\n#endif\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\nuniform vec4 u_fillHighlightColor;\n#endif\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nvarying float v_height;\nvarying float v_slope;\nvarying float v_aspect;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nvarying float v_distance;\nvarying vec3 v_fogRayleighColor;\nvarying vec3 v_fogMieColor;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split,\n    vec4 colorToAlpha)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual 'if' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture2D(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_COLOR_TO_ALPHA\n    vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);\n    colorDiff.r = max(max(colorDiff.r, colorDiff.g), colorDiff.b);\n    alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);\n#endif\n\n#if !defined(APPLY_GAMMA)\n    vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));\n    color = tempColor.rgb;\n    alpha = tempColor.a;\n#else\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_imagerySplitPosition;\n    // Split to the left\n    if (split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    outAlpha += sign(outAlpha) - 1.0;\n\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n\n    // When rendering imagery for a tile in multiple passes,\n    // some GPU/WebGL implementation combinations will not blend fragments in\n    // additional passes correctly if their computation includes an unmasked\n    // divide-by-zero operation,\n    // even if it's not in the output or if the output has alpha zero.\n    //\n    // For example, without sanitization for outAlpha,\n    // this renders without artifacts:\n    //   if (outAlpha == 0.0) { outColor = vec3(0.0); }\n    //\n    // but using czm_branchFreeTernary will cause portions of the tile that are\n    // alpha-zero in the additional pass to render as black instead of blending\n    // with the previous pass:\n    //   outColor = czm_branchFreeTernary(outAlpha == 0.0, vec3(0.0), outColor);\n    //\n    // So instead, sanitize against divide-by-zero,\n    // store this state on the sign of outAlpha, and correct on return.\n\n    return vec4(outColor, max(outAlpha, 0.0));\n}\n\nvec3 colorCorrect(vec3 rgb) {\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n#endif\n    return rgb;\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\n\nvoid main()\n{\n#ifdef TILE_LIMIT_RECTANGLE\n    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\n        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n        {\n            discard;\n        }\n#endif\n\n#ifdef SPLIT_TERRAIN\n    float splitPosition = czm_imagerySplitPosition;\n    if (u_terrainSplitDirection < 0.0 && gl_FragCoord.x > splitPosition) {\n        discard;\n    } else if (u_terrainSplitDirection > 0.0 && gl_FragCoord.x < splitPosition) {\n        discard;\n    }\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0));\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordiantes\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\n    float cameraDist;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n    }\n    else if (czm_sceneMode == czm_sceneModeColumbusView)\n    {\n        cameraDist = -czm_view[3].z;\n    }\n    else\n    {\n        cameraDist = length(czm_view[3]);\n    }\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    if (czm_sceneMode != czm_sceneMode3D) {\n        vec3 radii = czm_ellipsoidRadii;\n        float maxRadii = max(radii.x, max(radii.y, radii.z));\n        fadeOutDist -= maxRadii;\n        fadeInDist -= maxRadii;\n    }\n    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\n    float fade = 0.0;\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\n\n    float mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\n\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n    }\n#endif\n\n#ifdef APPLY_MATERIAL\n    czm_materialInput materialInput;\n    materialInput.st = v_textureCoordinates.st;\n    materialInput.normalEC = normalize(v_normalEC);\n    materialInput.slope = v_slope;\n    materialInput.height = v_height;\n    materialInput.aspect = v_aspect;\n    czm_material material = czm_getMaterial(materialInput);\n    color.xyz = mix(color.xyz, material.diffuse, material.alpha);\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalize(v_normalEC)) * 0.9 + 0.3, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, fade);\n    vec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\n    finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\n    vec3 fogColor = colorCorrect(v_fogMieColor) + finalColor.rgb * colorCorrect(v_fogRayleighColor);\n#ifndef HDR\n    const float fExposure = 2.0;\n    fogColor = vec3(1.0) - exp(-fExposure * fogColor);\n#endif\n#endif\n\n#ifdef FOG\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING)\n    float darken = clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), u_minimumBrightness, 1.0);\n    fogColor *= darken;\n#endif\n\n#ifdef HDR\n    const float modifier = 0.15;\n    finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor, modifier), finalColor.a);\n#else\n    finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor), finalColor.a);\n#endif\n#endif\n\n#ifdef GROUND_ATMOSPHERE\n    if (czm_sceneMode != czm_sceneMode3D)\n    {\n        gl_FragColor = finalColor;\n        return;\n    }\n\n#if defined(PER_FRAGMENT_GROUND_ATMOSPHERE) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0));\n    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\n    xy *= czm_viewport.zw * mpp * 0.5;\n\n    vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n\n    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\n    ellipsoidPosition = (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\n    AtmosphereColor atmosColor = computeGroundAtmosphereFromSpace(ellipsoidPosition, true);\n\n    vec3 groundAtmosphereColor = colorCorrect(atmosColor.mie) + finalColor.rgb * colorCorrect(atmosColor.rayleigh);\n#ifndef HDR\n    groundAtmosphereColor = vec3(1.0) - exp(-fExposure * groundAtmosphereColor);\n#endif\n\n    fadeInDist = u_nightFadeDistance.x;\n    fadeOutDist = u_nightFadeDistance.y;\n\n    float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n\n#ifdef HDR\n    // Some tweaking to make HDR look better\n    sunlitAtmosphereIntensity = max(sunlitAtmosphereIntensity * sunlitAtmosphereIntensity, 0.03);\n#endif\n\n    groundAtmosphereColor = mix(groundAtmosphereColor, fogColor, sunlitAtmosphereIntensity);\n#else\n    vec3 groundAtmosphereColor = fogColor;\n#endif\n\n#ifdef HDR\n    // Some tweaking to make HDR look better\n    groundAtmosphereColor = czm_saturation(groundAtmosphereColor, 1.6);\n#endif\n\n    finalColor = vec4(mix(finalColor.rgb, groundAtmosphereColor, fade), finalColor.a);\n#endif\n\n    gl_FragColor = finalColor;\n}\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedpositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_sunDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0) + 0.25 * czm_getSpecular(czm_moonDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n#ifdef HDR\n    specular *= 1.4;\n\n    float e = 0.2;\n    float d = 3.3;\n    float c = 1.7;\n\n    vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));\n#else\n    vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;\n#endif\n\n    return vec4(color, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n"}.call(t,i,t,e))||(e.exports=r)},1839:function(e,t,i){var r;void 0===(r=function(){"use strict";return"#ifdef QUANTIZATION_BITS12\nattribute vec4 compressed0;\nattribute float compressed1;\n#else\nattribute vec4 position3DAndHeight;\nattribute vec4 textureCoordAndEncodedNormals;\n#endif\n\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\n\n// Uniforms for 2D Mercator projection\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\n\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nvarying float v_slope;\nvarying float v_aspect;\nvarying float v_height;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nvarying float v_distance;\nvarying vec3 v_fogMieColor;\nvarying vec3 v_fogRayleighColor;\n#endif\n\n// These functions are generated at runtime.\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\n\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return u_modifiedModelViewProjection * vec4(position, 1.0);\n}\n\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\n    // The width of a tile at level 11, in radians and assuming a single root tile, is\n    //   2.0 * czm_pi / pow(2.0, 11.0)\n    // We want to just linearly interpolate the 2D position from the texture coordinates\n    // when we're at this level or higher.  The constant below is the expression\n    // above evaluated and then rounded up at the 4th significant digit.\n    const float maxTileWidth = 0.003068;\n    float positionFraction = textureCoordinates.y;\n    float southLatitude = u_southAndNorthLatitude.x;\n    float northLatitude = u_southAndNorthLatitude.y;\n    if (northLatitude - southLatitude > maxTileWidth)\n    {\n        float southMercatorY = u_southMercatorYAndOneOverHeight.x;\n        float oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\n\n        float currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\n        currentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\n        positionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n    }\n    return positionFraction;\n}\n\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\n    return textureCoordinates.y;\n}\n\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    return u_modifiedModelViewProjection * rtcPosition2D;\n}\n\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\n\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, height, textureCoordinates);\n}\n\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    // We do not do RTC while morphing, so there is potential for jitter.\n    // This is unlikely to be noticeable, though.\n    vec3 position3DWC = position + u_center3D;\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    vec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\n    return czm_modelViewProjection * morphPosition;\n}\n\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\n\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\n    vec2 xy = czm_decompressTextureCoordinates(compressed0.x);\n    vec2 zh = czm_decompressTextureCoordinates(compressed0.y);\n    vec3 position = vec3(xy, zh.x);\n    float height = zh.y;\n    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\n\n    height = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\n    position = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = compressed0.w;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#else\n    // A single float per element\n    vec3 position = position3DAndHeight.xyz;\n    float height = position3DAndHeight.w;\n    vec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = 0.0;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#endif\n\n    vec3 position3DWC = position + u_center3D;\n    gl_Position = getPosition(position, height, textureCoordinates);\n\n    v_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;  // position in model coordinates\n    vec3 normalMC = czm_octDecode(encodedNormal);\n    v_normalMC = normalMC;\n    v_normalEC = czm_normal3D * v_normalMC;\n#elif defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(GENERATE_POSITION) || defined(HDR)\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;  // position in model coordinates\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\n    AtmosphereColor atmosFogColor = computeGroundAtmosphereFromSpace(position3DWC, false);\n    v_fogMieColor = atmosFogColor.mie;\n    v_fogRayleighColor = atmosFogColor.rayleigh;\n    v_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n\n#ifdef APPLY_MATERIAL\n    float northPoleZ = czm_ellipsoidRadii.z;\n    vec3 northPolePositionMC = vec3(0.0, 0.0, northPoleZ);\n    vec3 ellipsoidNormal = normalize(v_positionMC); // For a sphere this is correct, but not generally for an ellipsoid.\n    vec3 vectorEastMC = normalize(cross(northPolePositionMC - v_positionMC, ellipsoidNormal));\n    float dotProd = abs(dot(ellipsoidNormal, v_normalMC));\n    v_slope = acos(dotProd);\n    vec3 normalRejected = ellipsoidNormal * dotProd;\n    vec3 normalProjected = v_normalMC - normalRejected;\n    vec3 aspectVector = normalize(normalProjected);\n    v_aspect = acos(dot(aspectVector, vectorEastMC));\n    float determ = dot(cross(vectorEastMC, aspectVector), ellipsoidNormal);\n    v_aspect = czm_branchFreeTernary(determ < 0.0, 2.0 * czm_pi - v_aspect, v_aspect);\n    v_height = height;\n#endif\n}\n"}.call(t,i,t,e))||(e.exports=r)},1840:function(e,t,i){var r;void 0===(r=function(){"use strict";return"/*!\n * Atmosphere code:\n *\n * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Atmosphere:\n //   Code:  http://sponeil.net/\n //   GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\nconst float fInnerRadius = 6378137.0;\nconst float fOuterRadius = 6378137.0 * 1.025;\nconst float fOuterRadius2 = fOuterRadius * fOuterRadius;\n\nconst float Kr = 0.0025;\nconst float Km = 0.0015;\nconst float ESun = 15.0;\n\nconst float fKrESun = Kr * ESun;\nconst float fKmESun = Km * ESun;\nconst float fKr4PI = Kr * 4.0 * czm_pi;\nconst float fKm4PI = Km * 4.0 * czm_pi;\n\nconst float fScale = 1.0 / (fOuterRadius - fInnerRadius);\nconst float fScaleDepth = 0.25;\nconst float fScaleOverScaleDepth = fScale / fScaleDepth;\n\nstruct AtmosphereColor\n{\n    vec3 mie;\n    vec3 rayleigh;\n};\n\nconst int nSamples = 2;\nconst float fSamples = 2.0;\n\nfloat scale(float fCos)\n{\n    float x = 1.0 - fCos;\n    return fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\nAtmosphereColor computeGroundAtmosphereFromSpace(vec3 v3Pos, bool useSunLighting)\n{\n\tvec3 v3InvWavelength = vec3(1.0 / pow(0.650, 4.0), 1.0 / pow(0.570, 4.0), 1.0 / pow(0.475, 4.0));\n\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n    vec3 v3Ray = v3Pos - czm_viewerPositionWC;\n    float fFar = length(v3Ray);\n    v3Ray /= fFar;\n\n    float fCameraHeight = length(czm_viewerPositionWC);\n    float fCameraHeight2 = fCameraHeight * fCameraHeight;\n\n    // This next line is an ANGLE workaround. It is equivalent to B = 2.0 * dot(czm_viewerPositionWC, v3Ray),\n    // which is what it should be, but there are problems at the poles.\n    float B = 2.0 * length(czm_viewerPositionWC) * dot(normalize(czm_viewerPositionWC), v3Ray);\n    float C = fCameraHeight2 - fOuterRadius2;\n    float fDet = max(0.0, B*B - 4.0 * C);\n    float fNear = 0.5 * (-B - sqrt(fDet));\n\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 v3Start = czm_viewerPositionWC + v3Ray * fNear;\n    fFar -= fNear;\n    float fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\n\n    // The light angle based on the sun position would be:\n    //    dot(czm_sunDirectionWC, v3Pos) / length(v3Pos);\n    // When we want the atmosphere to be uniform over the globe so it is set to 1.0.\n\n    float fLightAngle = czm_branchFreeTernary(useSunLighting, dot(czm_sunDirectionWC, v3Pos) / length(v3Pos), 1.0);\n    float fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\n    float fCameraScale = scale(fCameraAngle);\n    float fLightScale = scale(fLightAngle);\n    float fCameraOffset = fDepth*fCameraScale;\n    float fTemp = (fLightScale + fCameraScale);\n\n    // Initialize the scattering loop variables\n    float fSampleLength = fFar / fSamples;\n    float fScaledLength = fSampleLength * fScale;\n    vec3 v3SampleRay = v3Ray * fSampleLength;\n    vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n\n    // Now loop through the sample rays\n    vec3 v3FrontColor = vec3(0.0);\n    vec3 v3Attenuate = vec3(0.0);\n    for(int i=0; i<nSamples; i++)\n    {\n        float fHeight = length(v3SamplePoint);\n        float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\n        float fScatter = fDepth*fTemp - fCameraOffset;\n        v3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\n        v3FrontColor += v3Attenuate * (fDepth * fScaledLength);\n        v3SamplePoint += v3SampleRay;\n    }\n\n    AtmosphereColor color;\n    color.mie = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\n    color.rayleigh = v3Attenuate; // Calculate the attenuation factor for the ground\n\n    return color;\n}\n\n"}.call(t,i,t,e))||(e.exports=r)},1841:function(e,t,i){var r,n;r=[i(8),i(20),i(441),i(77),i(431),i(44)],void 0===(n=function(e,t,i,r,n,o){"use strict";function a(e,t,i,r,n){this.numberOfDayTextures=e,this.flags=t,this.material=i,this.shaderProgram=r,this.clippingShaderState=n}function s(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}return s.prototype.getShaderProgram=function(t){var s=t.frameState,l=t.surfaceTile,u=t.numberOfDayTextures,c=t.applyBrightness,d=t.applyContrast,h=t.applyHue,p=t.applySaturation,m=t.applyGamma,f=t.applyAlpha,_=t.applySplit,g=t.showReflectiveOcean,v=t.showOceanWaves,y=t.enableLighting,x=t.showGroundAtmosphere,w=t.perFragmentGroundAtmosphere,T=t.hasVertexNormals,C=t.useWebMercatorProjection,E=t.enableFog,A=t.enableClippingPlanes,S=t.clippingPlanes,P=t.clippedByBoundaries,b=t.splitTerrain,D=t.hasImageryLayerCutout,O=t.colorCorrect,I=t.highlightFillTile,M=t.colorToAlpha,N=0,F="",R=l.renderedMesh.encoding;R.quantization===i.BITS12&&(N=1,F="QUANTIZATION_BITS12");var L=0,V="";e(l.vertexArray)&&e(l.terrainData)&&!l.terrainData._createdByUpsampling||(L=1,V="DISABLE_GL_POSITION_LOG_DEPTH");var U=0,z="";P&&(U=1,z="TILE_LIMIT_RECTANGLE");var B=0,H="";D&&(B=1,H="APPLY_IMAGERY_CUTOUT");var k=s.mode,G=k|c<<2|d<<3|h<<4|p<<5|m<<6|f<<7|g<<8|v<<9|y<<10|x<<11|w<<12|T<<13|C<<14|E<<15|N<<16|_<<17|A<<18|L<<19|U<<20|B<<21|O<<22|I<<23|M<<24|b<<25,W=0;e(S)&&S.length>0&&(W=A?S.clippingPlanesState:0);var Y=l.surfaceShader;if(e(Y)&&Y.numberOfDayTextures===u&&Y.flags===G&&Y.material===this.material&&Y.clippingShaderState===W)return Y.shaderProgram;var j=this._shadersByTexturesFlags[u];if(e(j)||(j=this._shadersByTexturesFlags[u]=[]),Y=j[G],!e(Y)||Y.material!==this.material||Y.clippingShaderState!==W){var X=this.baseVertexShaderSource.clone(),Q=this.baseFragmentShaderSource.clone();0!==W&&Q.sources.unshift(n(S,s.context)),X.defines.push(F,V),Q.defines.push("TEXTURE_UNITS "+u,z,H),c&&Q.defines.push("APPLY_BRIGHTNESS"),d&&Q.defines.push("APPLY_CONTRAST"),h&&Q.defines.push("APPLY_HUE"),p&&Q.defines.push("APPLY_SATURATION"),m&&Q.defines.push("APPLY_GAMMA"),f&&Q.defines.push("APPLY_ALPHA"),g&&(Q.defines.push("SHOW_REFLECTIVE_OCEAN"),X.defines.push("SHOW_REFLECTIVE_OCEAN")),v&&Q.defines.push("SHOW_OCEAN_WAVES"),M&&Q.defines.push("APPLY_COLOR_TO_ALPHA"),y&&(T?(X.defines.push("ENABLE_VERTEX_LIGHTING"),Q.defines.push("ENABLE_VERTEX_LIGHTING")):(X.defines.push("ENABLE_DAYNIGHT_SHADING"),Q.defines.push("ENABLE_DAYNIGHT_SHADING"))),x&&(X.defines.push("GROUND_ATMOSPHERE"),Q.defines.push("GROUND_ATMOSPHERE"),w&&Q.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE")),X.defines.push("INCLUDE_WEB_MERCATOR_Y"),Q.defines.push("INCLUDE_WEB_MERCATOR_Y"),E&&(X.defines.push("FOG"),Q.defines.push("FOG")),_&&Q.defines.push("APPLY_SPLIT"),A&&Q.defines.push("ENABLE_CLIPPING_PLANES"),b&&Q.defines.push("SPLIT_TERRAIN"),O&&Q.defines.push("COLOR_CORRECT"),I&&Q.defines.push("HIGHLIGHT_FILL_TILE");var q="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates)\n    {\n        vec4 color = initialColor;\n";D&&(q+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(var Z=0;Z<u;++Z)q+=D?"        cutoutAndColorResult = u_dayTextureCutoutRectangles["+Z+"];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n":"        color = sampleAndBlend(\n",q+="            color,\n            u_dayTextures["+Z+"],\n            u_dayTextureUseWebMercatorT["+Z+"] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle["+Z+"],\n            u_dayTextureTranslationAndScale["+Z+"],\n            "+(f?"u_dayTextureAlpha["+Z+"]":"1.0")+",\n            "+(c?"u_dayTextureBrightness["+Z+"]":"0.0")+",\n            "+(d?"u_dayTextureContrast["+Z+"]":"0.0")+",\n            "+(h?"u_dayTextureHue["+Z+"]":"0.0")+",\n            "+(p?"u_dayTextureSaturation["+Z+"]":"0.0")+",\n            "+(m?"u_dayTextureOneOverGamma["+Z+"]":"0.0")+",\n            "+(_?"u_dayTextureSplit["+Z+"]":"0.0")+",\n            "+(M?"u_colorsToAlpha["+Z+"]":"vec4(0.0)")+"\n        );\n",D&&(q+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");q+="        return color;\n    }",Q.sources.push(q),X.sources.push(function(e){var t;switch(e){case o.SCENE3D:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case o.SCENE2D:case o.COLUMBUS_VIEW:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case o.MORPHING:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return t}(k)),X.sources.push(function(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}(C));var K=r.fromCache({context:s.context,vertexShaderSource:X,fragmentShaderSource:Q,attributeLocations:R.getAttributeLocations()});Y=j[G]=new a(u,G,this.material,K,W)}return l.surfaceShader=Y,Y.shaderProgram},s.prototype.destroy=function(){var i,r,n=this._shadersByTexturesFlags;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];if(!e(a))continue;for(i in a)a.hasOwnProperty(i)&&(r=a[i],e(r)&&r.shaderProgram.destroy())}return t(this)},s}.apply(t,r))||(e.exports=n)},1842:function(e,t,i){var r,n;r=[i(33),i(326),i(24),i(12),i(49),i(32),i(22),i(67),i(58),i(9),i(8),i(10),i(20),i(11),i(25),i(64),i(121),i(50),i(93),i(14),i(28),i(120),i(115),i(45),i(29),i(437),i(329),i(441),i(496),i(166),i(113),i(78),i(83),i(68),i(69),i(55),i(95),i(87),i(268),i(274),i(284),i(325),i(305),i(745),i(140),i(316),i(74),i(112),i(360),i(44),i(102),i(1843),i(746)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O,I,M,N,F,R,L,V,U,z,B,H,k,G,W,Y,j,X,Q,q,Z,K,J){"use strict";function $(e){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.showGroundAtmosphere=!1,this.shadows=Z.RECEIVE_ONLY,this.splitDirection=W.NONE,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._errorEvent=new m,this._imageryLayers.layerAdded.addEventListener($.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener($.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener($.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener($.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new m,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new a(0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=E.clone(E.MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1}function ee(e,t){var i=e.loadingImagery;c(i)||(i=e.readyImagery);var r=t.loadingImagery;return c(r)||(r=t.readyImagery),i.imageryLayer._layerIndex-r.imageryLayer._layerIndex}d($.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){this._baseColor=e,this._firstPassInitialColor=n.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,c(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){H.setOwner(e,this,"_clippingPlanes")}}}),$.prototype.update=function(e){this._imageryLayers._update()},$.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile(function(e){e.data.imagery.sort(ee)})),function(e,t){var i=t.creditDisplay;e._terrainProvider.ready&&c(e._terrainProvider.credit)&&i.addCredit(e._terrainProvider.credit);for(var r=e._imageryLayers,n=0,o=r.length;n<o;++n){var a=r.get(n).imageryProvider;a.ready&&c(a.credit)&&i.addCredit(a.credit)}}(this,e);for(var t=this._vertexArraysToDestroy,i=t.length,r=0;r<i;++r)G._freeVertexArray(t[r]);t.length=0},$.prototype.beginUpdate=function(e){for(var t=this._tilesToRenderByTextureCount,i=0,r=t.length;i<r;++i){var n=t[i];c(n)&&(n.length=0)}var o=this._clippingPlanes;c(o)&&o.enabled&&o.update(e),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1},$.prototype.endUpdate=function(e){c(this._renderState)||(this._renderState=R.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:k.LESS}}),this._blendRenderState=R.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:k.LESS_OR_EQUAL},blending:V.ALPHA_BLEND})),this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&K.updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);for(var t=this._tilesToRenderByTextureCount,i=0,r=t.length;i<r;++i){var n=t[i];if(c(n))for(var o=0,a=n.length;o<a;++o)Se(this,n[o],e)}},$.prototype.updateForPick=function(e){for(var t=this._drawCommands,i=0,r=this._usedDrawCommands;i<r;++i)e.commandList.push(t[i])},$.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},$.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},$.prototype.loadTile=function(e,t){var i,r=t.data,n=!0;c(r)&&(n=r.boundingVolumeSourceTile!==t||t._lastSelectionResult===B.CULLED_BUT_NEEDED,i=r.terrainState),G.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this._vertexArraysToDestroy,n),r=t.data,n&&i!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)&&r.boundingVolumeSourceTile===t&&(n=!1,G.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this._vertexArraysToDestroy,n))};var te=new e,ie=new E,re=new E,ne=new o;function oe(e,t){if(t.west<t.east)return t;var i=E.clone(t,re);return E.center(e,ne).longitude>0?i.east=y.PI:i.west=-y.PI,i}$.prototype.computeTileVisibility=function(t,i,n){var o=this.computeDistanceToTile(t,i);if(t._distance=o,i.fog.enabled&&y.fog(o,i.fog.density)>=1)return b.NONE;var a=t.data,s=a.tileBoundingRegion;if(void 0===a.boundingVolumeSourceTile)return b.PARTIAL;var l=i.cullingVolume,u=a.orientedBoundingBox;!c(u)&&c(a.renderedMesh)&&(u=a.renderedMesh.boundingSphere3D),a.clippedByBoundaries=!1;var d=oe(t.rectangle,this.cartographicLimitRectangle),h=E.simpleIntersection(d,t.rectangle,ie);if(!c(h))return b.NONE;if(E.equals(h,t.rectangle)||(a.clippedByBoundaries=!0),i.mode!==q.SCENE3D&&(u=te,e.fromRectangleWithHeights2D(t.rectangle,i.mapProjection,s.minimumHeight,s.maximumHeight,u),r.fromElements(u.center.z,u.center.x,u.center.y,u.center),i.mode===q.MORPHING&&c(a.renderedMesh)&&(u=e.union(a.renderedMesh.boundingSphere3D,u,u))),!c(u))return v.INTERSECTING;var p=this._clippingPlanes;if(c(p)&&p.enabled){var m=p.computeIntersectionWithBoundingVolume(u);if(t.isClipped=m!==v.INSIDE,m===v.OUTSIDE)return b.NONE}var f=l.computeVisibility(u);if(f===v.OUTSIDE)return b.NONE;var _=i.mode===q.SCENE3D&&i.camera.frustum instanceof T;if(i.mode===q.SCENE3D&&!_&&c(n)){var g=a.occludeePointInScaledSpace;return c(g)?n.ellipsoid.isScaledSpacePointVisible(g)?f:b.NONE:f}return f},$.prototype.canRefine=function(e){return!!c(e.data.terrainData)||void 0!==this.terrainProvider.getTileDataAvailable(2*e.x,2*e.y,e.level+1)};var ae=[],se=[];$.prototype.canRenderWithoutLosingDetail=function(e,t){var i=e.data,r=ae;r.length=this._imageryLayers.length;var n,o,a,s=!1,l=!1;for(c(i)&&(s=i.terrainState===J.READY,l=!0,n=i.imagery),o=0,a=r.length;o<a;++o)r[o]=l;if(c(n))for(o=0,a=n.length;o<a;++o){var u=n[o],d=u.loadingImagery,h=!c(d)||d.state===U.FAILED||d.state===U.INVALID,p=(u.loadingImagery||u.readyImagery).imageryLayer._layerIndex;r[p]=h&&r[p]}var m=this.quadtree._lastSelectionFrameNumber,f=se;for(f.length=0,f.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);f.length>0;){var _=f.pop(),g=_._lastSelectionResultFrame===m?_._lastSelectionResult:B.NONE;if(g===B.RENDERED){var v=_.data;if(!c(v))continue;if(!s&&_.data.terrainState===J.READY)return!1;var y=_.data.imagery;for(o=0,a=y.length;o<a;++o){var x=y[o],w=x.loadingImagery,T=!c(w)||w.state===U.FAILED||w.state===U.INVALID,C=(x.loadingImagery||x.readyImagery).imageryLayer._layerIndex;if(T&&!r[C])return!1}}else g===B.REFINED&&f.push(_.southwestChild,_.southeastChild,_.northwestChild,_.northeastChild)}return!0};var le=new r;$.prototype.computeTileLoadPriority=function(e,t){var i=e.data;if(void 0===i)return 0;var n=i.orientedBoundingBox;if(void 0===n)return 0;var o=t.camera.positionWC,a=t.camera.directionWC,s=r.subtract(n.center,o,le),l=r.magnitude(s);return l<y.EPSILON5?0:(r.divideByScalar(s,l,s),(1-r.dot(s,a))*e._distance)};var ue=new x,ce=new x,de=new n,he=new n,pe=new r,me=new r,fe=new r,_e=new r;$.prototype.showTileThisFrame=function(e,t){for(var i=0,r=e.data.imagery,n=0,o=r.length;n<o;++n){var a=r[n];c(a.readyImagery)&&0!==a.readyImagery.imageryLayer.alpha&&++i}var s=this._tilesToRenderByTextureCount[i];c(s)||(s=[],this._tilesToRenderByTextureCount[i]=s),s.push(e);var l=e.data;c(l.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;var u=this._debug;++u.tilesRendered,u.texturesRendered+=i};var ge=[new r,new r,new r,new r];$.prototype.computeDistanceToTile=function(e,t){var i=function(e,t,i){var r=e.data;void 0===r&&(r=e.data=new G);void 0===r.tileBoundingRegion&&(r.tileBoundingRegion=new z({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:e.tilingScheme.ellipsoid,minimumHeight:0,maximumHeight:0}));var n=r.terrainData,o=r.mesh,a=r.tileBoundingRegion;if(void 0!==o&&void 0!==o.minimumHeight&&void 0!==o.maximumHeight)return a.minimumHeight=o.minimumHeight,a.maximumHeight=o.maximumHeight,e;if(void 0!==n&&void 0!==n._minimumHeight&&void 0!==n._maximumHeight)return a.minimumHeight=n._minimumHeight*i.terrainExaggeration,a.maximumHeight=n._maximumHeight*i.terrainExaggeration,e;a.minimumHeight=Number.NaN,a.maximumHeight=Number.NaN;var s=e.parent;for(;void 0!==s;){var l=s.data;if(void 0!==l){var u=l.mesh;if(void 0!==u&&void 0!==u.minimumHeight&&void 0!==u.maximumHeight)return a.minimumHeight=u.minimumHeight,a.maximumHeight=u.maximumHeight,s;var c=l.terrainData;if(void 0!==c&&void 0!==c._minimumHeight&&void 0!==c._maximumHeight)return a.minimumHeight=c._minimumHeight*i.terrainExaggeration,a.maximumHeight=c._maximumHeight*i.terrainExaggeration,s}s=s.parent}return}(e,this.terrainProvider,t),n=e.data,o=n.tileBoundingRegion;if(void 0===i)return 9999999999;if(n.boundingVolumeSourceTile!==i){n.boundingVolumeSourceTile=i;var a=e.rectangle;c(a)&&a.width<y.PI_OVER_TWO+y.EPSILON5&&(n.orientedBoundingBox=w.fromRectangle(e.rectangle,o.minimumHeight,o.maximumHeight,e.tilingScheme.ellipsoid,n.orientedBoundingBox),n.occludeePointInScaledSpace=function(e,t,i,n,o){var a=e.quadtree._occluders.ellipsoid,s=a.ellipsoid,l=ge;return r.fromRadians(i.west,i.south,n,s,l[0]),r.fromRadians(i.east,i.south,n,s,l[1]),r.fromRadians(i.west,i.north,n,s,l[2]),r.fromRadians(i.east,i.north,n,s,l[3]),a.computeHorizonCullingPoint(t,l,o)}(this,n.orientedBoundingBox.center,e.rectangle,o.maximumHeight,n.occludeePointInScaledSpace))}var s=o.minimumHeight,l=o.maximumHeight;if(n.boundingVolumeSourceTile!==e){var u=t.camera.positionCartographic.height;Math.abs(u-s)>Math.abs(u-l)?(o.minimumHeight=s,o.maximumHeight=s):(o.minimumHeight=l,o.maximumHeight=l)}var d=o.distanceToCamera(t);return o.minimumHeight=s,o.maximumHeight=l,d},$.prototype.isDestroyed=function(){return!1},$.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),h(this)},$.prototype._onLayerAdded=function(e,t){if(e.show){var i=this._terrainProvider,r=this,n=e.imageryProvider,o=this._imageryLayersUpdatedEvent;n._reload=function(){e._imageryCache={},r._quadtree.forEachLoadedTile(function(t){if(!c(t._loadedCallbacks[e._layerIndex])){var r,n=t.data.imagery,o=n.length,a=-1,s=0;for(r=0;r<o;++r){var l=n[r];if(u(l.readyImagery,l.loadingImagery).imageryLayer===e)-1===a&&(a=r),++s;else if(-1!==a)break}if(-1!==a){var d=a+s;e._createTileImagerySkeletons(t,i,d)&&(t._loadedCallbacks[e._layerIndex]=function(e,t,i){return function(r){var n,o,a,s=-1,l=r.data.imagery,d=l.length;for(a=0;a<d;++a)if(n=l[a],(o=u(n.readyImagery,n.loadingImagery)).imageryLayer===t){s=a;break}if(-1!==s){var h=s+e;if(n=l[h],o=c(n)?u(n.readyImagery,n.loadingImagery):void 0,!c(o)||o.imageryLayer!==t)return!t._createTileImagerySkeletons(r,i,h);for(a=s;a<h;++a)l[a].freeResources();l.splice(s,e)}return!0}}(s,e,i),t.state=Q.LOADING)}}})},this._quadtree.forEachLoadedTile(function(t){e._createTileImagerySkeletons(t,i)&&(t.state=Q.LOADING,0===t.level||t._lastSelectionResultFrame===r.quadtree._lastSelectionFrameNumber&&t._lastSelectionResult===B.RENDERED||(t.renderable=!1))}),this._layerOrderChanged=!0,o.raiseEvent()}},$.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile(function(t){for(var i=t.data.imagery,r=-1,n=0,o=0,a=i.length;o<a;++o){var s=i[o],l=s.loadingImagery;if(c(l)||(l=s.readyImagery),l.imageryLayer===e)-1===r&&(r=o),s.freeResources(),++n;else if(-1!==r)break}-1!==r&&i.splice(r,n)}),c(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},$.prototype._onLayerMoved=function(e,t,i){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},$.prototype._onLayerShownOrHidden=function(e,t,i){i?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};var ve,ye,xe,we=new x;function Te(e,t){return{u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view,i=x.multiplyByPoint(t,this.properties.rtc,me);return x.setTranslation(t,i,ue),ue},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view,i=e.context.uniformState.projection,r=x.multiplyByPoint(t,this.properties.rtc,me);return x.setTranslation(t,r,ce),x.multiply(i,ce,ce),ce},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){var i=t._clippingPlanes;return c(i)&&c(i.texture)?i.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){var i=t._clippingPlanes;return c(i)?x.multiply(e.context.uniformState.view,i.modelMatrix,we):x.IDENTITY},u_clippingPlanesEdgeStyle:function(){var e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_terrainSplitDirection:function(){return t.splitDirection},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},properties:{initialColor:new n(0,0,.5,1),fillHighlightColor:new a(0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new i(65e5,9e6),nightFadeDistance:new i(1e7,4e7),hsbShift:new r,center3D:void 0,rtc:new r,modifiedModelView:new x,tileRectangle:new n,dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new i,southMercatorYAndOneOverHeight:new i,waterMask:void 0,waterMaskTranslationAndScale:new n,minMaxHeight:new i,scaleAndBias:new x,clippingPlanesEdgeColor:a.clone(a.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new n}}}function Ce(e,t,i){var r,n,o=i.data;if(c(o.vertexArray)?(r=o.mesh,n=o.vertexArray):c(o.fill)&&c(o.fill.vertexArray)&&(r=o.fill.mesh,n=o.fill.vertexArray),c(r)&&c(n)){if(c(o.wireframeVertexArray)){if(o.wireframeVertexArray.mesh===r)return;o.wireframeVertexArray.destroy(),o.wireframeVertexArray=void 0}o.wireframeVertexArray=function(e,t,i){var r={indices:i.indices,primitiveType:C.TRIANGLES};_.toWireframe(r);var n=r.indices,o=O.createIndexBuffer({context:e,typedArray:n,usage:I.STATIC_DRAW,indexDatatype:g.fromSizeInBytes(n.BYTES_PER_ELEMENT)});return new L({context:e,attributes:t._attributes,indexBuffer:o})}(e,n,r),o.wireframeVertexArray.mesh=r}}!function(){var e,i,n=new f({geometry:t.fromDimensions({dimensions:new r(2,2,2)})}),o=new f({geometry:new A({radius:1})}),a=new x;function l(e){return new X({geometryInstances:e,appearance:new j({translucent:!1,flat:!0}),asynchronous:!1})}ve=function(t,r){return t===e?i:(xe(),e=t,a=x.fromRotationTranslation(t.halfAxes,t.center,a),n.modelMatrix=a,n.attributes.color=s.fromColor(r),i=l(n))},ye=function(t,r){return t===e?i:(xe(),e=t,a=x.fromTranslation(t.center,a),a=x.multiplyByUniformScale(a,t.radius,a),o.modelMatrix=a,o.attributes.color=s.fromColor(r),i=l(o))},xe=function(){c(i)&&(i.destroy(),i=void 0,e=void 0)}}();var Ee=new n(0,0,0,0),Ae={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0};function Se(t,i,o){var s=i.data;c(s.vertexArray)||(void 0===s.fill&&(s.fill=new K(i)),s.fill.update(t,o));var u=o.creditDisplay,d=s.terrainData;if(c(d)&&c(d.credits))for(var h=d.credits,p=0,m=h.length;p<m;++p)u.addCredit(h[p]);var f=M.maximumTextureImageUnits,_=s.waterMaskTexture,g=s.waterMaskTranslationAndScale;!c(_)&&c(s.fill)&&(_=s.fill.waterMaskTexture,g=s.fill.waterMaskTranslationAndScale);var v=t.hasWaterMask&&c(_),T=t.oceanNormalMap,A=v&&c(T),S=t.terrainProvider.ready&&t.terrainProvider.hasVertexNormals,b=o.fog.enabled,O=t.showGroundAtmosphere,I=Z.castShadows(t.shadows),R=Z.receiveShadows(t.shadows),L=t.hueShift,V=t.saturationShift,U=t.brightnessShift,z=!(y.equalsEpsilon(L,0,y.EPSILON7)&&y.equalsEpsilon(V,0,y.EPSILON7)&&y.equalsEpsilon(U,0,y.EPSILON7)),B=!1;if(O){var H,k=o.mode,G=o.camera;H=k===q.SCENE2D||k===q.COLUMBUS_VIEW?G.positionCartographic.height:r.magnitude(G.positionWC);var j=t.nightFadeOutDistance;k!==q.SCENE3D&&(j-=o.mapProjection.ellipsoid.maximumRadius),B=H>j}v&&--f,A&&--f,c(o.shadowState)&&o.shadowState.shadowsEnabled&&--f,c(t.clippingPlanes)&&t.clippingPlanes.enabled&&--f;var X=s.renderedMesh,Q=X.center,J=X.encoding,$=de,ee=0,te=0,re=0,ne=0,ae=!1;if(o.mode!==q.SCENE3D){var se=o.mapProjection,le=se.project(E.southwest(i.rectangle),fe),ue=se.project(E.northeast(i.rectangle),_e);if($.x=le.x,$.y=le.y,$.z=ue.x,$.w=ue.y,o.mode!==q.MORPHING&&((Q=pe).x=0,Q.y=.5*($.z+$.x),Q.z=.5*($.w+$.y),$.x-=Q.y,$.y-=Q.z,$.z-=Q.y,$.w-=Q.z),o.mode===q.SCENE2D&&J.quantization===P.BITS12){var ce=1/(Math.pow(2,12)-1)*.5,me=($.z-$.x)*ce,ge=($.w-$.y)*ce;$.x-=me,$.y-=ge,$.z+=me,$.w+=ge}se instanceof D&&(ee=i.rectangle.south,te=i.rectangle.north,re=D.geodeticLatitudeToMercatorAngle(ee),ne=1/(D.geodeticLatitudeToMercatorAngle(te)-re),ae=!0)}var we=Ae;we.frameState=o,we.surfaceTile=s,we.showReflectiveOcean=v,we.showOceanWaves=A,we.enableLighting=t.enableLighting,we.showGroundAtmosphere=O,we.perFragmentGroundAtmosphere=B,we.hasVertexNormals=S,we.useWebMercatorProjection=ae,we.clippedByBoundaries=s.clippedByBoundaries,we.splitTerrain=t.splitDirection!==W.NONE;var Se=s.imagery,Pe=0,be=Se.length,De=t._renderState,Oe=t._blendRenderState,Ie=De,Me=t._firstPassInitialColor,Ne=o.context;c(t._debug.boundingSphereTile)||xe();do{var Fe,Re,Le=0;if(t._drawCommands.length<=t._usedDrawCommands?((Fe=new N).owner=i,Fe.cull=!1,Fe.boundingVolume=new e,Fe.orientedBoundingBox=void 0,Re=Te(o,t),t._drawCommands.push(Fe),t._uniformMaps.push(Re)):(Fe=t._drawCommands[t._usedDrawCommands],Re=t._uniformMaps[t._usedDrawCommands]),Fe.owner=i,++t._usedDrawCommands,i===t._debug.boundingSphereTile){var Ve=s.orientedBoundingBox;c(Ve)?ve(Ve,a.RED).update(o):c(X)&&c(X.boundingSphere3D)&&ye(X.boundingSphere3D,a.RED).update(o)}var Ue=Re.properties;n.clone(Me,Ue.initialColor),Ue.oceanNormalMap=T,Ue.lightingFadeDistance.x=t.lightingFadeOutDistance,Ue.lightingFadeDistance.y=t.lightingFadeInDistance,Ue.nightFadeDistance.x=t.nightFadeOutDistance,Ue.nightFadeDistance.y=t.nightFadeInDistance,Ue.zoomedOutOceanSpecularIntensity=t.zoomedOutOceanSpecularIntensity;var ze=!c(s.vertexArray)&&c(t.fillHighlightColor)&&t.fillHighlightColor.alpha>0;ze&&a.clone(t.fillHighlightColor,Ue.fillHighlightColor),Ue.center3D=X.center,r.clone(Q,Ue.rtc),n.clone($,Ue.tileRectangle),Ue.southAndNorthLatitude.x=ee,Ue.southAndNorthLatitude.y=te,Ue.southMercatorYAndOneOverHeight.x=re,Ue.southMercatorYAndOneOverHeight.y=ne;var Be=he,He=oe(i.rectangle,t.cartographicLimitRectangle);r.fromElements(L,V,U,Ue.hsbShift);var ke=i.rectangle,Ge=1/ke.width,We=1/ke.height;Be.x=(He.west-ke.west)*Ge,Be.y=(He.south-ke.south)*We,Be.z=(He.east-ke.west)*Ge,Be.w=(He.north-ke.south)*We,n.clone(Be,Ue.localizedCartographicLimitRectangle);var Ye=b&&y.fog(i._distance,o.fog.density)>y.EPSILON3;z=z&&(Ye||O);for(var je=!1,Xe=!1,Qe=!1,qe=!1,Ze=!1,Ke=!1,Je=!1,$e=!1,et=!1;Le<f&&Pe<be;){var tt=Se[Pe],it=tt.readyImagery;if(++Pe,c(it)&&0!==it.imageryLayer.alpha){var rt=tt.useWebMercatorT?it.textureWebMercator:it.texture,nt=it.imageryLayer;c(tt.textureTranslationAndScale)||(tt.textureTranslationAndScale=nt._calculateTextureTranslationAndScale(i,tt)),Ue.dayTextures[Le]=rt,Ue.dayTextureTranslationAndScale[Le]=tt.textureTranslationAndScale,Ue.dayTextureTexCoordsRectangle[Le]=tt.textureCoordinateRectangle,Ue.dayTextureUseWebMercatorT[Le]=tt.useWebMercatorT,Ue.dayTextureAlpha[Le]=nt.alpha,Ke=Ke||1!==Ue.dayTextureAlpha[Le],Ue.dayTextureBrightness[Le]=nt.brightness,je=je||Ue.dayTextureBrightness[Le]!==Y.DEFAULT_BRIGHTNESS,Ue.dayTextureContrast[Le]=nt.contrast,Xe=Xe||Ue.dayTextureContrast[Le]!==Y.DEFAULT_CONTRAST,Ue.dayTextureHue[Le]=nt.hue,Qe=Qe||Ue.dayTextureHue[Le]!==Y.DEFAULT_HUE,Ue.dayTextureSaturation[Le]=nt.saturation,qe=qe||Ue.dayTextureSaturation[Le]!==Y.DEFAULT_SATURATION,Ue.dayTextureOneOverGamma[Le]=1/nt.gamma,Ze=Ze||Ue.dayTextureOneOverGamma[Le]!==1/Y.DEFAULT_GAMMA,Ue.dayTextureSplit[Le]=nt.splitDirection,Je=Je||0!==Ue.dayTextureSplit[Le];var ot=Ue.dayTextureCutoutRectangles[Le];if(c(ot)||(ot=Ue.dayTextureCutoutRectangles[Le]=new n),n.clone(n.ZERO,ot),c(nt.cutoutRectangle)){var at=oe(ke,nt.cutoutRectangle),st=E.simpleIntersection(at,ke,ie);$e=c(st)||$e,ot.x=(at.west-ke.west)*Ge,ot.y=(at.south-ke.south)*We,ot.z=(at.east-ke.west)*Ge,ot.w=(at.north-ke.south)*We}var lt=Ue.colorsToAlpha[Le];c(lt)||(lt=Ue.colorsToAlpha[Le]=new n);var ut=c(nt.colorToAlpha)&&nt.colorToAlphaThreshold>0;if(et=et||ut,ut){var ct=nt.colorToAlpha;lt.x=ct.red,lt.y=ct.green,lt.z=ct.blue,lt.w=nt.colorToAlphaThreshold}else lt.w=-1;if(c(it.credits))for(var dt=it.credits,ht=0,pt=dt.length;ht<pt;++ht)u.addCredit(dt[ht]);++Le}}Ue.dayTextures.length=Le,Ue.waterMask=_,n.clone(g,Ue.waterMaskTranslationAndScale),Ue.minMaxHeight.x=J.minimumHeight,Ue.minMaxHeight.y=J.maximumHeight,x.clone(J.matrix,Ue.scaleAndBias);var mt=t._clippingPlanes,ft=c(mt)&&mt.enabled&&i.isClipped;ft&&(Ue.clippingPlanesEdgeColor=a.clone(mt.edgeColor,Ue.clippingPlanesEdgeColor),Ue.clippingPlanesEdgeWidth=mt.edgeWidth),c(t.uniformMap)&&(Re=l(Re,t.uniformMap)),we.numberOfDayTextures=Le,we.applyBrightness=je,we.applyContrast=Xe,we.applyHue=Qe,we.applySaturation=qe,we.applyGamma=Ze,we.applyAlpha=Ke,we.applySplit=Je,we.enableFog=Ye,we.enableClippingPlanes=ft,we.clippingPlanes=mt,we.hasImageryLayerCutout=$e,we.colorCorrect=z,we.highlightFillTile=ze,we.colorToAlpha=et,Fe.shaderProgram=t._surfaceShaderSet.getShaderProgram(we),Fe.castShadows=I,Fe.receiveShadows=R,Fe.renderState=Ie,Fe.primitiveType=C.TRIANGLES,Fe.vertexArray=s.vertexArray||s.fill.vertexArray,Fe.uniformMap=Re,Fe.pass=F.GLOBE,t._debug.wireframe&&(Ce(Ne,0,i),c(s.wireframeVertexArray)&&(Fe.vertexArray=s.wireframeVertexArray,Fe.primitiveType=C.LINES));var _t=Fe.boundingVolume,gt=Fe.orientedBoundingBox;if(o.mode!==q.SCENE3D){var vt=s.tileBoundingRegion;e.fromRectangleWithHeights2D(i.rectangle,o.mapProjection,vt.minimumHeight,vt.maximumHeight,_t),r.fromElements(_t.center.z,_t.center.x,_t.center.y,_t.center),o.mode===q.MORPHING&&(_t=e.union(X.boundingSphere3D,_t,_t))}else Fe.boundingVolume=e.clone(X.boundingSphere3D,_t),Fe.orientedBoundingBox=w.clone(s.orientedBoundingBox,gt);Fe.dirty=!0,o.commandList.push(Fe),Ie=Oe,Me=Ee}while(Pe<be)}return $}.apply(t,r))||(e.exports=n)},1843:function(e,t,i){var r,n;r=[i(205),i(228),i(33),i(24),i(12),i(49),i(32),i(8),i(440),i(14),i(11),i(120),i(323),i(29),i(1844),i(328),i(329),i(166),i(745),i(284)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y){"use strict";function x(e){this.tile=e,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new o}x.prototype.update=function(e,t,i){this.changedThisFrame&&(U(e,t,this.tile,i),this.changedThisFrame=!1)},x.prototype.destroy=function(e){s(this.vertexArray)&&(s(e)?e.push(this.vertexArray):v._freeVertexArray(this.vertexArray,e),this.vertexArray=void 0),s(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)};var w=new h;function T(e,t,i,r,n,o,a,l,d){if(void 0!==r){for(var h=r;h&&(h._lastSelectionResultFrame!==n||y.wasKicked(h._lastSelectionResult)||y.originalResult(h._lastSelectionResult)===y.CULLED);){if(a)return;var p=h.parent;if(o>=m.NORTHWEST&&void 0!==p)switch(o){case m.NORTHWEST:h=h===p.northwestChild?p:void 0;break;case m.NORTHEAST:h=h===p.northeastChild?p:void 0;break;case m.SOUTHWEST:h=h===p.southwestChild?p:void 0;break;case m.SOUTHEAST:h=h===p.southeastChild?p:void 0}else h=p}if(void 0!==h)if(h._lastSelectionResult!==y.RENDERED){if(y.originalResult(r._lastSelectionResult)!==y.CULLED)switch(o){case m.WEST:T(e,t,i,r.northwestChild,n,o,!0,l,d),T(e,t,i,r.southwestChild,n,o,!0,l,d);break;case m.EAST:T(e,t,i,r.southeastChild,n,o,!0,l,d),T(e,t,i,r.northeastChild,n,o,!0,l,d);break;case m.SOUTH:T(e,t,i,r.southwestChild,n,o,!0,l,d),T(e,t,i,r.southeastChild,n,o,!0,l,d);break;case m.NORTH:T(e,t,i,r.northeastChild,n,o,!0,l,d),T(e,t,i,r.northwestChild,n,o,!0,l,d);break;case m.NORTHWEST:T(e,t,i,r.northwestChild,n,o,!0,l,d);break;case m.NORTHEAST:T(e,t,i,r.northeastChild,n,o,!0,l,d);break;case m.SOUTHWEST:T(e,t,i,r.southwestChild,n,o,!0,l,d);break;case m.SOUTHEAST:T(e,t,i,r.southeastChild,n,o,!0,l,d);break;default:throw new c("Invalid edge")}}else{if(s(h.data.vertexArray))return;!function(e,t,i,r,n,o,a,l){var c=r.data;if(void 0===c.fill)c.fill=new x(r);else if(c.fill.visitedFrame===o)return;c.fill.enqueuedFrame!==o&&(c.fill.enqueuedFrame=o,c.fill.changedThisFrame=!1,a.enqueue(r));!function(e,t,i,r,n,o){var a,l,c,d,h,p,f,_=r.data.fill,g=i.data.fill;s(g)?(g.visitedFrame=t.frameNumber,g.changedThisFrame&&(U(e,t,i,o),g.changedThisFrame=!1),a=i.data.fill.mesh):a=i.data.mesh;switch(n){case m.WEST:l=_.westMeshes,c=_.westTiles;break;case m.SOUTH:l=_.southMeshes,c=_.southTiles;break;case m.EAST:l=_.eastMeshes,c=_.eastTiles;break;case m.NORTH:l=_.northMeshes,c=_.northTiles;break;case m.NORTHWEST:return _.changedThisFrame=_.changedThisFrame||_.northwestMesh!==a,_.northwestMesh=a,void(_.northwestTile=i);case m.NORTHEAST:return _.changedThisFrame=_.changedThisFrame||_.northeastMesh!==a,_.northeastMesh=a,void(_.northeastTile=i);case m.SOUTHWEST:return _.changedThisFrame=_.changedThisFrame||_.southwestMesh!==a,_.southwestMesh=a,void(_.southwestTile=i);case m.SOUTHEAST:return _.changedThisFrame=_.changedThisFrame||_.southeastMesh!==a,_.southeastMesh=a,void(_.southeastTile=i)}if(i.level<=r.level)return _.changedThisFrame=_.changedThisFrame||l[0]!==a||1!==l.length,l[0]=a,c[0]=i,l.length=1,void(c.length=1);var v,y=i.rectangle,x=r.rectangle;switch(n){case m.WEST:for(v=(x.north-x.south)*u.EPSILON5,d=0;d<c.length&&(p=c[d],f=p.rectangle,!u.greaterThan(y.north,f.south,v));++d);for(h=d;h<c.length&&(p=c[h],f=p.rectangle,!u.greaterThanOrEquals(y.south,f.north,v));++h);break;case m.SOUTH:for(v=(x.east-x.west)*u.EPSILON5,d=0;d<c.length&&(p=c[d],f=p.rectangle,!u.lessThan(y.west,f.east,v));++d);for(h=d;h<c.length&&(p=c[h],f=p.rectangle,!u.lessThanOrEquals(y.east,f.west,v));++h);break;case m.EAST:for(v=(x.north-x.south)*u.EPSILON5,d=0;d<c.length&&(p=c[d],f=p.rectangle,!u.lessThan(y.south,f.north,v));++d);for(h=d;h<c.length&&(p=c[h],f=p.rectangle,!u.lessThanOrEquals(y.north,f.south,v));++h);break;case m.NORTH:for(v=(x.east-x.west)*u.EPSILON5,d=0;d<c.length&&(p=c[d],f=p.rectangle,!u.greaterThan(y.east,f.west,v));++d);for(h=d;h<c.length&&(p=c[h],f=p.rectangle,!u.greaterThanOrEquals(y.west,f.east,v));++h);}h-d==1?(_.changedThisFrame=_.changedThisFrame||l[d]!==a,l[d]=a,c[d]=i):(_.changedThisFrame=!0,l.splice(d,h-d,a),c.splice(d,h-d,i))}(e,t,i,r,n,l)}(e,t,i,h,o,n,l,d)}}}x.updateFillTiles=function(e,t,i,r){var n=e._quadtree,o=n._levelZeroTiles,a=n._lastSelectionFrameNumber,l=w;l.clear();for(var u=0;u<t.length;++u){var c=t[u];s(c.data.vertexArray)&&l.enqueue(t[u])}for(var d=l.dequeue();void 0!==d;){var h=d.findTileToWest(o),p=d.findTileToSouth(o),f=d.findTileToEast(o),_=d.findTileToNorth(o);T(e,i,d,h,a,m.EAST,!1,l,r),T(e,i,d,p,a,m.NORTH,!1,l,r),T(e,i,d,f,a,m.WEST,!1,l,r),T(e,i,d,_,a,m.SOUTH,!1,l,r);var g=h.findTileToNorth(o),v=h.findTileToSouth(o),y=f.findTileToNorth(o),x=f.findTileToSouth(o);T(e,i,d,g,a,m.SOUTHEAST,!1,l,r),T(e,i,d,y,a,m.SOUTHWEST,!1,l,r),T(e,i,d,v,a,m.NORTHEAST,!1,l,r),T(e,i,d,x,a,m.NORTHWEST,!1,l,r),d=l.dequeue()}};var C=new a,E=new a,A=new n,S=new n,P=new r,b=new r,D=new r;function O(){this.height=0,this.encodedNormal=new r}function I(e,t,i,r,n,o,a,l,u){if(s(n))return n;var c;if(s(o)&&s(a))c=.5*(o.height+a.height);else if(s(o))c=o.height;else if(s(a))c=a.height;else if(s(l))c=l.height;else{var d=e.tile.data.tileBoundingRegion,h=0,p=0;s(d)&&(h=d.minimumHeight,p=d.maximumHeight),c=.5*(h+p)}return j(e,t,i,r,c,u),u}var M={minimumHeight:0,maximumHeight:0},N=new O,F=new O,R=new O,L=new O,V="undefined"!=typeof Uint8Array?new Uint8Array(81):void 0;function U(t,o,a,u){v.initialize(a,t.terrainProvider,t._imageryLayers);var c=a.data,h=c.fill,p=a.rectangle,y=a.tilingScheme.ellipsoid,x=X(h,y,0,1,h.northwestTile,h.northwestMesh,h.northTiles,h.northMeshes,h.westTiles,h.westMeshes,R),w=X(h,y,0,0,h.southwestTile,h.southwestMesh,h.westTiles,h.westMeshes,h.southTiles,h.southMeshes,N),T=X(h,y,1,0,h.southeastTile,h.southeastMesh,h.southTiles,h.southMeshes,h.eastTiles,h.eastMeshes,F),A=X(h,y,1,1,h.northeastTile,h.northeastMesh,h.eastTiles,h.eastMeshes,h.northTiles,h.northMeshes,L);x=I(h,y,0,1,x,w,A,T,R),w=I(h,y,0,0,w,x,T,A,N),T=I(h,y,1,1,T,w,A,x,F),A=I(h,y,1,1,A,T,x,w,L);var b,O,U=w.height,B=T.height,H=x.height,k=A.height,G=Math.min(U,B,H,k),W=Math.max(U,B,H,k),Y=.5*(G+W),j=t.getLevelMaximumGeometricError(a.level),Q=y.maximumRadius-j,Z=4*Math.acos(Q/y.maximumRadius);if(Z*=1.5,p.width>Z&&W-G<=j){var K=new l({width:9,height:9,buffer:V,structure:{heightOffset:W}});h.mesh=K._createMeshSync(a.tilingScheme,a.x,a.y,a.level,1)}else{var J=new f(void 0,void 0,void 0,void 0,!0,!0),$=E;$.longitude=.5*(p.east+p.west),$.latitude=.5*(p.north+p.south),$.height=Y,J.center=y.cartographicToCartesian($,J.center);var te,ie=5;for(b=0,O=(te=h.westMeshes).length;b<O;++b)ie+=te[b].eastIndicesNorthToSouth.length;for(b=0,O=(te=h.southMeshes).length;b<O;++b)ie+=te[b].northIndicesWestToEast.length;for(b=0,O=(te=h.eastMeshes).length;b<O;++b)ie+=te[b].westIndicesSouthToNorth.length;for(b=0,O=(te=h.northMeshes).length;b<O;++b)ie+=te[b].southIndicesEastToWest.length;var re=M;re.minimumHeight=G,re.maximumHeight=W;var ne=J.getStride(),oe=new Float32Array(ie*ne),ae=0,se=ae,le=ae=q(h,y,J,oe,ae=z(y,p,J,oe,ae,0,1,x.height,x.encodedNormal,1,re),h.westTiles,h.westMeshes,m.EAST,re),ue=ae=q(h,y,J,oe,ae=z(y,p,J,oe,ae,0,0,w.height,w.encodedNormal,0,re),h.southTiles,h.southMeshes,m.NORTH,re),ce=ae=q(h,y,J,oe,ae=z(y,p,J,oe,ae,1,0,T.height,T.encodedNormal,0,re),h.eastTiles,h.eastMeshes,m.WEST,re);ae=q(h,y,J,oe,ae=z(y,p,J,oe,ae,1,1,A.height,A.encodedNormal,1,re),h.northTiles,h.northMeshes,m.SOUTH,re),G=re.minimumHeight,W=re.maximumHeight;var de=d.fromRectangle(p,G,W,a.tilingScheme.ellipsoid),he=g.geodeticLatitudeToMercatorAngle(p.south),pe=1/(g.geodeticLatitudeToMercatorAngle(p.north)-he),me=(g.geodeticLatitudeToMercatorAngle($.latitude)-he)*pe;y.geodeticSurfaceNormalCartographic(C,S);var fe=e.octEncode(S,P),_e=ae;J.encode(oe,ae*ne,de.center,r.fromElements(.5,.5,D),Y,fe,me);var ge,ve=++ae,ye=3*(ve-1),xe=ye*(ve<256?1:2);if((oe.length-ve*ne)*Float32Array.BYTES_PER_ELEMENT>=xe){var we=ve*ne*Float32Array.BYTES_PER_ELEMENT;ge=ve<256?new Uint8Array(oe.buffer,we,ye):new Uint16Array(oe.buffer,we,ye)}else ge=ve<256?new Uint8Array(ye):new Uint16Array(ye);oe=new Float32Array(oe.buffer,0,ve*ne);var Te=0;for(b=0;b<ve-2;++b)ge[Te++]=_e,ge[Te++]=b,ge[Te++]=b+1;ge[Te++]=_e,ge[Te++]=b,ge[Te++]=0;var Ce=[];for(b=le;b>=se;--b)Ce.push(b);var Ee=[];for(b=ue;b>=le;--b)Ee.push(b);var Ae=[];for(b=ce;b>=ue;--b)Ae.push(b);var Se=[];for(Se.push(0),b=_e-1;b>=ce;--b)Se.push(b);h.mesh=new _(J.center,oe,ge,G,W,i.fromOrientedBoundingBox(de),function(e,t,i,r,o){var a=e.quadtree._occluders.ellipsoid,s=a.ellipsoid,l=ee;return n.fromRadians(i.west,i.south,r,s,l[0]),n.fromRadians(i.east,i.south,r,s,l[1]),n.fromRadians(i.west,i.north,r,s,l[2]),n.fromRadians(i.east,i.north,r,s,l[3]),a.computeHorizonCullingPoint(t,l,o)}(t,de.center,p,W),J.getStride(),de,J,o.terrainExaggeration,Ce,Ee,Ae,Se)}var Pe=o.context;s(h.vertexArray)&&(s(u)?u.push(h.vertexArray):v._freeVertexArray(h.vertexArray)),h.vertexArray=v._createVertexArrayForMesh(Pe,h.mesh),c.processImagery(a,t.terrainProvider,o,!0);var be=h.waterMaskTexture;if(h.waterMaskTexture=void 0,t.terrainProvider.hasWaterMask){var De=c._findAncestorTileWithTerrainData(a);s(De)&&s(De.data.waterMaskTexture)&&(h.waterMaskTexture=De.data.waterMaskTexture,++h.waterMaskTexture.referenceCount,c._computeWaterMaskTranslationAndScale(a,De,h.waterMaskTranslationAndScale))}s(be)&&(--be.referenceCount,0===be.referenceCount&&be.destroy())}function z(e,t,i,r,n,o,a,s,l,c,d){var h=C;h.longitude=u.lerp(t.west,t.east,o),h.latitude=u.lerp(t.south,t.north,a),h.height=s;var p=e.cartographicToCartesian(h,A),m=b;return m.x=o,m.y=a,i.encode(r,n*i.getStride(),p,m,s,l,c),d.minimumHeight=Math.min(d.minimumHeight,s),d.maximumHeight=Math.max(d.maximumHeight,s),n+1}var B=new p;function H(e,t,i,r){var n=e.rectangle,o=t.rectangle;0===t.x&&1===i.x&&e.x===e.tilingScheme.getNumberOfXTilesAtLevel(e.level)-1?((n=p.clone(e.rectangle,B)).west-=u.TWO_PI,n.east-=u.TWO_PI):0===e.x&&0===i.x&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1&&((n=p.clone(e.rectangle,B)).west+=u.TWO_PI,n.east+=u.TWO_PI);var a=n.east-n.west,s=(o.west-n.west)/a,l=(o.east-n.west)/a,c=n.north-n.south,d=(o.south-n.south)/c,h=(o.north-n.south)/c,m=(i.x-s)/(l-s),f=(i.y-d)/(h-d);return Math.abs(m)<Math.EPSILON5?m=0:Math.abs(m-1)<Math.EPSILON5&&(m=1),Math.abs(f)<Math.EPSILON5?f=0:Math.abs(f-1)<Math.EPSILON5&&(f=1),r.x=m,r.y=f,r}var k=new r;function G(e,t,i,r,n){var o=e.encoding,a=e.vertices;if(n.height=o.decodeHeight(a,t),o.hasVertexNormals)o.getOctEncodedNormal(a,t,n.encodedNormal);else{var s=n.encodedNormal;s.x=0,s.y=0}}var W=new r,Y=new n;function j(t,i,r,n,o,a){a.height=o;var s=i.geodeticSurfaceNormalCartographic(C,A);e.octEncode(s,a.encodedNormal)}function X(e,t,i,r,n,o,a,l,u,c,d){var h;return $(e,t,l,a,!1,i,r,d)||$(e,t,c,u,!0,i,r,d)?d:J(n,o)?(G(o,0===i?0===r?o.eastIndicesNorthToSouth[0]:o.southIndicesEastToWest[0]:0===r?o.northIndicesWestToEast[0]:o.westIndicesSouthToNorth[0],0,0,d),d):(h=0===i?0===r?Q(e.westMeshes,e.westTiles,m.EAST,e.southMeshes,e.southTiles,m.NORTH,i,r):Q(e.northMeshes,e.northTiles,m.SOUTH,e.westMeshes,e.westTiles,m.EAST,i,r):0===r?Q(e.southMeshes,e.southTiles,m.NORTH,e.eastMeshes,e.eastTiles,m.WEST,i,r):Q(e.eastMeshes,e.eastTiles,m.WEST,e.northMeshes,e.northTiles,m.SOUTH,i,r),s(h)?(j(0,t,0,0,h,d),d):void 0)}function Q(e,t,i,r,n,o,a,l){var u=K(e,t,!1,i,a,l),c=K(r,n,!0,o,a,l);return s(u)&&s(c)?.5*(u+c):s(u)?u:c}function q(e,t,i,r,n,o,a,s,l){for(var u=0;u<o.length;++u)n=Z(e,t,i,r,n,o[u],a[u],s,l);return n}function Z(e,t,i,r,n,o,a,s,l){var c=o.rectangle;s===m.EAST&&0===e.tile.x?((c=p.clone(o.rectangle,B)).west-=u.TWO_PI,c.east-=u.TWO_PI):s===m.WEST&&0===o.x&&((c=p.clone(o.rectangle,B)).west+=u.TWO_PI,c.east+=u.TWO_PI);var d,h,f,_,v=e.tile.rectangle;switch(n>0&&(i.decodeTextureCoordinates(r,n-1,D),d=D.x,h=D.y),s){case m.WEST:f=a.westIndicesSouthToNorth,_=!1;break;case m.NORTH:f=a.northIndicesWestToEast,_=!0;break;case m.EAST:f=a.eastIndicesNorthToSouth,_=!1;break;case m.SOUTH:f=a.southIndicesEastToWest,_=!0}var y,x,w=o,T=e.tile,C=a.encoding,E=a.vertices,S=i.getStride();C.hasWebMercatorT&&(y=g.geodeticLatitudeToMercatorAngle(v.south),x=1/(g.geodeticLatitudeToMercatorAngle(v.north)-y));for(var b=0;b<f.length;++b){var O=f[b],I=C.decodeTextureCoordinates(E,O,D);H(w,T,I,I);var M=I.x,N=I.y,F=_?M:N;if(!(F<0||F>1)&&!(Math.abs(M-d)<u.EPSILON5&&Math.abs(N-h)<u.EPSILON5)){var R=Math.abs(M)<u.EPSILON5||Math.abs(M-1)<u.EPSILON5,L=Math.abs(N)<u.EPSILON5||Math.abs(N-1)<u.EPSILON5;if(!R||!L){var V,U=C.decodePosition(E,O,A),z=C.decodeHeight(E,O);C.hasVertexNormals?V=C.getOctEncodedNormal(E,O,P):((V=P).x=0,V.y=0);var k=N;if(C.hasWebMercatorT){var G=u.lerp(v.south,v.north,N);k=(g.geodeticLatitudeToMercatorAngle(G)-y)*x}i.encode(r,n*S,U,I,z,V,k),l.minimumHeight=Math.min(l.minimumHeight,z),l.maximumHeight=Math.max(l.maximumHeight,z),++n}}}return n}function K(e,t,i,r,n,o){var a,l,u;i?(a=0,l=e.length,u=1):(a=e.length-1,l=-1,u=-1);for(var c=a;c!==l;c+=u){var d=e[c];if(J(t[c],d)){var h;switch(r){case m.WEST:h=d.westIndicesSouthToNorth;break;case m.SOUTH:h=d.southIndicesEastToWest;break;case m.EAST:h=d.eastIndicesNorthToSouth;break;case m.NORTH:h=d.northIndicesWestToEast}var p=h[i?0:h.length-1];if(s(p))return d.encoding.decodeHeight(d.vertices,p)}}}function J(e,t){return s(t)&&(!s(e.data.fill)||!e.data.fill.changedThisFrame)}function $(i,r,o,a,s,l,c,d){var h,p,m,f,_,g=a[s?0:o.length-1],v=o[s?0:o.length-1];if(J(g,v)&&(0===l?0===c?(h=s?v.northIndicesWestToEast:v.eastIndicesNorthToSouth,p=s,m=s):(h=s?v.eastIndicesNorthToSouth:v.southIndicesEastToWest,p=!s,m=!1):0===c?(h=s?v.westIndicesSouthToNorth:v.northIndicesWestToEast,p=!s,m=!0):(h=s?v.southIndicesEastToWest:v.westIndicesSouthToNorth,p=s,m=!s),h.length>0)){_=h[f=s?0:h.length-1],v.encoding.decodeTextureCoordinates(v.vertices,_,D);var y=H(g,i.tile,D,D);if(y.x===l&&y.y===c)return G(v,_,0,0,d),!0;if(!((f=t(h,p?l:c,function(e,t){v.encoding.decodeTextureCoordinates(v.vertices,e,D);var r=H(g,i.tile,D,D);return m?p?r.x-l:r.y-c:p?l-r.x:c-r.y}))<0))return G(v,h[f],0,0,d),!0;if((f=~f)>0&&f<h.length)return function(t,i,r,o,a,s,l,c,d,h){var p,m=o.encoding,f=o.vertices,_=H(i,r,m.decodeTextureCoordinates(f,a,D),D),g=H(i,r,m.decodeTextureCoordinates(f,s,b),b);p=d?(l-_.x)/(g.x-_.x):(c-_.y)/(g.y-_.y);var v,y=m.decodeHeight(f,a),x=m.decodeHeight(f,s),w=r.rectangle;if(C.longitude=u.lerp(w.west,w.east,l),C.latitude=u.lerp(w.south,w.north,c),h.height=C.height=u.lerp(y,x,p),m.hasVertexNormals){var T=m.getOctEncodedNormal(f,a,k),E=m.getOctEncodedNormal(f,s,W),S=e.octDecode(T.x,T.y,A),P=e.octDecode(E.x,E.y,Y);v=n.lerp(S,P,p,A),n.normalize(v,v),e.octEncode(v,h.encodedNormal)}else v=t.geodeticSurfaceNormalCartographic(C,A),e.octEncode(v,h.encodedNormal)}(r,g,i.tile,v,h[f-1],h[f],l,c,p,d),!0}return!1}var ee=[new n,new n,new n,new n];return x}.apply(t,r))||(e.exports=n)},1844:function(e,t,i){var r;void 0===(r=function(){"use strict";return{WEST:0,NORTH:1,EAST:2,SOUTH:3,NORTHWEST:4,NORTHEAST:5,SOUTHWEST:6,SOUTHEAST:7}}.apply(t,[]))||(e.exports=r)},1845:function(e,t,i){var r,n;r=[i(9),i(8),i(10),i(20),i(11),i(25),i(14),i(29),i(18),i(316)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u){"use strict";function c(){this._layers=[],this.layerAdded=new o,this.layerRemoved=new o,this.layerMoved=new o,this.layerShownOrHidden=new o}function d(e,t){return e.indexOf(t)}function h(e,t,i){var r=e._layers;if((t=a.clamp(t,0,r.length-1))!==(i=a.clamp(i,0,r.length-1))){var n=r[t];r[t]=r[i],r[i]=n,e._update(),e.layerMoved.raiseEvent(n,i,t)}}i(c.prototype,{length:{get:function(){return this._layers.length}}}),c.prototype.add=function(e,i){t(i)?this._layers.splice(i,0,e):(i=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,i)},c.prototype.addImageryProvider=function(e,t){var i=new u(e);return this.add(i,t),i},c.prototype.remove=function(t,i){i=e(i,!0);var r=this._layers.indexOf(t);return-1!==r&&(this._layers.splice(r,1),this._update(),this.layerRemoved.raiseEvent(t,r),i&&t.destroy(),!0)},c.prototype.removeAll=function(t){t=e(t,!0);for(var i=this._layers,r=0,n=i.length;r<n;r++){var o=i[r];this.layerRemoved.raiseEvent(o,r),t&&o.destroy()}this._layers=[]},c.prototype.contains=function(e){return-1!==this.indexOf(e)},c.prototype.indexOf=function(e){return this._layers.indexOf(e)},c.prototype.get=function(e){return this._layers[e]},c.prototype.raise=function(e){var t=d(this._layers,e);h(this,t,t+1)},c.prototype.lower=function(e){var t=d(this._layers,e);h(this,t,t-1)},c.prototype.raiseToTop=function(e){var t=d(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))},c.prototype.lowerToBottom=function(e){var t=d(this._layers,e);0!==t&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};var p=new s;return c.prototype.pickImageryLayerFeatures=function(e,i){var r=i.globe.pick(e,i);if(t(r)){for(var n,o=i.globe.ellipsoid.cartesianToCartographic(r),u=i.globe._surface._tilesToRender,c=0;!t(n)&&c<u.length;++c){var d=u[c];s.contains(d.rectangle,o)&&(n=d)}if(t(n)){for(var h=n.data.imagery,m=[],f=[],_=h.length-1;_>=0;--_){var g=h[_],v=g.readyImagery;if(t(v)){var y=v.imageryLayer.imageryProvider;if(t(y.pickFeatures)&&s.contains(v.rectangle,o)){var x=p;if(x.west=a.lerp(n.rectangle.west,n.rectangle.east,g.textureCoordinateRectangle.x-1/1024),x.east=a.lerp(n.rectangle.west,n.rectangle.east,g.textureCoordinateRectangle.z+1/1024),x.south=a.lerp(n.rectangle.south,n.rectangle.north,g.textureCoordinateRectangle.y-1/1024),x.north=a.lerp(n.rectangle.south,n.rectangle.north,g.textureCoordinateRectangle.w+1/1024),s.contains(x,o)){var w=y.pickFeatures(v.x,v.y,v.level,o.longitude,o.latitude);t(w)&&(m.push(w),f.push(v.imageryLayer))}}}}if(0!==m.length)return l.all(m,function(e){for(var i=[],r=0;r<e.length;++r){var n=e[r],a=f[r];if(t(n)&&n.length>0)for(var s=0;s<n.length;++s){var l=n[s];l.imageryLayer=a,t(l.position)||(l.position=o),i.push(l)}}return i})}}},c.prototype.queueReprojectionCommands=function(e){for(var t=this._layers,i=0,r=t.length;i<r;++i)t[i].queueReprojectionCommands(e)},c.prototype.cancelReprojections=function(){for(var e=this._layers,t=0,i=e.length;t<i;++t)e[t].cancelReprojections()},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this.removeAll(!0),r(this)},c.prototype._update=function(){var e,i,r,n,o=!0,a=this._layers;for(r=0,n=a.length;r<n;++r)(i=a[r])._layerIndex=r,i.show?(i._isBaseLayer=o,o=!1):i._isBaseLayer=!1,i.show!==i._show&&(t(i._show)&&(t(e)||(e=[]),e.push(i)),i._show=i.show);if(t(e))for(r=0,n=e.length;r<n;++r)i=e[r],this.layerShownOrHidden.raiseEvent(i,i._layerIndex,i.show)},c}.apply(t,r))||(e.exports=n)},1846:function(e,t,i){var r,n;r=[i(12),i(32),i(9),i(8),i(10),i(11),i(25),i(111),i(14),i(28),i(115),i(174),i(146),i(29),i(496),i(1847),i(1848),i(360),i(44),i(1849),i(284)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x){"use strict";function w(e){this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,maxDepthVisited:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastMaxDepthVisited:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};var t=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new y,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this._cameraPositionCartographic=void 0,this._cameraReferenceFrameOriginCartographic=void 0,this.maximumScreenSpaceError=i(e.maximumScreenSpaceError,2),this.tileCacheSize=i(e.tileCacheSize,100),this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this._occluders=new f({ellipsoid:t}),this._tileLoadProgressEvent=new a,this._lastTileLoadQueueLength=0,this._lastSelectionFrameNumber=void 0}function T(e){var t=e._debug;t.maxDepth=0,t.maxDepthVisited=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}var C;n(w.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}},occluders:{get:function(){return this._occluders}}}),w.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0},w.prototype.forEachLoadedTile=function(e){for(var t=this._tileReplacementQueue.head;r(t);)t.state!==g.START&&e(t),t=t.replacementNext},w.prototype.forEachRenderedTile=function(e){for(var t=this._tilesToRender,i=0,r=t.length;i<r;++i)e(t[i])},w.prototype.updateHeight=function(e,t){var i=this,r={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t,removeFunc:function(){for(var e=i._addHeightCallbacks,t=e.length,n=0;n<t;++n)if(e[n]===r){e.splice(n,1);break}i._removeHeightCallbacks.push(r)}};return i._addHeightCallbacks.push(r),r.removeFunc},w.prototype.update=function(e){r(this._tileProvider.update)&&this._tileProvider.update(e)},w.prototype.beginFrame=function(e){e.passes.render&&(this._tilesInvalidated&&(!function(e){var t=e._tileReplacementQueue;t.head=void 0,t.tail=void 0,t.count=0,T(e);var i=e._levelZeroTiles;if(r(i))for(var n=0;n<i.length;++n){for(var o=i[n].customData,a=o.length,s=0;s<a;++s){var l=o[s];l.level=0,e._addHeightCallbacks.push(l)}i[n].freeResources()}e._levelZeroTiles=void 0,e._tileProvider.cancelReprojections()}(this),this._tilesInvalidated=!1),this._tileProvider.initialize(e),T(this),this._debug.suspendLodUpdate||this._tileReplacementQueue.markStartOfRenderFrame())},w.prototype.render=function(e){var t=e.passes,i=this._tileProvider;t.render&&(i.beginUpdate(e),function(e,t){var i,n=e._debug;if(n.suspendLodUpdate)return;e._tilesToRender.length=0;var o,a=e._tileProvider;if(!r(e._levelZeroTiles)){if(!a.ready)return;var s=a.tilingScheme;e._levelZeroTiles=_.createLevelZeroTiles(s);var l=e._levelZeroTiles.length;if(P.length<l)for(P=new Array(l),i=0;i<l;++i)void 0===P[i]&&(P[i]=new D)}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;var c=e._levelZeroTiles,d=c.length>1?e._occluders:void 0;C=t.camera.positionCartographic,c.sort(A);var h,p=e._addHeightCallbacks,m=e._removeHeightCallbacks,f=t.frameNumber;if(p.length>0||m.length>0){for(i=0,h=c.length;i<h;++i)(o=c[i])._updateCustomData(f,p,m);p.length=0,m.length=0}var g=t.camera;e._cameraPositionCartographic=g.positionCartographic;var v=u.getTranslation(g.transform,S);for(e._cameraReferenceFrameOriginCartographic=e.tileProvider.tilingScheme.ellipsoid.cartesianToCartographic(v,e._cameraReferenceFrameOriginCartographic),i=0,h=c.length;i<h;++i)o=c[i],e._tileReplacementQueue.markTileRendered(o),o.renderable?F(e,o,a,t,d,!1,P[i]):(b(e,e._tileLoadQueueHigh,o,t),++n.tilesWaitingForChildren);e._lastSelectionFrameNumber=f}(this,e),function(e,t){for(var i=e._tileProvider,r=e._tilesToRender,n=0,o=r.length;n<o;++n){var a=r[n];i.showTileThisFrame(a,t)}}(this,e),i.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&i.updateForPick(e)},w.prototype.endFrame=function(n){n.passes.render&&n.mode!==v.MORPHING&&(function(e,t){var i=e._tileLoadQueueHigh,r=e._tileLoadQueueMedium,n=e._tileLoadQueueLow;if(0===i.length&&0===r.length&&0===n.length)return;e._tileReplacementQueue.trimTiles(e.tileCacheSize);var o=s()+e._loadQueueTimeSlice,a=e._tileProvider,l=V(e,t,a,o,i,!1);l=V(e,t,a,o,r,l),V(e,t,a,o,n,l)}(this,n),function(n,o){if(!n.tileProvider.ready)return;var a=H;a.length=0;var l,u=n._tileToUpdateHeights,c=n._tileProvider.terrainProvider,d=s(),h=n._updateHeightsTimeSlice,m=d+h,f=o.mode,_=o.mapProjection,g=n.tileProvider.tilingScheme.ellipsoid;for(;u.length>0;){var y=u[0];if(r(y.data)&&r(y.data.mesh)){var w=y.customData,T=w.length,C=!1;for(l=n._lastTileIndex;l<T;++l){var E=w[l];if(y.level>E.level){if(r(E.positionOnEllipsoidSurface)||(E.positionOnEllipsoidSurface=e.fromRadians(E.positionCartographic.longitude,E.positionCartographic.latitude,0,g)),f===v.SCENE3D){var A=g.geodeticSurfaceNormal(E.positionOnEllipsoidSurface,U.direction),S=g.getSurfaceNormalIntersectionWithZAxis(E.positionOnEllipsoidSurface,11500,U.origin);if(!r(S)){var P;r(y.data.tileBoundingRegion)&&(P=y.data.tileBoundingRegion.minimumHeight);var b=Math.min(i(P,0),-11500),D=e.multiplyByScalar(A,Math.abs(b)+1,B);e.subtract(E.positionOnEllipsoidSurface,D,U.origin)}}else t.clone(E.positionCartographic,z),z.height=-11500,_.project(z,B),e.fromElements(B.z,B.x,B.y,B),e.clone(B,U.origin),e.clone(e.UNIT_X,U.direction);var O=y.data.pick(U,f,_,!1,B);r(O)&&(E.callback(O),E.level=y.level)}else if(y.level===E.level){for(var I,M=y.children,N=M.length,F=0;F<N&&(I=M[F],!p.contains(I.rectangle,E.positionCartographic));++F);var R=c.getTileDataAvailable(I.x,I.y,I.level),L=y.parent;(r(R)&&!R||r(L)&&r(L.data)&&r(L.data.terrainData)&&!L.data.terrainData.isChildAvailable(L.x,L.y,I.x,I.y))&&E.removeFunc()}if(s()>=m){C=!0;break}}if(C){n._lastTileIndex=l;break}n._lastTileIndex=0,u.shift()}else{var V=y._lastSelectionResultFrame===n._lastSelectionFrameNumber?y._lastSelectionResult:x.NONE;V!==x.RENDERED&&V!==x.CULLED_BUT_NEEDED||a.push(y),u.shift(),n._lastTileIndex=0}}for(l=0;l<a.length;l++)u.push(a[l])}(this,n),function(e,t){var i=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;(i!==e._lastTileLoadQueueLength||e._tilesInvalidated)&&(t.afterRender.push(a.prototype.raiseEvent.bind(e._tileLoadProgressEvent,i)),e._lastTileLoadQueueLength=i);var r=e._debug;r.enableDebugOutput&&!r.suspendLodUpdate&&(r.maxDepth=e._tilesToRender.reduce(function(e,t){return Math.max(e,t.level)},-1),r.tilesRendered=e._tilesToRender.length,r.tilesVisited===r.lastTilesVisited&&r.tilesRendered===r.lastTilesRendered&&r.tilesCulled===r.lastTilesCulled&&r.maxDepth===r.lastMaxDepth&&r.tilesWaitingForChildren===r.lastTilesWaitingForChildren&&r.maxDepthVisited===r.lastMaxDepthVisited||(console.log("Visited "+r.tilesVisited+", Rendered: "+r.tilesRendered+", Culled: "+r.tilesCulled+", Max Depth Rendered: "+r.maxDepth+", Max Depth Visited: "+r.maxDepthVisited+", Waiting for children: "+r.tilesWaitingForChildren),r.lastTilesVisited=r.tilesVisited,r.lastTilesRendered=r.tilesRendered,r.lastTilesCulled=r.tilesCulled,r.lastMaxDepth=r.maxDepth,r.lastTilesWaitingForChildren=r.tilesWaitingForChildren,r.lastMaxDepthVisited=r.maxDepthVisited))}(this,n))},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var E=new t;function A(e,t){var i=p.center(e.rectangle,E),r=i.longitude-C.longitude,n=i.latitude-C.latitude,o=(i=p.center(t.rectangle,E)).longitude-C.longitude,a=i.latitude-C.latitude;return r*r+n*n-(o*o+a*a)}var S=new e,P=[];function b(e,t,i,r){i.needsLoading&&(void 0!==e.tileProvider.computeTileLoadPriority&&(i._loadPriority=e.tileProvider.computeTileLoadPriority(i,r)),t.push(i))}function D(){this.allAreRenderable=!0,this.anyWereRenderedLastFrame=!1,this.notYetRenderableCount=0}function O(){this.southwest=new D,this.southeast=new D,this.northwest=new D,this.northeast=new D}O.prototype.combine=function(e){var t=this.southwest,i=this.southeast,r=this.northwest,n=this.northeast;e.allAreRenderable=t.allAreRenderable&&i.allAreRenderable&&r.allAreRenderable&&n.allAreRenderable,e.anyWereRenderedLastFrame=t.anyWereRenderedLastFrame||i.anyWereRenderedLastFrame||r.anyWereRenderedLastFrame||n.anyWereRenderedLastFrame,e.notYetRenderableCount=t.notYetRenderableCount+i.notYetRenderableCount+r.notYetRenderableCount+n.notYetRenderableCount};for(var I=new Array(30),M=0;M<I.length;++M)I[M]=new O;function N(e,t,i,n,o){var a=e._debug;++a.tilesVisited,e._tileReplacementQueue.markTileRendered(i),i._updateCustomData(t.frameNumber),i.level>a.maxDepthVisited&&(a.maxDepthVisited=i.level);var s=function(e,t,i){if(t.mode===v.SCENE2D||t.camera.frustum instanceof c||t.camera.frustum instanceof d)return function(e,t,i){var n=t.camera.frustum;r(n._offCenterFrustum)&&(n=n._offCenterFrustum);var o=t.context,a=o.drawingBufferWidth,s=o.drawingBufferHeight,u=e._tileProvider.getLevelMaximumGeometricError(i.level),c=Math.max(n.top-n.bottom,n.right-n.left)/Math.max(a,s),d=u/c;t.fog.enabled&&t.mode!==v.SCENE2D&&(d-=l.fog(i._distance,t.fog.density)*t.fog.sse);return d/=t.pixelRatio}(e,t,i);var n=e._tileProvider.getLevelMaximumGeometricError(i.level),o=i._distance,a=t.context.drawingBufferHeight,s=t.camera.frustum.sseDenominator,u=n*a/(o*s);t.fog.enabled&&(u-=l.fog(o,t.fog.density)*t.fog.sse);return u/=t.pixelRatio}(e,t,i)<e.maximumScreenSpaceError,u=i.southwestChild,h=i.southeastChild,p=i.northwestChild,m=i.northeastChild,f=e._lastSelectionFrameNumber,_=i._lastSelectionResultFrame===f?i._lastSelectionResult:x.NONE,y=e.tileProvider;if(s||n){var w=x.originalResult(_)===x.RENDERED,T=x.originalResult(_)===x.CULLED||_===x.NONE,C=i.state===g.DONE,E=w||T||C;if(E||r(y.canRenderWithoutLosingDetail)&&(E=y.canRenderWithoutLosingDetail(i)),E)return s&&b(e,e._tileLoadQueueMedium,i,t),R(e,i),o.allAreRenderable=i.renderable,o.anyWereRenderedLastFrame=_===x.RENDERED,o.notYetRenderableCount=i.renderable?0:1,i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=x.RENDERED,void(o.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(i));n=!0,s&&b(e,e._tileLoadQueueHigh,i,t)}if(y.canRefine(i)){if(u.upsampledFromParent&&h.upsampledFromParent&&p.upsampledFromParent&&m.upsampledFromParent)return R(e,i),b(e,e._tileLoadQueueMedium,i,t),e._tileReplacementQueue.markTileRendered(u),e._tileReplacementQueue.markTileRendered(h),e._tileReplacementQueue.markTileRendered(p),e._tileReplacementQueue.markTileRendered(m),o.allAreRenderable=i.renderable,o.anyWereRenderedLastFrame=_===x.RENDERED,o.notYetRenderableCount=i.renderable?0:1,i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=x.RENDERED,void(o.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(i));i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=x.REFINED;var A=e._tilesToRender.length,S=e._tileLoadQueueLow.length,P=e._tileLoadQueueMedium.length,D=e._tileLoadQueueHigh.length,O=e._tileToUpdateHeights.length;if(function(e,t,i,r,n,o,a,s){var l=o.camera.positionCartographic,u=e._tileProvider,c=e._occluders,d=I[t.level],h=d.southwest,p=d.southeast,m=d.northwest,f=d.northeast;l.longitude<t.rectangle.east?l.latitude<t.rectangle.north?(F(e,t,u,o,c,a,h),F(e,i,u,o,c,a,p),F(e,r,u,o,c,a,m),F(e,n,u,o,c,a,f)):(F(e,r,u,o,c,a,m),F(e,t,u,o,c,a,h),F(e,n,u,o,c,a,f),F(e,i,u,o,c,a,p)):l.latitude<t.rectangle.north?(F(e,i,u,o,c,a,p),F(e,t,u,o,c,a,h),F(e,n,u,o,c,a,f),F(e,r,u,o,c,a,m)):(F(e,n,u,o,c,a,f),F(e,r,u,o,c,a,m),F(e,i,u,o,c,a,p),F(e,t,u,o,c,a,h));d.combine(s)}(e,u,h,p,m,t,n,o),A!==e._tilesToRender.length){var M=o.allAreRenderable,N=o.anyWereRenderedLastFrame,L=o.notYetRenderableCount,V=!1;if(!M&&!N){for(var U=e._tilesToRender,z=A;z<U.length;++z)for(var B=U[z];void 0!==B&&B._lastSelectionResult!==x.KICKED&&B!==i;)B._lastSelectionResult=x.kick(B._lastSelectionResult),B=B.parent;e._tilesToRender.length=A,e._tileToUpdateHeights.length=O,R(e,i),i._lastSelectionResult=x.RENDERED;var H=_===x.RENDERED;!H&&L>e.loadingDescendantLimit&&(e._tileLoadQueueLow.length=S,e._tileLoadQueueMedium.length=P,e._tileLoadQueueHigh.length=D,b(e,e._tileLoadQueueMedium,i,t),o.notYetRenderableCount=i.renderable?0:1,V=!0),o.allAreRenderable=i.renderable,o.anyWereRenderedLastFrame=H,H||e._tileToUpdateHeights.push(i),++a.tilesWaitingForChildren}e.preloadAncestors&&!V&&b(e,e._tileLoadQueueLow,i,t)}}else i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=x.RENDERED,R(e,i),b(e,e._tileLoadQueueHigh,i,t),o.allAreRenderable=i.renderable,o.anyWereRenderedLastFrame=_===x.RENDERED,o.notYetRenderableCount=i.renderable?0:1}function F(e,t,i,n,o,a,s){if(i.computeTileVisibility(t,n,o)!==m.NONE)return N(e,n,t,a,s);if(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),s.allAreRenderable=!0,s.anyWereRenderedLastFrame=!1,s.notYetRenderableCount=0,function(e,t){var i=t.rectangle;return r(e._cameraPositionCartographic)&&p.contains(i,e._cameraPositionCartographic)||r(e._cameraReferenceFrameOriginCartographic)&&p.contains(i,e._cameraReferenceFrameOriginCartographic)}(e,t)){r(t.data)&&r(t.data.vertexArray)||b(e,e._tileLoadQueueMedium,t,n);var l=e._lastSelectionFrameNumber,u=t._lastSelectionResultFrame===l?t._lastSelectionResult:x.NONE;u!==x.CULLED_BUT_NEEDED&&u!==x.RENDERED&&e._tileToUpdateHeights.push(t),t._lastSelectionResult=x.CULLED_BUT_NEEDED}else e.preloadSiblings||0===t.level?(b(e,e._tileLoadQueueLow,t,n),t._lastSelectionResult=x.CULLED):t._lastSelectionResult=x.CULLED;t._lastSelectionResultFrame=n.frameNumber}function R(e,t){e._tilesToRender.push(t)}function L(e,t){return e._loadPriority-t._loadPriority}function V(e,t,i,r,n,o){void 0!==i.computeTileLoadPriority&&n.sort(L);for(var a=0,l=n.length;a<l&&(s()<r||!o);++a){var u=n[a];e._tileReplacementQueue.markTileRendered(u),i.loadTile(t,u),o=!0}return o}var U=new h,z=new t,B=new e,H=[];return w}.apply(t,r))||(e.exports=n)},1847:function(e,t,i){var r,n;r=[i(12),i(10),i(409)],void 0===(n=function(e,t,i){"use strict";function r(t){this._ellipsoid=new i(t.ellipsoid,e.ZERO)}return t(r.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),r}.apply(t,r))||(e.exports=n)},1848:function(e,t,i){var r,n;r=[i(8),i(10),i(11),i(29),i(360),i(284)],void 0===(n=function(e,t,i,r,n,o){"use strict";function a(e){this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this.replacementPrevious=void 0,this.replacementNext=void 0,this._distance=0,this._loadPriority=0,this._customData=[],this._frameUpdated=void 0,this._lastSelectionResult=o.NONE,this._lastSelectionResultFrame=void 0,this._loadedCallbacks={},this.state=n.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}function s(t){e(t)&&t.freeResources()}return a.createLevelZeroTiles=function(e){for(var t=e.getNumberOfXTilesAtLevel(0),i=e.getNumberOfYTilesAtLevel(0),r=new Array(t*i),n=0,o=0;o<i;++o)for(var s=0;s<t;++s)r[n++]=new a({tilingScheme:e,x:s,y:o,level:0});return r},a.prototype._updateCustomData=function(t,i,n){var o,a,s,l=this.customData;if(e(i)&&e(n)){for(l=l.filter(function(e){return-1===n.indexOf(e)}),this._customData=l,s=this._rectangle,o=0;o<i.length;++o)a=i[o],r.contains(s,a.positionCartographic)&&l.push(a);this._frameUpdated=t}else{var u=this._parent;if(e(u)&&this._frameUpdated!==u._frameUpdated){l.length=0,s=this._rectangle;var c=u.customData;for(o=0;o<c.length;++o)a=c[o],r.contains(s,a.positionCartographic)&&l.push(a);this._frameUpdated=u._frameUpdated}}},t(a.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return e(this._southwestChild)||(this._southwestChild=new a({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return e(this._southeastChild)||(this._southeastChild=new a({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return e(this._northwestChild)||(this._northwestChild=new a({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return e(this._northeastChild)||(this._northeastChild=new a({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<n.DONE}},eligibleForUnloading:{get:function(){var t=!0;return e(this.data)&&(t=this.data.eligibleForUnloading,e(t)||(t=!0)),t}}}),a.prototype.findLevelZeroTile=function(e,t,i){var r=this.tilingScheme.getNumberOfXTilesAtLevel(0);if(t<0?t+=r:t>=r&&(t-=r),!(i<0||i>=this.tilingScheme.getNumberOfYTilesAtLevel(0)))return e.filter(function(e){return e.x===t&&e.y===i})[0]},a.prototype.findTileToWest=function(e){var t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x-1,this.y);if(t.southeastChild===this)return t.southwestChild;if(t.northeastChild===this)return t.northwestChild;var i=t.findTileToWest(e);return void 0!==i?t.southwestChild===this?i.southeastChild:i.northeastChild:void 0},a.prototype.findTileToEast=function(e){var t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x+1,this.y);if(t.southwestChild===this)return t.southeastChild;if(t.northwestChild===this)return t.northeastChild;var i=t.findTileToEast(e);return void 0!==i?t.southeastChild===this?i.southwestChild:i.northwestChild:void 0},a.prototype.findTileToSouth=function(e){var t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y+1);if(t.northwestChild===this)return t.southwestChild;if(t.northeastChild===this)return t.southeastChild;var i=t.findTileToSouth(e);return void 0!==i?t.southwestChild===this?i.northwestChild:i.northeastChild:void 0},a.prototype.findTileToNorth=function(e){var t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y-1);if(t.southwestChild===this)return t.northwestChild;if(t.southeastChild===this)return t.northeastChild;var i=t.findTileToNorth(e);return void 0!==i?t.northwestChild===this?i.southwestChild:i.southeastChild:void 0},a.prototype.freeResources=function(){this.state=n.START,this.renderable=!1,this.upsampledFromParent=!1,e(this.data)&&e(this.data.freeResources)&&this.data.freeResources(),s(this._southwestChild),this._southwestChild=void 0,s(this._southeastChild),this._southeastChild=void 0,s(this._northwestChild),this._northwestChild=void 0,s(this._northeastChild),this._northeastChild=void 0},a}.apply(t,r))||(e.exports=n)},1849:function(e,t,i){var r,n;r=[i(8)],void 0===(n=function(e){"use strict";function t(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function i(e,t){var i=t.replacementPrevious,r=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=r),t===e.head?e.head=r:i.replacementNext=r,t===e.tail?e.tail=i:r.replacementPrevious=i,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}return t.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},t.prototype.trimTiles=function(t){for(var r=this.tail,n=!0;n&&e(this._lastBeforeStartOfFrame)&&this.count>t&&e(r);){n=r!==this._lastBeforeStartOfFrame;var o=r.replacementPrevious;r.eligibleForUnloading&&(r.freeResources(),i(this,r)),r=o}},t.prototype.markTileRendered=function(t){var r=this.head;if(r!==t){if(++this.count,!e(r))return t.replacementPrevious=void 0,t.replacementNext=void 0,this.head=t,void(this.tail=t);(e(t.replacementPrevious)||e(t.replacementNext))&&i(this,t),t.replacementPrevious=void 0,t.replacementNext=r,r.replacementPrevious=t,this.head=t}else t===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=t.replacementNext)},t}.apply(t,r))||(e.exports=n)},1850:function(e,t,i){e.exports=i.p+"4fff67aa927fc4ecb16298f61b0cf84a.jpg"},1851:function(e,t,i){var r,n;r=[i(110),i(12),i(9),i(8),i(10),i(20),i(26),i(1852),i(43),i(28),i(747),i(60),i(1855),i(210)],void 0===(n=function(e,t,r,n,o,a,s,l,u,c,d,h,p,m){"use strict";function f(e){var t=(e=r(e,r.EMPTY_OBJECT)).textureUrl;n(t)||(t=i(1858)),this.show=r(e.show,!0),this.textureUrl=t,this._ellipsoid=r(e.ellipsoid,s.MOON),this.onlySunLighting=r(e.onlySunLighting,!0),this._ellipsoidPrimitive=new p({radii:this.ellipsoid.radii,material:m.fromType(m.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new l}o(f.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var _=new u,g=new u,v=new t,y=[];return f.prototype.update=function(e){if(this.show){var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;var i=e.time;n(h.computeIcrfToFixedMatrix(i,_))||h.computeTemeToPseudoFixedMatrix(i,_);var r=this._axes.evaluate(i,g);u.transpose(r,r),u.multiply(_,r,r);var o=d.computeMoonPositionInEarthInertialFrame(i,v);u.multiplyByVector(_,o,o),c.fromRotationTranslation(r,o,t.modelMatrix);var a=e.commandList;return e.commandList=y,y.length=0,t.update(e),e.commandList=a,1===y.length?y[0]:void 0}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),a(this)},f}.apply(t,r))||(e.exports=n)},1852:function(e,t,i){var r,n;r=[i(12),i(8),i(1853),i(42),i(14),i(43),i(54)],void 0===(n=function(e,t,i,r,n,o,a){"use strict";function s(e){t(e)&&"function"==typeof e||(e=i.ComputeMoon),this._computeFunction=e}var l=new e,u=new e,c=new e;var d=new o,h=new a;return s.prototype.evaluate=function(i,s){t(i)||(i=r.now());var p=this._computeFunction(i),m=function(i,r,a){var s=l;s.x=Math.cos(i+n.PI_OVER_TWO),s.y=Math.sin(i+n.PI_OVER_TWO),s.z=0;var d=Math.cos(r),h=c;h.x=d*Math.cos(i),h.y=d*Math.sin(i),h.z=Math.sin(r);var p=e.cross(h,s,u);return t(a)||(a=new o),a[0]=s.x,a[1]=p.x,a[2]=h.x,a[3]=s.y,a[4]=p.y,a[5]=h.y,a[6]=s.z,a[7]=p.z,a[8]=h.z,a}(p.rightAscension,p.declination,s),f=n.zeroToTwoPi(p.rotation),_=a.fromAxisAngle(e.UNIT_Z,f,h),g=o.fromQuaternion(a.conjugate(_,_),d);return o.multiply(g,m,m)},s}.apply(t,r))||(e.exports=n)},1853:function(e,t,i){var r,n;r=[i(8),i(1854),i(42),i(14),i(199)],void 0===(n=function(e,t,i,r,n){"use strict";var o={},a=-.0529921,s=-.1059842,l=13.0120009,u=13.3407154,c=26.4057084,d=13.064993,h=1.7484877,p=new i;return o.ComputeMoon=function(o,m){e(o)||(o=i.now()),p=i.addSeconds(o,32.184,p);var f=i.totalDays(p)-2451545,_=f/n.DAYS_PER_JULIAN_CENTURY,g=(125.045+a*f)*r.RADIANS_PER_DEGREE,v=(250.089+s*f)*r.RADIANS_PER_DEGREE,y=(260.008+l*f)*r.RADIANS_PER_DEGREE,x=(176.625+u*f)*r.RADIANS_PER_DEGREE,w=(357.529+.9856003*f)*r.RADIANS_PER_DEGREE,T=(311.589+c*f)*r.RADIANS_PER_DEGREE,C=(134.963+d*f)*r.RADIANS_PER_DEGREE,E=(276.617+.3287146*f)*r.RADIANS_PER_DEGREE,A=(34.226+h*f)*r.RADIANS_PER_DEGREE,S=(15.134+-.1589763*f)*r.RADIANS_PER_DEGREE,P=(119.743+.0036096*f)*r.RADIANS_PER_DEGREE,b=(239.961+.1643573*f)*r.RADIANS_PER_DEGREE,D=(25.053+12.9590088*f)*r.RADIANS_PER_DEGREE,O=Math.sin(g),I=Math.sin(v),M=Math.sin(y),N=Math.sin(x),F=Math.sin(w),R=Math.sin(T),L=Math.sin(C),V=Math.sin(E),U=Math.sin(A),z=Math.sin(S),B=Math.sin(P),H=Math.sin(b),k=Math.sin(D),G=Math.cos(g),W=Math.cos(v),Y=Math.cos(y),j=Math.cos(x),X=Math.cos(w),Q=Math.cos(T),q=Math.cos(C),Z=Math.cos(E),K=Math.cos(A),J=Math.cos(S),$=Math.cos(P),ee=Math.cos(b),te=Math.cos(D),ie=(269.9949+.0031*_-3.8787*O-.1204*I+.07*M-.0172*N+.0072*R-.0052*z+.0043*k)*r.RADIANS_PER_DEGREE,re=(66.5392+.013*_+1.5419*G+.0239*W-.0278*Y+.0068*j-.0029*Q+9e-4*q+8e-4*J-9e-4*te)*r.RADIANS_PER_DEGREE,ne=(38.3213+13.17635815*f-1.4e-12*f*f+3.561*O+.1208*I-.0642*M+.0158*N+.0252*F-.0066*R-.0047*L-.0046*V+.0028*U+.0052*z+.004*B+.0019*H-.0044*k)*r.RADIANS_PER_DEGREE,oe=(13.17635815-2*f*1.4e-12+3.561*G*a+.1208*W*s-.0642*Y*l+.0158*j*u+.0252*X*.9856003-.0066*Q*c-.0047*q*d-.0046*Z*.3287146+.0028*K*h+.0052*J*-.1589763+.004*$*.0036096+.0019*ee*.1643573-.0044*te*12.9590088)/86400*r.RADIANS_PER_DEGREE;return e(m)||(m=new t),m.rightAscension=ie,m.declination=re,m.rotation=ne,m.rotationRate=oe,m},o}.apply(t,r))||(e.exports=n)},1854:function(e,t,i){var r;void 0===(r=function(){"use strict";return function(e,t,i,r){this.rightAscension=e,this.declination=t,this.rotation=i,this.rotationRate=r}}.call(t,i,t,e))||(e.exports=r)},1855:function(e,t,i){var r,n;r=[i(33),i(361),i(12),i(58),i(9),i(8),i(20),i(11),i(28),i(76),i(78),i(68),i(69),i(55),i(77),i(56),i(95),i(1856),i(1857),i(87),i(206),i(210),i(44)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T){"use strict";var C={position:0};function E(t){t=n(t,n.EMPTY_OBJECT),this.center=i.clone(n(t.center,i.ZERO)),this._center=new i,this.radii=i.clone(t.radii),this._radii=new i,this._oneOverEllipsoidRadiiSquared=new i,this._boundingSphere=new e,this.modelMatrix=l.clone(n(t.modelMatrix,l.IDENTITY)),this._modelMatrix=new l,this._computedModelMatrix=new l,this.show=n(t.show,!0),this.material=n(t.material,w.fromType(w.ColorType)),this._material=void 0,this._translucent=void 0,this.id=t.id,this._id=void 0,this.debugShowBoundingVolume=n(t.debugShowBoundingVolume,!1),this.onlySunLighting=n(t.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=n(t.depthTestEnabled,!0),this._useLogDepth=!1,this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new d({owner:n(t._owner,this)}),this._pickCommand=new d({owner:n(t._owner,this),pickOnly:!0});var r=this;this._uniforms={u_radii:function(){return r.radii},u_oneOverEllipsoidRadiiSquared:function(){return r._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return r._pickId.color}}}var A="#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n";return E.prototype.update=function(n){if(this.show&&n.mode===T.SCENE3D&&o(this.center)&&o(this.radii)){var a=n.context,s=this.material.isTranslucent(),d=this._translucent!==s;o(this._rs)&&!d||(this._translucent=s,this._rs=p.fromCache({cull:{enabled:!0,face:x.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!s&&a.fragmentDepth,blending:s?y.ALPHA_BLEND:void 0})),o(this._va)||(this._va=function(e){var r=e.cache.ellipsoidPrimitive_vertexArray;if(o(r))return r;var n=t.createGeometry(t.fromDimensions({dimensions:new i(2,2,2),vertexFormat:u.POSITION_ONLY}));return r=_.fromGeometry({context:e,geometry:n,attributeLocations:C,bufferUsage:c.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=r,r}(a));var w=!1,E=this.radii;if(!i.equals(this._radii,E)){i.clone(E,this._radii);var S=this._oneOverEllipsoidRadiiSquared;S.x=1/(E.x*E.x),S.y=1/(E.y*E.y),S.z=1/(E.z*E.z),w=!0}l.equals(this.modelMatrix,this._modelMatrix)&&i.equals(this.center,this._center)||(l.clone(this.modelMatrix,this._modelMatrix),i.clone(this.center,this._center),l.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),w=!0),w&&(i.clone(i.ZERO,this._boundingSphere.center),this._boundingSphere.radius=i.maximumComponent(E),e.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));var P=this._material!==this.material;this._material=this.material,this._material.update(a);var b=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;var D=n.useLogDepth,O=this._useLogDepth!==D;this._useLogDepth=D;var I,M,N=this._colorCommand;(P||b||d||O)&&(I=new f({sources:[v]}),M=new f({sources:[this.material.shaderSource,g]}),this.onlySunLighting&&M.defines.push("ONLY_SUN_LIGHTING"),!s&&a.fragmentDepth&&M.defines.push("WRITE_DEPTH"),this._useLogDepth&&(I.defines.push("LOG_DEPTH","DISABLE_GL_POSITION_LOG_DEPTH"),M.defines.push("LOG_DEPTH"),M.sources.push(A)),this._sp=m.replaceCache({context:a,shaderProgram:this._sp,vertexShaderSource:I,fragmentShaderSource:M,attributeLocations:C}),N.vertexArray=this._va,N.renderState=this._rs,N.shaderProgram=this._sp,N.uniformMap=r(this._uniforms,this.material._uniforms),N.executeInClosestFrustum=s);var F=n.commandList,R=n.passes;if(R.render&&(N.boundingVolume=this._boundingSphere,N.debugShowBoundingVolume=this.debugShowBoundingVolume,N.modelMatrix=this._computedModelMatrix,N.pass=s?h.TRANSLUCENT:h.OPAQUE,F.push(N)),R.pick){var L=this._pickCommand;o(this._pickId)&&this._id===this.id||(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=a.createPickId({primitive:this,id:this.id})),(P||b||!o(this._pickSP)||O)&&(I=new f({sources:[v]}),M=new f({sources:[this.material.shaderSource,g],pickColorQualifier:"uniform"}),this.onlySunLighting&&M.defines.push("ONLY_SUN_LIGHTING"),!s&&a.fragmentDepth&&M.defines.push("WRITE_DEPTH"),this._useLogDepth&&(I.defines.push("LOG_DEPTH"),M.defines.push("LOG_DEPTH"),M.sources.push(A)),this._pickSP=m.replaceCache({context:a,shaderProgram:this._pickSP,vertexShaderSource:I,fragmentShaderSource:M,attributeLocations:C}),L.vertexArray=this._va,L.renderState=this._rs,L.shaderProgram=this._pickSP,L.uniformMap=r(r(this._uniforms,this._pickUniforms),this.material._uniforms),L.executeInClosestFrustum=s),L.boundingVolume=this._boundingSphere,L.modelMatrix=this._computedModelMatrix,L.pass=s?h.TRANSLUCENT:h.OPAQUE,F.push(L)}}},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),a(this)},E}.apply(t,r))||(e.exports=n)},1856:function(e,t,i){var r;void 0===(r=function(){"use strict";return"#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#endif\n\nuniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\n\nvarying vec3 v_positionEC;\n\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\n    vec3 positionEC = czm_pointAlongRay(ray, intersection);\n    vec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\n    vec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\n    vec3 sphericalNormal = normalize(positionMC / u_radii);\n    vec3 normalMC = geodeticNormal * side;              // normalized surface normal (always facing the viewer) in model coordinates\n    vec3 normalEC = normalize(czm_normal * normalMC);   // normalized surface normal in eye coordiantes\n\n    vec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\n    vec3 positionToEyeEC = -positionEC;\n\n    czm_materialInput materialInput;\n    materialInput.s = st.s;\n    materialInput.st = st;\n    materialInput.str = (positionMC + u_radii) / u_radii;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef ONLY_SUN_LIGHTING\n    return czm_private_phong(normalize(positionToEyeEC), material);\n#else\n    return czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n\nvoid main()\n{\n    // PERFORMANCE_TODO: When dynamic branching is available, compute ratio of maximum and minimum radii\n    // in the vertex shader. Only when it is larger than some constant, march along the ray.\n    // Otherwise perform one intersection test which will be the common case.\n\n    // Test if the ray intersects a sphere with the ellipsoid's maximum radius.\n    // For very oblate ellipsoids, using the ellipsoid's radii for an intersection test\n    // may cause false negatives. This will discard fragments before marching the ray forward.\n    float maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\n    vec3 direction = normalize(v_positionEC);\n    vec3 ellipsoidCenter = czm_modelView[3].xyz;\n\n    float t1 = -1.0;\n    float t2 = -1.0;\n\n    float b = -2.0 * dot(direction, ellipsoidCenter);\n    float c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\n\n    float discriminant = b * b - 4.0 * c;\n    if (discriminant >= 0.0) {\n        t1 = (-b - sqrt(discriminant)) * 0.5;\n        t2 = (-b + sqrt(discriminant)) * 0.5;\n    }\n\n    if (t1 < 0.0 && t2 < 0.0) {\n        discard;\n    }\n\n    float t = min(t1, t2);\n    if (t < 0.0) {\n        t = 0.0;\n    }\n\n    // March ray forward to intersection with larger sphere and find\n    czm_ray ray = czm_ray(t * direction, direction);\n\n    vec3 ellipsoid_inverseRadii = vec3(1.0 / u_radii.x, 1.0 / u_radii.y, 1.0 / u_radii.z);\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoidCenter, ellipsoid_inverseRadii);\n\n    if (czm_isEmpty(intersection))\n    {\n        discard;\n    }\n\n    // If the viewer is outside, compute outsideFaceColor, with normals facing outward.\n    vec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\n\n    // If the viewer either is inside or can see inside, compute insideFaceColor, with normals facing inward.\n    vec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\n\n    gl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\n    gl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n\n#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n    t = (intersection.start != 0.0) ? intersection.start : intersection.stop;\n    vec3 positionEC = czm_pointAlongRay(ray, t);\n    vec4 positionCC = czm_projection * vec4(positionEC, 1.0);\n#ifdef LOG_DEPTH\n    czm_writeLogDepth(1.0 + positionCC.w);\n#else\n    float z = positionCC.z / positionCC.w;\n\n    float n = czm_depthRange.near;\n    float f = czm_depthRange.far;\n\n    gl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n#endif\n}\n"}.call(t,i,t,e))||(e.exports=r)},1857:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec3 position;\n\nuniform vec3 u_radii;\n\nvarying vec3 v_positionEC;\n\nvoid main()\n{\n    // In the vertex data, the cube goes from (-1.0, -1.0, -1.0) to (1.0, 1.0, 1.0) in model coordinates.\n    // Scale to consider the radii.  We could also do this once on the CPU when using the BoxGeometry,\n    // but doing it here allows us to change the radii without rewriting the vertex data, and\n    // allows all ellipsoids to reuse the same vertex data.\n    vec4 p = vec4(u_radii * position, 1.0);\n\n    v_positionEC = (czm_modelView * p).xyz;     // position in eye coordinates\n    gl_Position = czm_modelViewProjection * p;  // position in clip coordinates\n\n    // With multi-frustum, when the ellipsoid primitive is positioned on the intersection of two frustums\n    // and close to terrain, the terrain (writes depth) in the closest frustum can overwrite part of the\n    // ellipsoid (does not write depth) that was rendered in the farther frustum.\n    //\n    // Here, we clamp the depth in the vertex shader to avoid being overwritten; however, this creates\n    // artifacts since some fragments can be alpha blended twice.  This is solved by only rendering\n    // the ellipsoid in the closest frustum to the viewer.\n    gl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n\n    czm_vertexLogDepth();\n}\n"}.call(t,i,t,e))||(e.exports=r)},1858:function(e,t,i){e.exports=i.p+"b592e228bf0641d6b4f0b79e664177ab.jpg"},1859:function(e,t,i){var r,n;r=[i(144),i(62),i(33),i(361),i(24),i(12),i(32),i(16),i(22),i(67),i(72),i(236),i(9),i(8),i(10),i(20),i(11),i(497),i(25),i(108),i(64),i(121),i(93),i(42),i(14),i(28),i(1860),i(1861),i(115),i(174),i(193),i(350),i(61),i(146),i(366),i(91),i(141),i(60),i(123),i(1862),i(1863),i(83),i(68),i(103),i(69),i(66),i(55),i(77),i(56),i(63),i(18),i(1867),i(362),i(213),i(436),i(641),i(615),i(709),i(749),i(1870),i(1873),i(1874),i(1875),i(1876),i(751),i(1879),i(1880),i(498),i(631),i(1881),i(74),i(1882),i(1883),i(112),i(500),i(44),i(212),i(1907),i(1908),i(757),i(156),i(1911),i(384),i(1914)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O,I,M,N,F,R,L,V,U,z,B,H,k,G,W,Y,j,X,Q,q,Z,K,J,$,ee,te,ie,re,ne,oe,ae,se,le,ue,ce,de,he,pe,me,fe,_e,ge,ve,ye,xe,we,Te,Ce,Ee,Ae,Se,Pe,be,De){"use strict";var Oe=function(e){return function(){e.frameState.afterRender.push(function(){e.requestRender()})}};function Ie(e,t,i){this.ray=e,this.width=t,this.tilesets=i,this.ready=!1,this.deferred=Z.defer(),this.promise=this.deferred.promise}function Me(e){var i=(e=h(e,h.EMPTY_OBJECT)).canvas,r=e.contextOptions,n=e.creditContainer,a=e.creditViewport,s=p(n),u=new B(i,r);s||((n=document.createElement("div")).style.position="absolute",n.style.bottom="0",n.style["text-shadow"]="0 0 2px #000000",n.style.color="#ffffff",n.style["font-size"]="10px",n.style["padding-right"]="5px",i.parentNode.appendChild(n)),p(a)||(a=i.parentNode),this._id=c(),this._jobScheduler=new he,this._frameState=new ue(u,new re(n,"  ",a),this._jobScheduler),this._frameState.scene3DOnly=h(e.scene3DOnly,!1),this._removeCreditContainer=!s,this._creditContainer=n,this._canvas=i,this._context=u,this._computeEngine=new z(u),this._globe=void 0,this._primitives=new xe,this._groundPrimitives=new xe,this._mostDetailedRayPicks=[],this._logDepthBuffer=u.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new be,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[],this._useOIT=h(e.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,this._depthPlane=new oe,this._clearColorCommand=new U({color:new l,stencil:0,owner:this}),this._depthClearCommand=new U({depth:1,owner:this}),this._stencilClearCommand=new U({stencil:0}),this._classificationStencilClearCommand=new U({stencil:0,renderState:j.fromCache({stencilMask:Se.CLASSIFICATION_MASK})}),this._depthOnlyRenderStateCache={},this._pickRenderStateCache={},this._transitioner=new Ce(this),this._preUpdate=new v,this._postUpdate=new v,this._renderError=new v,this._preRender=new v,this._postRender=new v,this._pickPositionCache={},this._pickPositionCacheDirty=!1,this._minimumDisableDepthTestDistance=0,this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new v,this.morphComplete=new v,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=l.clone(l.BLACK),this._mode=we.SCENE3D,this._mapProjection=p(e.mapProjection)?e.mapProjection:new y,this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowGlobeDepth=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.fog=new le,this._sunCamera=new J(this),this.shadowMap=new Ae({context:u,lightCamera:this._sunCamera,enabled:h(e.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=l.clone(l.WHITE),this._actualInvertClassificationColor=l.clone(this._invertClassificationColor),this._invertClassification=new de,this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new ve,this._brdfLutGenerator=new K,this._terrainExaggeration=h(e.terrainExaggeration,1),this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new Ee(this),this._mapMode2D=h(e.mapMode2D,pe.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=h(e.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=h(e.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=F.requestCompletedEvent.addEventListener(Oe(this)),this._removeTaskProcessorListenerCallback=L.taskCompletedEvent.addEventListener(Oe(this)),this._removeGlobeCallbacks=[];var d=new t(0,0,u.drawingBufferWidth,u.drawingBufferHeight),m=new J(this);this._logDepthBuffer&&(m.frustum.near=.1,m.frustum.far=1e10);var f=new t(0,0,1,1),_=new J(this);_.frustum=new b({width:.1,aspectRatio:1,near:.1}),this._pickOffscreenView=new De(this,_,f),this.preloadFlightCamera=new J(this),this.preloadFlightCullingVolume=void 0,this.pickOffscreenDefaultWidth=.1,this._defaultView=new De(this,m,d),this._view=this._defaultView,this._hdr=void 0,this._hdrDirty=void 0,this.highDynamicRange=!1,this.gamma=2.2,this._sunColor=new o(1.8,1.85,2),this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this._specularEnvironmentMapAtlas=void 0,We(this,0,C.now()),Ye(this),this.initializeFrame()}function Ne(e,t,i){var r=e._frameState,n=e._context,o=e._view.oit,a=r.shadowState.lightShadowMaps,s=r.shadowState.lightShadowsEnabled,l=t.derivedCommands;p(t.pickId)&&(l.picking=ae.createPickDerivedCommand(e,t,n,l.picking)),t.pickOnly||(l.depth=ae.createDepthOnlyDerivedCommand(e,t,n,l.depth)),l.originalCommand=t,e._hdr&&(l.hdr=ae.createHdrCommand(t,n,l.hdr),l=(t=l.hdr.command).derivedCommands),s&&t.receiveShadows&&(l.shadows=Ae.createReceiveDerivedCommand(a,t,i,n,l.shadows)),t.pass===W.TRANSLUCENT&&p(o)&&o.isSupported()&&(s&&t.receiveShadows?(l.oit=p(l.oit)?l.oit:{},l.oit.shadows=o.createDerivedCommands(l.shadows.receiveCommand,n,l.oit.shadows)):l.oit=o.createDerivedCommands(t,n,l.oit))}m(Me.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return H.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return H.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},invertClassificationSupported:{get:function(){return this._context.depthTexture}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,function(e,t){for(var i=0;i<e._removeGlobeCallbacks.length;++i)e._removeGlobeCallbacks[i]();e._removeGlobeCallbacks.length=0;var r=[];p(t)&&(r.push(t.imageryLayersUpdatedEvent.addEventListener(Oe(e))),r.push(t.terrainProviderChanged.addEventListener(Oe(e)))),e._removeGlobeCallbacks=r}(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(e){this._view.camera=e}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},frameState:{get:function(){return this._frameState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(p(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if(p(this.globe))return this.globe.terrainProvider},set:function(e){p(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if(p(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){e===we.SCENE2D?this.morphTo2D(0):e===we.SCENE3D?this.morphTo3D(0):e===we.COLUMBUS_VIEW&&this.morphToColumbusView(0),this._mode=e}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},terrainExaggeration:{get:function(){return this._terrainExaggeration}},useWebVR:{get:function(){return this._useWebVR},set:function(e){this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new J(this),p(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new se(this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},imagerySplitPosition:{get:function(){return this._frameState.imagerySplitPosition},set:function(e){this._frameState.imagerySplitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){this._minimumDisableDepthTestDistance=e}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(e){e=this._context.fragmentDepth&&e,this._logDepthBuffer!==e&&(this._logDepthBuffer=e,this._logDepthBufferDirty=!0,this._defaultView.updateFrustums=!0)}},gamma:{get:function(){return this._context.uniformState.gamma},set:function(e){this._context.uniformState.gamma=e}},highDynamicRange:{get:function(){return this._hdr},set:function(e){var t=this._context,i=e&&t.depthTexture&&(t.colorBufferFloat||t.colorBufferHalfFloat);this._hdrDirty=i!==this._hdr,this._hdr=i}},highDynamicRangeSupported:{get:function(){var e=this._context;return e.depthTexture&&(e.colorBufferFloat||e.colorBufferHalfFloat)}},sunColor:{get:function(){return this._sunColor},set:function(e){this._sunColor=e}},pixelRatio:{get:function(){return this._frameState.pixelRatio},set:function(e){this._frameState.pixelRatio=e}},opaqueFrustumNearOffset:{get:function(){return this._frameState.useLogDepth?.9:.9999}}}),Me.prototype.getCompressedTextureFormatSupported=function(e){var t=this.context;return("WEBGL_compressed_texture_s3tc"===e||"s3tc"===e)&&t.s3tc||("WEBGL_compressed_texture_pvrtc"===e||"pvrtc"===e)&&t.pvrtc||("WEBGL_compressed_texture_etc1"===e||"etc1"===e)&&t.etc1},Me.prototype.updateDerivedCommands=function(e){if(p(e.derivedCommands)){var t=this._frameState,i=this._context,r=!1,n=t.shadowState.lastDirtyTime;e.lastDirtyTime!==n&&(e.lastDirtyTime=n,e.dirty=!0,r=!0);var o=t.useLogDepth,a=this._hdr,s=e.derivedCommands,l=p(s.logDepth),u=p(s.hdr),c=p(s.originalCommand),d=o&&!l,h=a&&!u,m=!(o&&a||c);if(e.dirty=e.dirty||d||h||m,e.dirty){e.dirty=!1;var f=t.shadowState.shadowMaps;t.shadowState.shadowsEnabled&&e.castShadows&&(s.shadows=Ae.createCastDerivedCommand(f,e,r,i,s.shadows)),(l||d)&&(s.logDepth=ae.createLogDepthCommand(e,i,s.logDepth),Ne(this,s.logDepth.command,r)),(c||m)&&Ne(this,e,r)}}};var Fe,Re=new te({pass:ee.MOST_DETAILED_PRELOAD}),Le=new te({pass:ee.MOST_DETAILED_PICK}),Ve=new te({pass:ee.RENDER}),Ue=new te({pass:ee.PICK}),ze=new te({pass:ee.PRELOAD}),Be=new te({pass:ee.PRELOAD_FLIGHT}),He=new te({pass:ee.REQUEST_RENDER_MODE_DEFER_CHECK}),ke=new i;function Ge(e){e.render=!1,e.pick=!1,e.depth=!1,e.postProcess=!1,e.offscreen=!1}function We(e,t,i){var r=e._frameState;r.frameNumber=t,r.time=C.clone(i,r.time)}function Ye(e){var t=e.camera,i=e._frameState;i.commandList.length=0,i.shadowMaps.length=0,i.brdfLutGenerator=e._brdfLutGenerator,i.environmentMap=e.skyBox&&e.skyBox._cubeMap,i.mode=e._mode,i.morphTime=e.morphTime,i.mapProjection=e.mapProjection,i.camera=t,i.cullingVolume=t.frustum.computeCullingVolume(t.positionWC,t.directionWC,t.upWC),i.occluder=function(e){var t=e.globe;if(e._mode===we.SCENE3D&&p(t)&&t.show){var i=t.ellipsoid;return ke.radius=i.minimumRadius,Fe=P.fromBoundingSphere(ke,e.camera.positionWC,Fe)}}(e),i.terrainExaggeration=e._terrainExaggeration,i.minimumDisableDepthTestDistance=e._minimumDisableDepthTestDistance,i.invertClassification=e.invertClassification,i.useLogDepth=e._logDepthBuffer&&!(e.camera.frustum instanceof b||e.camera.frustum instanceof D),i.sunColor=e._sunColor,p(e._specularEnvironmentMapAtlas)&&e._specularEnvironmentMapAtlas.ready?(i.specularEnvironmentMaps=e._specularEnvironmentMapAtlas.texture,i.specularEnvironmentMapsMaximumLOD=e._specularEnvironmentMapAtlas.maximumMipmapLevel):(i.specularEnvironmentMaps=void 0,i.specularEnvironmentMapsMaximumLOD=void 0),i.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,e._actualInvertClassificationColor=l.clone(e.invertClassificationColor,e._actualInvertClassificationColor),de.isTranslucencySupported(e._context)||(e._actualInvertClassificationColor.alpha=1),i.invertClassificationColor=e._actualInvertClassificationColor,p(e.globe)?i.maximumScreenSpaceError=e.globe.maximumScreenSpaceError:i.maximumScreenSpaceError=2,Ge(i.passes),i.tilesetPassState=void 0}var je=new d;function Xe(e,t,i){var r=k.shallowClone(e);r.shaderProgram=function(e,t,i){var r=t.context,n=h(i,e.shaderProgram),o=n.fragmentShaderSource.clone(),a=[];o.sources=o.sources.map(function(e){e=Q.replaceMain(e,"czm_Debug_main");for(var t,i=/gl_FragData\[(\d+)\]/g;null!==(t=i.exec(e));)-1===a.indexOf(t[1])&&a.push(t[1]);return e});var s,u=a.length,c="void main() \n{ \n    czm_Debug_main(); \n";if(t.debugShowCommands){p(e._debugColor)||(e._debugColor=l.fromRandom());var d=e._debugColor;if(u>0)for(s=0;s<u;++s)c+="    gl_FragData["+a[s]+"].rgb *= vec3("+d.red+", "+d.green+", "+d.blue+"); \n";else c+="    gl_FragColor.rgb *= vec3("+d.red+", "+d.green+", "+d.blue+"); \n"}if(t.debugShowFrustums){var m=1&e.debugOverlappingFrustums?"1.0":"0.0",f=2&e.debugOverlappingFrustums?"1.0":"0.0",_=4&e.debugOverlappingFrustums?"1.0":"0.0";if(u>0)for(s=0;s<u;++s)c+="    gl_FragData["+a[s]+"].rgb *= vec3("+m+", "+f+", "+_+"); \n";else c+="    gl_FragColor.rgb *= vec3("+m+", "+f+", "+_+"); \n"}c+="}",o.sources.push(c);var g=function(e){var t={},i=e.vertexAttributes;for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r].index);return t}(n);return X.fromCache({context:r,vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:o,attributeLocations:g})}(e,t),r.execute(t.context,i),r.shaderProgram.destroy()}Me.prototype.isVisible=function(e,t,i){return p(e)&&(!p(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==T.OUTSIDE&&(!p(i)||!e.occlude||!e.boundingVolume.isOccluded(i)))};var Qe=new A(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);function qe(e,t,i,n,a){var s=t._frameState;if(!p(t.debugCommandFilter)||t.debugCommandFilter(e))if(e instanceof U)e.execute(i,n);else{e.debugShowBoundingVolume&&p(e.boundingVolume)&&function(e,t,i,n){var a,s=t._frameState,l=s.context,c=e.boundingVolume;p(t._debugVolume)&&t._debugVolume.destroy();var d=o.clone(c.center);if(s.mode!==we.SCENE3D){d=A.multiplyByPoint(Qe,d,d);var h=s.mapProjection,m=h.unproject(d);d=h.ellipsoid.cartographicToCartesian(m)}if(p(c.radius)){var f=c.radius;a=w.toWireframe(g.createGeometry(new g({radii:new o(f,f,f),vertexFormat:_e.FLAT_VERTEX_FORMAT}))),t._debugVolume=new ye({geometryInstances:new x({geometry:a,modelMatrix:A.fromTranslation(d),attributes:{color:new u(1,0,0,1)}}),appearance:new _e({flat:!0,translucent:!1}),asynchronous:!1})}else{var _=c.halfAxes;a=w.toWireframe(r.createGeometry(r.fromDimensions({dimensions:new o(2,2,2),vertexFormat:_e.FLAT_VERTEX_FORMAT}))),t._debugVolume=new ye({geometryInstances:new x({geometry:a,modelMatrix:A.fromRotationTranslation(_,d,new A),attributes:{color:new u(1,0,0,1)}}),appearance:new _e({flat:!0,translucent:!1}),asynchronous:!1})}var v,y=s.commandList,T=s.commandList=[];t._debugVolume.update(s),e=T[0],s.useLogDepth&&(e=ae.createLogDepthCommand(e,l).command),p(n)&&(v=i.framebuffer,i.framebuffer=n),e.execute(l,i),p(v)&&(i.framebuffer=v),s.commandList=y}(e,t,n,a),s.useLogDepth&&p(e.derivedCommands.logDepth)&&(e=e.derivedCommands.logDepth.command);var l=s.passes;if(!l.pick&&t._hdr&&p(e.derivedCommands)&&p(e.derivedCommands.hdr)&&(e=e.derivedCommands.hdr.command),l.pick||l.depth){if(l.pick&&!l.depth&&p(e.derivedCommands.picking))return void(e=e.derivedCommands.picking.pickCommand).execute(i,n);if(p(e.derivedCommands.depth))return void(e=e.derivedCommands.depth.depthOnlyCommand).execute(i,n)}t.debugShowCommands||t.debugShowFrustums?Xe(e,t,n):s.shadowState.lightShadowsEnabled&&e.receiveShadows&&p(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(i,n):e.execute(i,n)}}function Ze(e,t,i,r){var n=t._frameState,o=e.derivedCommands;p(o)&&(n.useLogDepth&&p(o.logDepth)&&(e=o.logDepth.command),o=e.derivedCommands,p(o.picking)?(e=o.picking.pickCommand).execute(i,r):p(o.depth)&&(e=o.depth.depthOnlyCommand).execute(i,r))}function Ke(e,t,i){return t.boundingVolume.distanceSquaredTo(i)-e.boundingVolume.distanceSquaredTo(i)}function Je(e,t,i){return e.boundingVolume.distanceSquaredTo(i)-t.boundingVolume.distanceSquaredTo(i)+E.EPSILON12}function $e(e,t,i,r,n){var o=e.context;S(r,Ke,e.camera.positionWC),p(n)&&t(n.unclassifiedCommand,e,o,i);for(var a=r.length,s=0;s<a;++s)t(r[s],e,o,i)}function et(e,t,i,r,n){var o=e.context;S(r,Je,e.camera.positionWC),p(n)&&t(n.unclassifiedCommand,e,o,i);for(var a=r.length,s=0;s<a;++s)t(r[s],e,o,i)}function tt(e,t){var i=e._view.debugGlobeDepths,r=i[t];return!p(r)&&e.context.depthTexture&&(r=new ce,i[t]=r),r}function it(e,t){var i=e._view.pickDepths,r=i[t];return p(r)||(r=new ge,i[t]=r),r}Qe=A.inverseTransformation(Qe,Qe);var rt=new O,nt=new I,ot=new b,at=new D;function st(e,t){var i,r=e.camera,n=e.context,o=n.uniformState;o.updateCamera(r),(i=p(r.frustum.fov)?r.frustum.clone(rt):p(r.frustum.infiniteProjectionMatrix)?r.frustum.clone(nt):p(r.frustum.width)?r.frustum.clone(ot):r.frustum.clone(at)).near=r.frustum.near,i.far=r.frustum.far,o.updateFrustum(i),o.updatePass(W.ENVIRONMENT);var a,s=e._frameState.passes,l=s.pick,u=e._environmentState,c=e._view,d=u.renderTranslucentDepthForPick,h=u.useWebVR;if(!l){var m,f=u.skyBoxCommand;if(p(f)&&qe(f,e,n,t),u.isSkyAtmosphereVisible&&qe(u.skyAtmosphereCommand,e,n,t),u.isSunVisible)if(u.sunDrawCommand.execute(n,t),e.sunBloom&&!h)m=u.useGlobeDepthFramebuffer?c.globeDepth.framebuffer:u.usePostProcess?c.sceneFramebuffer.getFramebuffer():u.originalFramebuffer,e._sunPostProcess.execute(n),e._sunPostProcess.copy(n,m),t.framebuffer=m;u.isMoonVisible&&u.moonCommand.execute(n,t)}u.useOIT?(p(e._executeOITFunction)||(e._executeOITFunction=function(e,t,i,r,n){c.oit.executeCommands(e,t,i,r,n)}),a=e._executeOITFunction):a=s.render?$e:et;for(var _,g=u.clearGlobeDepth,v=u.useDepthPlane,y=e._depthClearCommand,x=e._stencilClearCommand,w=e._classificationStencilClearCommand,T=e._depthPlane,C=u.usePostProcessSelected,E=r.position.z,A=c.frustumCommandsList,S=A.length,P=0;P<S;++P){var b=S-P-1,D=A[b];e.mode===we.SCENE2D?(r.position.z=E-D.near+1,i.far=Math.max(1,D.far-D.near),i.near=1,o.update(e.frameState),o.updateFrustum(i)):(i.near=0!==b?D.near*e.opaqueFrustumNearOffset:D.near,i.far=D.far,o.updateFrustum(i));var O,I=e.debugShowGlobeDepth?tt(e,b):c.globeDepth;e.debugShowGlobeDepth&&p(I)&&u.useGlobeDepthFramebuffer&&(I.update(n,t,c.viewport),I.clear(n,t,e._clearColorCommand.color),O=t.framebuffer,t.framebuffer=I.framebuffer),y.execute(n,t),n.stencilBuffer&&x.execute(n,t),o.updatePass(W.GLOBE);var M,N=D.commands[W.GLOBE],F=D.indices[W.GLOBE];for(_=0;_<F;++_)qe(N[_],e,n,t);for(p(I)&&u.useGlobeDepthFramebuffer&&I.executeCopyDepth(n,t),e.debugShowGlobeDepth&&p(I)&&u.useGlobeDepthFramebuffer&&(t.framebuffer=O),o.updatePass(W.TERRAIN_CLASSIFICATION),N=D.commands[W.TERRAIN_CLASSIFICATION],F=D.indices[W.TERRAIN_CLASSIFICATION],_=0;_<F;++_)qe(N[_],e,n,t);if(g&&(y.execute(n,t),v&&T.execute(n,t)),!u.useInvertClassification||l){for(o.updatePass(W.CESIUM_3D_TILE),N=D.commands[W.CESIUM_3D_TILE],F=D.indices[W.CESIUM_3D_TILE],_=0;_<F;++_)qe(N[_],e,n,t);if(F>0)for(p(I)&&u.useGlobeDepthFramebuffer&&I.executeUpdateDepth(n,t,g),o.updatePass(W.CESIUM_3D_TILE_CLASSIFICATION),N=D.commands[W.CESIUM_3D_TILE_CLASSIFICATION],F=D.indices[W.CESIUM_3D_TILE_CLASSIFICATION],_=0;_<F;++_)qe(N[_],e,n,t)}else{e._invertClassification.clear(n,t);var R=t.framebuffer;for(t.framebuffer=e._invertClassification._fbo,o.updatePass(W.CESIUM_3D_TILE),N=D.commands[W.CESIUM_3D_TILE],F=D.indices[W.CESIUM_3D_TILE],_=0;_<F;++_)qe(N[_],e,n,t);for(p(I)&&u.useGlobeDepthFramebuffer&&I.executeUpdateDepth(n,t,g),o.updatePass(W.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),N=D.commands[W.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],F=D.indices[W.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],_=0;_<F;++_)qe(N[_],e,n,t);for(t.framebuffer=R,e._invertClassification.executeClassified(n,t),1===e.frameState.invertClassificationColor.alpha&&e._invertClassification.executeUnclassified(n,t),F>0&&n.stencilBuffer&&w.execute(n,t),o.updatePass(W.CESIUM_3D_TILE_CLASSIFICATION),N=D.commands[W.CESIUM_3D_TILE_CLASSIFICATION],F=D.indices[W.CESIUM_3D_TILE_CLASSIFICATION],_=0;_<F;++_)qe(N[_],e,n,t)}for(F>0&&n.stencilBuffer&&x.execute(n,t),o.updatePass(W.OPAQUE),N=D.commands[W.OPAQUE],F=D.indices[W.OPAQUE],_=0;_<F;++_)qe(N[_],e,n,t);if(0!==b&&e.mode!==we.SCENE2D&&(i.near=D.near,o.updateFrustum(i)),!l&&u.useInvertClassification&&e.frameState.invertClassificationColor.alpha<1&&(M=e._invertClassification),o.updatePass(W.TRANSLUCENT),(N=D.commands[W.TRANSLUCENT]).length=D.indices[W.TRANSLUCENT],a(e,qe,t,N,M),n.depthTexture&&e.useDepthPicking&&(u.useGlobeDepthFramebuffer||d)){var L=d?t.framebuffer.depthStencilTexture:I.framebuffer.depthStencilTexture,V=it(e,b);V.update(n,L),V.executeCopyDepth(n,t)}if(!l&&C){var U=t.framebuffer;for(t.framebuffer=c.sceneFramebuffer.getIdFramebuffer(),i.near=0!==b?D.near*e.opaqueFrustumNearOffset:D.near,i.far=D.far,o.updateFrustum(i),o.updatePass(W.GLOBE),N=D.commands[W.GLOBE],F=D.indices[W.GLOBE],_=0;_<F;++_)Ze(N[_],e,n,t);for(g&&(y.framebuffer=t.framebuffer,y.execute(n,t),y.framebuffer=void 0),g&&v&&T.execute(n,t),o.updatePass(W.CESIUM_3D_TILE),N=D.commands[W.CESIUM_3D_TILE],F=D.indices[W.CESIUM_3D_TILE],_=0;_<F;++_)Ze(N[_],e,n,t);for(o.updatePass(W.OPAQUE),N=D.commands[W.OPAQUE],F=D.indices[W.OPAQUE],_=0;_<F;++_)Ze(N[_],e,n,t);for(o.updatePass(W.TRANSLUCENT),N=D.commands[W.TRANSLUCENT],F=D.indices[W.TRANSLUCENT],_=0;_<F;++_)Ze(N[_],e,n,t);t.framebuffer=U}}}function lt(e){e.context.uniformState.updatePass(W.COMPUTE);var t=e._environmentState.sunComputeCommand;p(t)&&t.execute(e._computeEngine);for(var i=e._computeCommandList,r=i.length,n=0;n<r;++n)i[n].execute(e._computeEngine)}function ut(e,t,i){for(var r=i.shadowMapCullingVolume,n=i.isPointLight,o=i.passes,a=o.length,s=t.length,l=0;l<s;++l){var u=t[l];if(e.updateDerivedCommands(u),u.castShadows&&(u.pass===W.GLOBE||u.pass===W.CESIUM_3D_TILE||u.pass===W.OPAQUE||u.pass===W.TRANSLUCENT)&&e.isVisible(u,r))if(n)for(var c=0;c<a;++c)o[c].commandList.push(u);else if(1===a)o[0].commandList.push(u);else for(var d=!1,h=a-1;h>=0;--h){var p=o[h].cullingVolume;if(e.isVisible(u,p))o[h].commandList.push(u),d=!0;else if(d)break}}}function ct(e){var t=e.frameState,i=t.shadowState.shadowMaps,r=i.length;if(t.shadowState.shadowsEnabled)for(var n=e.context,o=n.uniformState,a=0;a<r;++a){var s=i[a];if(!s.outOfView){var l,u=s.passes,c=u.length;for(l=0;l<c;++l)u[l].commandList.length=0;for(ut(e,e.frameState.commandList,s),l=0;l<c;++l){var d=s.passes[l];o.updateCamera(d.camera),s.updatePass(n,l);for(var h=d.commandList.length,p=0;p<h;++p){var m=d.commandList[p];o.updatePass(m.pass),qe(m.derivedCommands.shadows.castCommands[a],e,n,d.passState)}}}}}var dt=new o;function ht(e,i,r){var n=e._frameState.mode;e._environmentState.useWebVR?function(e,t,i){var r=e._view,n=r.camera,a=e._environmentState.renderTranslucentDepthForPick;Et(e,t,i),a||Ct(e);r.createPotentiallyVisibleSet(e),a||(lt(e),ct(e));var s=t.viewport;s.x=0,s.y=0,s.width=.5*s.width;var l=J.clone(n,e._cameraVR);l.frustum=n.frustum;var u=n.frustum.near,c=u*h(e.focalLength,5),d=h(e.eyeSeparation,c/30),p=o.multiplyByScalar(l.right,.5*d,dt);n.frustum.aspectRatio=s.width/s.height;var m=.5*d*u/c;o.add(l.position,p,n.position),n.frustum.xOffset=m,st(e,t),s.x=s.width,o.subtract(l.position,p,n.position),n.frustum.xOffset=-m,st(e,t),J.clone(l,n)}(e,i,r):n!==we.SCENE2D||e._mapMode2D===pe.ROTATE?wt(!0,e,i,r):(Et(e,i,r),function(e,i){var r=e.context,n=e.frameState,a=e.camera,s=i.viewport,l=t.clone(s,xt);i.viewport=l;var u=pt,c=mt;e.mapProjection.project(u,c);var d=o.clone(a.position,ft),h=A.clone(a.transform,gt),p=a.frustum.clone();a._setTransform(A.IDENTITY);var m=A.computeViewportTransformation(l,0,1,_t),f=a.frustum.projectionMatrix,_=a.positionWC.y,g=o.fromElements(E.sign(_)*c.x-_,0,-a.positionWC.x,vt),v=V.pointToGLWindowCoordinates(f,m,g,yt);v.x=Math.floor(v.x);var y=l.x,x=l.width;if(0===_||v.x<=y||v.x>=y+x)wt(!0,e,i);else if(Math.abs(y+.5*x-v.x)<1)l.width=v.x-l.x,a.position.x*=E.sign(a.position.x),a.frustum.right=0,n.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),r.uniformState.update(n),wt(!0,e,i),l.x=v.x,a.position.x=-a.position.x,a.frustum.right=-a.frustum.left,a.frustum.left=0,n.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),r.uniformState.update(n),wt(!1,e,i);else if(v.x>y+.5*x){l.width=v.x-y;var w=a.frustum.right;a.frustum.right=c.x-_,n.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),r.uniformState.update(n),wt(!0,e,i),l.x=v.x,l.width=y+x-v.x,a.position.x=-a.position.x,a.frustum.left=-a.frustum.right,a.frustum.right=w-2*a.frustum.right,n.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),r.uniformState.update(n),wt(!1,e,i)}else{l.x=v.x,l.width=y+x-v.x;var T=a.frustum.left;a.frustum.left=-c.x-_,n.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),r.uniformState.update(n),wt(!0,e,i),l.x=y,l.width=v.x-y,a.position.x=-a.position.x,a.frustum.right=-a.frustum.left,a.frustum.left=T-2*a.frustum.left,n.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),r.uniformState.update(n),wt(!1,e,i)}a._setTransform(h),o.clone(d,a.position),a.frustum=p.clone(),i.viewport=s}(e,i))}var pt=new a(Math.PI,E.PI_OVER_TWO),mt=new o,ft=new o,_t=new A,gt=new A,vt=new o,yt=new o,xt=new t;function wt(e,t,i,r){var n=t._environmentState,o=t._view,a=n.renderTranslucentDepthForPick;e||a||(t.frameState.commandList.length=0),a||Ct(t),o.createPotentiallyVisibleSet(t),e&&(p(r)&&Et(t,i,r),a||(lt(t),ct(t))),st(t,i)}function Tt(e){var t=e._frameState,i=e._view,r=e._environmentState,n=t.passes.render,o=t.passes.offscreen,a=e.skyAtmosphere,s=e.globe;if(!n||e._mode!==we.SCENE2D&&i.camera.frustum instanceof b)r.skyAtmosphereCommand=void 0,r.skyBoxCommand=void 0,r.sunDrawCommand=void 0,r.sunComputeCommand=void 0,r.moonCommand=void 0;else{p(a)&&p(s)&&(a.setDynamicAtmosphereColor(s.enableLighting),r.isReadyForAtmosphere=r.isReadyForAtmosphere||s._surface._tilesToRender.length>0),r.skyAtmosphereCommand=p(a)?a.update(t):void 0,r.skyBoxCommand=p(e.skyBox)?e.skyBox.update(t,e._hdr):void 0;var l=p(e.sun)?e.sun.update(t,i.passState,e._hdr):void 0;r.sunDrawCommand=p(l)?l.drawCommand:void 0,r.sunComputeCommand=p(l)?l.computeCommand:void 0,r.moonCommand=p(e.moon)?e.moon.update(t):void 0}var u=r.clearGlobeDepth=p(s)&&(!s.depthTestAgainstTerrain||e.mode===we.SCENE2D);(r.useDepthPlane=u&&e.mode===we.SCENE3D)&&e._depthPlane.update(t),r.renderTranslucentDepthForPick=!1,r.useWebVR=e._useWebVR&&e.mode!==we.SCENE2D&&!o;for(var c=t.mode===we.SCENE3D?t.occluder:void 0,d=t.cullingVolume,h=je.planes,m=0;m<5;++m)h[m]=d.planes[m];d=je,r.isSkyAtmosphereVisible=p(r.skyAtmosphereCommand)&&r.isReadyForAtmosphere,r.isSunVisible=e.isVisible(r.sunDrawCommand,d,c),r.isMoonVisible=e.isVisible(r.moonCommand,d,c);var f=e.specularEnvironmentMaps,_=e._specularEnvironmentMapAtlas;!p(f)||p(_)&&_.url===f?!p(f)&&p(_)&&(_.destroy(),e._specularEnvironmentMapAtlas=void 0):(_=_&&_.destroy(),e._specularEnvironmentMapAtlas=new me(f)),p(e._specularEnvironmentMapAtlas)&&e._specularEnvironmentMapAtlas.update(t)}function Ct(e){var t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),function(e){var t=e._frameState;e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes&&(e.debugShowFrustumPlanes?e._debugFrustumPlanes=new ne({camera:e.camera,updateOnChange:!1}):e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy(),e._debugShowFrustumPlanes=e.debugShowFrustumPlanes),p(e._debugFrustumPlanes)&&e._debugFrustumPlanes.update(t)}(e),function(e){var t=e._frameState,i=t.shadowMaps,r=i.length,n=r>0&&!t.passes.pick&&e.mode===we.SCENE3D;if(n!==t.shadowState.shadowsEnabled&&(++t.shadowState.lastDirtyTime,t.shadowState.shadowsEnabled=n),t.shadowState.lightShadowsEnabled=!1,n){for(var o=0;o<r;++o)if(i[o]!==t.shadowState.shadowMaps[o]){++t.shadowState.lastDirtyTime;break}t.shadowState.shadowMaps.length=0,t.shadowState.lightShadowMaps.length=0;for(var a=0;a<r;++a){var s=i[a];s.update(t),t.shadowState.shadowMaps.push(s),s.fromLightSource&&(t.shadowState.lightShadowMaps.push(s),t.shadowState.lightShadowsEnabled=!0),s.dirty&&(++t.shadowState.lastDirtyTime,s.dirty=!1)}}}(e),e._globe&&e._globe.render(t)}function Et(e,t,i){var r=e._context,n=e._frameState,o=e._environmentState,a=e._view,s=e._frameState.passes.pick,u=o.useWebVR;o.originalFramebuffer=t.framebuffer,p(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!u?e._sunPostProcess=new Pe:p(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!p(e.sun)&&p(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);var c=e._clearColorCommand;l.clone(i,c.color),c.execute(r,t);var d=o.useGlobeDepthFramebuffer=p(a.globeDepth);d&&(a.globeDepth.update(r,t,a.viewport,e._hdr),a.globeDepth.clear(r,t,i));var h=a.oit,m=o.useOIT=!s&&p(h)&&h.isSupported();m&&(h.update(r,t,a.globeDepth.framebuffer,e._hdr),h.clear(r,t,i),o.useOIT=h.isSupported());var f,_=e.postProcessStages,g=o.usePostProcess=!s&&(e._hdr||_.length>0||_.ambientOcclusion.enabled||_.fxaa.enabled||_.bloom.enabled);if(o.usePostProcessSelected=!1,g&&(a.sceneFramebuffer.update(r,a.viewport,e._hdr),a.sceneFramebuffer.clear(r,t,i),_.update(r,n.useLogDepth,e._hdr),_.clear(r),g=o.usePostProcess=_.ready,o.usePostProcessSelected=g&&_.hasSelected),o.isSunVisible&&e.sunBloom&&!u?(t.framebuffer=e._sunPostProcess.update(t),e._sunPostProcess.clear(r,t,i)):d?t.framebuffer=a.globeDepth.framebuffer:g&&(t.framebuffer=a.sceneFramebuffer.getFramebuffer()),p(t.framebuffer)&&c.execute(r,t),o.useInvertClassification=!s&&p(t.framebuffer)&&e.invertClassification)if(1===e.frameState.invertClassificationColor.alpha&&o.useGlobeDepthFramebuffer&&(f=a.globeDepth.framebuffer),p(f)||r.depthTexture){if(e._invertClassification.previousFramebuffer=f,e._invertClassification.update(r),e._invertClassification.clear(r,t),e.frameState.invertClassificationColor.alpha<1&&m){var v=e._invertClassification.unclassifiedCommand,y=v.derivedCommands;y.oit=h.createDerivedCommands(v,r,y.oit)}}else o.useInvertClassification=!1}function At(e,t){var i=e._context,r=e._frameState,n=e._environmentState,o=e._view,a=n.useOIT,s=n.useGlobeDepthFramebuffer,l=n.usePostProcess,u=n.originalFramebuffer,c=s?o.globeDepth.framebuffer:void 0,d=o.sceneFramebuffer.getFramebuffer(),p=o.sceneFramebuffer.getIdFramebuffer();if(a&&(t.framebuffer=l?d:u,o.oit.execute(i,t)),l){var m=d;s&&!a&&(m=c);var f=e.postProcessStages,_=m.getColorTexture(0),g=p.getColorTexture(0),v=h(c,d).depthStencilTexture;f.execute(i,_,v,g),f.copy(i,u)}a||l||!s||(t.framebuffer=u,o.globeDepth.executeCopyColor(i,t));var y=r.useLogDepth;e.debugShowGlobeDepth&&s&&tt(e,e.debugShowDepthFrustum-1).executeDebugGlobeDepth(i,t,y);e.debugShowPickDepth&&s&&it(e,e.debugShowDepthFrustum-1).executeDebugPickDepth(i,t,y)}function St(e){e._jobScheduler.resetBudgets();var t=e._frameState;e.primitives.prePassesUpdate(t),p(e.globe)&&e.globe.update(t),e._pickPositionCacheDirty=!0,t.creditDisplay.update()}function Pt(e){var t=e._frameState;e.primitives.postPassesUpdate(t),F.update()}Me.prototype.initializeFrame=function(){120==this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms(),this._context.textureCache.destroyReleasedTextures()),this._tweens.update(),this._screenSpaceCameraController.update(),p(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()};var bt=new l;function Dt(e){var i=e._frameState,r=e.context,n=r.uniformState,a=e._defaultView;e._view=a,Ye(e),i.passes.render=!0,i.passes.postProcess=e.postProcessStages.hasSelected,i.tilesetPassState=Ve;var s=h(e.backgroundColor,l.BLACK);e._hdr&&((s=l.clone(s,bt)).red=Math.pow(s.red,e.gamma),s.green=Math.pow(s.green,e.gamma),s.blue=Math.pow(s.blue,e.gamma)),i.backgroundColor=s,i.creditDisplay.beginFrame(),e.fog.update(i),n.update(i);var u=e.shadowMap;p(u)&&u.enabled&&(o.negate(n.sunDirectionWC,e._sunCamera.direction),i.shadowMaps.push(u)),e._computeCommandList.length=0,e._overlayCommandList.length=0;var c=a.viewport;c.x=0,c.y=0,c.width=r.drawingBufferWidth,c.height=r.drawingBufferHeight;var d=a.passState;d.framebuffer=void 0,d.blendingEnabled=void 0,d.scissorTest=void 0,d.viewport=t.clone(c,d.viewport),p(e.globe)&&e.globe.beginFrame(i),Tt(e),ht(e,d,s),At(e,d),d.framebuffer=void 0,function(e,t){e.context.uniformState.updatePass(W.OVERLAY);for(var i=e.context,r=e._overlayCommandList,n=r.length,o=0;o<n;++o)r[o].execute(i,t)}(e,d),p(e.globe)&&(e.globe.endFrame(i),e.globe.tilesLoaded||(e._renderRequested=!0)),i.creditDisplay.endFrame(),r.endFrame()}function Ot(e,t){try{t(e)}catch(t){if(e._renderError.raiseEvent(e,t),e.rethrowRenderErrors)throw t}}Me.prototype.render=function(e){this._preUpdate.raiseEvent(this,e);var t=this._frameState;t.newFrame=!1,p(e)||(e=C.now());var i=this._view.checkForCameraUpdates(this),r=!this.requestRenderMode||this._renderRequested||i||this._logDepthBufferDirty||this._hdrDirty||this.mode===we.MORPHING;if(!r&&p(this.maximumRenderTimeChange)&&p(this._lastRenderTime)){var n=Math.abs(C.secondsDifference(this._lastRenderTime,e));r=r||n>this.maximumRenderTimeChange}r&&(this._lastRenderTime=C.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1,We(this,E.incrementWrap(t.frameNumber,15e6,1),e),t.newFrame=!0);Ot(this,St),this.primitives.show&&(Ot(this,Jt),Ot(this,Yt),Ot(this,jt),r||Ot(this,Xt)),this._postUpdate.raiseEvent(this,e),r&&(this._preRender.raiseEvent(this,e),Ot(this,Dt)),function(e,t){if(e.debugShowFramesPerSecond){if(!p(e._performanceDisplay)){var i=document.createElement("div");i.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(i);var r=new fe({container:i});e._performanceDisplay=r,e._performanceContainer=i}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else p(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}(this,r),Ot(this,Pt),function(e){for(var t=e._frameState.afterRender,i=0,r=t.length;i<r;++i)t[i](),e.requestRender();t.length=0}(this),r&&this._postRender.raiseEvent(this,e)},Me.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)},Me.prototype.requestRender=function(){this._renderRequested=!0},Me.prototype.clampLineWidth=function(e){return Math.max(H.minimumAliasedLineWidth,Math.min(e,H.maximumAliasedLineWidth))};var It=new D,Mt=new o,Nt=new o,Ft=new n,Rt=new A;var Lt=new I;function Vt(e,t,i,r,n){var a=e.camera.frustum;return a instanceof b||a instanceof D?function(e,t,i,r,n){var a=e.camera,s=a.frustum;p(s._offCenterFrustum)&&(s=s._offCenterFrustum);var l=2*(t.x-n.x)/n.width-1;l*=.5*(s.right-s.left);var u=2*(n.height-t.y-n.y)/n.height-1;u*=.5*(s.top-s.bottom);var c=A.clone(a.transform,Rt);a._setTransform(A.IDENTITY);var d=o.clone(a.position,Mt);o.multiplyByScalar(a.right,l,Nt),o.add(Nt,d,d),o.multiplyByScalar(a.up,u,Nt),o.add(Nt,d,d),a._setTransform(c),e.mode===we.SCENE2D&&o.fromElements(d.z,d.x,d.y,d);var h=s.getPixelDimensions(n.width,n.height,1,Ft),m=It;return m.right=.5*h.x,m.left=-m.right,m.top=.5*h.y,m.bottom=-m.top,m.near=s.near,m.far=s.far,m.computeCullingVolume(d,a.directionWC,a.upWC)}(e,t,0,0,n):function(e,t,i,r,n){var o=e.camera,a=o.frustum,s=a.near,l=Math.tan(.5*a.fovy),u=a.aspectRatio*l,c=(2*(t.x-n.x)/n.width-1)*s*u,d=(2*(n.height-t.y-n.y)/n.height-1)*s*l,h=a.getPixelDimensions(n.width,n.height,1,Ft),p=h.x*i*.5,m=h.y*r*.5,f=Lt;return f.top=d+m,f.bottom=d-m,f.right=c+p,f.left=c-p,f.near=s,f.far=a.far,f.computeCullingVolume(o.positionWC,o.directionWC,o.upWC)}(e,t,i,r,n)}var Ut=3,zt=3,Bt=new t(0,0,Ut,zt),Ht=new l(0,0,0,0),kt=new n;Me.prototype.pick=function(e,i,r){Ut=h(i,3),zt=h(r,Ut);var n=this._context,o=n.uniformState,a=this._frameState,s=this._defaultView;this._view=s;var l=s.viewport;l.x=0,l.y=0,l.width=n.drawingBufferWidth,l.height=n.drawingBufferHeight;var u=s.passState;u.viewport=t.clone(l,u.viewport);var c=Te.transformWindowToDrawingBuffer(this,e,kt);this._jobScheduler.disableThisFrame(),Ye(this),a.cullingVolume=Vt(this,c,Ut,zt,l),a.invertClassification=!1,a.passes.pick=!0,a.tilesetPassState=Ue,o.update(a),Tt(this),Bt.x=c.x-.5*(Ut-1),Bt.y=this.drawingBufferHeight-c.y-.5*(zt-1),Bt.width=Ut,Bt.height=zt,ht(this,u=s.pickFramebuffer.begin(Bt,s.viewport),Ht),At(this,u);var d=s.pickFramebuffer.end(Bt);return n.endFrame(),d},Me.prototype.pickPositionWorldCoordinates=function(e,i){if(this.useDepthPicking){var r=e.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(r))return o.clone(this._pickPositionCache[r],i);var n=this._frameState,a=this._context,s=a.uniformState,l=this._defaultView;this._view=l;var u=Te.transformWindowToDrawingBuffer(this,e,kt);this.pickTranslucentDepth?function(e,i){var r=e._context,n=e._frameState,o=e._environmentState,a=e._defaultView;e._view=a;var s=a.viewport;s.x=0,s.y=0,s.width=r.drawingBufferWidth,s.height=r.drawingBufferHeight;var l=a.passState;l.viewport=t.clone(s,l.viewport),Ge(n.passes),n.passes.pick=!0,n.passes.depth=!0,n.cullingVolume=Vt(e,i,1,1,s),n.tilesetPassState=Ue,Tt(e),o.renderTranslucentDepthForPick=!0,ht(e,l=a.pickDepthFramebuffer.update(r,i,s),Ht),At(e,l),r.endFrame()}(this,u):(Ye(this,n.frameNumber,n.time),s.update(n),Tt(this)),u.y=this.drawingBufferHeight-u.y;var c,d=this.camera;c=p(d.frustum.fov)?d.frustum.clone(rt):p(d.frustum.infiniteProjectionMatrix)?d.frustum.clone(nt):p(d.frustum.width)?d.frustum.clone(ot):d.frustum.clone(at);for(var h=l.frustumCommandsList,m=h.length,f=0;f<m;++f){var _=it(this,f).getDepth(a,u.x,u.y);if(_>0&&_<1){var g,v=h[f];return this.mode===we.SCENE2D?(g=d.position.z,d.position.z=g-v.near+1,c.far=Math.max(1,v.far-v.near),c.near=1,s.update(n),s.updateFrustum(c)):(c.near=v.near*(0!==f?this.opaqueFrustumNearOffset:1),c.far=v.far,s.updateFrustum(c)),i=Te.drawingBufferToWgs84Coordinates(this,u,_,i),this.mode===we.SCENE2D&&(d.position.z=g,s.update(n)),this._pickPositionCache[r]=o.clone(i),i}}this._pickPositionCache[r]=void 0}};var Gt=new a;function Wt(e,t){var i,r,n=[],o=[],a=[],s=[];p(e)||(e=Number.MAX_VALUE);for(var l=t();p(l);){var u=l.object,c=l.position,d=l.exclude;if(p(c)&&!p(u)){n.push(l);break}if(!p(u)||!p(u.primitive))break;if(!d&&(n.push(l),0>=--e))break;var h=u.primitive,m=!1;"function"==typeof h.getGeometryInstanceAttributes&&p(u.id)&&(r=h.getGeometryInstanceAttributes(u.id),p(r)&&p(r.show)&&(m=!0,r.show=R.toValue(!1,r.show),a.push(r))),u instanceof $&&(m=!0,u.show=!1,s.push(u)),m||(h.show=!1,o.push(h)),l=t()}for(i=0;i<o.length;++i)o[i].show=!0;for(i=0;i<a.length;++i)(r=a[i]).show=R.toValue(!0,r.show);for(i=0;i<s.length;++i)s[i].show=!0;return n}function Yt(e){var t=e._frameState;ze.camera=t.camera,ze.cullingVolume=t.cullingVolume,e.primitives.updateForPass(t,ze)}function jt(e){var t=e._frameState;t.camera.hasCurrentFlight()&&(Be.camera=e.preloadFlightCamera,Be.cullingVolume=e.preloadFlightCullingVolume,e.primitives.updateForPass(t,Be))}function Xt(e){e.primitives.updateForPass(e._frameState,He)}Me.prototype.pickPosition=function(e,t){if(t=this.pickPositionWorldCoordinates(e,t),p(t)&&this.mode!==we.SCENE3D){o.fromElements(t.y,t.z,t.x,t);var i=this.mapProjection,r=i.ellipsoid,n=i.unproject(t,Gt);r.cartographicToCartesian(n,t)}return t},Me.prototype.drillPick=function(e,t,i,r){var n=this;return Wt(t,function(){var t=n.pick(e,i,r);if(p(t))return{object:t,position:void 0,exclude:!1}}).map(function(e){return e.object})};var Qt=new o,qt=new o;function Zt(e,t,i,r){var n=t.direction,a=o.mostOrthogonalAxis(n,Qt),s=o.cross(n,a,Qt),l=o.cross(n,s,qt);return r.position=t.origin,r.direction=n,r.up=l,r.right=s,r.frustum.width=h(i,e.pickOffscreenDefaultWidth),r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC)}function Kt(e,t){var i=e._frameState,r=t.ray,n=t.width,o=t.tilesets,a=e._pickOffscreenView.camera,s=Zt(e,r,n,a),l=Re;l.camera=a,l.cullingVolume=s;for(var u=!0,c=o.length,d=0;d<c;++d){var h=o[d];h.show&&e.primitives.contains(h)&&(h.updateForPass(i,l),u=u&&l.ready)}return u&&t.deferred.resolve(),u}function Jt(e){for(var t=e._mostDetailedRayPicks,i=0;i<t.length;++i)Kt(e,t[i])&&t.splice(i--,1)}function $t(e,t,i,r,n){var o=[];if(function e(t,i,r){for(var n=t.length,o=0;o<n;++o){var a=t.get(o);a.show&&(a instanceof ie?p(i)&&-1!==i.indexOf(a)||r.push(a):a instanceof xe&&e(a,i,r))}}(e.primitives,i,o),0===o.length)return Z.resolve(n());var a=new Ie(t,r,o);return e._mostDetailedRayPicks.push(a),a.promise.then(function(){return n()})}function ei(e,t){return!(!p(e)||!p(t)||0===t.length)&&(t.indexOf(e)>-1||t.indexOf(e.primitive)>-1||t.indexOf(e.id)>-1)}function ti(e,i,r,n,o,a,s){return Wt(r,function(){return function(e,i,r,n,o,a){var s=e._context,l=s.uniformState,u=e._frameState,c=e._pickOffscreenView;e._view=c,Zt(e,i,n,c.camera),Bt=t.clone(c.viewport,Bt);var d,h=c.pickFramebuffer.begin(Bt,c.viewport);e._jobScheduler.disableThisFrame(),Ye(e),u.invertClassification=!1,u.passes.pick=!0,u.passes.offscreen=!0,u.tilesetPassState=a?Le:Ue,l.update(u),Tt(e),ht(e,h,Ht),At(e,h);var m=c.pickFramebuffer.end(s);if(e._context.depthTexture)for(var f=c.frustumCommandsList.length,_=0;_<f;++_){var g=it(e,_).getDepth(s,0,0);if(g>0&&g<1){var v=c.frustumCommandsList[_],y=v.near*(0!==_?e.opaqueFrustumNearOffset:1),x=y+g*(v.far-y);d=N.getPoint(i,x);break}}if(e._view=e._defaultView,s.endFrame(),p(m)||p(d))return{object:m,position:d,exclude:!p(d)&&o||ei(m,r)}}(e,i,n,o,a,s)})}function ii(e,t,i,r,n,o){var a=ti(e,t,1,i,r,n,o);if(a.length>0)return a[0]}function ri(e,t,i,r,n,o,a){return ti(e,t,i,r,n,o,a)}function ni(e,t){var i=Z.defer();return t.then(function(t){var r=e.postRender.addEventListener(function(){i.resolve(t),r()})}),i.promise}Me.prototype.pickFromRay=function(e,t,i){return ii(this,e,t,i,!1,!1)},Me.prototype.drillPickFromRay=function(e,t,i,r){return ri(this,e,t,i,r,!1,!1)},Me.prototype.pickFromRayMostDetailed=function(e,t,i){var r=this;return e=N.clone(e),t=p(t)?t.slice():t,ni(this,$t(this,e,t,i,function(){return ii(r,e,t,i,!1,!0)}))},Me.prototype.drillPickFromRayMostDetailed=function(e,t,i,r){var n=this;return e=N.clone(e),i=p(i)?i.slice():i,ni(this,$t(this,e,i,r,function(){return ri(n,e,t,i,r,!1,!0)}))};var oi=new o,ai=new o,si=new N,li=new a;function ui(t,i){var r=t.globe,n=p(r)?r.ellipsoid:t.mapProjection.ellipsoid,s=e._defaultMaxTerrainHeight,l=n.geodeticSurfaceNormalCartographic(i,ai),u=a.toCartesian(i,n,oi),c=si;c.origin=u,c.direction=l;var d=new N;return N.getPoint(c,s,d.origin),o.negate(l,d.direction),d}function ci(e,t){var i=e.globe,r=p(i)?i.ellipsoid:e.mapProjection.ellipsoid;return ui(e,a.fromCartesian(t,r,li))}function di(e,t){var i=e.globe,r=p(i)?i.ellipsoid:e.mapProjection.ellipsoid;return a.fromCartesian(t,r,li).height}function hi(e,t,i,r){var n=ui(e,t);return $t(e,n,i,r,function(){var t=ii(e,n,i,r,!0,!0);if(p(t))return di(e,t.position)})}function pi(e,t,i,r,n){var a=ci(e,t);return $t(e,a,i,r,function(){var t=ii(e,a,i,r,!0,!0);if(p(t))return o.clone(t.position,n)})}return Me.prototype.sampleHeight=function(e,t,i){var r=ii(this,ui(this,e),t,i,!0,!1);if(p(r))return di(this,r.position)},Me.prototype.clampToHeight=function(e,t,i,r){var n=ii(this,ci(this,e),t,i,!0,!1);if(p(n))return o.clone(n.position,r)},Me.prototype.sampleHeightMostDetailed=function(e,t,i){t=p(t)?t.slice():t;for(var r=e.length,n=new Array(r),o=0;o<r;++o)n[o]=hi(this,e[o],t,i);return ni(this,Z.all(n).then(function(t){for(var i=t.length,r=0;r<i;++r)e[r].height=t[r];return e}))},Me.prototype.clampToHeightMostDetailed=function(e,t,i){t=p(t)?t.slice():t;for(var r=e.length,n=new Array(r),o=0;o<r;++o)n[o]=pi(this,e[o],t,i,e[o]);return ni(this,Z.all(n).then(function(t){for(var i=t.length,r=0;r<i;++r)e[r]=t[r];return e}))},Me.prototype.cartesianToCanvasCoordinates=function(e,t){return Te.wgs84ToWindowCoordinates(this,e,t)},Me.prototype.completeMorph=function(){this._transitioner.completeMorph()},Me.prototype.morphTo2D=function(e){var t,i=this.globe;t=p(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=h(e,2),this._transitioner.morphTo2D(e,t)},Me.prototype.morphToColumbusView=function(e){var t,i=this.globe;t=p(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=h(e,2),this._transitioner.morphToColumbusView(e,t)},Me.prototype.morphTo3D=function(e){var t,i=this.globe;t=p(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=h(e,2),this._transitioner.morphTo3D(e,t)},Me.prototype.isDestroyed=function(){return!1},Me.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),p(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(var e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,f(this)},Me}.apply(t,r))||(e.exports=n)},1860:function(e,t,i){var r,n;r=[i(8),i(11)],void 0===(n=function(e,t){"use strict";var i=[],r=[];function n(e,t,o,a,s){if(!(a>=s)){var l=Math.floor(.5*(a+s));n(e,t,o,a,l),n(e,t,o,l+1,s),function(e,t,n,o,a,s){var l,u,c=a-o+1,d=s-a,h=i,p=r;for(l=0;l<c;++l)h[l]=e[o+l];for(u=0;u<d;++u)p[u]=e[a+u+1];l=0,u=0;for(var m=o;m<=s;++m){var f=h[l],_=p[u];l<c&&(u>=d||t(f,_,n)<=0)?(e[m]=f,++l):u<d&&(e[m]=_,++u)}}(e,t,o,a,l,s)}}return function(e,t,o){var a=e.length,s=Math.ceil(.5*a);i.length=s,r.length=s,n(e,t,o,0,a-1),i.length=0,r.length=0}}.apply(t,r))||(e.exports=n)},1861:function(e,t,i){var r,n;r=[i(33),i(12),i(9),i(8),i(10),i(11),i(26),i(14),i(29),i(496)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u){"use strict";function c(e,i){this._occluderPosition=t.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=i}var d=new t;n(c.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){e=t.clone(e,this._cameraPosition);var i,r,n,o=t.subtract(this._occluderPosition,e,d),a=t.magnitudeSquared(o),s=this._occluderRadius*this._occluderRadius;if(a>s){i=Math.sqrt(a-s),a=1/Math.sqrt(a),r=t.multiplyByScalar(o,a,d);var l=i*i*a;n=t.add(e,t.multiplyByScalar(r,l,d),d)}else i=Number.MAX_VALUE;this._horizonDistance=i,this._horizonPlaneNormal=r,this._horizonPlanePosition=n,this._cameraPosition=e}}}),c.fromBoundingSphere=function(e,i,n){return r(n)?(t.clone(e.center,n._occluderPosition),n._occluderRadius=e.radius,n.cameraPosition=i,n):new c(e,i)};var h=new t;c.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){var i=t.subtract(e,this._occluderPosition,h),r=this._occluderRadius;if((r=t.magnitudeSquared(i)-r*r)>0)return r=Math.sqrt(r)+this._horizonDistance,i=t.subtract(e,this._cameraPosition,i),r*r>t.magnitudeSquared(i)}return!1};var p=new t;c.prototype.isBoundingSphereVisible=function(e){var i=t.clone(e.center,p),r=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){var n=t.subtract(i,this._occluderPosition,h),o=this._occluderRadius-r;if(o=t.magnitudeSquared(n)-o*o,r<this._occluderRadius)return o>0&&(o=Math.sqrt(o)+this._horizonDistance,n=t.subtract(i,this._cameraPosition,n),o*o+r*r>t.magnitudeSquared(n));if(o>0){n=t.subtract(i,this._cameraPosition,n);var a=t.magnitudeSquared(n),s=this._occluderRadius*this._occluderRadius,l=r*r;return(this._horizonDistance*this._horizonDistance+s)*l>a*s||(o=Math.sqrt(o)+this._horizonDistance)*o+l>a}return!0}return!1};var m=new t;c.prototype.computeVisibility=function(e){var i=t.clone(e.center),r=e.radius;if(r>this._occluderRadius)return u.FULL;if(this._horizonDistance!==Number.MAX_VALUE){var n=t.subtract(i,this._occluderPosition,m),o=this._occluderRadius-r,a=t.magnitudeSquared(n);if((o=a-o*o)>0){o=Math.sqrt(o)+this._horizonDistance,n=t.subtract(i,this._cameraPosition,n);var s=t.magnitudeSquared(n);return o*o+r*r<s?u.NONE:(o=a-(o=this._occluderRadius+r)*o)>0?s<(o=Math.sqrt(o)+this._horizonDistance)*o+r*r?u.FULL:u.PARTIAL:(n=t.subtract(i,this._horizonPlanePosition,n),t.dot(n,this._horizonPlaneNormal)>-r?u.PARTIAL:u.FULL)}}return u.NONE};var f=new t;c.computeOccludeePoint=function(e,i,r){var n=t.clone(i),o=t.clone(e.center),a=e.radius,s=r.length,l=t.normalize(t.subtract(n,o,f),f),u=-t.dot(l,o),d=c._anyRotationVector(o,l,u),h=c._horizonToPlaneNormalDotProduct(e,l,u,d,r[0]);if(h){for(var p,m=1;m<s;++m){if(!(p=c._horizonToPlaneNormalDotProduct(e,l,u,d,r[m])))return;p<h&&(h=p)}if(!(h<.0017453283658983088)){var _=a/h;return t.add(o,t.multiplyByScalar(l,_,f),f)}}};var _=[];c.computeOccludeePointFromRectangle=function(r,n){n=i(n,a.WGS84);var o=l.subsample(r,n,0,_),s=e.fromPoints(o),u=t.ZERO;if(!t.equals(u,s.center))return c.computeOccludeePoint(new e(u,n.minimumRadius),s.center,o)};var g=new t;c._anyRotationVector=function(e,i,r){var n=t.abs(i,g),o=n.x>n.y?0:1;(0===o&&n.z>n.x||1===o&&n.z>n.y)&&(o=2);var a,s=new t;0===o?(n.x=e.x,n.y=e.y+1,n.z=e.z+1,a=t.UNIT_X):1===o?(n.x=e.x+1,n.y=e.y,n.z=e.z+1,a=t.UNIT_Y):(n.x=e.x+1,n.y=e.y+1,n.z=e.z,a=t.UNIT_Z);var l=(t.dot(i,n)+r)/-t.dot(i,a);return t.normalize(t.subtract(t.add(n,t.multiplyByScalar(a,l,s),n),e,n),n)};var v=new t;c._rotationVector=function(e,i,r,n,o){var a=t.subtract(n,e,v);if(a=t.normalize(a,a),t.dot(i,a)<.9999999847691291){var l=t.cross(i,a,a);if(t.magnitude(l)>s.EPSILON13)return t.normalize(l,new t)}return o};var y=new t,x=new t,w=new t,T=new t;return c._horizonToPlaneNormalDotProduct=function(e,i,r,n,o){var a=t.clone(o,y),s=t.clone(e.center,x),l=e.radius,u=t.subtract(s,a,w),c=t.magnitudeSquared(u),d=l*l;if(c<d)return!1;var h=c-d,p=Math.sqrt(h),m=p*(1/Math.sqrt(c))*p;u=t.normalize(u,u);var f=t.add(a,t.multiplyByScalar(u,m,T),T),_=Math.sqrt(h-m*m),g=this._rotationVector(s,i,r,a,n),v=t.fromElements(g.x*g.x*u.x+(g.x*g.y-g.z)*u.y+(g.x*g.z+g.y)*u.z,(g.x*g.y+g.z)*u.x+g.y*g.y*u.y+(g.y*g.z-g.x)*u.z,(g.x*g.z-g.y)*u.x+(g.y*g.z+g.x)*u.y+g.z*g.z*u.z,y);v=t.normalize(v,v);var C=t.multiplyByScalar(v,_,y);g=t.normalize(t.subtract(t.add(f,C,w),s,w),w);var E=t.dot(i,g);g=t.normalize(t.subtract(t.subtract(f,C,g),s,g),g);var A=t.dot(i,g);return E<A?E:A},c}.apply(t,r))||(e.exports=n)},1862:function(e,t,i){var r,n;r=[i(62),i(16),i(22),i(8),i(20),i(11),i(45),i(748),i(123),i(68),i(103),i(55),i(77)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h){"use strict";function p(e){this._context=e}var m,f=new u({primitiveType:a.TRIANGLES}),_=new l({color:new i(0,0,0,0)});return p.prototype.execute=function(t){r(t.preExecute)&&t.preExecute(t);var i=t.outputTexture,n=i.width,o=i.height,a=this._context,l=r(t.vertexArray)?t.vertexArray:a.getViewportQuadVertexArray(),u=r(t.shaderProgram)?t.shaderProgram:function(e,t){return h.fromCache({context:e,vertexShaderSource:s,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}(a,t.fragmentShaderSource),p=function(e,t){return new c({context:e,colorTextures:[t],destroyAttachments:!1})}(a,i),g=function(t,i){return r(m)&&m.viewport.width===t&&m.viewport.height===i||(m=d.fromCache({viewport:new e(0,0,t,i)})),m}(n,o),v=t.uniformMap,y=_;y.framebuffer=p,y.renderState=g,y.execute(a);var x=f;x.vertexArray=l,x.renderState=g,x.shaderProgram=u,x.uniformMap=v,x.framebuffer=p,x.execute(a),p.destroy(),t.persists||(u.destroy(),r(t.vertexArray)&&l.destroy()),r(t.postExecute)&&t.postExecute(i)},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){return n(this)},p}.apply(t,r))||(e.exports=n)},1863:function(e,t,i){var r,n;r=[i(16),i(41),i(22),i(34),i(72),i(9),i(8),i(10),i(20),i(11),i(52),i(53),i(28),i(61),i(45),i(40),i(47),i(748),i(78),i(123),i(83),i(233),i(68),i(251),i(66),i(55),i(1864),i(77),i(63),i(1865),i(1866),i(95)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O,I){"use strict";function M(e,t,i){var r=e.getError();if(r!==e.NO_ERROR)throw new f(function(e,t,i,r){for(var n=function(e,t){var i="WebGL Error:  ";switch(t){case e.INVALID_ENUM:i+="INVALID_ENUM";break;case e.INVALID_VALUE:i+="INVALID_VALUE";break;case e.INVALID_OPERATION:i+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:i+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:i+="CONTEXT_LOST_WEBGL lost";break;default:i+="Unknown ("+t+")"}return i}(e,r)+": "+t.name+"(",o=0;o<i.length;++o)0!==o&&(n+=", "),n+=i[o];return n+=");"}(e,t,i,r))}function N(e,t,i){return{get:function(){var r=e[t];return i(e,"get: "+t,r),e[t]},set:function(r){e[t]=r,i(e,"set: "+t,r)}}}function F(e,t){for(var i=t.length,r=0;r<i;++r){var n=e.getExtension(t[r]);if(n)return n}}function R(e,r){if("undefined"==typeof WebGLRenderingContext)throw new f("The browser does not support WebGL.  Visit http://get.webgl.org.");this._canvas=e,r=t(r,!0),(r=o(r,{})).allowTextureFilterAnisotropic=o(r.allowTextureFilterAnisotropic,!0);var s=o(r.webgl,{});s.alpha=o(s.alpha,!1),s.stencil=o(s.stencil,!0);var l,u=o(r.requestWebgl2,!1)&&"undefined"!=typeof WebGL2RenderingContext,c=!1,d=r.getWebGLStub;if(a(d))l=d(e,s);else if(u&&(l=e.getContext("webgl2",s)||e.getContext("experimental-webgl2",s)||void 0,a(l)&&(c=!0)),a(l)||(l=e.getContext("webgl",s)||e.getContext("experimental-webgl",s)||void 0),!a(l))throw new f("The browser supports WebGL, but initialization failed.");this._originalGLContext=l,this._gl=l,this._webgl2=c,this._id=n(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new S(this),this._textureCache=new D;var h=l;this._stencilBits=h.getParameter(h.STENCIL_BITS),x._maximumCombinedTextureImageUnits=h.getParameter(h.MAX_COMBINED_TEXTURE_IMAGE_UNITS),x._maximumCubeMapSize=h.getParameter(h.MAX_CUBE_MAP_TEXTURE_SIZE),x._maximumFragmentUniformVectors=h.getParameter(h.MAX_FRAGMENT_UNIFORM_VECTORS),x._maximumTextureImageUnits=h.getParameter(h.MAX_TEXTURE_IMAGE_UNITS),x._maximumRenderbufferSize=h.getParameter(h.MAX_RENDERBUFFER_SIZE),x._maximumTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE),x._maximumVaryingVectors=h.getParameter(h.MAX_VARYING_VECTORS),x._maximumVertexAttributes=h.getParameter(h.MAX_VERTEX_ATTRIBS),x._maximumVertexTextureImageUnits=h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x._maximumVertexUniformVectors=h.getParameter(h.MAX_VERTEX_UNIFORM_VECTORS);var p=h.getParameter(h.ALIASED_LINE_WIDTH_RANGE);x._minimumAliasedLineWidth=p[0],x._maximumAliasedLineWidth=p[1];var m=h.getParameter(h.ALIASED_POINT_SIZE_RANGE);x._minimumAliasedPointSize=m[0],x._maximumAliasedPointSize=m[1];var g=h.getParameter(h.MAX_VIEWPORT_DIMS);x._maximumViewportWidth=g[0],x._maximumViewportHeight=g[1];var v=h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_FLOAT);x._highpFloatSupported=0!==v.precision;var y=h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_INT);x._highpIntSupported=0!==y.rangeMax,this._antialias=h.getContextAttributes().antialias,this._standardDerivatives=!!F(h,["OES_standard_derivatives"]),this._blendMinmax=!!F(h,["EXT_blend_minmax"]),this._elementIndexUint=!!F(h,["OES_element_index_uint"]),this._depthTexture=!!F(h,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!F(h,["EXT_frag_depth"]),this._debugShaders=F(h,["WEBGL_debug_shaders"]),this._textureFloat=!!F(h,["OES_texture_float"]),this._textureHalfFloat=!!F(h,["OES_texture_half_float"]),this._textureFloatLinear=!!F(h,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!F(h,["OES_texture_half_float_linear"]),this._colorBufferFloat=!!F(h,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._colorBufferHalfFloat=!!F(h,["EXT_color_buffer_half_float"]),this._s3tc=!!F(h,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!F(h,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._etc1=!!F(h,["WEBGL_compressed_texture_etc1"]);var w,T,E,P,b,I,M,N,R,L,V=r.allowTextureFilterAnisotropic?F(h,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;if(this._textureFilterAnisotropic=V,x._maximumTextureFilterAnisotropy=a(V)?h.getParameter(V.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,c){var U=this;w=function(){return U._gl.createVertexArray()},T=function(e){U._gl.bindVertexArray(e)},E=function(e){U._gl.deleteVertexArray(e)},P=function(e,t,i,r,n){h.drawElementsInstanced(e,t,i,r,n)},b=function(e,t,i,r){h.drawArraysInstanced(e,t,i,r)},I=function(e,t){h.vertexAttribDivisor(e,t)},M=function(e){h.drawBuffers(e)}}else N=F(h,["OES_vertex_array_object"]),a(N)&&(w=function(){return N.createVertexArrayOES()},T=function(e){N.bindVertexArrayOES(e)},E=function(e){N.deleteVertexArrayOES(e)}),R=F(h,["ANGLE_instanced_arrays"]),a(R)&&(P=function(e,t,i,r,n){R.drawElementsInstancedANGLE(e,t,i,r,n)},b=function(e,t,i,r){R.drawArraysInstancedANGLE(e,t,i,r)},I=function(e,t){R.vertexAttribDivisorANGLE(e,t)}),L=F(h,["WEBGL_draw_buffers"]),a(L)&&(M=function(e){L.drawBuffersWEBGL(e)});this.glCreateVertexArray=w,this.glBindVertexArray=T,this.glDeleteVertexArray=E,this.glDrawElementsInstanced=P,this.glDrawArraysInstanced=b,this.glVertexAttribDivisor=I,this.glDrawBuffers=M,this._vertexArrayObject=!!N,this._instancedArrays=!!R,this._drawBuffers=!!L,x._maximumDrawBuffers=this.drawBuffers?h.getParameter(_.MAX_DRAW_BUFFERS):1,x._maximumColorAttachments=this.drawBuffers?h.getParameter(_.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new i(0,0,0,0),this._clearDepth=1,this._clearStencil=0;var z=new O,B=new C(this),H=A.fromCache();this._defaultPassState=B,this._defaultRenderState=H,this._defaultTexture=void 0,this._defaultCubeMap=void 0,this._us=z,this._currentRenderState=H,this._currentPassState=B,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(var k=0;k<x._maximumVertexAttributes;k++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options=r,this.cache={},A.apply(h,H,B)}var L,V={};function U(e,t,i,r){var n=e._currentRenderState,o=e._currentPassState;e._currentRenderState=t,e._currentPassState=i,A.partialApply(e._gl,n,t,o,i,r)}function z(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;var i=L;if(a(t))t._bind(),i=t._getActiveColorAttachments();else{var r=e._gl;r.bindFramebuffer(r.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(i)}}s(R.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},textureCache:{get:function(){return this._textureCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},etc1:{get:function(){return this._etc1}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=function(e,t){if(!a(t))return e;function i(i){return function(){var r=i.apply(e,arguments);return t(e,i,arguments),r}}var r={};for(var n in e){var o=e[n];o instanceof Function?r[n]=i(o):Object.defineProperty(r,n,N(e,n,t))}return r}(this._originalGLContext,e?M:void 0)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new b({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){var e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new w({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return V}}}),"undefined"!=typeof WebGLRenderingContext&&(L=[_.BACK]);var B=new y;R.prototype.clear=function(e,t){e=o(e,B),t=o(t,this._defaultPassState);var r=this._gl,n=0,s=e.color,l=e.depth,u=e.stencil;a(s)&&(i.equals(this._clearColor,s)||(i.clone(s,this._clearColor),r.clearColor(s.red,s.green,s.blue,s.alpha)),n|=r.COLOR_BUFFER_BIT),a(l)&&(l!==this._clearDepth&&(this._clearDepth=l,r.clearDepth(l)),n|=r.DEPTH_BUFFER_BIT),a(u)&&(u!==this._clearStencil&&(this._clearStencil=u,r.clearStencil(u)),n|=r.STENCIL_BUFFER_BIT),U(this,o(e.renderState,this._defaultRenderState),t,!0),z(this,o(e.framebuffer,t.framebuffer)),r.clear(n)},R.prototype.draw=function(e,t,i,r){t=o(t,this._defaultPassState);var n=o(e._framebuffer,t.framebuffer),s=o(e._renderState,this._defaultRenderState);i=o(i,e._shaderProgram),r=o(r,e._uniformMap),function(e,t,i,r,n){z(e,t),U(e,n,i,!1),r._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,r.maximumTextureUnitIndex)}(this,n,t,i,s),function(e,t,i,r){var n=t._primitiveType,s=t._vertexArray,l=t._offset,u=t._count,c=t.instanceCount;e._us.model=o(t._modelMatrix,h.IDENTITY),i._setUniforms(r,e._us,e.validateShaderProgram),s._bind();var d=s.indexBuffer;a(d)?(l*=d.bytesPerIndex,u=o(u,d.numberOfIndices),0===c?e._gl.drawElements(n,u,d.indexDatatype,l):e.glDrawElementsInstanced(n,u,d.indexDatatype,l,c)):(u=o(u,s.numberOfVertices),0===c?e._gl.drawArrays(n,l,u):e.glDrawArraysInstanced(n,l,u,c)),s._unBind()}(this,e,i,r)},R.prototype.endFrame=function(){var e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null);var t=L;this.drawBuffers&&this.glDrawBuffers(t);var i=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(var r=0;r<i;++r)e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},R.prototype.readPixels=function(e){var t=this._gl;e=o(e,o.EMPTY_OBJECT);var i=Math.max(o(e.x,0),0),r=Math.max(o(e.y,0),0),n=o(e.width,t.drawingBufferWidth),s=o(e.height,t.drawingBufferHeight),l=e.framebuffer,u=E.UNSIGNED_BYTE;a(l)&&l.numberOfColorAttachments>0&&(u=l.getColorTexture(0).pixelDatatype);var c=p.createTypedArray(p.RGBA,u,n,s);return z(this,l),t.readPixels(i,r,n,s,p.RGBA,u,c),c};var H={position:0,textureCoordinates:1};function k(e,t,i){this._pickObjects=e,this.key=t,this.color=i}return R.prototype.getViewportQuadVertexArray=function(){var e=this.cache.viewportQuad_vertexArray;if(!a(e)){var t=new c({attributes:{position:new d({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new d({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:m.TRIANGLES});e=I.fromGeometry({context:this,geometry:t,attributeLocations:H,bufferUsage:v.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e},R.prototype.createViewportQuadCommand=function(e,t){return t=o(t,o.EMPTY_OBJECT),new T({vertexArray:this.getViewportQuadVertexArray(),primitiveType:m.TRIANGLES,renderState:t.renderState,shaderProgram:P.fromCache({context:this,vertexShaderSource:g,fragmentShaderSource:e,attributeLocations:H}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})},R.prototype.getObjectByPickColor=function(e){return this._pickObjects[e.toRgba()]},s(k.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}}),k.prototype.destroy=function(){delete this._pickObjects[this.key]},R.prototype.createPickId=function(e){++this._nextPickColor[0];var t=this._nextPickColor[0];if(0===t)throw new f("Out of unique Pick IDs.");return this._pickObjects[t]=e,new k(this._pickObjects,t,i.fromRgba(t))},R.prototype.isDestroyed=function(){return!1},R.prototype.destroy=function(){var e=this.cache;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];a(i.destroy)&&i.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._textureCache=this._textureCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),l(this)},R}.apply(t,r))||(e.exports=n)},1864:function(e,t,i){var r,n;r=[i(8),i(10),i(20),i(77),i(56)],void 0===(n=function(e,t,i,r,n){"use strict";function o(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}function a(e,t){for(var i=t.derivedKeywords,r=i.length,n=0;n<r;++n){var o=i[n]+t.keyword;a(e,e._shaders[o])}delete e._shaders[t.keyword],t.shaderProgram.finalDestroy()}return t(o.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),o.prototype.replaceShaderProgram=function(t){return e(t.shaderProgram)&&t.shaderProgram.destroy(),this.getShaderProgram(t)},o.prototype.getShaderProgram=function(t){var i=t.vertexShaderSource,o=t.fragmentShaderSource,a=t.attributeLocations;"string"==typeof i&&(i=new n({sources:[i]})),"string"==typeof o&&(o=new n({sources:[o]}));var s,l=i.createCombinedVertexShader(this._context),u=o.createCombinedFragmentShader(this._context),c=l+u+JSON.stringify(a);if(e(this._shaders[c]))s=this._shaders[c],delete this._shadersToRelease[c];else{var d=this._context,h=new r({gl:d._gl,logShaderCompilation:d.logShaderCompilation,debugShaders:d.debugShaders,vertexShaderSource:i,vertexShaderText:l,fragmentShaderSource:o,fragmentShaderText:u,attributeLocations:a});s={cache:this,shaderProgram:h,keyword:c,derivedKeywords:[],count:0},h._cachedShader=s,this._shaders[c]=s,++this._numberOfShaders}return++s.count,s.shaderProgram},o.prototype.replaceDerivedShaderProgram=function(t,i,r){var n=t._cachedShader,o=i+n.keyword,s=this._shaders[o];if(e(s)){a(this,s);var l=n.derivedKeywords.indexOf(i);l>-1&&n.derivedKeywords.splice(l,1)}return this.createDerivedShaderProgram(t,i,r)},o.prototype.getDerivedShaderProgram=function(t,i){var r=i+t._cachedShader.keyword,n=this._shaders[r];if(e(n))return n.shaderProgram},o.prototype.createDerivedShaderProgram=function(e,t,i){var o=e._cachedShader,a=t+o.keyword,s=i.vertexShaderSource,l=i.fragmentShaderSource,u=i.attributeLocations;"string"==typeof s&&(s=new n({sources:[s]})),"string"==typeof l&&(l=new n({sources:[l]}));var c=this._context,d=s.createCombinedVertexShader(c),h=l.createCombinedFragmentShader(c),p=new r({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:s,vertexShaderText:d,fragmentShaderSource:l,fragmentShaderText:h,attributeLocations:u}),m={cache:this,shaderProgram:p,keyword:a,derivedKeywords:[],count:0};return o.derivedKeywords.push(t),p._cachedShader=m,this._shaders[a]=m,p},o.prototype.destroyReleasedShaderPrograms=function(){var e=this._shadersToRelease;for(var t in e){if(e.hasOwnProperty(t))a(this,e[t]),--this._numberOfShaders}this._shadersToRelease={}},o.prototype.releaseShaderProgram=function(t){if(e(t)){var i=t._cachedShader;i&&0==--i.count&&(this._shadersToRelease[i.keyword]=i)}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){var e=this._shaders;for(var t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return i(this)},o}.apply(t,r))||(e.exports=n)},1865:function(e,t,i){var r,n;r=[i(8),i(10),i(20)],void 0===(n=function(e,t,i){"use strict";function r(){this._textures={},this._numberOfTextures=0,this._texturesToRelease={}}return t(r.prototype,{numberOfTextures:{get:function(){return this._numberOfTextures}}}),r.prototype.getTexture=function(t){var i=this._textures[t];if(e(i))return delete this._texturesToRelease[t],++i.count,i.texture},r.prototype.addTexture=function(e,t){var i={texture:t,count:1};t.finalDestroy=t.destroy;var r=this;t.destroy=function(){0==--i.count&&(r._texturesToRelease[e]=i)},this._textures[e]=i,++this._numberOfTextures},r.prototype.destroyReleasedTextures=function(){var e=this._texturesToRelease;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];delete this._textures[t],i.texture.finalDestroy(),--this._numberOfTextures}this._texturesToRelease={}},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){var e=this._textures;for(var t in e)e.hasOwnProperty(t)&&e[t].texture.finalDestroy();return i(this)},r}.apply(t,r))||(e.exports=n)},1866:function(e,t,i){var r,n;r=[i(62),i(24),i(12),i(49),i(32),i(22),i(9),i(8),i(10),i(187),i(14),i(43),i(28),i(115),i(747),i(60),i(44),i(88)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g){"use strict";function v(){this.globeDepthTexture=void 0,this.gamma=void 0,this._viewport=new e,this._viewportCartesian4=new r,this._viewportDirty=!1,this._viewportOrthographicMatrix=h.clone(h.IDENTITY),this._viewportTransformation=h.clone(h.IDENTITY),this._model=h.clone(h.IDENTITY),this._view=h.clone(h.IDENTITY),this._inverseView=h.clone(h.IDENTITY),this._projection=h.clone(h.IDENTITY),this._infiniteProjection=h.clone(h.IDENTITY),this._entireFrustum=new t,this._currentFrustum=new t,this._frustumPlanes=new r,this._log2FarDistance=void 0,this._log2FarPlusOne=void 0,this._log2NearDistance=void 0,this._frameState=void 0,this._temeToPseudoFixed=d.clone(h.IDENTITY),this._view3DDirty=!0,this._view3D=new h,this._inverseView3DDirty=!0,this._inverseView3D=new h,this._inverseModelDirty=!0,this._inverseModel=new h,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new d,this._viewRotation=new d,this._inverseViewRotation=new d,this._viewRotation3D=new d,this._inverseViewRotation3D=new d,this._inverseProjectionDirty=!0,this._inverseProjection=new h,this._modelViewDirty=!0,this._modelView=new h,this._modelView3DDirty=!0,this._modelView3D=new h,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new h,this._inverseModelViewDirty=!0,this._inverseModelView=new h,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new h,this._viewProjectionDirty=!0,this._viewProjection=new h,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new h,this._modelViewProjectionDirty=!0,this._modelViewProjection=new h,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new h,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new h,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new h,this._normalDirty=!0,this._normal=new d,this._normal3DDirty=!0,this._normal3D=new d,this._inverseNormalDirty=!0,this._inverseNormal=new d,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new d,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new u,this._cameraPosition=new i,this._sunPositionWC=new i,this._sunPositionColumbusView=new i,this._sunDirectionWC=new i,this._sunDirectionEC=new i,this._sunColor=new i,this._moonDirectionEC=new i,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._cameraDirection=new i,this._cameraRight=new i,this._cameraUp=new i,this._frustum2DWidth=0,this._eyeHeight2D=new t,this._resolutionScale=1,this._orthographicIn3D=!1,this._backgroundColor=new o,this._brdfLut=void 0,this._environmentMap=void 0,this._sphericalHarmonicCoefficients=void 0,this._specularEnvironmentMaps=void 0,this._specularEnvironmentMapsDimensions=new t,this._specularEnvironmentMapsMaximumLOD=void 0,this._fogDensity=void 0,this._invertClassificationColor=void 0,this._imagerySplitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}l(v.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(t){if(!e.equals(t,this._viewport)){e.clone(t,this._viewport);var i=this._viewport,r=this._viewportCartesian4;r.x=i.x,r.y=i.y,r.z=i.width,r.w=i.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return T(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return T(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){h.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,h.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){var e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,h.getRotation(this.inverseModel,e),d.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return M(this),this._view3D}},viewRotation:{get:function(){return M(this),this._viewRotation}},viewRotation3D:{get:function(){return M(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return N(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return N(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){var e;return(e=this)._inverseProjectionDirty&&(e._inverseProjectionDirty=!1,e._mode===_.SCENE2D||e._mode===_.MORPHING||e._orthographicIn3D?h.clone(h.ZERO,e._inverseProjection):h.inverse(e._projection,e._inverseProjection)),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){var e;return(e=this)._modelViewDirty&&(e._modelViewDirty=!1,h.multiplyTransformation(e._view,e._model,e._modelView)),this._modelView}},modelView3D:{get:function(){var e;return(e=this)._modelView3DDirty&&(e._modelView3DDirty=!1,h.multiplyTransformation(e.view3D,e._model,e._modelView3D)),this._modelView3D}},modelViewRelativeToEye:{get:function(){return function(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;var t=e.modelView,i=e._modelViewRelativeToEye;i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=0,i[13]=0,i[14]=0,i[15]=t[15]}}(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){var e;return(e=this)._inverseModelViewDirty&&(e._inverseModelViewDirty=!1,h.inverse(e.modelView,e._inverseModelView)),this._inverseModelView}},inverseModelView3D:{get:function(){var e;return(e=this)._inverseModelView3DDirty&&(e._inverseModelView3DDirty=!1,h.inverse(e.modelView3D,e._inverseModelView3D)),this._inverseModelView3D}},viewProjection:{get:function(){var e;return(e=this)._viewProjectionDirty&&(e._viewProjectionDirty=!1,h.multiply(e._projection,e._view,e._viewProjection)),this._viewProjection}},inverseViewProjection:{get:function(){var e;return(e=this)._inverseViewProjectionDirty&&(e._inverseViewProjectionDirty=!1,h.inverse(e.viewProjection,e._inverseViewProjection)),this._inverseViewProjection}},modelViewProjection:{get:function(){var e;return(e=this)._modelViewProjectionDirty&&(e._modelViewProjectionDirty=!1,h.multiply(e._projection,e.modelView,e._modelViewProjection)),this._modelViewProjection}},inverseModelViewProjection:{get:function(){var e;return(e=this)._inverseModelViewProjectionDirty&&(e._inverseModelViewProjectionDirty=!1,h.inverse(e.modelViewProjection,e._inverseModelViewProjection)),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){var e;return(e=this)._modelViewProjectionRelativeToEyeDirty&&(e._modelViewProjectionRelativeToEyeDirty=!1,h.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye)),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){var e;return(e=this)._modelViewInfiniteProjectionDirty&&(e._modelViewInfiniteProjectionDirty=!1,h.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection)),this._modelViewInfiniteProjection}},normal:{get:function(){return function(e){if(e._normalDirty){e._normalDirty=!1;var t=e._normal;h.getRotation(e.inverseModelView,t),d.transpose(t,t)}}(this),this._normal}},normal3D:{get:function(){return function(e){if(e._normal3DDirty){e._normal3DDirty=!1;var t=e._normal3D;h.getRotation(e.inverseModelView3D,t),d.transpose(t,t)}}(this),this._normal3D}},inverseNormal:{get:function(){var e;return(e=this)._inverseNormalDirty&&(e._inverseNormalDirty=!1,h.getRotation(e.inverseModelView,e._inverseNormal)),this._inverseNormal}},inverseNormal3D:{get:function(){var e;return(e=this)._inverseNormal3DDirty&&(e._inverseNormal3DDirty=!1,h.getRotation(e.inverseModelView3D,e._inverseNormal3D)),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},log2FarDistance:{get:function(){return this._log2FarDistance}},log2FarPlusOne:{get:function(){return this._log2FarPlusOne}},log2NearDistance:{get:function(){return this._log2NearDistance}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},sunColor:{get:function(){return this._sunColor}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},encodedCameraPositionMCHigh:{get:function(){return E(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return E(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},resolutionScale:{get:function(){return this._resolutionScale}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps}},specularEnvironmentMapsDimensions:{get:function(){return this._specularEnvironmentMapsDimensions}},specularEnvironmentMapsMaximumLOD:{get:function(){return this._specularEnvironmentMapsMaximumLOD}},imagerySplitPosition:{get:function(){return this._imagerySplitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}}});var y=new d,x=new n;v.prototype.updateCamera=function(e){var t,r;t=this,r=e.viewMatrix,h.clone(r,t._view),h.getRotation(r,t._viewRotation),t._view3DDirty=!0,t._inverseView3DDirty=!0,t._modelViewDirty=!0,t._modelView3DDirty=!0,t._modelViewRelativeToEyeDirty=!0,t._inverseModelViewDirty=!0,t._inverseModelView3DDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,t._modelViewInfiniteProjectionDirty=!0,t._normalDirty=!0,t._inverseNormalDirty=!0,t._normal3DDirty=!0,t._inverseNormal3DDirty=!0,function(e,t){h.clone(t,e._inverseView),h.getRotation(t,e._inverseViewRotation)}(this,e.inverseViewMatrix),function(e,t){i.clone(t.positionWC,e._cameraPosition),i.clone(t.directionWC,e._cameraDirection),i.clone(t.rightWC,e._cameraRight),i.clone(t.upWC,e._cameraUp),e._encodedCameraPositionMCDirty=!0}(this,e),this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this.updateFrustum(e.frustum),this._orthographicIn3D=this._mode!==_.SCENE2D&&e.frustum instanceof p},v.prototype.updateFrustum=function(e){var t,i;t=this,i=e.projectionMatrix,h.clone(i,t._projection),t._inverseProjectionDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,s(e.infiniteProjectionMatrix)&&function(e,t){h.clone(t,e._infiniteProjection),e._modelViewInfiniteProjectionDirty=!0}(this,e.infiniteProjectionMatrix),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,this._log2FarDistance=2/c.log2(e.far+1),this._log2FarPlusOne=c.log2(e.far+1),this._log2NearDistance=c.log2(e.near),s(e._offCenterFrustum)&&(e=e._offCenterFrustum),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right},v.prototype.updatePass=function(e){this._pass=e};var w=[];function T(e){if(e._viewportDirty){var t=e._viewport;h.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),h.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}v.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection;var r=e.context._canvas;this._resolutionScale=r.width/r.clientWidth;var n=e.camera;this.updateCamera(n),e.mode===_.SCENE2D?(this._frustum2DWidth=n.frustum.right-n.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),function(e,t){s(f.computeIcrfToFixedMatrix(t.time,y))||(y=f.computeTemeToPseudoFixedMatrix(t.time,y));var r=m.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);d.multiplyByVector(y,r,r),i.normalize(r,e._sunDirectionWC),r=d.multiplyByVector(e.viewRotation3D,r,e._sunDirectionEC),i.normalize(r,r),r=m.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),d.multiplyByVector(y,r,r),d.multiplyByVector(e.viewRotation3D,r,r),i.normalize(r,r);var n=t.mapProjection,o=n.ellipsoid.cartesianToCartographic(e._sunPositionWC,x);n.project(o,e._sunPositionColumbusView)}(this,e),this._sunColor=i.clone(e.sunColor,this._sunColor);var l=e.brdfLutGenerator,u=s(l)?l.colorTexture:void 0;this._brdfLut=u,this._environmentMap=a(e.environmentMap,e.context.defaultCubeMap),this._sphericalHarmonicCoefficients=a(e.sphericalHarmonicCoefficients,w),this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapsMaximumLOD=e.specularEnvironmentMapsMaximumLOD,s(this._specularEnvironmentMaps)&&t.clone(this._specularEnvironmentMaps.dimensions,this._specularEnvironmentMapsDimensions),this._fogDensity=e.fog.density,this._invertClassificationColor=e.invertClassificationColor,this._frameState=e,this._temeToPseudoFixed=f.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed),this._imagerySplitPosition=e.imagerySplitPosition*e.context.drawingBufferWidth;var c,h=n.frustum.fov,p=this._viewport;c=p.height>p.width?2*Math.tan(.5*h)/p.height:2*Math.tan(.5*h)/p.width,this._geometricToleranceOverMeter=c*e.maximumScreenSpaceError,o.clone(e.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};var C=new i;function E(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,h.multiplyByPoint(e.inverseModel,e._cameraPosition,C),u.fromCartesian(C,e._encodedCameraPositionMC))}var A=new i,S=new i,P=new i,b=new i,D=new n,O=new i,I=new h;function M(e){e._view3DDirty&&(e._mode===_.SCENE3D?h.clone(e._view,e._view3D):function(e,t,r,n,o,a,l,u){var d=A;d.x=e.y,d.y=e.z,d.z=e.x;var p=S;p.x=r.y,p.y=r.z,p.z=r.x;var m=P;m.x=n.y,m.y=n.z,m.z=n.x;var g=b;g.x=t.y,g.y=t.z,g.z=t.x,a===_.SCENE2D&&(d.z=.5*o);var v=l.unproject(d,D);v.longitude=c.clamp(v.longitude,-Math.PI,Math.PI),v.latitude=c.clamp(v.latitude,-c.PI_OVER_TWO,c.PI_OVER_TWO);var y=l.ellipsoid,x=y.cartographicToCartesian(v,O),w=f.eastNorthUpToFixedFrame(x,y,I);h.multiplyByPointAsVector(w,p,p),h.multiplyByPointAsVector(w,m,m),h.multiplyByPointAsVector(w,g,g),s(u)||(u=new h),u[0]=p.x,u[1]=m.x,u[2]=-g.x,u[3]=0,u[4]=p.y,u[5]=m.y,u[6]=-g.y,u[7]=0,u[8]=p.z,u[9]=m.z,u[10]=-g.z,u[11]=0,u[12]=-i.dot(p,x),u[13]=-i.dot(m,x),u[14]=i.dot(g,x),u[15]=1}(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),h.getRotation(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function N(e){e._inverseView3DDirty&&(h.inverseTransformation(e.view3D,e._inverseView3D),h.getRotation(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}return v}.apply(t,r))||(e.exports=n)},1867:function(e,t,i){var r,n;r=[i(62),i(8),i(10),i(20),i(61),i(103),i(66),i(55),i(88),i(63),i(96),i(89),i(114),i(1868)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p){"use strict";function m(){this._framebuffer=void 0,this._colorTexture=void 0,this._drawCommand=void 0}return i(m.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),m.prototype.update=function(i){if(!t(this._colorTexture)){var r=i.context;!function(e,t){var i=new u({context:t,width:256,height:256,pixelFormat:n.RGBA,pixelDatatype:a.UNSIGNED_BYTE,sampler:new l({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:d.NEAREST,magnificationFilter:c.NEAREST})});e._colorTexture=i;var r=new o({context:t,colorTextures:[i],destroyAttachments:!1});e._framebuffer=r}(this,r),function(t,i){var r=t._framebuffer,n=i.createViewportQuadCommand(p,{framebuffer:r,renderState:s.fromCache({viewport:new e(0,0,256,256)})});t._drawCommand=n}(this,r),this._drawCommand.execute(r),this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),r(this)},m}.apply(t,r))||(e.exports=n)},1868:function(e,t,i){var r;void 0===(r=function(){"use strict";return"varying vec2 v_textureCoordinates;\nconst float M_PI = 3.141592653589793;\n\nfloat vdcRadicalInverse(int i)\n{\n    float r;\n    float base = 2.0;\n    float value = 0.0;\n    float invBase = 1.0 / base;\n    float invBi = invBase;\n    for (int x = 0; x < 100; x++)\n    {\n        if (i <= 0)\n        {\n            break;\n        }\n        r = mod(float(i), base);\n        value += r * invBi;\n        invBi *= invBase;\n        i = int(float(i) * invBase);\n    }\n    return value;\n}\n\nvec2 hammersley2D(int i, int N)\n{\n    return vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\n\nvec3 importanceSampleGGX(vec2 xi, float roughness, vec3 N)\n{\n    float a = roughness * roughness;\n    float phi = 2.0 * M_PI * xi.x;\n    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (a * a - 1.0) * xi.y));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n    return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\nfloat G1_Smith(float NdotV, float k)\n{\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\nfloat G_Smith(float roughness, float NdotV, float NdotL)\n{\n    float k = roughness * roughness / 2.0;\n    return G1_Smith(NdotV, k) * G1_Smith(NdotL, k);\n}\n\nvec2 integrateBrdf(float roughness, float NdotV)\n{\n    vec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);\n    float A = 0.0;\n    float B = 0.0;\n    const int NumSamples = 1024;\n    for (int i = 0; i < NumSamples; i++)\n    {\n        vec2 xi = hammersley2D(i, NumSamples);\n        vec3 H = importanceSampleGGX(xi, roughness, vec3(0.0, 0.0, 1.0));\n        vec3 L = 2.0 * dot(V, H) * H - V;\n        float NdotL = clamp(L.z, 0.0, 1.0);\n        float NdotH = clamp(H.z, 0.0, 1.0);\n        float VdotH = clamp(dot(V, H), 0.0, 1.0);\n        if (NdotL > 0.0)\n        {\n            float G = G_Smith(roughness, NdotV, NdotL);\n            float G_Vis = G * VdotH / (NdotH * NdotV);\n            float Fc = pow(1.0 - VdotH, 5.0);\n            A += (1.0 - Fc) * G_Vis;\n            B += Fc * G_Vis;\n        }\n    }\n    return vec2(A, B) / float(NumSamples);\n}\n\nvoid main()\n{\n    gl_FragColor = vec4(integrateBrdf(1.0 - v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1869:function(e,t,i){var r,n;r=[i(33),i(12),i(16),i(34),i(9),i(8),i(750),i(52),i(53),i(65),i(115),i(193),i(45),i(54)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p){"use strict";var m=0,f=1;function _(e){var i,r,o=e.frustum,a=e.orientation,s=e.origin,l=n(e._drawNearPlane,!0);o instanceof d?(i=m,r=d.packedLength):o instanceof c&&(i=f,r=c.packedLength),this._frustumType=i,this._frustum=o.clone(),this._origin=t.clone(s),this._orientation=p.clone(a),this._drawNearPlane=l,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+r+t.packedLength+p.packedLength}_.pack=function(e,i,r){r=n(r,0);var o=e._frustumType,a=e._frustum;return i[r++]=o,o===m?(d.pack(a,i,r),r+=d.packedLength):(c.pack(a,i,r),r+=c.packedLength),t.pack(e._origin,i,r),r+=t.packedLength,p.pack(e._orientation,i,r),i[r+=p.packedLength]=e._drawNearPlane?1:0,i};var g=new d,v=new c,y=new p,x=new t;return _.unpack=function(e,i,r){i=n(i,0);var a,s=e[i++];s===m?(a=d.unpack(e,i,g),i+=d.packedLength):(a=c.unpack(e,i,v),i+=c.packedLength);var l=t.unpack(e,i,x);i+=t.packedLength;var u=p.unpack(e,i,y),h=1===e[i+=p.packedLength];if(!o(r))return new _({frustum:a,origin:l,orientation:u,_drawNearPlane:h});var f=s===r._frustumType?r._frustum:void 0;return r._frustum=a.clone(f),r._frustumType=s,r._origin=t.clone(l,r._origin),r._orientation=p.clone(u,r._orientation),r._drawNearPlane=h,r},_.createGeometry=function(t){var i=t._frustumType,n=t._frustum,o=t._origin,c=t._orientation,d=t._drawNearPlane,p=new Float64Array(24);a._computeNearFarPlanes(o,c,i,n,p);for(var m,f,_=new u({position:new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:p})}),g=d?2:1,v=new Uint16Array(8*(g+1)),y=d?0:1;y<2;++y)f=4*y,v[m=d?8*y:0]=f,v[m+1]=f+1,v[m+2]=f+1,v[m+3]=f+2,v[m+4]=f+2,v[m+5]=f+3,v[m+6]=f+3,v[m+7]=f;for(y=0;y<2;++y)f=4*y,v[m=8*(g+y)]=f,v[m+1]=f+4,v[m+2]=f+1,v[m+3]=f+5,v[m+4]=f+2,v[m+5]=f+6,v[m+6]=f+3,v[m+7]=f+7;return new s({attributes:_,indices:v,primitiveType:h.LINES,boundingSphere:e.fromVertices(p)})},_}.apply(t,r))||(e.exports=n)},1870:function(e,t,i){var r,n;r=[i(33),i(12),i(34),i(8),i(48),i(52),i(53),i(45),i(78),i(68),i(69),i(55),i(77),i(56),i(95),i(1871),i(1872),i(44)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g){"use strict";function v(){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0,this._useLogDepth=!1}var y=n.supportsTypedArrays()?new Float32Array(12):[],x=new t,w=new t,T=new t,C=new t;return v.prototype.update=function(n){if(this._mode=n.mode,n.mode===g.SCENE3D){var v=n.context,E=n.mapProjection.ellipsoid,A=n.useLogDepth;if(r(this._command)||(this._rs=d.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._command=new u({renderState:this._rs,boundingVolume:new e(t.ZERO,E.maximumRadius),pass:c.OPAQUE,owner:this})),!r(this._sp)||this._useLogDepth!==A){this._useLogDepth=A;var S=new p({sources:[_]}),P=new p({sources:[f]});if(A){P.sources.push("#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"),P.defines.push("LOG_DEPTH"),S.defines.push("LOG_DEPTH"),S.defines.push("DISABLE_GL_POSITION_LOG_DEPTH")}this._sp=h.replaceCache({shaderProgram:this._sp,context:v,vertexShaderSource:S,fragmentShaderSource:P,attributeLocations:{position:0}}),this._command.shaderProgram=this._sp}var b=function(e,i){var r=e.radii,n=i.camera.positionWC,o=t.multiplyComponents(e.oneOverRadii,n,x),a=t.magnitude(o),s=t.normalize(o,w),l=t.normalize(t.cross(t.UNIT_Z,o,T),T),u=t.normalize(t.cross(s,l,C),C),c=Math.sqrt(t.magnitudeSquared(o)-1),d=t.multiplyByScalar(s,1/a,x),h=c/a,p=t.multiplyByScalar(l,h,w),m=t.multiplyByScalar(u,h,T),f=t.add(d,m,C);t.subtract(f,p,f),t.multiplyComponents(r,f,f),t.pack(f,y,0);var _=t.subtract(d,m,C);t.subtract(_,p,_),t.multiplyComponents(r,_,_),t.pack(_,y,3);var g=t.add(d,m,C);t.add(g,p,g),t.multiplyComponents(r,g,g),t.pack(g,y,6);var v=t.subtract(d,m,C);return t.add(v,p,v),t.multiplyComponents(r,v,v),t.pack(v,y,9),y}(E,n);if(r(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(b);else{var D=new o({attributes:{position:new a({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:b})},indices:[0,1,2,2,1,3],primitiveType:s.TRIANGLES});this._va=m.fromGeometry({context:v,geometry:D,attributeLocations:{position:0},bufferUsage:l.DYNAMIC_DRAW}),this._command.vertexArray=this._va}}},v.prototype.execute=function(e,t){this._mode===g.SCENE3D&&this._command.execute(e,t)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()},v}.apply(t,r))||(e.exports=n)},1871:function(e,t,i){var r;void 0===(r=function(){"use strict";return"varying vec4 positionEC;\n\nvoid main()\n{\n    vec3 direction = normalize(positionEC.xyz);\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n    if (!czm_isEmpty(intersection))\n    {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n    }\n    else\n    {\n        discard;\n    }\n\n    czm_writeLogDepth();\n}\n"}.call(t,i,t,e))||(e.exports=r)},1872:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec4 position;\n\nvarying vec4 positionEC;\n\nvoid main()\n{\n    positionEC = czm_modelView * position;\n    gl_Position = czm_projection * positionEC;\n\n    czm_vertexLogDepth();\n}\n"}.call(t,i,t,e))||(e.exports=r)},1873:function(e,t,i){var r,n;r=[i(9),i(8),i(68),i(55),i(56)],void 0===(n=function(e,t,i,r,n){"use strict";function o(){}var a=/\bgl_FragDepthEXT\b/,s=/\bdiscard\b/;o.createDepthOnlyDerivedCommand=function(e,o,l,u){var c,d;return t(u)||(u={}),t(u.depthOnlyCommand)&&(c=u.depthOnlyCommand.shaderProgram,d=u.depthOnlyCommand.renderState),u.depthOnlyCommand=i.shallowClone(o,u.depthOnlyCommand),t(c)&&u.shaderProgramId===o.shaderProgram.id?(u.depthOnlyCommand.shaderProgram=c,u.depthOnlyCommand.renderState=d):(u.depthOnlyCommand.shaderProgram=function(e,i){var r=e.shaderCache.getDerivedShaderProgram(i,"depthOnly");if(!t(r)){var o,l=i._attributeLocations,u=i.fragmentShaderSource,c=!1,d=u.sources,h=d.length;for(o=0;o<h;++o)if(a.test(d[o])||s.test(d[o])){c=!0;break}var p=!1,m=u.defines;for(h=m.length,o=0;o<h;++o)if("LOG_DEPTH"===m[o]){p=!0;break}c||p?!c&&p&&(u=new n({defines:["LOG_DEPTH"],sources:["#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\nvoid main() \n{ \n    gl_FragColor = vec4(1.0); \n    czm_writeLogDepth(); \n} \n"]})):u=new n({sources:["void main() \n{ \n    gl_FragColor = vec4(1.0); \n} \n"]}),r=e.shaderCache.createDerivedShaderProgram(i,"depthOnly",{vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:u,attributeLocations:l})}return r}(l,o.shaderProgram),u.depthOnlyCommand.renderState=function(e,i){var n=e._depthOnlyRenderStateCache,o=n[i.id];if(!t(o)){var a=r.getState(i);a.depthMask=!0,a.colorMask={red:!1,green:!1,blue:!1,alpha:!1},o=r.fromCache(a),n[i.id]=o}return o}(e,o.renderState),u.shaderProgramId=o.shaderProgram.id),u};var l=/\s+czm_writeLogDepth\(/,u=/\s+czm_vertexLogDepth\(/,c=/\s*#extension\s+GL_EXT_frag_depth\s*:\s*enable/;return o.createLogDepthCommand=function(e,r,o){var a;return t(o)||(o={}),t(o.command)&&(a=o.command.shaderProgram),o.command=i.shallowClone(e,o.command),t(a)&&o.shaderProgramId===e.shaderProgram.id?o.command.shaderProgram=a:(o.command.shaderProgram=function(e,i){var r=e.shaderCache.getDerivedShaderProgram(i,"logDepth");if(!t(r)){var o,a=i._attributeLocations,s=i.vertexShaderSource.clone(),d=i.fragmentShaderSource.clone();s.defines=t(s.defines)?s.defines.slice(0):[],s.defines.push("LOG_DEPTH"),d.defines=t(d.defines)?d.defines.slice(0):[],d.defines.push("LOG_DEPTH");var h=!1,p=s.sources,m=p.length;for(o=0;o<m;++o)if(u.test(p[o])){h=!0;break}if(!h){for(o=0;o<m;++o)p[o]=n.replaceMain(p[o],"czm_log_depth_main");p.push("\n\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_vertexLogDepth(); \n} \n")}var f=!0;for(h=!1,m=(p=d.sources).length,o=0;o<m;++o)l.test(p[o])&&(h=!0),c.test(p[o])&&(f=!1);var _="";if(f&&(_+="#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"),!h){for(o=0;o<m;o++)p[o]=n.replaceMain(p[o],"czm_log_depth_main");_+="\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_writeLogDepth(); \n} \n"}p.push(_),r=e.shaderCache.createDerivedShaderProgram(i,"logDepth",{vertexShaderSource:s,fragmentShaderSource:d,attributeLocations:a})}return r}(r,e.shaderProgram),o.shaderProgramId=e.shaderProgram.id),o},o.createPickDerivedCommand=function(e,o,a,s){var l,u;return t(s)||(s={}),t(s.pickCommand)&&(l=s.pickCommand.shaderProgram,u=s.pickCommand.renderState),s.pickCommand=i.shallowClone(o,s.pickCommand),t(l)&&s.shaderProgramId===o.shaderProgram.id?(s.pickCommand.shaderProgram=l,s.pickCommand.renderState=u):(s.pickCommand.shaderProgram=function(e,i,r){var o=e.shaderCache.getDerivedShaderProgram(i,"pick");if(!t(o)){for(var a=i._attributeLocations,s=i.fragmentShaderSource,l=s.sources,u=l.length,c="void main() \n{ \n    czm_non_pick_main(); \n    if (gl_FragColor.a == 0.0) { \n        discard; \n    } \n    gl_FragColor = "+r+"; \n} \n",d=new Array(u+1),h=0;h<u;++h)d[h]=n.replaceMain(l[h],"czm_non_pick_main");d[u]=c,s=new n({sources:d,defines:s.defines}),o=e.shaderCache.createDerivedShaderProgram(i,"pick",{vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:s,attributeLocations:a})}return o}(a,o.shaderProgram,o.pickId),s.pickCommand.renderState=function(e,i){var n=e._pickRenderStateCache,o=n[i.id];if(!t(o)){var a=r.getState(i);a.blending.enabled=!1,a.depthMask=!0,o=r.fromCache(a),n[i.id]=o}return o}(e,o.renderState),s.shaderProgramId=o.shaderProgram.id),s},o.createHdrCommand=function(e,r,n){var o;return t(n)||(n={}),t(n.command)&&(o=n.command.shaderProgram),n.command=i.shallowClone(e,n.command),t(o)&&n.shaderProgramId===e.shaderProgram.id?n.command.shaderProgram=o:(n.command.shaderProgram=function(e,i){var r=e.shaderCache.getDerivedShaderProgram(i,"HDR");if(!t(r)){var n=i._attributeLocations,o=i.vertexShaderSource.clone(),a=i.fragmentShaderSource.clone();o.defines=t(o.defines)?o.defines.slice(0):[],o.defines.push("HDR"),a.defines=t(a.defines)?a.defines.slice(0):[],a.defines.push("HDR"),r=e.shaderCache.createDerivedShaderProgram(i,"HDR",{vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:n})}return r}(r,e.shaderProgram),n.shaderProgramId=e.shaderProgram.id),n},o}.apply(t,r))||(e.exports=n)},1874:function(e,t,i){var r,n;r=[i(8),i(20),i(11),i(14),i(43),i(54)],void 0===(n=function(e,t,i,r,n,o){"use strict";function a(t){this._scene=t,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;var i=this;function n(t){var n=t.alpha;if(!e(n))return i._alpha=void 0,i._beta=void 0,void(i._gamma=void 0);i._alpha=r.toRadians(n),i._beta=r.toRadians(t.beta),i._gamma=r.toRadians(t.gamma)}window.addEventListener("deviceorientation",n,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",n,!1)}}var s=new o,l=new o,u=new n;return a.prototype.update=function(){if(e(this._alpha)){e(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma);var t=this._lastAlpha-this._alpha,i=this._lastBeta-this._beta,r=this._lastGamma-this._gamma;!function(e,t,i,r){var a=e.direction,c=e.right,d=e.up,h=o.fromAxisAngle(a,i,l),p=o.fromAxisAngle(c,r,s),m=o.multiply(p,h,p),f=o.fromAxisAngle(d,t,l);o.multiply(f,m,m);var _=n.fromQuaternion(m,u);n.multiplyByVector(_,c,c),n.multiplyByVector(_,d,d),n.multiplyByVector(_,a,a)}(this._scene.camera,-t,i,r),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma}},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this._removeListener(),t(this)},a}.apply(t,r))||(e.exports=n)},1875:function(e,t,i){var r,n;r=[i(12),i(8),i(14),i(44)],void 0===(n=function(e,t,i,r){"use strict";function n(){this.enabled=!0,this.density=2e-4,this.screenSpaceErrorFactor=2,this.minimumBrightness=.03}for(var o=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874],a=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7],s=0;s<a.length;++s)a[s]*=1e6;for(var l=a[1],u=a[a.length-1],c=0;c<a.length;++c)a[c]=(a[c]-u)/(l-u);var d=0;var h=new e;return n.prototype.update=function(n){if(n.fog.enabled=this.enabled){var s=n.camera,c=s.positionCartographic;if(!t(c)||c.height>8e5||n.mode!==r.SCENE3D)n.fog.enabled=!1;else{var p=c.height,m=function(e){var t,i=o,r=i.length;if(e<i[0])return d=0;if(e>i[r-1])return d=r-2;if(e>=i[d]){if(d+1<r&&e<i[d+1])return d;if(d+2<r&&e<i[d+2])return++d}else if(d-1>=0&&e>=i[d-1])return--d;for(t=0;t<r-2&&!(e>=i[t]&&e<i[t+1]);++t);return d=t}(p),f=i.clamp((p-o[m])/(o[m+1]-o[m]),0,1),_=i.lerp(a[m],a[m+1],f),g=1e6*this.density;_=_*(g-g/l*u)*1e-6;var v=e.normalize(s.positionWC,h);_*=1-Math.abs(e.dot(s.directionWC,v)),n.fog.density=_,n.fog.sse=this.screenSpaceErrorFactor,n.fog.minimumBrightness=this.minimumBrightness}}},n}.apply(t,r))||(e.exports=n)},1876:function(e,t,i){var r,n;r=[i(44)],void 0===(n=function(e){"use strict";return function(t,i,r){this.context=t,this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this.specularEnvironmentMapsMaximumLOD=void 0,this.mode=e.SCENE3D,this.morphTime=e.getMorphTime(e.SCENE3D),this.frameNumber=0,this.newFrame=!1,this.time=void 0,this.jobScheduler=r,this.mapProjection=void 0,this.camera=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.pixelRatio=1,this.passes={render:!1,pick:!1,depth:!1,postProcess:!1,offscreen:!1},this.creditDisplay=i,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0,minimumBrightness:void 0},this.terrainExaggeration=1,this.shadowState={shadowsEnabled:!0,lightShadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.imagerySplitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.sunColor=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.useLogDepth=!1,this.tilesetPassState=void 0}}.apply(t,r))||(e.exports=n)},1877:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D u_depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1878:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D u_depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_depthTexture, v_textureCoordinates).r);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1879:function(e,t,i){var r,n;r=[i(22),i(8),i(10),i(20),i(61),i(123),i(103),i(66),i(55),i(88),i(56),i(63),i(96),i(89),i(114),i(363),i(87),i(156),i(207),i(208)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y){"use strict";function x(){this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._texture=void 0,this._classifiedTexture=void 0,this._depthStencilTexture=void 0,this._fbo=void 0,this._fboClassified=void 0,this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new o({color:new e(0,0,0,0),owner:this}),this._clearCommand=new o({color:new e(0,0,0,0),depth:1,stencil:0});var t=this;this._uniformMap={colorTexture:function(){return t._texture},depthTexture:function(){return t._depthStencilTexture},classifiedTexture:function(){return t._classifiedTexture}}}i(x.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}}),x.isTranslucencySupported=function(e){return e.depthTexture&&e.fragmentDepth};var w={depthMask:!1,stencilTest:{enabled:!0,frontFunction:v.EQUAL,frontOperation:{fail:y.KEEP,zFail:y.KEEP,zPass:y.KEEP},backFunction:v.NEVER,reference:0,mask:g.CLASSIFICATION_MASK},blending:_.ALPHA_BLEND},T={depthMask:!1,stencilTest:{enabled:!0,frontFunction:v.NOT_EQUAL,frontOperation:{fail:y.KEEP,zFail:y.KEEP,zPass:y.KEEP},backFunction:v.NEVER,reference:0,mask:g.CLASSIFICATION_MASK},blending:_.ALPHA_BLEND},C={depthMask:!0,depthTest:{enabled:!0},stencilTest:g.setCesium3DTileBit(),stencilMask:g.CESIUM_3D_TILE_MASK,blending:_.ALPHA_BLEND};return x.prototype.update=function(e){var i=this._texture,r=!t(i)||this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;var o,_,g=e.drawingBufferWidth,v=e.drawingBufferHeight,y=!t(i)||i.width!==g||i.height!==v;((y||r)&&(this._texture=this._texture&&this._texture.destroy(),this._classifiedTexture=this._classifiedTexture&&this._classifiedTexture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._texture=new d({context:e,width:g,height:v,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new u({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.LINEAR,magnificationFilter:h.LINEAR})}),t(this._previousFramebuffer)||(this._classifiedTexture=new d({context:e,width:g,height:v,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new u({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.LINEAR,magnificationFilter:h.LINEAR})}),this._depthStencilTexture=new d({context:e,width:g,height:v,pixelFormat:n.DEPTH_STENCIL,pixelDatatype:s.UNSIGNED_INT_24_8}))),!t(this._fbo)||y||r)&&(this._fbo=this._fbo&&this._fbo.destroy(),this._fboClassified=this._fboClassified&&this._fboClassified.destroy(),t(this._previousFramebuffer)?(o=this._previousFramebuffer.depthStencilTexture,_=this._previousFramebuffer.depthStencilRenderbuffer):o=this._depthStencilTexture,this._fbo=new a({context:e,colorTextures:[this._texture],depthStencilTexture:o,depthStencilRenderbuffer:_,destroyAttachments:!1}),t(this._previousFramebuffer)||(this._fboClassified=new a({context:e,colorTextures:[this._classifiedTexture],depthStencilTexture:o,destroyAttachments:!1})));if(t(this._rsUnclassified)||(this._rsUnclassified=l.fromCache(w),this._rsClassified=l.fromCache(T),this._rsDefault=l.fromCache(C)),!t(this._unclassifiedCommand)||r){t(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());var x=t(this._previousFramebuffer)?"uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n#ifdef UNCLASSIFIED\n    gl_FragColor = color * czm_invertClassificationColor;\n#else\n    gl_FragColor = color;\n#endif\n}\n":"#extension GL_EXT_frag_depth : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform sampler2D classifiedTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n    bool isClassified = all(equal(texture2D(classifiedTexture, v_textureCoordinates), vec4(0.0)));\n#ifdef UNCLASSIFIED\n    vec4 highlightColor = czm_invertClassificationColor;\n    if (isClassified)\n    {\n        discard;\n    }\n#else\n    vec4 highlightColor = vec4(1.0);\n    if (!isClassified)\n    {\n        discard;\n    }\n#endif\n    gl_FragColor = color * highlightColor;\n    gl_FragDepthEXT = texture2D(depthTexture, v_textureCoordinates).r;\n}\n",E=new c({defines:["UNCLASSIFIED"],sources:[x]}),A=new c({sources:[x]});this._unclassifiedCommand=e.createViewportQuadCommand(E,{renderState:t(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=e.createViewportQuadCommand(A,{renderState:t(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),t(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),t(this._previousFramebuffer)||(this._translucentCommand=e.createViewportQuadCommand(f,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}},x.prototype.clear=function(e,i){var r=i.framebuffer;t(this._previousFramebuffer)?(i.framebuffer=this._fbo,this._clearColorCommand.execute(e,i)):(i.framebuffer=this._fbo,this._clearCommand.execute(e,i),i.framebuffer=this._fboClassified,this._clearCommand.execute(e,i)),i.framebuffer=r},x.prototype.executeClassified=function(e,i){if(!t(this._previousFramebuffer)){var r=i.framebuffer;i.framebuffer=this._fboClassified,this._translucentCommand.execute(e,i),i.framebuffer=r}this._classifiedCommand.execute(e,i)},x.prototype.executeUnclassified=function(e,t){this._unclassifiedCommand.execute(e,t)},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){return this._fbo=this._fbo&&this._fbo.destroy(),this._texture=this._texture&&this._texture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),t(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),r(this)},x}.apply(t,r))||(e.exports=n)},1880:function(e,t,i){var r,n;r=[i(8),i(10),i(11),i(111),i(629)],void 0===(n=function(e,t,i,r,n){"use strict";function o(e){this._total=e,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}function a(t){var i=new Array(n.NUMBER_OF_JOB_TYPES);i[n.TEXTURE]=new o(e(t)?t[n.TEXTURE]:10),i[n.PROGRAM]=new o(e(t)?t[n.PROGRAM]:10),i[n.BUFFER]=new o(e(t)?t[n.BUFFER]:30);var r,a=i.length,s=0;for(r=0;r<a;++r)s+=i[r].total;var l=new Array(a);for(r=0;r<a;++r)l[r]=!1;this._totalBudget=s,this._totalUsedThisFrame=0,this._budgets=i,this._executedThisFrame=l}return t(o.prototype,{total:{get:function(){return this._total}}}),a.getTimestamp=r,t(a.prototype,{totalBudget:{get:function(){return this._totalBudget}}}),a.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget},a.prototype.resetBudgets=function(){for(var e=this._budgets,t=e.length,i=0;i<t;++i){var r=e[i];r.starvedLastFrame=r.starvedThisFrame,r.starvedThisFrame=!1,r.usedThisFrame=0,r.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0},a.prototype.execute=function(e,t){var i,r=this._budgets,n=r[t],o=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&o)return n.starvedThisFrame=!0,!1;if(n.usedThisFrame+n.stolenFromMeThisFrame>=n.total){var s,l=r.length;for(s=0;s<l&&(!((i=r[s]).usedThisFrame+i.stolenFromMeThisFrame<i.total)||i.starvedLastFrame);++s);if(s===l&&o)return!1;o&&(n.starvedThisFrame=!0)}var u=a.getTimestamp();e.execute();var c=a.getTimestamp()-u;return this._totalUsedThisFrame+=c,i?i.stolenFromMeThisFrame+=c:n.usedThisFrame+=c,this._executedThisFrame[t]=!0,!0},a}.apply(t,r))||(e.exports=n)},1881:function(e,t,i){var r,n;r=[i(9),i(8),i(10),i(20),i(11),i(111),i(348)],void 0===(n=function(e,t,i,r,n,o,a){"use strict";function s(t){t=e(t,e.EMPTY_OBJECT);var i=a(t.container);this._container=i;var r=document.createElement("div");r.className="cesium-performanceDisplay";var n=document.createElement("div");n.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),n.appendChild(this._fpsText);var s=document.createElement("div");s.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),s.appendChild(this._msText),r.appendChild(s),r.appendChild(n),this._container.appendChild(r),this._lastFpsSampleTime=o(),this._lastMsSampleTime=o(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;var l=document.createElement("div");l.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),l.appendChild(this._throttledText),r.appendChild(l)}return i(s.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(this._throttledText.nodeValue=e?"(throttled)":"",this._throttled=e)}}}),s.prototype.update=function(t){var i=o(),r=e(t,!0);this._fpsFrameCount++;var n=i-this._lastFpsSampleTime;if(n>1e3){var a="N/A";r&&(a=1e3*this._fpsFrameCount/n|0),this._fpsText.nodeValue=a+" FPS",this._lastFpsSampleTime=i,this._fpsFrameCount=0}this._msFrameCount++;var s=i-this._lastMsSampleTime;if(s>200){var l="N/A";r&&(l=(s/this._msFrameCount).toFixed(2)),this._msText.nodeValue=l+" MS",this._lastMsSampleTime=i,this._msFrameCount=0}},s.prototype.destroy=function(){return r(this)},s}.apply(t,r))||(e.exports=n)},1882:function(e,t,i){var r,n;r=[i(49),i(8),i(20),i(61),i(103),i(66),i(55),i(56),i(63)],void 0===(n=function(e,t,i,r,n,o,a,s,l){"use strict";function u(){this._framebuffer=void 0,this._depthTexture=void 0,this._textureToCopy=void 0,this._copyDepthCommand=void 0,this._useLogDepth=void 0,this._debugPickDepthViewportCommand=void 0}function c(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function d(e){e._framebuffer=e._framebuffer&&!e._framebuffer.isDestroyed()&&e._framebuffer.destroy()}function h(e,t,i,a){c(e),d(e),function(e,t,i,n){e._depthTexture=new l({context:t,width:i,height:n,pixelFormat:r.RGBA,pixelDatatype:o.UNSIGNED_BYTE})}(e,t,i,a),e._framebuffer=new n({context:t,colorTextures:[e._depthTexture],destroyAttachments:!1})}u.prototype.executeDebugPickDepth=function(e,i,r){!function(e,i,r,n){if(!t(e._debugPickDepthViewportCommand)||n!==e._useLogDepth){var o=new s({defines:[n?"LOG_DEPTH":""],sources:["uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"]});e._debugPickDepthViewportCommand=i.createViewportQuadCommand(o,{uniformMap:{u_texture:function(){return e._depthTexture}},owner:e}),e._useLogDepth=n}e._debugPickDepthViewportCommand.execute(i,r)}(this,e,i,r)},u.prototype.update=function(e,i){!function(e,i,r){var n=r.width,o=r.height,a=e._depthTexture,s=!t(a)||a.width!==n||a.height!==o;t(e._framebuffer)&&!s||h(e,i,n,o)}(this,e,i),function(e,i,r){t(e._copyDepthCommand)||(e._copyDepthCommand=i.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n",{renderState:a.fromCache(),uniformMap:{u_texture:function(){return e._textureToCopy}},owner:e}));e._textureToCopy=r,e._copyDepthCommand.framebuffer=e._framebuffer}(this,e,i)};var p=new e,m=new e(1,1/255,1/65025,1/16581375);return u.prototype.getDepth=function(t,i,r){var n=t.readPixels({x:i,y:r,width:1,height:1,framebuffer:this._framebuffer}),o=e.unpack(n,0,p);return e.divideByScalar(o,255,o),e.dot(o,m)},u.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return c(this),d(this),this._copyDepthCommand.shaderProgram=t(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy(),i(this)},u}.apply(t,r))||(e.exports=n)},1883:function(e,t,i){var r,n;r=[i(191),i(16),i(9),i(8),i(10),i(20),i(11),i(61),i(66),i(88),i(63),i(96),i(89),i(114),i(363),i(1884),i(755),i(1906)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g){"use strict";var v=[];function y(){var e=f.createFXAAStage(),t=f.createAmbientOcclusionStage(),i=f.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=f.createAutoExposureStage(),this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=g.ACES;var n=this._tonemapping;e.enabled=!1,t.enabled=!1,i.enabled=!1,n.enabled=!1;var o=new _(this),a={},s=v;for(s.push(e,t,i,n);s.length>0;){var l=s.pop();a[l.name]=l,l._textureCache=o;var u=l.length;if(r(u))for(var c=0;c<u;++c)s.push(l.get(c))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;var d=this;t.uniforms.randomTexture=function(){return d._randomTexture},this._ao=t,this._bloom=i,this._fxaa=e,this._lastLength=void 0,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=a,this._textureCache=o}function x(e){if(e._stagesRemoved){e._stagesRemoved=!1;for(var t=[],i=e._stages,r=i.length,n=0,o=0;n<r;++n){var a=i[n];a&&(a._index=o++,t.push(a))}e._stages=t}}function w(e){for(;r(e.length);)e=e.get(e.length-1);return e.outputTexture}function T(e,t,i,n,o){if(r(e.execute))e.execute(t,i,n,o);else{var a,s=e.length;if(e.inputPreviousStageTexture)for(T(e.get(0),t,i,n,o),a=1;a<s;++a)T(e.get(a),t,w(e.get(a-1)),n,o);else for(a=0;a<s;++a)T(e.get(a),t,i,n,o)}}return n(y.prototype,{ready:{get:function(){for(var e=!1,t=this._stages,i=t.length-1;i>=0;--i){var r=t[i];e=e||r.ready&&r.enabled}var n=this._fxaa,o=this._ao,a=this._bloom,s=this._tonemapping;return e=(e=(e=(e=e||n.ready&&n.enabled)||o.ready&&o.enabled)||a.ready&&a.enabled)||s.ready&&s.enabled}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return x(this),this._stages.length}},outputTexture:{get:function(){var e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);for(var t=this._stages,i=t.length-1;i>=0;--i){var n=t[i];if(r(n)&&n.ready&&n.enabled)return this.getOutputTexture(n.name)}var o=this._tonemapping;if(o.enabled&&o.ready)return this.getOutputTexture(o.name);var a=this._bloom;if(a.enabled&&a.ready)return this.getOutputTexture(a.name);var s=this._ao;return s.enabled&&s.ready?this.getOutputTexture(s.name):void 0}},hasSelected:{get:function(){for(var t=e(this._stages);t.length>0;){var i=t.pop();if(r(i)){if(r(i.selected))return!0;var n=i.length;if(r(n))for(var o=0;o<n;++o)t.push(i.get(o))}}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(e){if(this._tonemapper!==e){r(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());var t,i=this._autoExposureEnabled;switch(e){case g.REINHARD:t=f.createReinhardTonemappingStage(i);break;case g.MODIFIED_REINHARD:t=f.createModifiedReinhardTonemappingStage(i);break;case g.FILMIC:t=f.createFilmicTonemappingStage(i);break;default:t=f.createAcesTonemappingStage(i)}if(i){var n=this._autoExposure;t.uniforms.autoExposure=function(){return n.outputTexture}}this._tonemapper=e,this._tonemapping=t,r(this._stageNames)&&(this._stageNames[t.name]=t,t._textureCache=this._textureCache),this._textureCacheDirty=!0}}}}),y.prototype.add=function(e){var t=this._stageNames,i=v;for(i.push(e);i.length>0;){var n=i.pop();t[n.name]=n,n._textureCache=this._textureCache;var o=n.length;if(r(o))for(var a=0;a<o;++a)i.push(n.get(a))}var s=this._stages;return e._index=s.length,s.push(e),this._textureCacheDirty=!0,e},y.prototype.remove=function(e){if(!this.contains(e))return!1;var t=this._stageNames,i=v;for(i.push(e);i.length>0;){var n=i.pop();delete t[n.name];var o=n.length;if(r(o))for(var a=0;a<o;++a)i.push(n.get(a))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0},y.prototype.contains=function(e){return r(e)&&r(e._index)&&e._textureCache===this._textureCache},y.prototype.get=function(e){return x(this),this._stages[e]},y.prototype.removeAll=function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)this.remove(e[i]);e.length=0},y.prototype.getStageByName=function(e){return this._stageNames[e]},y.prototype.update=function(e,t,i){x(this);var n=this._activeStages,o=this._activeStages=this._previousActiveStages;this._previousActiveStages=n;var a,m,f=this._stages,_=o.length=f.length,g=0;for(a=0;a<_;++a)(m=f[a]).ready&&m.enabled&&m._isSupported(e)&&(o[g++]=m);o.length=g;var v=g!==n.length;if(!v)for(a=0;a<g;++a)if(o[a]!==n[a]){v=!0;break}var y=this._ao,w=this._bloom,T=this._autoExposure,C=this._tonemapping,E=this._fxaa;C.enabled=i;var A=y.enabled&&y._isSupported(e),S=w.enabled&&w._isSupported(e),P=C.enabled&&C._isSupported(e),b=E.enabled&&E._isSupported(e);if((v||this._textureCacheDirty||g!==this._lastLength||A!==this._aoEnabled||S!==this._bloomEnabled||P!==this._tonemappingEnabled||b!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._lastLength=g,this._aoEnabled=A,this._bloomEnabled=S,this._tonemappingEnabled=P,this._fxaaEnabled=b,this._textureCacheDirty=!1),r(this._randomTexture)&&!A&&(this._randomTexture.destroy(),this._randomTexture=void 0),!r(this._randomTexture)&&A){_=196608;var D=new Uint8Array(_);for(a=0;a<_;a+=3)D[a]=Math.floor(255*Math.random());this._randomTexture=new c({context:e,pixelFormat:s.RGB,pixelDatatype:l.UNSIGNED_BYTE,source:{arrayBufferView:D,width:256,height:256},sampler:new u({wrapS:p.REPEAT,wrapT:p.REPEAT,minificationFilter:h.NEAREST,magnificationFilter:d.NEAREST})})}for(this._textureCache.update(e),E.update(e,t),y.update(e,t),w.update(e,t),C.update(e,t),this._autoExposureEnabled&&T.update(e,t),_=f.length,a=0;a<_;++a)f[a].update(e,t)},y.prototype.clear=function(e){this._textureCache.clear(e),this._autoExposureEnabled&&this._autoExposure.clear(e)},y.prototype.getOutputTexture=function(e){var t=this.getStageByName(e);if(r(t))return w(t)},y.prototype.execute=function(e,t,i,r){var n=this._activeStages,o=n.length,a=this._fxaa,s=this._ao,l=this._bloom,u=this._autoExposure,c=this._tonemapping,d=s.enabled&&s._isSupported(e),h=l.enabled&&l._isSupported(e),p=this._autoExposureEnabled,m=c.enabled&&c._isSupported(e),f=a.enabled&&a._isSupported(e);if(f||d||h||m||0!==o){var _=t;d&&s.ready&&(T(s,e,_,i,r),_=w(s)),h&&l.ready&&(T(l,e,_,i,r),_=w(l)),p&&u.ready&&T(u,e,_,i,r),m&&c.ready&&(T(c,e,_,i,r),_=w(c));var g=_;if(o>0){T(n[0],e,_,i,r);for(var v=1;v<o;++v)T(n[v],e,w(n[v-1]),i,r);g=w(n[o-1])}f&&a.ready&&T(a,e,g,i,r)}},y.prototype.copy=function(e,t){if(!r(this._copyColorCommand)){var i=this;this._copyColorCommand=e.createViewportQuadCommand(m,{uniformMap:{colorTexture:function(){return i.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},y.prototype.isDestroyed=function(){return!1},y.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),o(this)},y}.apply(t,r))||(e.exports=n)},1884:function(e,t,i){var r,n;r=[i(110),i(72),i(22),i(8),i(10),i(160),i(20),i(26),i(1885),i(1886),i(1887),i(1888),i(1889),i(1890),i(1891),i(1892),i(1893),i(1894),i(1895),i(1896),i(752),i(1897),i(1898),i(1899),i(1900),i(1901),i(1902),i(1903),i(753),i(754),i(499)],void 0===(n=function(e,t,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O,I){"use strict";var M={};function N(e){var t="#define USE_STEP_SIZE\n"+w,i=new D({name:e+"_x_direction",fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:0},sampleMode:I.LINEAR}),r=new D({name:e+"_y_direction",fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:1},sampleMode:I.LINEAR}),n={};return o(n,{delta:{get:function(){return i.uniforms.delta},set:function(e){var t=i.uniforms,n=r.uniforms;t.delta=n.delta=e}},sigma:{get:function(){return i.uniforms.sigma},set:function(e){var t=i.uniforms,n=r.uniforms;t.sigma=n.sigma=e}},stepSize:{get:function(){return i.uniforms.stepSize},set:function(e){var t=i.uniforms,n=r.uniforms;t.stepSize=n.stepSize=e}}}),new O({name:e,stages:[i,r],uniforms:n})}M.createBlurStage=function(){return N("czm_blur")},M.createDepthOfFieldStage=function(){var e=N("czm_depth_of_field_blur"),t=new D({name:"czm_depth_of_field_composite",fragmentShader:_,uniforms:{focalDistance:5,blurTexture:e.name}}),i={};return o(i,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(e){t.uniforms.focalDistance=e}},delta:{get:function(){return e.uniforms.delta},set:function(t){e.uniforms.delta=t}},sigma:{get:function(){return e.uniforms.sigma},set:function(t){e.uniforms.sigma=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}}}),new O({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:i})},M.isDepthOfFieldSupported=function(e){return e.context.depthTexture},M.createEdgeDetectionStage=function(){var e=t();return new D({name:"czm_edge_detection_"+e,fragmentShader:v,uniforms:{length:.25,color:r.clone(r.BLACK)}})},M.isEdgeDetectionSupported=function(e){return e.context.depthTexture},M.createSilhouetteStage=function(e){var t=function(e){if(!n(e))return M.createEdgeDetectionStage();for(var t=new O({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),i={},r="",o="",a=0;a<e.length;++a)r+="uniform sampler2D edgeTexture"+a+"; \n",o+="        vec4 edge"+a+" = texture2D(edgeTexture"+a+", v_textureCoordinates); \n        if (edge"+a+".a > 0.0) \n        { \n            color = edge"+a+"; \n            break; \n        } \n",i["edgeTexture"+a]=e[a].name;var s=r+"varying vec2 v_textureCoordinates; \nvoid main() { \n    vec4 color = vec4(0.0); \n    for (int i = 0; i < "+e.length+"; i++) \n    { \n"+o+"    } \n    gl_FragColor = color; \n} \n",l=new D({name:"czm_edge_detection_combine",fragmentShader:s,uniforms:i});return new O({name:"czm_edge_detection_composite",stages:[t,l]})}(e),i=new D({name:"czm_silhouette_color_edges",fragmentShader:S,uniforms:{silhouetteTexture:t.name}});return new O({name:"czm_silhouette",stages:[t,i],inputPreviousStageTexture:!1,uniforms:t.uniforms})},M.isSilhouetteSupported=function(e){return e.context.depthTexture},M.createBloomStage=function(){var e=new D({name:"czm_bloom_contrast_bias",fragmentShader:f,uniforms:{contrast:128,brightness:-.3}}),t=N("czm_bloom_blur"),i=new O({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),r=new D({name:"czm_bloom_generate_composite",fragmentShader:p,uniforms:{glowOnly:!1,bloomTexture:i.name}}),n={};return o(n,{glowOnly:{get:function(){return r.uniforms.glowOnly},set:function(e){r.uniforms.glowOnly=e}},contrast:{get:function(){return e.uniforms.contrast},set:function(t){e.uniforms.contrast=t}},brightness:{get:function(){return e.uniforms.brightness},set:function(t){e.uniforms.brightness=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}}}),new O({name:"czm_bloom",stages:[i,r],inputPreviousStageTexture:!1,uniforms:n})},M.createAmbientOcclusionStage=function(){var e=new D({name:"czm_ambient_occlusion_generate",fragmentShader:c,uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),t=N("czm_ambient_occlusion_blur");t.uniforms.stepSize=.86;var i=new O({name:"czm_ambient_occlusion_generate_blur",stages:[e,t]}),r=new D({name:"czm_ambient_occlusion_composite",fragmentShader:d,uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:i.name}}),n={};return o(n,{intensity:{get:function(){return e.uniforms.intensity},set:function(t){e.uniforms.intensity=t}},bias:{get:function(){return e.uniforms.bias},set:function(t){e.uniforms.bias=t}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(t){e.uniforms.lengthCap=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}},frustumLength:{get:function(){return e.uniforms.frustumLength},set:function(t){e.uniforms.frustumLength=t}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(t){e.uniforms.randomTexture=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},blurStepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}},ambientOcclusionOnly:{get:function(){return r.uniforms.ambientOcclusionOnly},set:function(e){r.uniforms.ambientOcclusionOnly=e}}}),new O({name:"czm_ambient_occlusion",stages:[i,r],inputPreviousStageTexture:!1,uniforms:n})},M.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};var F="#define FXAA_QUALITY_PRESET 39 \n"+P+"\n"+x;return M.createFXAAStage=function(){return new D({name:"czm_FXAA",fragmentShader:F,sampleMode:I.LINEAR})},M.createAcesTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new D({name:"czm_aces",fragmentShader:t+=u,uniforms:{autoExposure:void 0}})},M.createFilmicTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new D({name:"czm_filmic",fragmentShader:t+=y,uniforms:{autoExposure:void 0}})},M.createReinhardTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new D({name:"czm_reinhard",fragmentShader:t+=A,uniforms:{autoExposure:void 0}})},M.createModifiedReinhardTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new D({name:"czm_modified_reinhard",fragmentShader:t+=C,uniforms:{white:r.WHITE,autoExposure:void 0}})},M.createAutoExposureStage=function(){return new b},M.createBlackAndWhiteStage=function(){return new D({name:"czm_black_and_white",fragmentShader:h,uniforms:{gradations:5}})},M.createBrightnessStage=function(){return new D({name:"czm_brightness",fragmentShader:m,uniforms:{brightness:.5}})},M.createNightVisionStage=function(){return new D({name:"czm_night_vision",fragmentShader:E})},M.createDepthViewStage=function(){return new D({name:"czm_depth_view",fragmentShader:g})},M.createLensFlareStage=function(){return new D({name:"czm_lens_flare",fragmentShader:T,uniforms:{dirtTexture:i(1904),starTexture:i(1905),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,earthRadius:l.WGS84.maximumRadius}})},M}.apply(t,r))||(e.exports=n)},1885:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\n\nvarying vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\nvoid main()\n{\n    vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n\n#ifdef AUTO_EXPOSURE\n    color /= texture2D(autoExposure, vec2(0.5)).r;\n#endif\n    color = czm_acesTonemapping(color);\n    color = czm_inverseGamma(color);\n\n    gl_FragColor = vec4(color, fragmentColor.a);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1886:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D randomTexture;\nuniform sampler2D depthTexture;\nuniform float intensity;\nuniform float bias;\nuniform float lengthCap;\nuniform float stepSize;\nuniform float frustumLength;\n\nvarying vec2 v_textureCoordinates;\n\nvec4 clipToEye(vec2 uv, float depth)\n{\n    vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\n    vec4 posEC = czm_inverseProjection * vec4(xy, depth, 1.0);\n    posEC = posEC / posEC.w;\n    return posEC;\n}\n\n//Reconstruct Normal Without Edge Removation\nvec3 getNormalXEdge(vec3 posInCamera, float depthU, float depthD, float depthL, float depthR, vec2 pixelSize)\n{\n    vec4 posInCameraUp = clipToEye(v_textureCoordinates - vec2(0.0, pixelSize.y), depthU);\n    vec4 posInCameraDown = clipToEye(v_textureCoordinates + vec2(0.0, pixelSize.y), depthD);\n    vec4 posInCameraLeft = clipToEye(v_textureCoordinates - vec2(pixelSize.x, 0.0), depthL);\n    vec4 posInCameraRight = clipToEye(v_textureCoordinates + vec2(pixelSize.x, 0.0), depthR);\n\n    vec3 up = posInCamera.xyz - posInCameraUp.xyz;\n    vec3 down = posInCameraDown.xyz - posInCamera.xyz;\n    vec3 left = posInCamera.xyz - posInCameraLeft.xyz;\n    vec3 right = posInCameraRight.xyz - posInCamera.xyz;\n\n    vec3 DX = length(left) < length(right) ? left : right;\n    vec3 DY = length(up) < length(down) ? up : down;\n\n    return normalize(cross(DY, DX));\n}\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 posInCamera = clipToEye(v_textureCoordinates, depth);\n\n    if (posInCamera.z > frustumLength)\n    {\n        gl_FragColor = vec4(1.0);\n        return;\n    }\n\n    vec2 pixelSize = 1.0 / czm_viewport.zw;\n    float depthU = czm_readDepth(depthTexture, v_textureCoordinates- vec2(0.0, pixelSize.y));\n    float depthD = czm_readDepth(depthTexture, v_textureCoordinates+ vec2(0.0, pixelSize.y));\n    float depthL = czm_readDepth(depthTexture, v_textureCoordinates- vec2(pixelSize.x, 0.0));\n    float depthR = czm_readDepth(depthTexture, v_textureCoordinates+ vec2(pixelSize.x, 0.0));\n    vec3 normalInCamera = getNormalXEdge(posInCamera.xyz, depthU, depthD, depthL, depthR, pixelSize);\n\n    float ao = 0.0;\n    vec2 sampleDirection = vec2(1.0, 0.0);\n    float gapAngle = 90.0 * czm_radiansPerDegree;\n\n    // RandomNoise\n    float randomVal = texture2D(randomTexture, v_textureCoordinates).x;\n\n    float inverseViewportWidth = 1.0 / czm_viewport.z;\n    float inverseViewportHeight = 1.0 / czm_viewport.w;\n\n    //Loop for each direction\n    for (int i = 0; i < 4; i++)\n    {\n        float newGapAngle = gapAngle * (float(i) + randomVal);\n        float cosVal = cos(newGapAngle);\n        float sinVal = sin(newGapAngle);\n\n        //Rotate Sampling Direction\n        vec2 rotatedSampleDirection = vec2(cosVal * sampleDirection.x - sinVal * sampleDirection.y, sinVal * sampleDirection.x + cosVal * sampleDirection.y);\n        float localAO = 0.0;\n        float localStepSize = stepSize;\n\n        //Loop for each step\n        for (int j = 0; j < 6; j++)\n        {\n            vec2 directionWithStep = vec2(rotatedSampleDirection.x * localStepSize * inverseViewportWidth, rotatedSampleDirection.y * localStepSize * inverseViewportHeight);\n            vec2 newCoords = directionWithStep + v_textureCoordinates;\n\n            //Exception Handling\n            if(newCoords.x > 1.0 || newCoords.y > 1.0 || newCoords.x < 0.0 || newCoords.y < 0.0)\n            {\n                break;\n            }\n\n            float stepDepthInfo = czm_readDepth(depthTexture, newCoords);\n            vec4 stepPosInCamera = clipToEye(newCoords, stepDepthInfo);\n            vec3 diffVec = stepPosInCamera.xyz - posInCamera.xyz;\n            float len = length(diffVec);\n\n            if (len > lengthCap)\n            {\n                break;\n            }\n\n            float dotVal = clamp(dot(normalInCamera, normalize(diffVec)), 0.0, 1.0 );\n            float weight = len / lengthCap;\n            weight = 1.0 - weight * weight;\n\n            if (dotVal < bias)\n            {\n                dotVal = 0.0;\n            }\n\n            localAO = max(localAO, dotVal * weight);\n            localStepSize += stepSize;\n        }\n        ao += localAO;\n    }\n\n    ao /= 4.0;\n    ao = 1.0 - clamp(ao, 0.0, 1.0);\n    ao = pow(ao, intensity);\n    gl_FragColor = vec4(vec3(ao), 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1887:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D ambientOcclusionTexture;\nuniform bool ambientOcclusionOnly;\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 color = texture2D(colorTexture, v_textureCoordinates).rgb;\n    vec3 ao = texture2D(ambientOcclusionTexture, v_textureCoordinates).rgb;\n    gl_FragColor.rgb = ambientOcclusionOnly ? ao : ao * color;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1888:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform float gradations;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\n#ifdef CZM_SELECTED_FEATURE\n    if (czm_selected()) {\n        gl_FragColor = vec4(rgb, 1.0);\n        return;\n    }\n#endif\n    float luminance = czm_luminance(rgb);\n    float darkness = luminance * gradations;\n    darkness = (darkness - fract(darkness)) / gradations;\n    gl_FragColor = vec4(vec3(darkness), 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1889:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D bloomTexture;\nuniform bool glowOnly;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n\n#ifdef CZM_SELECTED_FEATURE\n    if (czm_selected()) {\n        gl_FragColor = color;\n        return;\n    }\n#endif\n\n    vec4 bloom = texture2D(bloomTexture, v_textureCoordinates);\n    gl_FragColor = glowOnly ? bloom : bloom + color;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1890:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform float brightness;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\n    vec3 target = vec3(0.0);\n    gl_FragColor = vec4(mix(target, rgb, brightness), 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1891:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform float contrast;\nuniform float brightness;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 sceneColor = texture2D(colorTexture, v_textureCoordinates).xyz;\n    sceneColor = czm_RGBToHSB(sceneColor);\n    sceneColor.z += brightness;\n    sceneColor = czm_HSBToRGB(sceneColor);\n\n    float factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));\n    sceneColor = factor * (sceneColor - vec3(0.5)) + vec3(0.5);\n    gl_FragColor = vec4(sceneColor, 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1892:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D blurTexture;\nuniform sampler2D depthTexture;\nuniform float focalDistance;\n\nvarying vec2 v_textureCoordinates;\n\nvec4 toEye(vec2 uv, float depth)\n{\n   vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\n   vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n   posInCamera = posInCamera / posInCamera.w;\n   return posInCamera;\n}\n\nfloat computeDepthBlur(float depth)\n{\n    float f;\n    if (depth < focalDistance)\n    {\n        f = (focalDistance - depth) / (focalDistance - czm_currentFrustum.x);\n    }\n    else\n    {\n        f = (depth - focalDistance) / (czm_currentFrustum.y - focalDistance);\n        f = pow(f, 0.1);\n    }\n    f *= f;\n    f = clamp(f, 0.0, 1.0);\n    return pow(f, 0.5);\n}\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 posInCamera = toEye(v_textureCoordinates, depth);\n    float d = computeDepthBlur(-posInCamera.z);\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), texture2D(blurTexture, v_textureCoordinates), d);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1893:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    gl_FragColor = vec4(vec3(depth), 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1894:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D depthTexture;\nuniform float length;\nuniform vec4 color;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float directions[3];\n    directions[0] = -1.0;\n    directions[1] = 0.0;\n    directions[2] = 1.0;\n\n    float scalars[3];\n    scalars[0] = 3.0;\n    scalars[1] = 10.0;\n    scalars[2] = 3.0;\n\n    float padx = 1.0 / czm_viewport.z;\n    float pady = 1.0 / czm_viewport.w;\n\n#ifdef CZM_SELECTED_FEATURE\n    bool selected = false;\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        selected = selected || czm_selected(vec2(-padx, dir * pady));\n        selected = selected || czm_selected(vec2(padx, dir * pady));\n        selected = selected || czm_selected(vec2(dir * padx, -pady));\n        selected = selected || czm_selected(vec2(dir * padx, pady));\n        if (selected)\n        {\n            break;\n        }\n    }\n    if (!selected)\n    {\n        gl_FragColor = vec4(color.rgb, 0.0);\n        return;\n    }\n#endif\n\n    float horizEdge = 0.0;\n    float vertEdge = 0.0;\n\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        float scale = scalars[i];\n\n        horizEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(-padx, dir * pady)).x * scale;\n        horizEdge += texture2D(depthTexture, v_textureCoordinates + vec2(padx, dir * pady)).x * scale;\n\n        vertEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, -pady)).x * scale;\n        vertEdge += texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, pady)).x * scale;\n    }\n\n    float len = sqrt(horizEdge * horizEdge + vertEdge * vertEdge);\n    gl_FragColor = vec4(color.rgb, len > length ? color.a : 0.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1895:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\n\nvarying vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\n// See slides 142 and 143:\n//     http://www.gdcvault.com/play/1012459/Uncharted_2__HDR_Lighting\n\nvoid main()\n{\n    vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n\n#ifdef AUTO_EXPOSURE\n    float exposure = texture2D(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#endif\n\n\tconst float A = 0.22; // shoulder strength\n\tconst float B = 0.30; // linear strength\n\tconst float C = 0.10; // linear angle\n\tconst float D = 0.20; // toe strength\n\tconst float E = 0.01; // toe numerator\n\tconst float F = 0.30; // toe denominator\n\n\tconst float white = 11.2; // linear white point value\n\n\tvec3 c = ((color * (A * color + C * B) + D * E) / (color * ( A * color + B) + D * F)) - E / F;\n\tfloat w = ((white * (A * white + C * B) + D * E) / (white * ( A * white + B) + D * F)) - E / F;\n\n\tc = czm_inverseGamma(c / w);\n\tgl_FragColor = vec4(c, fragmentColor.a);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1896:function(e,t,i){var r;void 0===(r=function(){"use strict";return"varying vec2 v_textureCoordinates;\n\nuniform sampler2D colorTexture;\n\nconst float fxaaQualitySubpix = 0.5;\nconst float fxaaQualityEdgeThreshold = 0.125;\nconst float fxaaQualityEdgeThresholdMin = 0.0833;\n\nvoid main()\n{\n    vec2 fxaaQualityRcpFrame = vec2(1.0) / czm_viewport.zw;\n    vec4 color = FxaaPixelShader(\n        v_textureCoordinates,\n        colorTexture,\n        fxaaQualityRcpFrame,\n        fxaaQualitySubpix,\n        fxaaQualityEdgeThreshold,\n        fxaaQualityEdgeThresholdMin);\n    float alpha = texture2D(colorTexture, v_textureCoordinates).a;\n    gl_FragColor = vec4(color.rgb, alpha);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1897:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D dirtTexture;\nuniform sampler2D starTexture;\nuniform vec2 dirtTextureDimensions;\nuniform float distortion;\nuniform float ghostDispersal;\nuniform float haloWidth;\nuniform float earthRadius;\nuniform float intensity;\n\nvarying vec2 v_textureCoordinates;\n\n// whether it is in space or not\n// 6500000.0 is Emprical value\n#define DISTANCE_TO_SPACE 6500000.0\n\n// return ndc from world coordinate biased earthRadius\nvec4 getNDCFromWC(vec3 WC, float earthRadius)\n{\n    vec4 positionEC = czm_view * vec4(WC, 1.0);\n    positionEC = vec4(positionEC.x + earthRadius , positionEC.y, positionEC.z, 1.0);\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    return czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n}\n\n// Check if current pixel is included Earth\n// if then mask it gradually\nfloat isInEarth(vec2 texcoord, vec2 sceneSize)\n{\n    vec2 NDC = texcoord * 2.0 - 1.0;\n    vec4 earthPosSC = getNDCFromWC(vec3(0.0), 0.0);\n    vec4 earthPosSCEdge = getNDCFromWC(vec3(0.0), earthRadius * 1.5);\n    NDC.xy -= earthPosSC.xy;\n\n    float X = abs(NDC.x) * sceneSize.x;\n    float Y = abs(NDC.y) * sceneSize.y;\n\n    return clamp(0.0, 1.0, max(sqrt(X * X + Y * Y) / max(abs(earthPosSCEdge.x * sceneSize.x), 1.0) - 0.8 , 0.0));\n}\n\n// For Chromatic effect\nvec4 textureDistorted(sampler2D tex, vec2 texcoord, vec2 direction, vec3 distortion, bool isSpace)\n{\n    vec2 sceneSize = czm_viewport.zw;\n    vec3 color;\n    if(isSpace)\n    {\n        color.r = isInEarth(texcoord + direction * distortion.r, sceneSize) * texture2D(tex, texcoord + direction * distortion.r).r;\n        color.g = isInEarth(texcoord + direction * distortion.g, sceneSize) * texture2D(tex, texcoord + direction * distortion.g).g;\n        color.b = isInEarth(texcoord  + direction * distortion.b, sceneSize) * texture2D(tex, texcoord + direction * distortion.b).b;\n    }\n    else\n    {\n        color.r = texture2D(tex, texcoord + direction * distortion.r).r;\n        color.g = texture2D(tex, texcoord + direction * distortion.g).g;\n        color.b = texture2D(tex, texcoord + direction * distortion.b).b;\n    }\n    return vec4(clamp(color, 0.0, 1.0), 0.0);\n}\n\nvoid main(void)\n{\n    vec4 originalColor = texture2D(colorTexture, v_textureCoordinates);\n    vec3 rgb = originalColor.rgb;\n    bool isSpace = length(czm_viewerPositionWC.xyz) > DISTANCE_TO_SPACE;\n\n    // Sun position\n    vec4 sunPos = czm_morphTime == 1.0 ? vec4(czm_sunPositionWC, 1.0) : vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    vec4 sunPositionEC = czm_view * sunPos;\n    vec4 sunPositionWC = czm_eyeToWindowCoordinates(sunPositionEC);\n    sunPos = czm_viewportOrthographic * vec4(sunPositionWC.xy, -sunPositionWC.z, 1.0);\n\n    // If sun is not in the screen space, use original color.\n    if(!isSpace || !((sunPos.x >= -1.1 && sunPos.x <= 1.1) && (sunPos.y >= -1.1 && sunPos.y <= 1.1)))\n    {\n        // Lens flare is disabled when not in space until #5932 is fixed.\n        //    https://github.com/AnalyticalGraphicsInc/cesium/issues/5932\n        gl_FragColor = originalColor;\n        return;\n    }\n\n    vec2 texcoord = -v_textureCoordinates + vec2(1.0);\n    vec2 texelSize = 1.0 / czm_viewport.zw;\n    vec3 distortionVec = vec3(-texelSize.x * distortion, 0.0, texelSize.x * distortion);\n\n    // ghost vector to image centre:\n    vec2 ghostVec = (vec2(0.5) - texcoord) * ghostDispersal;\n    vec3 direction = normalize(vec3(ghostVec, 0.0));\n\n    // sample ghosts:\n    vec4 result = vec4(0.0);\n    vec4 ghost = vec4(0.0);\n    for (int i = 0; i < 4; ++i)\n    {\n        vec2 offset = fract(texcoord + ghostVec * float(i));\n        // Only bright spots from the centre of the source image\n        ghost += textureDistorted(colorTexture, offset, direction.xy, distortionVec, isSpace);\n    }\n    result += ghost;\n\n    // sample halo\n    vec2 haloVec = normalize(ghostVec) * haloWidth;\n    float weightForHalo = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));\n    weightForHalo = pow(1.0 - weightForHalo, 5.0);\n\n    result += textureDistorted(colorTexture, texcoord + haloVec, direction.xy, distortionVec, isSpace) * weightForHalo * 1.5;\n\n    vec2 dirtTexCoords = (v_textureCoordinates * czm_viewport.zw) / dirtTextureDimensions;\n    if (dirtTexCoords.x > 1.0)\n    {\n        dirtTexCoords.x = mod(floor(dirtTexCoords.x), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.x) :  fract(dirtTexCoords.x);\n    }\n    if (dirtTexCoords.y > 1.0)\n    {\n        dirtTexCoords.y = mod(floor(dirtTexCoords.y), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.y) :  fract(dirtTexCoords.y);\n    }\n    result += texture2D(dirtTexture, dirtTexCoords);\n\n    // Rotating starburst texture's coordinate\n    // dot(czm_view[0].xyz, vec3(0.0, 0.0, 1.0)) + dot(czm_view[1].xyz, vec3(0.0, 1.0, 0.0))\n    float camrot = czm_view[0].z + czm_view[1].y;\n    float cosValue = cos(camrot);\n    float sinValue = sin(camrot);\n    mat3 rotation = mat3(\n        cosValue, -sinValue, 0.0,\n        sinValue, cosValue, 0.0,\n        0.0, 0.0, 1.0\n    );\n\n    vec3 st1 = vec3(v_textureCoordinates * 2.0 - vec2(1.0), 1.0);\n    vec3 st2 = vec3((rotation * st1).xy, 1.0);\n    vec3 st3 = st2 * 0.5 + vec3(0.5);\n    vec2 lensStarTexcoord = st3.xy;\n    float weightForLensFlare = length(vec3(sunPos.xy, 0.0));\n    float oneMinusWeightForLensFlare = max(1.0 - weightForLensFlare, 0.0);\n\n    if (!isSpace)\n    {\n        result *= oneMinusWeightForLensFlare * intensity * 0.2;\n    }\n    else\n    {\n        result *= oneMinusWeightForLensFlare * intensity;\n        result *= texture2D(starTexture, lensStarTexcoord) * pow(weightForLensFlare, 1.0) * max((1.0 - length(vec3(st1.xy, 0.0))), 0.0) * 2.0;\n    }\n\n    result += texture2D(colorTexture, v_textureCoordinates);\n\n    gl_FragColor = result;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1898:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform vec3 white;\n\nvarying vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\n// See equation 4:\n//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf\n\nvoid main()\n{\n    vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\n    float exposure = texture2D(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#endif\n    color = (color * (1.0 + color / white)) / (1.0 + color);\n    color = czm_inverseGamma(color);\n    gl_FragColor = vec4(color, fragmentColor.a);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1899:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\n\nvarying vec2 v_textureCoordinates;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    float noiseValue = rand(v_textureCoordinates + sin(czm_frameNumber)) * 0.1;\n    vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\n    vec3 green = vec3(0.0, 1.0, 0.0);\n    gl_FragColor = vec4((noiseValue + rgb) * green, 1.0);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1900:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\n\nvarying vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\n// See equation 3:\n//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf\n\nvoid main()\n{\n    vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\n    float exposure = texture2D(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#endif\n    color = color / (1.0 + color);\n    color = czm_inverseGamma(color);\n    gl_FragColor = vec4(color, fragmentColor.a);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1901:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D silhouetteTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 silhouetteColor = texture2D(silhouetteTexture, v_textureCoordinates);\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    gl_FragColor = mix(color, silhouetteColor, silhouetteColor.a);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1902:function(e,t,i){var r;
/**
 * @license
 * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *  * Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *  * Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *  * Neither the name of NVIDIA CORPORATION nor the names of its
 *    contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */void 0===(r=function(){"use strict";return"/**\n * @license\n * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *  * Neither the name of NVIDIA CORPORATION nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// NVIDIA GameWorks Graphics Samples GitHub link: https://github.com/NVIDIAGameWorks/GraphicsSamples\n// Original FXAA 3.11 shader link: https://github.com/NVIDIAGameWorks/GraphicsSamples/blob/master/samples/es3-kepler/FXAA/FXAA3_11.h\n\n// Steps used to integrate into Cesium:\n// * The following defines are set:\n//       #define FXAA_PC 1\n//       #define FXAA_WEBGL_1 1\n//       #define FXAA_GREEN_AS_LUMA 1\n//       #define FXAA_EARLY_EXIT 1\n//       #define FXAA_GLSL_120 1\n// * All other preprocessor directives besides the FXAA_QUALITY__P* directives were removed.\n// * Double underscores are invalid for preprocessor directives so replace them with a single underscore. Replace\n//   /FXAA_QUALITY__P(.*)/g with /FXAA_QUALITY__P$1/.\n// * There are no implicit conversions from ivec* to vec* so replace:\n//       #define FxaaInt2 ivec2\n//           with\n//       #define FxaaInt2 vec2\n// * The texture2DLod function is only available in vertex shaders so replace:\n//       #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\n//       #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\n//           with\n//       #define FxaaTexTop(t, p) texture2D(t, p)\n//       #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n// * FXAA_QUALITY_PRESET is prepended in the javascript code. We may want to expose that setting in the future.\n// * The following parameters to FxaaPixelShader are unused and can be removed:\n//       fxaaConsolePosPos\n//       fxaaConsoleRcpFrameOpt\n//       fxaaConsoleRcpFrameOpt2\n//       fxaaConsole360RcpFrameOpt2\n//       fxaaConsoleEdgeSharpness\n//       fxaaConsoleEdgeThreshold\n//       fxaaConsoleEdgeThresholdMi\n//       fxaaConsole360ConstDir\n\n//\n// Choose the quality preset.\n// This needs to be compiled into the shader as it effects code.\n// Best option to include multiple presets is to\n// in each shader define the preset, then include this file.\n//\n// OPTIONS\n// -----------------------------------------------------------------------\n// 10 to 15 - default medium dither (10=fastest, 15=highest quality)\n// 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\n// 39       - no dither, very expensive\n//\n// NOTES\n// -----------------------------------------------------------------------\n// 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\n// 13 = about same speed as FXAA 3.9 and better than 12\n// 23 = closest to FXAA 3.9 visually and performance wise\n//  _ = the lowest digit is directly related to performance\n// _  = the highest digit is directly related to style\n//\n//#define FXAA_QUALITY_PRESET 12\n\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n\nFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\n\nFxaaFloat4 FxaaPixelShader(\n    //\n    // Use noperspective interpolation here (turn off perspective interpolation).\n    // {xy} = center of pixel\n    FxaaFloat2 pos,\n    //\n    // Input color texture.\n    // {rgb_} = color in linear or perceptual color space\n    // if (FXAA_GREEN_AS_LUMA == 0)\n    //     {___a} = luma in perceptual color space (not linear)\n    FxaaTex tex,\n    //\n    // Only used on FXAA Quality.\n    // This must be from a constant/uniform.\n    // {x_} = 1.0/screenWidthInPixels\n    // {_y} = 1.0/screenHeightInPixels\n    FxaaFloat2 fxaaQualityRcpFrame,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_SUBPIX define.\n    // It is here now to allow easier tuning.\n    // Choose the amount of sub-pixel aliasing removal.\n    // This can effect sharpness.\n    //   1.00 - upper limit (softer)\n    //   0.75 - default amount of filtering\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\n    //   0.25 - almost off\n    //   0.00 - completely off\n    FxaaFloat fxaaQualitySubpix,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.\n    // It is here now to allow easier tuning.\n    // The minimum amount of local contrast required to apply algorithm.\n    //   0.333 - too little (faster)\n    //   0.250 - low quality\n    //   0.166 - default\n    //   0.125 - high quality\n    //   0.063 - overkill (slower)\n    FxaaFloat fxaaQualityEdgeThreshold,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.\n    // It is here now to allow easier tuning.\n    // Trims the algorithm from processing darks.\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\n    //   0.0625 - high quality (faster)\n    //   0.0312 - visible limit (slower)\n    // Special notes when using FXAA_GREEN_AS_LUMA,\n    //   Likely want to set this to zero.\n    //   As colors that are mostly not-green\n    //   will appear very dark in the green channel!\n    //   Tune by looking at mostly non-green content,\n    //   then start at zero and increase until aliasing is a problem.\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n/*--------------------------------------------------------------------------*/\n    if(earlyExit)\n        return rgbyM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n/*--------------------------------------------------------------------------*/\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\n/*--------------------------------------------------------------------------*/\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n/*--------------------------------------------------------------------------*/\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n/*--------------------------------------------------------------------------*/\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n/*--------------------------------------------------------------------------*/\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n/*--------------------------------------------------------------------------*/\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n    #endif\n/*--------------------------------------------------------------------------*/\n                        }\n                        #endif\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n/*--------------------------------------------------------------------------*/\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n/*--------------------------------------------------------------------------*/\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n/*--------------------------------------------------------------------------*/\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1903:function(e,t,i){var r,n;r=[i(24),i(22),i(9),i(8),i(10),i(20),i(61),i(123),i(103),i(66),i(88),i(63),i(96),i(89),i(114)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m){"use strict";function f(){this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._ready=!1,this._name="czm_autoexposure",this._logDepthChanged=void 0,this._useLogDepth=void 0,this._framebuffers=void 0,this._previousLuminance=void 0,this._commands=void 0,this._clearCommand=void 0,this._minMaxLuminance=new e,this.enabled=!0,this._enabled=!0,this.minimumLuminance=.1,this.maximumLuminance=10}function _(e){var t=e._framebuffers;if(r(t)){for(var i=t.length,n=0;n<i;++n)t[n].destroy();e._framebuffers=void 0,e._previousLuminance.destroy(),e._previousLuminance=void 0}}function g(e){var t=e._commands;if(r(t)){for(var i=t.length,n=0;n<i;++n)t[n].shaderProgram.destroy();e._commands=void 0}}function v(e,t){var i;if(0===t)i={colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions}};else{var r=e._framebuffers[t-1].getColorTexture(0);i={colorTexture:function(){return r},colorTextureDimensions:function(){return r.dimensions}}}return i.minMaxLuminance=function(){return e._minMaxLuminance},i.previousLuminance=function(){return e._previousLuminance.getColorTexture(0)},i}function y(e,t){var i="uniform sampler2D colorTexture; \nvarying vec2 v_textureCoordinates; \nfloat sampleTexture(vec2 offset) { \n";return i+=0===e?"    vec4 color = texture2D(colorTexture, v_textureCoordinates + offset); \n    return czm_luminance(color.rgb); \n":"    return texture2D(colorTexture, v_textureCoordinates + offset).r; \n",i+="}\n\n",i+="uniform vec2 colorTextureDimensions; \nuniform vec2 minMaxLuminance; \nuniform sampler2D previousLuminance; \nvoid main() { \n    float color = 0.0; \n    float xStep = 1.0 / colorTextureDimensions.x; \n    float yStep = 1.0 / colorTextureDimensions.y; \n    int count = 0; \n    for (int i = 0; i < 3; ++i) { \n        for (int j = 0; j < 3; ++j) { \n            vec2 offset; \n            offset.x = -xStep + float(i) * xStep; \n            offset.y = -yStep + float(j) * yStep; \n            if (offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0) { \n                continue; \n            } \n            color += sampleTexture(offset); \n            ++count; \n        } \n    } \n    if (count > 0) { \n        color /= float(count); \n    } \n",e===t-1&&(i+="    float previous = texture2D(previousLuminance, vec2(0.5)).r; \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n    color = previous + (color - previous) / (60.0 * 1.5); \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n"),i+="    gl_FragColor = vec4(color); \n} \n"}return n(f.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},outputTexture:{get:function(){var e=this._framebuffers;if(r(e))return e[e.length-1].getColorTexture(0)}}}),f.prototype.clear=function(e){var i=this._framebuffers;if(r(i)){var n=this._clearCommand;r(n)||(n=this._clearCommand=new s({color:new t(0,0,0,0),framebuffer:void 0}));for(var o=i.length,a=0;a<o;++a)n.framebuffer=i[a],n.execute(e)}},f.prototype.update=function(e){var t=e.drawingBufferWidth,i=e.drawingBufferHeight;t===this._width&&i===this._height||(this._width=t,this._height=i,function(e,t){_(e);for(var i=e._width,r=e._height,n=a.RGBA,o=t.halfFloatingPointTexture?u.HALF_FLOAT:u.FLOAT,s=new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST}),f=Math.ceil(Math.log(Math.max(i,r))/Math.log(3)),g=new Array(f),v=0;v<f;++v)i=Math.max(Math.ceil(i/3),1),r=Math.max(Math.ceil(r/3),1),g[v]=new l({context:t,colorTextures:[new d({context:t,width:i,height:r,pixelFormat:n,pixelDatatype:o,sampler:s})]});var y=g[f-1].getColorTexture(0);e._previousLuminance=new l({context:t,colorTextures:[new d({context:t,width:y.width,height:y.height,pixelFormat:n,pixelDatatype:o,sampler:s})]}),e._framebuffers=g}(this,e),function(e,t){g(e);for(var i=e._framebuffers,r=i.length,n=new Array(r),o=0;o<r;++o)n[o]=t.createViewportQuadCommand(y(o,r),{framebuffer:i[o],uniformMap:v(e,o)});e._commands=n}(this,e),this._ready||(this._ready=!0)),this._minMaxLuminance.x=this.minimumLuminance,this._minMaxLuminance.y=this.maximumLuminance;var r=this._framebuffers,n=r[r.length-1];r[r.length-1]=this._previousLuminance,this._commands[this._commands.length-1].framebuffer=this._previousLuminance,this._previousLuminance=n},f.prototype.execute=function(e,t){this._colorTexture=t;var i=this._commands;if(r(i))for(var n=i.length,o=0;o<n;++o)i[o].execute(e)},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return _(this),g(this),o(this)},f}.apply(t,r))||(e.exports=n)},1904:function(e,t,i){e.exports=i.p+"c6ab0a71c7048eb83585b34bd32f4ee0.jpg"},1905:function(e,t,i){e.exports=i.p+"27faaa4b21b2a66ac3496b20640e571f.jpg"},1906:function(e,t,i){var r,n;r=[i(17)],void 0===(n=function(e){"use strict";var t={REINHARD:0,MODIFIED_REINHARD:1,FILMIC:2,ACES:3,validate:function(e){return e===t.REINHARD||e===t.MODIFIED_REINHARD||e===t.FILMIC||e===t.ACES}};return e(t)}.apply(t,r))||(e.exports=n)},1907:function(e,t,i){var r,n;r=[i(12),i(32),i(16),i(8),i(20),i(204),i(14),i(28),i(115),i(174),i(193),i(146),i(276),i(216),i(60),i(362),i(44)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";function g(e){this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}g.prototype.completeMorph=function(){r(this._completeMorph)&&this._completeMorph()},g.prototype.morphTo2D=function(t,i){r(this._completeMorph)&&this._completeMorph();var n=this._scene;this._previousMode=n.mode,this._morphToOrthographic=n.camera.frustum instanceof l,this._previousMode!==_.SCENE2D&&this._previousMode!==_.MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,_.SCENE2D,!0),n._mode=_.MORPHING,n.camera._setTransform(s.IDENTITY),this._previousMode===_.COLUMBUS_VIEW?function(t,i){i*=.5;var n=t._scene,a=n.camera,l=e.clone(a.position,ee),u=e.clone(a.direction,te),c=e.clone(a.up,ie),d=e.negate(e.UNIT_Z,ne),h=e.clone(e.UNIT_Y,oe),p=re;if(i>0)e.clone(e.ZERO,re),p.z=5*n.mapProjection.ellipsoid.maximumRadius;else{e.clone(l,re);var m=se;s.multiplyByPoint(f.TRANSFORM_2D,l,m.origin),s.multiplyByPointAsVector(f.TRANSFORM_2D,u,m.direction);var _=n.globe;if(r(_)){var g=_.pickWorldCoordinates(m,n,le);r(g)&&(s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,g,p),p.z+=e.distance(l,p))}}var v=ae;v.right=.5*p.z,v.left=-v.right,v.top=v.right*(n.drawingBufferHeight/n.drawingBufferWidth),v.bottom=-v.top;var y=ue;y.position=p,y.direction=d,y.up=h,y.frustum=v;var x=we(y);function w(e,t){e.position.z=t}M(t,x);var T=n.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){J(l,p,t.time,a.position),J(u,d,t.time,a.direction),J(c,h,t.time,a.up),e.cross(a.direction,a.up,a.right),e.normalize(a.right,a.right),a._adjustOrthographicFrustum(!0)},complete:function(){$(t,i,y,w,x)}});t._currentTweens.push(T)}(this,t):function(t,i,n){i*=.5;var o=t._scene,a=o.camera,l=de;if(i>0)e.clone(e.ZERO,l.position),l.position.z=5*n.maximumRadius,e.negate(e.UNIT_Z,l.direction),e.clone(e.UNIT_Y,l.up);else{n.cartesianToCartographic(a.positionWC,ce),o.mapProjection.project(ce,l.position),e.negate(e.UNIT_Z,l.direction),e.clone(e.UNIT_Y,l.up);var u=me;e.clone(l.position2D,u.origin);var c=e.clone(a.directionWC,u.direction),d=n.scaleToGeodeticSurface(a.positionWC,_e),h=m.eastNorthUpToFixedFrame(d,n,fe);s.inverseTransformation(h,h),s.multiplyByPointAsVector(h,c,c),s.multiplyByPointAsVector(f.TRANSFORM_2D,c,c);var p=o.globe;if(r(p)){var _=p.pickWorldCoordinates(u,o,pe);if(r(_)){var g=e.distance(l.position2D,_);_.x+=g,e.clone(_,l.position2D)}}}function v(e,t){e.position.x=t}s.multiplyByPoint(f.TRANSFORM_2D,l.position,l.position2D),s.multiplyByPointAsVector(f.TRANSFORM_2D,l.direction,l.direction2D),s.multiplyByPointAsVector(f.TRANSFORM_2D,l.up,l.up2D);var y=l.frustum;y.right=.5*l.position.z,y.left=-y.right,y.top=y.right*(o.drawingBufferHeight/o.drawingBufferWidth),y.bottom=-y.top;var x=he;s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,l.position2D,x.position),e.clone(l.direction,x.direction),e.clone(l.up,x.up),x.frustum=y;var w=we(x);M(t,w),ve(t,i,l,function(){$(t,i,l,v,w)})}(this,t,i),0===t&&r(this._completeMorph)&&this._completeMorph())};var v=new e,y=new e,x=new e,w=new e,T=new e,C=new e,E=new e,A=new t,S=new s,P=new c,b=new l,D={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};g.prototype.morphToColumbusView=function(t,i){r(this._completeMorph)&&this._completeMorph();var n=this._scene;if(this._previousMode=n.mode,this._previousMode!==_.COLUMBUS_VIEW&&this._previousMode!==_.MORPHING){this._scene.morphStart.raiseEvent(this,this._previousMode,_.COLUMBUS_VIEW,!0),n.camera._setTransform(s.IDENTITY);var l,u=v,c=y,d=x;if(t>0)u.x=0,u.y=-1,u.z=1,u=e.multiplyByScalar(e.normalize(u,u),5*i.maximumRadius,u),e.negate(e.normalize(u,c),c),e.cross(e.UNIT_X,c,d);else{var h=n.camera;if(this._previousMode===_.SCENE2D)e.clone(h.position,u),u.z=h.frustum.right-h.frustum.left,e.negate(e.UNIT_Z,c),e.clone(e.UNIT_Y,d);else{e.clone(h.positionWC,u),e.clone(h.directionWC,c),e.clone(h.upWC,d);var p=i.scaleToGeodeticSurface(u,E),g=m.eastNorthUpToFixedFrame(p,i,S);s.inverseTransformation(g,g),n.mapProjection.project(i.cartesianToCartographic(u,A),u),s.multiplyByPointAsVector(g,c,c),s.multiplyByPointAsVector(g,d,d)}}this._morphToOrthographic?((l=b).width=n.camera.frustum.right-n.camera.frustum.left,l.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight):((l=P).aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight,l.fov=a.toRadians(60));var O=D;O.position=u,O.direction=c,O.up=d,O.frustum=l;var I=function(t){return function(i){var n=i._scene;n._mode=_.COLUMBUS_VIEW,n.morphTime=_.getMorphTime(_.COLUMBUS_VIEW),N(i);var o=n.camera;(i._previousModeMode!==_.MORPHING||i._morphCancelled)&&(i._morphCancelled=!1,e.clone(t.position,o.position),e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right));var a=o.frustum;n.frameState.useLogDepth&&(a.near=.1,a.far=1e10);var s=r(i._completeMorph);i._completeMorph=void 0,n.camera.update(n.mode),i._scene.morphComplete.raiseEvent(i,i._previousMode,_.COLUMBUS_VIEW,s)}}(O);M(this,I),this._previousMode===_.SCENE2D?function(t,i,r,n){i*=.5;var a=t._scene,s=a.camera,l=e.clone(r.position,q),u=e.clone(r.direction,Z),c=e.clone(r.up,K);function d(){s.frustum=r.frustum.clone();var d=e.clone(s.position,j),h=e.clone(s.direction,X),p=e.clone(s.up,Q);d.z=l.z;var m=a.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){J(d,l,t.time,s.position),J(h,u,t.time,s.direction),J(p,c,t.time,s.up),e.cross(s.direction,s.up,s.right),e.normalize(s.right,s.right)},complete:function(){n(t)}});t._currentTweens.push(m)}a._mode=_.MORPHING,t._morphToOrthographic?d():ge(t,0,r,d)}(this,t,O,I):(O.position2D=s.multiplyByPoint(f.TRANSFORM_2D,u,w),O.direction2D=s.multiplyByPointAsVector(f.TRANSFORM_2D,c,T),O.up2D=s.multiplyByPointAsVector(f.TRANSFORM_2D,d,C),n._mode=_.MORPHING,ve(this,t,O,I)),0===t&&r(this._completeMorph)&&this._completeMorph()}};var O={position:new e,direction:new e,up:new e,frustum:void 0},I=new c;function M(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new h(e._scene.canvas,!1);var i=function(){e._morphCancelled=!0,e._scene.camera.cancelFlight(),t(e)};e._completeMorph=i,e._morphHandler.setInputAction(i,p.LEFT_DOWN),e._morphHandler.setInputAction(i,p.MIDDLE_DOWN),e._morphHandler.setInputAction(i,p.RIGHT_DOWN),e._morphHandler.setInputAction(i,p.WHEEL)}}function N(e){for(var t=e._currentTweens,i=0;i<t.length;++i)t[i].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}g.prototype.morphTo3D=function(t,i){r(this._completeMorph)&&this._completeMorph();var n=this._scene;if(this._previousMode=n.mode,this._previousMode!==_.SCENE3D&&this._previousMode!==_.MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,_.SCENE3D,!0),n._mode=_.MORPHING,n.camera._setTransform(s.IDENTITY),this._previousMode===_.SCENE2D)!function(t,i,r){i/=3;var n,o,s=t._scene,l=s.camera;i>0?(n=O,e.fromDegrees(0,0,5*r.maximumRadius,r,n.position),e.negate(n.position,n.direction),e.normalize(n.direction,n.direction),e.clone(e.UNIT_Z,n.up)):(l.position.z=l.frustum.right-l.frustum.left,n=V(t,r));t._morphToOrthographic?((o=Y).aspectRatio=s.drawingBufferWidth/s.drawingBufferHeight,o.width=l.frustum.right-l.frustum.left):((o=I).aspectRatio=s.drawingBufferWidth/s.drawingBufferHeight,o.fov=a.toRadians(60));n.frustum=o;var u,c=xe(n);M(t,c),u=t._morphToOrthographic?function(){W(t,i,n,c)}:function(){ge(t,i,n,function(){W(t,i,n,c)})};i>0?(s._mode=_.SCENE2D,l.flyTo({duration:i,destination:e.fromDegrees(0,0,5*r.maximumRadius,r,q),complete:function(){s._mode=_.MORPHING,u()}})):u()}(this,t,i);else{var o,u;t>0?(o=O,e.fromDegrees(0,0,5*i.maximumRadius,i,o.position),e.negate(o.position,o.direction),e.normalize(o.direction,o.direction),e.clone(e.UNIT_Z,o.up)):o=V(this,i);var c=n.camera;c.frustum instanceof l?u=c.frustum.clone():((u=I).aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight,u.fov=a.toRadians(60)),o.frustum=u;var d=xe(o);M(this,d),W(this,t,o,d)}0===t&&r(this._completeMorph)&&this._completeMorph()}},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return N(this),n(this)};var F=new t,R=new e,L=new s;function V(e,t){var i=e._scene,r=i.camera,n=O,o=n.position,a=n.direction,l=n.up,u=i.mapProjection.unproject(r.position,F);t.cartographicToCartesian(u,o);var c=t.scaleToGeodeticSurface(o,R),d=m.eastNorthUpToFixedFrame(c,t,L);return s.multiplyByPointAsVector(d,r.direction,a),s.multiplyByPointAsVector(d,r.up,l),n}var U=new e,z=new e,B=new e,H=new e,k=new e,G=new e;function W(t,i,r,n){i*=.5;var a=t._scene,l=a.camera,u=e.clone(l.position,U),c=e.clone(l.direction,z),d=e.clone(l.up,B),h=s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,r.position,H),p=s.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,r.direction,k),m=s.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,r.up,G);var _=a.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){J(u,h,t.time,l.position),J(c,p,t.time,l.direction),J(d,m,t.time,l.up),e.cross(l.direction,l.up,l.right),e.normalize(l.right,l.right)},complete:function(){ye(t,a,0,1,i,n)}});t._currentTweens.push(_)}var Y=new l,j=new e,X=new e,Q=new e,q=new e,Z=new e,K=new e;function J(t,i,r,n){return e.lerp(t,i,r,n)}function $(e,t,i,r,n){var s=e._scene,u=s.camera;if(!(u.frustum instanceof l)){var c=u.frustum.fov,d=.5*a.RADIANS_PER_DEGREE,h=i.position.z*Math.tan(.5*c);u.frustum.far=h/Math.tan(.5*d)+1e7;var p=s.tweens.add({duration:t,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){u.frustum.fov=a.lerp(c,d,e.time);var t=h/Math.tan(.5*u.frustum.fov);r(u,t)},complete:function(){u.frustum=i.frustum.clone(),n(e)}});e._currentTweens.push(p)}}var ee=new e,te=new e,ie=new e,re=new e,ne=new e,oe=new e,ae=new u,se=new d,le=new e,ue={position:void 0,direction:void 0,up:void 0,frustum:void 0};var ce=new t,de={position:new e,direction:new e,up:new e,position2D:new e,direction2D:new e,up2D:new e,frustum:new u},he={position:new e,direction:new e,up:new e,frustum:void 0},pe=new e,me=new d,fe=new s,_e=new e;function ge(e,t,i,r){var n=e._scene,s=n.camera,l=s.frustum.right-s.frustum.left;s.frustum=i.frustum.clone();var u=s.frustum.fov,c=.5*a.RADIANS_PER_DEGREE,d=l*Math.tan(.5*u);s.frustum.far=d/Math.tan(.5*c)+1e7,s.frustum.fov=c;var h=n.tweens.add({duration:t,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){s.frustum.fov=a.lerp(c,u,e.time),s.position.z=d/Math.tan(.5*s.frustum.fov)},complete:function(){r(e)}});e._currentTweens.push(h)}function ve(t,i,r,n){var a=t._scene,s=a.camera,l=e.clone(s.position,j),u=e.clone(s.direction,X),c=e.clone(s.up,Q),d=e.clone(r.position2D,q),h=e.clone(r.direction2D,Z),p=e.clone(r.up2D,K);var m=a.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){J(l,d,t.time,s.position),J(u,h,t.time,s.direction),J(c,p,t.time,s.up),e.cross(s.direction,s.up,s.right),e.normalize(s.right,s.right),s._adjustOrthographicFrustum(!0)},complete:function(){ye(t,a,1,0,i,n)}});t._currentTweens.push(m)}function ye(e,t,i,n,a,s){var l={object:t,property:"morphTime",startValue:i,stopValue:n,duration:a,easingFunction:o.QUARTIC_OUT};r(s)&&(l.complete=function(){s(e)});var u=t.tweens.addProperty(l);e._currentTweens.push(u)}function xe(t){return function(i){var n=i._scene;n._mode=_.SCENE3D,n.morphTime=_.getMorphTime(_.SCENE3D),N(i);var o=n.camera;(i._previousMode!==_.MORPHING||i._morphCancelled)&&(i._morphCancelled=!1,e.clone(t.position,o.position),e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right),o.frustum=t.frustum.clone());var a=o.frustum;n.frameState.useLogDepth&&(a.near=.1,a.far=1e10);var s=r(i._completeMorph);i._completeMorph=void 0,n.camera.update(n.mode),i._scene.morphComplete.raiseEvent(i,i._previousMode,_.SCENE3D,s)}}function we(t){return function(i){var n=i._scene;n._mode=_.SCENE2D,n.morphTime=_.getMorphTime(_.SCENE2D),N(i);var o=n.camera;e.clone(t.position,o.position),o.position.z=2*n.mapProjection.ellipsoid.maximumRadius,e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right),o.frustum=t.frustum.clone();var a=r(i._completeMorph);i._completeMorph=void 0,n.camera.update(n.mode),i._scene.morphComplete.raiseEvent(i,i._previousMode,_.SCENE2D,a)}}return g}.apply(t,r))||(e.exports=n)},1908:function(e,t,i){var r,n;r=[i(24),i(12),i(49),i(32),i(9),i(8),i(20),i(11),i(26),i(265),i(145),i(85),i(277),i(14),i(43),i(28),i(115),i(129),i(54),i(146),i(60),i(1909),i(756),i(498),i(44),i(212),i(384)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S){"use strict";function P(i){this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=T.LEFT_DRAG,this.zoomEventTypes=[T.RIGHT_DRAG,T.WHEEL,T.PINCH],this.rotateEventTypes=T.LEFT_DRAG,this.tiltEventTypes=[T.MIDDLE_DRAG,T.PINCH,{eventType:T.LEFT_DRAG,modifier:h.CTRL},{eventType:T.RIGHT_DRAG,modifier:h.CTRL}],this.lookEventTypes={eventType:T.LEFT_DRAG,modifier:h.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=i,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new w(i.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._tweens=new S,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new e(-1,-1),this._tiltCenter=new t,this._rotateMousePosition=new e(-1,-1),this._rotateStartPosition=new t,this._strafeStartPosition=new t,this._zoomMouseStart=new e(-1,-1),this._zoomWorldPosition=new t,this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._rotatingZoom=!1;var n=i.mapProjection;this._maxCoord=n.project(new r(Math.PI,p.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3}var b=.4;function D(t,i,r,n,a,s,l){var u=s[l];o(u)||(u=s[l]={startPosition:new e,endPosition:new e,motion:new e,active:!1});var c,d=t.getButtonPressTime(i,r),h=t.getButtonReleaseTime(i,r),m=d&&h&&(h.getTime()-d.getTime())/1e3,f=new Date,_=h&&(f.getTime()-h.getTime())/1e3;if(d&&h&&m<b){var g=function(e,t){if(e<0)return 0;var i=25*(1-t);return Math.exp(-i*e)}(_,n);if(u.active)u.startPosition=e.clone(u.endPosition,u.startPosition),u.endPosition=e.multiplyByScalar(u.motion,g,u.endPosition),u.endPosition=e.add(u.startPosition,u.endPosition,u.endPosition),u.motion=e.clone(e.ZERO,u.motion);else{var v=t.getLastMovement(i,r);if(!o(v)||(c=v,e.equalsEpsilon(c.startPosition,c.endPosition,p.EPSILON14)))return;u.motion.x=.5*(v.endPosition.x-v.startPosition.x),u.motion.y=.5*(v.endPosition.y-v.startPosition.y),u.startPosition=e.clone(v.startPosition,u.startPosition),u.endPosition=e.multiplyByScalar(u.motion,g,u.endPosition),u.endPosition=e.add(u.startPosition,u.endPosition,u.endPosition),u.active=!0}if(isNaN(u.endPosition.x)||isNaN(u.endPosition.y)||e.distance(u.startPosition,u.endPosition)<.5)return void(u.active=!1);if(!t.isButtonDown(i,r))a(s,t.getStartMousePosition(i,r),u)}else u.active=!1}var O=[];function I(e,t,i,r,n,a){if(o(i)){var s=e._aggregator;d(i)||(O[0]=i,i=O);for(var l=i.length,u=0;u<l;++u){var c=i[u],h=o(c.eventType)?c.eventType:c,p=c.modifier,m=s.isMoving(h,p)&&s.getMovement(h,p),f=s.getStartMousePosition(h,p);e.enableInputs&&t&&(m?r(e,f,m):n<1&&D(s,h,p,n,r,e,a))}}}var M=new y,N=new t,F=new e,R=new t,L=new e,V=new t,U=new t,z=new t,B=new t,H=new t,k=new t,G=new t,W=new t,Y=new t,j=new t,X=new t,Q=new t,q=new t,Z=new t,K=new t,J=new t,$=new t,ee=new t,te={orientation:new u};function ie(i,r,n,a,s,l){var u=1;o(l)&&(u=p.clamp(Math.abs(l),.25,1));var c=i.minimumZoomDistance*u,d=i.maximumZoomDistance,h=a*(s-c);h=p.clamp(h,i._minimumZoomRate,i._maximumZoomRate);var m=(n.endPosition.y-n.startPosition.y)/i._scene.canvas.clientHeight,f=h*(m=Math.min(m,i.maximumMovementRatio));if(!(f>0&&Math.abs(s-c)<1||f<0&&Math.abs(s-d)<1)){s-f<c?f=s-c-1:s-f>d&&(f=s-d);var g=i._scene,v=g.camera,y=g.mode,x=te.orientation;if(x.heading=v.heading,x.pitch=v.pitch,x.roll=v.roll,v.frustum instanceof _)Math.abs(f)>0&&(v.zoomIn(f),v._adjustOrthographicFrustum());else{var w,T=e.equals(r,i._zoomMouseStart),C=i._zoomingOnVector,S=i._rotatingZoom;if(T||(i._zoomMouseStart=e.clone(r,i._zoomMouseStart),o(i._globe)&&(y===E.SCENE2D?(w=v.getPickRay(r,M).origin,w=t.fromElements(w.y,w.z,w.x)):w=me(i,r,N)),o(w)?(i._useZoomWorldPosition=!0,i._zoomWorldPosition=t.clone(w,i._zoomWorldPosition)):i._useZoomWorldPosition=!1,C=i._zoomingOnVector=!1,S=i._rotatingZoom=!1),i._useZoomWorldPosition){var P=y===E.COLUMBUS_VIEW;if(v.positionCartographic.height<2e6&&(S=!0),!T||S){if(y===E.SCENE2D){var b=i._zoomWorldPosition,D=v.position;if(!t.equals(b,D)&&v.positionCartographic.height<2*i._maxCoord.x){var O=v.position.x,I=t.subtract(b,D,R);t.normalize(I,I);var ie=t.distance(b,D)*f/(.5*v.getMagnitude());v.move(I,.5*ie),(v.position.x<0&&O>0||v.position.x>0&&O<0)&&(w=v.getPickRay(r,M).origin,w=t.fromElements(w.y,w.z,w.x),i._zoomWorldPosition=t.clone(w,i._zoomWorldPosition))}}else if(y===E.SCENE3D){var re=t.normalize(v.position,H);if(v.positionCartographic.height<3e3&&Math.abs(t.dot(v.direction,re))<.6)P=!0;else{var ne=g.canvas,oe=L;oe.x=ne.clientWidth/2,oe.y=ne.clientHeight/2;var ae=me(i,oe,V);if(o(ae)&&v.positionCartographic.height<1e6){var se=G;t.clone(v.position,se);var le=i._zoomWorldPosition,ue=k;if(ue=t.normalize(le,ue),t.dot(ue,re)<0)return;var ce=K,de=j;t.clone(v.direction,de),t.add(se,t.multiplyByScalar(de,1e3,J),ce);var he=X,pe=Q;t.subtract(le,se,he),t.normalize(he,pe);var fe=t.dot(re,pe);if(fe>=0)return void(i._zoomMouseStart.x=-1);var _e=Math.acos(-fe),ge=t.magnitude(se),ve=t.magnitude(le),ye=ge-f,xe=t.magnitude(he),we=Math.asin(p.clamp(xe/ve*Math.sin(_e),-1,1))-Math.asin(p.clamp(ye/ve*Math.sin(_e),-1,1))+_e,Te=W;t.normalize(se,Te);var Ce=Y;Ce=t.cross(pe,Te,Ce),Ce=t.normalize(Ce,Ce),t.normalize(t.cross(Te,Ce,J),de),t.multiplyByScalar(t.normalize(ce,J),t.magnitude(ce)-f,ce),t.normalize(se,se),t.multiplyByScalar(se,ye,se);var Ee=q;t.multiplyByScalar(t.add(t.multiplyByScalar(Te,Math.cos(we)-1,$),t.multiplyByScalar(de,Math.sin(we),ee),J),ye,Ee),t.add(se,Ee,se),t.normalize(ce,Te),t.normalize(t.cross(Te,Ce,J),de);var Ae=Z;return t.multiplyByScalar(t.add(t.multiplyByScalar(Te,Math.cos(we)-1,$),t.multiplyByScalar(de,Math.sin(we),ee),J),t.magnitude(ce),Ae),t.add(ce,Ae,ce),t.clone(se,v.position),t.normalize(t.subtract(ce,se,J),v.direction),t.clone(v.direction,v.direction),t.cross(v.direction,v.up,v.right),t.cross(v.right,v.direction,v.up),void v.setView(te)}if(o(ae)){var Se=t.normalize(ae,U),Pe=t.normalize(i._zoomWorldPosition,z),be=t.dot(Pe,Se);if(be>0&&be<1){var De=p.acosClamped(be),Oe=t.cross(Pe,Se,B),Ie=f/(Math.abs(De)>p.toRadians(20)?.75*v.positionCartographic.height:v.positionCartographic.height-f);v.rotate(Oe,De*Ie)}}else P=!0}}i._rotatingZoom=!P}if(!T&&P||C){var Me=A.wgs84ToWindowCoordinates(g,i._zoomWorldPosition,F),Ne=(y!==E.COLUMBUS_VIEW&&e.equals(r,i._zoomMouseStart)&&o(Me)?v.getPickRay(Me,M):v.getPickRay(r,M)).direction;y!==E.COLUMBUS_VIEW&&y!==E.SCENE2D||t.fromElements(Ne.y,Ne.z,Ne.x,Ne),v.move(Ne,f),i._zoomingOnVector=!0}else v.zoomIn(f);v.setView(te)}else v.zoomIn(f)}}}var re=new y,ne=new y,oe=new t;function ae(e,i,r){var n=e._scene.camera,o=n.getPickRay(r.startPosition,re).origin,a=n.getPickRay(r.endPosition,ne).origin;o=t.fromElements(o.y,o.z,o.x,o),a=t.fromElements(a.y,a.z,a.x,a);var s=t.subtract(o,a,oe),l=t.magnitude(s);l>0&&(t.normalize(s,s),n.move(s,l))}function se(e,t,i){o(i.distance)&&(i=i.distance);var r=e._scene.camera;ie(e,t,i,e._zoomFactor,r.getMagnitude())}var le=new e,ue=new e;function ce(t,i,r){if(o(r.angleAndHeight))!function(e,t,i){var r=e._rotateFactor*e._rotateRateRangeAdjustment;r>e._maximumRotateRate&&(r=e._maximumRotateRate);r<e._minimumRotateRate&&(r=e._minimumRotateRate);var n=e._scene,o=n.camera,a=n.canvas,s=(i.endPosition.x-i.startPosition.x)/a.clientWidth;s=Math.min(s,e.maximumMovementRatio);var l=r*s*Math.PI*4;o.twistRight(l)}(t,0,r.angleAndHeight);else{var n=t._scene,a=n.camera,s=n.canvas,l=s.clientWidth,u=s.clientHeight,c=le;c.x=2/l*r.startPosition.x-1,c.y=2/u*(u-r.startPosition.y)-1,c=e.normalize(c,c);var d=ue;d.x=2/l*r.endPosition.x-1,d.y=2/u*(u-r.endPosition.y)-1,d=e.normalize(d,d);var h=p.acosClamped(c.x);c.y<0&&(h=p.TWO_PI-h);var m=p.acosClamped(d.x);d.y<0&&(m=p.TWO_PI-m);var f=m-h;a.twistRight(f)}}var de=new y,he=new t,pe=new t;function me(e,i,r){var n=e._scene,a=e._globe,s=n.camera;if(o(a)){var l;n.pickPositionSupported&&(l=n.pickPositionWorldCoordinates(i,he));var u=s.getPickRay(i,de),c=a.pickWorldCoordinates(u,n,pe);return(o(l)?t.distance(l,s.positionWC):Number.POSITIVE_INFINITY)<(o(c)?t.distance(c,s.positionWC):Number.POSITIVE_INFINITY)?t.clone(l,r):t.clone(c,r)}}var fe=new y,_e=new y,ge=new t,ve=new t,ye=new t,xe=new t,we=new g(t.UNIT_X,0),Te=new e,Ce=new e;function Ee(i,r,n){if(t.equals(r,i._translateMousePosition)||(i._looking=!1),t.equals(r,i._strafeMousePosition)||(i._strafing=!1),i._looking)Ft(i,r,n);else if(i._strafing)qe(i,r,n);else{var a,s=i._scene.camera,l=e.clone(n.startPosition,Te),u=e.clone(n.endPosition,Ce),d=s.getPickRay(l,fe),h=t.clone(t.ZERO,xe),m=t.UNIT_X;if(s.position.z<i._minimumPickingTerrainHeight&&(a=me(i,l,ge),o(a)&&(h.x=a.x)),h.x>s.position.z&&o(a))return t.clone(a,i._strafeStartPosition),i._strafing=!0,qe(i,r,n),void(i._strafeMousePosition=e.clone(r,i._strafeMousePosition));var f=g.fromPointNormal(h,m,we);d=s.getPickRay(l,fe);var _=c.rayPlane(d,f,ge),v=s.getPickRay(u,_e),y=c.rayPlane(v,f,ve);if(!o(_)||!o(y))return i._looking=!0,Ft(i,r,n),void e.clone(r,i._translateMousePosition);var x=t.subtract(_,y,ye),w=x.x;x.x=x.y,x.y=x.z,x.z=w;var T=t.magnitude(x);T>p.EPSILON6&&(t.normalize(x,x),s.move(x,T))}}var Ae=new e,Se=new y,Pe=new t,be=new t,De=new f,Oe=new f,Ie=new t,Me=new g(t.UNIT_X,0),Ne=new t,Fe=new r,Re=new f,Le=new v,Ve=new m,Ue=new t;function ze(i,r,n){if(o(n.angleAndHeight)&&(n=n.angleAndHeight),e.equals(r,i._tiltCenterMousePosition)||(i._tiltCVOffMap=!1,i._looking=!1),i._looking)Ft(i,r,n);else{var a=i._scene.camera,s=i._maxCoord,u=Math.abs(a.position.x)-s.x<0&&Math.abs(a.position.y)-s.y<0;i._tiltCVOffMap||!u||a.position.z>i._minimumPickingTerrainHeight?(i._tiltCVOffMap=!0,function(i,r,n){var a=i._scene,s=a.camera,u=a.canvas,c=Ae;c.x=u.clientWidth/2,c.y=u.clientHeight/2;var d,h=s.getPickRay(c,Se),m=t.UNIT_X,_=h.origin,g=h.direction,v=t.dot(m,g);Math.abs(v)>p.EPSILON6&&(d=-t.dot(m,_)/v);if(!o(d)||d<=0)return i._looking=!0,Ft(i,r,n),void e.clone(r,i._tiltCenterMousePosition);var y=t.multiplyByScalar(g,d,Pe);t.add(_,y,y);var w=a.mapProjection,T=w.ellipsoid;t.fromElements(y.y,y.z,y.x,y);var C=w.unproject(y,Fe);T.cartographicToCartesian(C,y);var E=x.eastNorthUpToFixedFrame(y,T,De),A=i._globe,S=i._ellipsoid;i._globe=void 0,i._ellipsoid=l.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var P=f.clone(s.transform,Re);s._setTransform(E),it(i,r,n,t.UNIT_Z),s._setTransform(P),i._globe=A,i._ellipsoid=S;var b=S.maximumRadius;i._rotateFactor=1/b,i._rotateRateRangeAdjustment=b}(i,r,n)):function(i,r,n){var a,s,u=i._scene,d=u.camera,h=t.UNIT_X;if(e.equals(r,i._tiltCenterMousePosition))a=t.clone(i._tiltCenter,Pe);else{if(d.position.z<i._minimumPickingTerrainHeight&&(a=me(i,r,Pe)),!o(a)){var _,y=(s=d.getPickRay(r,Se)).origin,w=s.direction,T=t.dot(h,w);if(Math.abs(T)>p.EPSILON6&&(_=-t.dot(h,y)/T),!o(_)||_<=0)return i._looking=!0,Ft(i,r,n),void e.clone(r,i._tiltCenterMousePosition);a=t.multiplyByScalar(w,_,Pe),t.add(y,a,a)}e.clone(r,i._tiltCenterMousePosition),t.clone(a,i._tiltCenter)}var C=u.canvas,E=Ae;E.x=C.clientWidth/2,E.y=i._tiltCenterMousePosition.y,s=d.getPickRay(E,Se);var A=t.clone(t.ZERO,Ie);A.x=a.x;var S=g.fromPointNormal(A,h,Me),P=c.rayPlane(s,S,be),b=d._projection,D=b.ellipsoid;t.fromElements(a.y,a.z,a.x,a);var O=b.unproject(a,Fe);D.cartographicToCartesian(O,a);var I,M=x.eastNorthUpToFixedFrame(a,D,De);o(P)?(t.fromElements(P.y,P.z,P.x,P),O=b.unproject(P,Fe),D.cartographicToCartesian(O,P),I=x.eastNorthUpToFixedFrame(P,D,Oe)):I=M;var N=i._globe,F=i._ellipsoid;i._globe=void 0,i._ellipsoid=l.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var R=t.UNIT_Z,L=f.clone(d.transform,Re);d._setTransform(M);var V=t.cross(t.UNIT_Z,t.normalize(d.position,Ne),Ne),U=t.dot(d.right,V);if(it(i,r,n,R,!1,!0),d._setTransform(I),U<0){n.startPosition.y>n.endPosition.y&&(R=void 0);var z=d.constrainedAxis;d.constrainedAxis=void 0,it(i,r,n,R,!0,!1),d.constrainedAxis=z}else it(i,r,n,R,!0,!1);if(o(d.constrainedAxis)){var B=t.cross(d.direction,d.constrainedAxis,Ue);t.equalsEpsilon(B,t.ZERO,p.EPSILON6)||(t.dot(B,d.right)<0&&t.negate(B,B),t.cross(B,d.direction,d.up),t.cross(d.direction,d.up,d.right),t.normalize(d.up,d.up),t.normalize(d.right,d.right))}d._setTransform(L),i._globe=N,i._ellipsoid=F;var H=F.maximumRadius;i._rotateFactor=1/H,i._rotateRateRangeAdjustment=H;var k=t.clone(d.positionWC,Ne);if(d._adjustHeightForTerrain(),!t.equals(d.positionWC,k)){d._setTransform(I),d.worldToCameraCoordinatesPoint(k,k);var G=t.magnitudeSquared(k);t.magnitudeSquared(d.position)>G&&(t.normalize(d.position,d.position),t.multiplyByScalar(d.position,Math.sqrt(G),d.position));var W=t.angleBetween(k,d.position),Y=t.cross(k,d.position,k);t.normalize(Y,Y);var j=v.fromAxisAngle(Y,W,Le),X=m.fromQuaternion(j,Ve);m.multiplyByVector(X,d.direction,d.direction),m.multiplyByVector(X,d.up,d.up),t.cross(d.direction,d.up,d.right),t.cross(d.right,d.direction,d.up),d._setTransform(L)}}(i,r,n)}}var Be=new e,He=new y,ke=new t;function Ge(e,i,r){o(r.distance)&&(r=r.distance);var n=e._scene,a=n.camera,s=n.canvas,l=Be;l.x=s.clientWidth/2,l.y=s.clientHeight/2;var u,c,d=a.getPickRay(l,He);if(a.position.z<e._minimumPickingTerrainHeight&&(u=me(e,l,ke)),o(u))c=t.distance(d.origin,u);else{var h=t.UNIT_X,p=d.origin,m=d.direction;c=-t.dot(h,p)/t.dot(h,m)}ie(e,i,r,e._zoomFactor,c)}var We=new y,Ye=new g(t.UNIT_X,0),je=new t,Xe=new t,Qe=new t;function qe(e,i,r){var n=e._scene,a=n.camera,s=me(e,r.startPosition,Qe);if(o(s)){var l=r.endPosition,u=a.getPickRay(l,We),d=t.clone(a.direction,Xe);n.mode===E.COLUMBUS_VIEW&&t.fromElements(d.z,d.x,d.y,d);var h=g.fromPointNormal(s,d,Ye),p=c.rayPlane(u,h,je);o(p)&&(d=t.subtract(s,p,d),n.mode===E.COLUMBUS_VIEW&&t.fromElements(d.y,d.z,d.x,d),t.add(a.position,d,a.position))}}var Ze=new t,Ke=new r,Je=new t,$e=new l,et=new t;function tt(i,r,n){var a=i._scene.camera;if(f.equals(a.transform,f.IDENTITY)){var s,u,c,d=i._ellipsoid.geodeticSurfaceNormal(a.position,et),h=i._ellipsoid.cartesianToCartographic(a.positionWC,Ke).height,p=i._globe;if(o(p)&&h<i._minimumPickingTerrainHeight&&(c=me(i,n.startPosition,Qe),o(c))){var m=a.getPickRay(n.startPosition,de),_=i._ellipsoid.geodeticSurfaceNormal(c);Math.abs(t.dot(m.direction,_))<.05&&!i._looking&&(i._rotating=!1,i._strafing=!0)}e.equals(r,i._rotateMousePosition)?i._looking?Ft(i,r,n,d):i._rotating?it(i,r,n):i._strafing?(t.clone(c,i._strafeStartPosition),qe(i,0,n)):(s=t.magnitude(i._rotateStartPosition),(u=Je).x=u.y=u.z=s,dt(i,r,n,l.fromCartesian3(u,$e))):(i._looking=!1,i._rotating=!1,i._strafing=!1,o(p)&&h<i._minimumPickingTerrainHeight?o(c)?t.magnitude(a.position)<t.magnitude(c)?(t.clone(c,i._strafeStartPosition),i._strafing=!0,qe(i,0,n)):(s=t.magnitude(c),(u=Je).x=u.y=u.z=s,dt(i,r,n,l.fromCartesian3(u,$e)),t.clone(c,i._rotateStartPosition)):(i._looking=!0,Ft(i,r,n,d)):o(a.pickEllipsoid(n.startPosition,i._ellipsoid,Ze))?(dt(i,r,n,i._ellipsoid),t.clone(Ze,i._rotateStartPosition)):h>i._minimumTrackBallHeight?(i._rotating=!0,it(i,r,n)):(i._looking=!0,Ft(i,r,n,d)),e.clone(r,i._rotateMousePosition))}else it(i,r,n)}function it(e,i,r,a,s,l){s=n(s,!1),l=n(l,!1);var u=e._scene,c=u.camera,d=u.canvas,h=c.constrainedAxis;o(a)&&(c.constrainedAxis=a);var p=t.magnitude(c.position),m=e._rotateFactor*(p-e._rotateRateRangeAdjustment);m>e._maximumRotateRate&&(m=e._maximumRotateRate),m<e._minimumRotateRate&&(m=e._minimumRotateRate);var f=(r.startPosition.x-r.endPosition.x)/d.clientWidth,_=(r.startPosition.y-r.endPosition.y)/d.clientHeight;f=Math.min(f,e.maximumMovementRatio),_=Math.min(_,e.maximumMovementRatio);var g=m*f*Math.PI*2,v=m*_*Math.PI;s||c.rotateRight(g),l||c.rotateUp(v),c.constrainedAxis=h}var rt=i.clone(i.UNIT_W),nt=i.clone(i.UNIT_W),ot=new t,at=new t,st=new t,lt=new t,ut=new e,ct=new e;function dt(i,r,n,a){var s=i._scene.camera,l=e.clone(n.startPosition,ut),u=e.clone(n.endPosition,ct),c=s.pickEllipsoid(l,a,rt),d=s.pickEllipsoid(u,a,nt);if(!o(c)||!o(d))return i._rotating=!0,void it(i,0,n);if(c=s.worldToCameraCoordinates(c,c),d=s.worldToCameraCoordinates(d,d),o(s.constrainedAxis)){var h=s.constrainedAxis,m=t.mostOrthogonalAxis(h,ot);t.cross(m,h,m),t.normalize(m,m);var f=t.cross(h,m,at),_=t.magnitude(c),g=t.dot(h,c),v=Math.acos(g/_),y=t.multiplyByScalar(h,g,st);t.subtract(c,y,y),t.normalize(y,y);var x=t.magnitude(d),w=t.dot(h,d),T=Math.acos(w/x),C=t.multiplyByScalar(h,w,lt);t.subtract(d,C,C),t.normalize(C,C);var E=Math.acos(t.dot(y,m));t.dot(y,f)<0&&(E=p.TWO_PI-E);var A=Math.acos(t.dot(C,m));t.dot(C,f)<0&&(A=p.TWO_PI-A);var S,P=E-A;S=t.equalsEpsilon(h,s.position,p.EPSILON2)?s.right:t.cross(h,s.position,ot);var b,D=t.cross(h,S,ot),O=t.dot(D,t.subtract(c,h,at)),I=t.dot(D,t.subtract(d,h,at));b=O>0&&I>0?T-v:O>0&&I<=0?t.dot(s.position,h)>0?-v-T:v+T:v-T,s.rotateRight(P),s.rotateUp(b)}else{t.normalize(c,c),t.normalize(d,d);var M=t.dot(c,d),N=t.cross(c,d,ot);if(M<1&&!t.equalsEpsilon(N,t.ZERO,p.EPSILON14)){var F=Math.acos(M);s.rotate(N,F)}}}var ht=new t,pt=new r;function mt(e,i,r){o(r.distance)&&(r=r.distance);var n=e._ellipsoid,a=e._scene,s=a.camera,l=a.canvas,u=Be;u.x=l.clientWidth/2,u.y=l.clientHeight/2;var c,d,h=s.getPickRay(u,He),p=n.cartesianToCartographic(s.position,pt).height;p<e._minimumPickingTerrainHeight&&(c=me(e,u,ke)),d=o(c)?t.distance(h.origin,c):p;var m=t.normalize(s.position,ht);ie(e,i,r,e._zoomFactor,d,t.dot(m,s.direction))}var ft=new e,_t=new y,gt=new t,vt=new t,yt=new f,xt=new f,wt=new f,Tt=new v,Ct=new m,Et=new r,At=new t;function St(i,r,n){var a=i._scene.camera;if(f.equals(a.transform,f.IDENTITY))if(o(n.angleAndHeight)&&(n=n.angleAndHeight),e.equals(r,i._tiltCenterMousePosition)||(i._tiltOnEllipsoid=!1,i._looking=!1),i._looking){var s=i._ellipsoid.geodeticSurfaceNormal(a.position,At);Ft(i,r,n,s)}else{var u=i._ellipsoid.cartesianToCartographic(a.position,Et);i._tiltOnEllipsoid||u.height>i._minimumCollisionTerrainHeight?(i._tiltOnEllipsoid=!0,function(i,r,n){var a=i._ellipsoid,s=i._scene,u=s.camera,d=.25*i.minimumZoomDistance,h=a.cartesianToCartographic(u.positionWC,Pt).height;if(h-d-1<p.EPSILON3&&n.endPosition.y-n.startPosition.y<0)return;var m=s.canvas,_=ft;_.x=m.clientWidth/2,_.y=m.clientHeight/2;var g,v=u.getPickRay(_,_t),w=c.rayEllipsoid(v,a);if(o(w))g=y.getPoint(v,w.start,gt);else{if(!(h>i._minimumTrackBallHeight)){i._looking=!0;var T=i._ellipsoid.geodeticSurfaceNormal(u.position,At);return Ft(i,r,n,T),void e.clone(r,i._tiltCenterMousePosition)}var C=c.grazingAltitudeLocation(v,a);if(!o(C))return;var E=a.cartesianToCartographic(C,Et);E.height=0,g=a.cartographicToCartesian(E,gt)}var A=x.eastNorthUpToFixedFrame(g,a,yt),S=i._globe,P=i._ellipsoid;i._globe=void 0,i._ellipsoid=l.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var b=f.clone(u.transform,wt);u._setTransform(A),it(i,0,n,t.UNIT_Z),u._setTransform(b),i._globe=S,i._ellipsoid=P;var D=P.maximumRadius;i._rotateFactor=1/D,i._rotateRateRangeAdjustment=D}(i,r,n)):function(i,r,n){var a,s,u,d=i._ellipsoid,h=i._scene,_=h.camera;if(e.equals(r,i._tiltCenterMousePosition))a=t.clone(i._tiltCenter,gt);else{if(a=me(i,r,gt),!o(a)){if(s=_.getPickRay(r,_t),u=c.rayEllipsoid(s,d),!o(u)){var g=d.cartesianToCartographic(_.position,Et);if(g.height<=i._minimumTrackBallHeight){i._looking=!0;var w=i._ellipsoid.geodeticSurfaceNormal(_.position,At);Ft(i,r,n,w),e.clone(r,i._tiltCenterMousePosition)}return}a=y.getPoint(s,u.start,gt)}e.clone(r,i._tiltCenterMousePosition),t.clone(a,i._tiltCenter)}var T=h.canvas,C=ft;C.x=T.clientWidth/2,C.y=i._tiltCenterMousePosition.y,s=_.getPickRay(C,_t);var E=t.magnitude(a),A=t.fromElements(E,E,E,Je),S=l.fromCartesian3(A,$e);if(u=c.rayEllipsoid(s,S),!o(u))return;var P=t.magnitude(s.origin)>E?u.start:u.stop,b=y.getPoint(s,P,vt),D=x.eastNorthUpToFixedFrame(a,d,yt),O=x.eastNorthUpToFixedFrame(b,S,xt),I=i._globe,M=i._ellipsoid;i._globe=void 0,i._ellipsoid=l.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var N=t.UNIT_Z,F=f.clone(_.transform,wt);_._setTransform(D);var R=t.cross(b,_.positionWC,Ue),L=t.dot(_.rightWC,R);if(it(i,0,n,N,!1,!0),_._setTransform(O),L<0){n.startPosition.y>n.endPosition.y&&(N=void 0);var V=_.constrainedAxis;_.constrainedAxis=void 0,it(i,0,n,N,!0,!1),_.constrainedAxis=V}else it(i,0,n,N,!0,!1);if(o(_.constrainedAxis)){var U=t.cross(_.direction,_.constrainedAxis,Ue);t.equalsEpsilon(U,t.ZERO,p.EPSILON6)||(t.dot(U,_.right)<0&&t.negate(U,U),t.cross(U,_.direction,_.up),t.cross(_.direction,_.up,_.right),t.normalize(_.up,_.up),t.normalize(_.right,_.right))}_._setTransform(F),i._globe=I,i._ellipsoid=M;var z=M.maximumRadius;i._rotateFactor=1/z,i._rotateRateRangeAdjustment=z;var B=t.clone(_.positionWC,Ue);if(_._adjustHeightForTerrain(),!t.equals(_.positionWC,B)){_._setTransform(O),_.worldToCameraCoordinatesPoint(B,B);var H=t.magnitudeSquared(B);t.magnitudeSquared(_.position)>H&&(t.normalize(_.position,_.position),t.multiplyByScalar(_.position,Math.sqrt(H),_.position));var k=t.angleBetween(B,_.position),G=t.cross(B,_.position,B);t.normalize(G,G);var W=v.fromAxisAngle(G,k,Tt),Y=m.fromQuaternion(W,Ct);m.multiplyByVector(Y,_.direction,_.direction),m.multiplyByVector(Y,_.up,_.up),t.cross(_.direction,_.up,_.right),t.cross(_.right,_.direction,_.up),_._setTransform(F)}}(i,r,n)}}var Pt=new r;var bt=new e,Dt=new e,Ot=new y,It=new y,Mt=new t,Nt=new t;function Ft(e,i,r,a){var s=e._scene.camera,l=bt;l.x=r.startPosition.x,l.y=0;var u=Dt;u.x=r.endPosition.x,u.y=0;var c,d,h=s.getPickRay(l,Ot),m=s.getPickRay(u,It),f=0;s.frustum instanceof _?(c=h.origin,d=m.origin,t.add(s.direction,c,c),t.add(s.direction,d,d),t.subtract(c,s.position,c),t.subtract(d,s.position,d),t.normalize(c,c),t.normalize(d,d)):(c=h.direction,d=m.direction);var g=t.dot(c,d);g<1&&(f=Math.acos(g)),f=r.startPosition.x>r.endPosition.x?-f:f;var v=e._horizontalRotationAxis;if(o(a)?s.look(a,-f):o(v)?s.look(v,-f):s.lookLeft(f),l.x=0,l.y=r.startPosition.y,u.x=0,u.y=r.endPosition.y,h=s.getPickRay(l,Ot),m=s.getPickRay(u,It),f=0,s.frustum instanceof _?(c=h.origin,d=m.origin,t.add(s.direction,c,c),t.add(s.direction,d,d),t.subtract(c,s.position,c),t.subtract(d,s.position,d),t.normalize(c,c),t.normalize(d,d)):(c=h.direction,d=m.direction),(g=t.dot(c,d))<1&&(f=Math.acos(g)),f=r.startPosition.y>r.endPosition.y?-f:f,a=n(a,v),o(a)){var y=s.direction,x=t.negate(a,Mt),w=t.equalsEpsilon(y,a,p.EPSILON2),T=t.equalsEpsilon(y,x,p.EPSILON2);if(w||T)(w&&f<0||T&&f>0)&&s.look(s.right,-f);else{g=t.dot(y,a);var C=p.acosClamped(g);f>0&&f>C&&(f=C-p.EPSILON4),g=t.dot(y,x),C=p.acosClamped(g),f<0&&-f>C&&(f=-C+p.EPSILON4);var E=t.cross(a,y,Nt);s.look(E,f)}}else s.lookUp(f)}return P.prototype.update=function(){f.equals(this._scene.camera.transform,f.IDENTITY)?(this._globe=this._scene.globe,this._ellipsoid=o(this._globe)?this._globe.ellipsoid:this._scene.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=l.UNIT_SPHERE),this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight*this._scene.terrainExaggeration,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight*this._scene.terrainExaggeration,this._minimumTrackBallHeight=this.minimumTrackBallHeight*this._scene.terrainExaggeration;var e=this._ellipsoid.maximumRadius;this._rotateFactor=1/e,this._rotateRateRangeAdjustment=e;var i,r,n=this._scene.mode;n===E.SCENE2D?(r=(i=this)._scene.mapMode2D===C.ROTATE,f.equals(f.IDENTITY,i._scene.camera.transform)?(I(i,i.enableTranslate,i.translateEventTypes,ae,i.inertiaTranslate,"_lastInertiaTranslateMovement"),I(i,i.enableZoom,i.zoomEventTypes,se,i.inertiaZoom,"_lastInertiaZoomMovement"),r&&I(i,i.enableRotate,i.tiltEventTypes,ce,i.inertiaSpin,"_lastInertiaTiltMovement")):(I(i,i.enableZoom,i.zoomEventTypes,se,i.inertiaZoom,"_lastInertiaZoomMovement"),r&&I(i,i.enableRotate,i.translateEventTypes,ce,i.inertiaSpin,"_lastInertiaSpinMovement"))):n===E.COLUMBUS_VIEW?(this._horizontalRotationAxis=t.UNIT_Z,function(e){var t=e._scene.camera;if(f.equals(f.IDENTITY,t.transform)){var i=e._tweens;if(e._aggregator.anyButtonDown&&i.removeAll(),I(e,e.enableTilt,e.tiltEventTypes,ze,e.inertiaSpin,"_lastInertiaTiltMovement"),I(e,e.enableTranslate,e.translateEventTypes,Ee,e.inertiaTranslate,"_lastInertiaTranslateMovement"),I(e,e.enableZoom,e.zoomEventTypes,Ge,e.inertiaZoom,"_lastInertiaZoomMovement"),I(e,e.enableLook,e.lookEventTypes,Ft),!(e._aggregator.anyButtonDown||o(e._lastInertiaZoomMovement)&&e._lastInertiaZoomMovement.active||o(e._lastInertiaTranslateMovement)&&e._lastInertiaTranslateMovement.active||i.contains(e._tween))){var r=t.createCorrectPositionTween(e.bounceAnimationTime);o(r)&&(e._tween=i.add(r))}i.update()}else I(e,e.enableRotate,e.rotateEventTypes,it,e.inertiaSpin,"_lastInertiaSpinMovement"),I(e,e.enableZoom,e.zoomEventTypes,mt,e.inertiaZoom,"_lastInertiaZoomMovement")}(this)):n===E.SCENE3D&&(this._horizontalRotationAxis=void 0,function(e){I(e,e.enableRotate,e.rotateEventTypes,tt,e.inertiaSpin,"_lastInertiaSpinMovement"),I(e,e.enableZoom,e.zoomEventTypes,mt,e.inertiaZoom,"_lastInertiaZoomMovement"),I(e,e.enableTilt,e.tiltEventTypes,St,e.inertiaSpin,"_lastInertiaTiltMovement"),I(e,e.enableLook,e.lookEventTypes,Ft)}(this)),this._aggregator.reset()},P.prototype.isDestroyed=function(){return!1},P.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),a(this)},P}.apply(t,r))||(e.exports=n)},1909:function(e,t,i){var r,n;r=[i(24),i(8),i(10),i(20),i(11),i(277),i(14),i(276),i(216),i(756)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u){"use strict";function c(e,i){var r=e;return t(i)&&(r+="+"+i),r}function d(i,r,n){var o=c(u.PINCH,r),a=i._update,s=i._isDown,d=i._eventStartPosition,h=i._pressTime,p=i._releaseTime;a[o]=!0,s[o]=!1,d[o]=new e;var m=i._movement[o];t(m)||(m=i._movement[o]={}),m.distance={startPosition:new e,endPosition:new e},m.angleAndHeight={startPosition:new e,endPosition:new e},m.prevAngle=0,i._eventHandler.setInputAction(function(t){i._buttonsDown++,s[o]=!0,h[o]=new Date,e.lerp(t.position1,t.position2,.5,d[o])},l.PINCH_START,r),i._eventHandler.setInputAction(function(){i._buttonsDown=Math.max(i._buttonsDown-1,0),s[o]=!1,p[o]=new Date},l.PINCH_END,r),i._eventHandler.setInputAction(function(t){if(s[o]){a[o]?(u=t,c=m,e.clone(u.distance.startPosition,c.distance.startPosition),e.clone(u.distance.endPosition,c.distance.endPosition),e.clone(u.angleAndHeight.startPosition,c.angleAndHeight.startPosition),e.clone(u.angleAndHeight.endPosition,c.angleAndHeight.endPosition),a[o]=!1,m.prevAngle=m.angleAndHeight.startPosition.x):(e.clone(t.distance.endPosition,m.distance.endPosition),e.clone(t.angleAndHeight.endPosition,m.angleAndHeight.endPosition));for(var i=m.angleAndHeight.endPosition.x,r=m.prevAngle,l=2*Math.PI;i>=r+Math.PI;)i-=l;for(;i<r-Math.PI;)i+=l;m.angleAndHeight.endPosition.x=-i*n.clientWidth/12,m.angleAndHeight.startPosition.x=-r*n.clientWidth/12}var u,c},l.PINCH_MOVE,r)}function h(i,r){var n=c(u.WHEEL,r),o=i._update;o[n]=!0;var s=i._movement[n];t(s)||(s=i._movement[n]={}),s.startPosition=new e,s.endPosition=new e,i._eventHandler.setInputAction(function(t){var i=15*a.toRadians(t);o[n]?(e.clone(e.ZERO,s.startPosition),s.endPosition.x=0,s.endPosition.y=i,o[n]=!1):s.endPosition.y=s.endPosition.y+i},l.WHEEL,r)}function p(i,r,n){var o=c(n,r),a=i._isDown,s=i._eventStartPosition,d=i._pressTime,h=i._releaseTime;a[o]=!1,s[o]=new e;var p,m,f=i._lastMovement[o];t(f)||(f=i._lastMovement[o]={startPosition:new e,endPosition:new e,valid:!1}),n===u.LEFT_DRAG?(p=l.LEFT_DOWN,m=l.LEFT_UP):n===u.RIGHT_DRAG?(p=l.RIGHT_DOWN,m=l.RIGHT_UP):n===u.MIDDLE_DRAG&&(p=l.MIDDLE_DOWN,m=l.MIDDLE_UP),i._eventHandler.setInputAction(function(t){i._buttonsDown++,f.valid=!1,a[o]=!0,d[o]=new Date,e.clone(t.position,s[o])},p,r),i._eventHandler.setInputAction(function(){i._buttonsDown=Math.max(i._buttonsDown-1,0),a[o]=!1,h[o]=new Date},m,r)}function m(t,i){e.clone(t.startPosition,i.startPosition),e.clone(t.endPosition,i.endPosition)}function f(i,r){var n=i._update,o=i._movement,a=i._lastMovement,s=i._isDown;for(var d in u)if(u.hasOwnProperty(d)){var h=u[d];if(t(h)){var p=c(h,r);n[p]=!0,t(i._lastMovement[p])||(i._lastMovement[p]={startPosition:new e,endPosition:new e,valid:!1}),t(i._movement[p])||(i._movement[p]={startPosition:new e,endPosition:new e})}}i._eventHandler.setInputAction(function(l){for(var d in u)if(u.hasOwnProperty(d)){var h=u[d];if(t(h)){var p=c(h,r);s[p]&&(n[p]?(m(o[p],a[p]),a[p].valid=!0,m(l,o[p]),n[p]=!1):e.clone(l.endPosition,o[p].endPosition))}}e.clone(l.endPosition,i._currentMousePosition)},l.MOUSE_MOVE,r)}function _(i){for(var r in this._eventHandler=new s(i,!0),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new e,h(this,void 0),d(this,void 0,i),p(this,void 0,u.LEFT_DRAG),p(this,void 0,u.RIGHT_DRAG),p(this,void 0,u.MIDDLE_DRAG),f(this,void 0),o)if(o.hasOwnProperty(r)){var n=o[r];t(n)&&(h(this,n),d(this,n,i),p(this,n,u.LEFT_DRAG),p(this,n,u.RIGHT_DRAG),p(this,n,u.MIDDLE_DRAG),f(this,n))}}return i(_.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!(this._update[c(u.WHEEL)]&&this._update[c(u.WHEEL,o.SHIFT)]&&this._update[c(u.WHEEL,o.CTRL)]&&this._update[c(u.WHEEL,o.ALT)]);return this._buttonsDown>0||e}}}),_.prototype.isMoving=function(e,t){var i=c(e,t);return!this._update[i]},_.prototype.getMovement=function(e,t){var i=c(e,t);return this._movement[i]},_.prototype.getLastMovement=function(e,t){var i=c(e,t),r=this._lastMovement[i];if(r.valid)return r},_.prototype.isButtonDown=function(e,t){var i=c(e,t);return this._isDown[i]},_.prototype.getStartMousePosition=function(e,t){if(e===u.WHEEL)return this._currentMousePosition;var i=c(e,t);return this._eventStartPosition[i]},_.prototype.getButtonPressTime=function(e,t){var i=c(e,t);return this._pressTime[i]},_.prototype.getButtonReleaseTime=function(e,t){var i=c(e,t);return this._releaseTime[i]},_.prototype.reset=function(){for(var e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),r(this)},_}.apply(t,r))||(e.exports=n)},1910:function(e,t,i){var r,n;r=[i(8),i(56)],void 0===(n=function(e,t){"use strict";function i(){}return i.getShadowCastShaderKeyword=function(e,t,i,r){return"castShadow "+e+" "+t+" "+i+" "+r},i.createShadowCastVertexShader=function(i,r,n){var o=i.defines.slice(0),a=i.sources.slice(0);o.push("SHADOW_MAP"),n&&o.push("GENERATE_POSITION");var s=t.findPositionVarying(i),l=e(s);if(r&&!l){for(var u=a.length,c=0;c<u;++c)a[c]=t.replaceMain(a[c],"czm_shadow_cast_main");a.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}")}return new t({defines:o,sources:a})},i.createShadowCastFragmentShader=function(i,r,n,o){var a=i.defines.slice(0),s=i.sources.slice(0),l=t.findPositionVarying(i),u=e(l);u||(l="v_positionEC");for(var c=s.length,d=0;d<c;++d)s[d]=t.replaceMain(s[d],"czm_shadow_cast_main");var h="";return r&&(u||(h+="varying vec3 v_positionEC; \n"),h+="uniform vec4 shadowMap_lightPositionEC; \n"),h+=o?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",h+=r?"    float distance = length("+l+"); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    gl_FragColor = czm_packDepth(distance); \n":n?"    gl_FragColor = vec4(1.0); \n":"    gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",h+="} \n",s.push(h),new t({defines:a,sources:s})},i.getShadowReceiveShaderKeyword=function(e,t,i,r){return"receiveShadow "+e._usesDepthTexture+e._polygonOffsetSupported+e._isPointLight+e._isSpotLight+(e._numberOfCascades>1)+e.debugCascadeColors+e.softShadows+t+i+r},i.createShadowReceiveVertexShader=function(e,i,r){var n=e.defines.slice(0),o=e.sources.slice(0);return n.push("SHADOW_MAP"),i&&(r?n.push("GENERATE_POSITION_AND_NORMAL"):n.push("GENERATE_POSITION")),new t({defines:n,sources:o})},i.createShadowReceiveFragmentShader=function(i,r,n,o,a){for(var s=t.findNormalVarying(i),l=!o&&e(s)||o&&a,u=t.findPositionVarying(i),c=e(u),d=r._usesDepthTexture,h=r._polygonOffsetSupported,p=r._isPointLight,m=r._isSpotLight,f=r._numberOfCascades>1,_=r.debugCascadeColors,g=r.softShadows,v=p?r._pointBias:o?r._terrainBias:r._primitiveBias,y=i.defines.slice(0),x=i.sources.slice(0),w=x.length,T=0;T<w;++T)x[T]=t.replaceMain(x[T],"czm_shadow_receive_main");p?y.push("USE_CUBE_MAP_SHADOW"):d&&y.push("USE_SHADOW_DEPTH_TEXTURE"),g&&!p&&y.push("USE_SOFT_SHADOWS"),f&&n&&o&&(l?y.push("ENABLE_VERTEX_LIGHTING"):y.push("ENABLE_DAYNIGHT_SHADING")),n&&v.normalShading&&l&&(y.push("USE_NORMAL_SHADING"),v.normalShadingSmooth>0&&y.push("USE_NORMAL_SHADING_SMOOTH"));var C="";return C+=p?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",C+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nvarying vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n"+(c?"    return vec4("+u+", 1.0); \n":"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n")+"} \nvec3 getNormalEC() \n{ \n"+(l?"    return normalize("+s+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(v.normalOffset&&l?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",C+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",C+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",o?C+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":h||(C+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),C+=p?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":m?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":f?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(_?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",C+="    gl_FragColor.rgb *= visibility; \n} \n",x.push(C),new t({defines:y,sources:x})},i}.apply(t,r))||(e.exports=n)},1911:function(e,t,i){var r,n;r=[i(62),i(24),i(49),i(8),i(20),i(14),i(28),i(60),i(1912),i(1913),i(752),i(363),i(753),i(754),i(499),i(755),i(758)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";function g(){this._sceneFramebuffer=new _;var e=new Array(6);e[0]=new h({fragmentShader:d,textureScale:.125,forcePowerOfTwo:!0,sampleMode:m.LINEAR});var i=e[1]=new h({fragmentShader:u,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:.125,forcePowerOfTwo:!0}),r=this;this._delta=1,this._sigma=2,this._blurStep=new t,e[2]=new h({fragmentShader:c,uniforms:{step:function(){return r._blurStep.x=r._blurStep.y=1/i.outputTexture.width,r._blurStep},delta:function(){return r._delta},sigma:function(){return r._sigma},direction:0},textureScale:.125,forcePowerOfTwo:!0}),e[3]=new h({fragmentShader:c,uniforms:{step:function(){return r._blurStep.x=r._blurStep.y=1/i.outputTexture.width,r._blurStep},delta:function(){return r._delta},sigma:function(){return r._sigma},direction:1},textureScale:.125,forcePowerOfTwo:!0}),e[4]=new h({fragmentShader:d,sampleMode:m.LINEAR}),this._uCenter=new t,this._uRadius=void 0,e[5]=new h({fragmentShader:l,uniforms:{center:function(){return r._uCenter},radius:function(){return r._uRadius},colorTexture2:function(){return r._sceneFramebuffer.getFramebuffer().getColorTexture(0)}}}),this._stages=new p({stages:e});for(var n=new f(this),o=e.length,a=0;a<o;++a)e[a]._textureCache=n;this._textureCache=n,this.length=e.length}g.prototype.get=function(e){return this._stages.get(e)},g.prototype.getStageByName=function(e){for(var t=this._stages.length,i=0;i<t;++i){var r=this._stages.get(i);if(r.name===e)return r}};var v=new i,y=new t,x=new t,w=new a;return g.prototype.clear=function(e,t,i){this._sceneFramebuffer.clear(e,t,i),this._textureCache.clear(e)},g.prototype.update=function(i){var r=i.context,n=i.viewport,l=this._sceneFramebuffer;l.update(r,n);var u=l.getFramebuffer();return this._textureCache.update(r),this._stages.update(r,!1),function(i,r,n){var l=r.uniformState,u=l.sunPositionWC,c=l.view,d=l.viewProjection,h=l.projection,p=a.computeViewportTransformation(n,0,1,w),m=a.multiplyByPoint(c,u,v),f=s.pointToGLWindowCoordinates(d,p,u,y);m.x+=o.SOLAR_RADIUS;var _=s.pointToGLWindowCoordinates(h,p,m,m),g=30*t.magnitude(t.subtract(_,f,_))*2,T=x;T.x=g,T.y=g,i._uCenter=t.clone(f,i._uCenter),i._uRadius=.15*Math.max(T.x,T.y);var C=r.drawingBufferWidth,E=r.drawingBufferHeight,A=i._stages,S=A.get(0),P=S.outputTexture.width,b=S.outputTexture.height,D=new e;D.width=P,D.height=b,p=a.computeViewportTransformation(D,0,1,w),f=s.pointToGLWindowCoordinates(d,p,u,y),T.x*=P/C,T.y*=b/E;var O=S.scissorRectangle;O.x=Math.max(f.x-.5*T.x,0),O.y=Math.max(f.y-.5*T.y,0),O.width=Math.min(T.x,C),O.height=Math.min(T.y,E);for(var I=1;I<4;++I)e.clone(O,A.get(I).scissorRectangle)}(this,r,n),u},g.prototype.execute=function(e){var t=this._sceneFramebuffer.getFramebuffer().getColorTexture(0),i=this._stages,r=i.length;i.get(0).execute(e,t);for(var n=1;n<r;++n)i.get(n).execute(e,i.get(n-1).outputTexture)},g.prototype.copy=function(e,t){if(!r(this._copyColorCommand)){var i=this;this._copyColorCommand=e.createViewportQuadCommand(d,{uniformMap:{colorTexture:function(){return i._stages.get(i._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),n(this)},g}.apply(t,r))||(e.exports=n)},1912:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D colorTexture2;\n\nuniform vec2 center;\nuniform float radius;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color0 = texture2D(colorTexture, v_textureCoordinates);\n    vec4 color1 = texture2D(colorTexture2, v_textureCoordinates);\n\n    float x = length(gl_FragCoord.xy - center) / radius;\n    float t = smoothstep(0.5, 0.8, x);\n    gl_FragColor = mix(color0 + color1, color1, t);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1913:function(e,t,i){var r;void 0===(r=function(){"use strict";return'uniform sampler2D colorTexture;\n\nuniform float avgLuminance;\nuniform float threshold;\nuniform float offset;\n\nvarying vec2 v_textureCoordinates;\n\nfloat key(float avg)\n{\n    float guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\n    return max(0.0, guess) + 0.1;\n}\n\n// See section 9. "The bright-pass filter" of Realtime HDR Rendering\n// http://www.cg.tuwien.ac.at/research/publications/2007/Luksch_2007_RHR/Luksch_2007_RHR-RealtimeHDR%20.pdf\n\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    vec3 xyz = czm_RGBToXYZ(color.rgb);\n    float luminance = xyz.r;\n\n    float scaledLum = key(avgLuminance) * luminance / avgLuminance;\n    float brightLum = max(scaledLum - threshold, 0.0);\n    float brightness = brightLum / (offset + brightLum);\n\n    xyz.r = brightness;\n    gl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n'}.call(t,i,t,e))||(e.exports=r)},1914:function(e,t,i){var r,n;r=[i(62),i(12),i(236),i(8),i(111),i(304),i(14),i(28),i(115),i(174),i(123),i(69),i(251),i(362),i(1915),i(751),i(1916),i(1919),i(1920),i(758),i(44),i(757)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w){"use strict";function T(t,i,r){var n,o,a=t.context,s=[],l=i.frustum.near,u=i.frustum.far,c=t.logarithmicDepthBuffer?t.logarithmicDepthFarToNearRatio:t.farToNearRatio;S(l,u,c,Math.ceil(Math.log(u/l)/Math.log(c)),t.logarithmicDepthBuffer,s,!1,void 0),a.depthTexture&&(n=new f),t._useOIT&&a.depthTexture&&(o=new _(a));var d=new h(a);d.viewport=e.clone(r),this.camera=i,this._cameraClone=p.clone(i),this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.viewport=r,this.passState=d,this.pickFramebuffer=new v(a),this.pickDepthFramebuffer=new g,this.sceneFramebuffer=new y,this.globeDepth=n,this.oit=o,this.pickDepths=[],this.debugGlobeDepths=[],this.frustumCommandsList=s,this.debugFrustumStatistics=void 0,this.updateFrustums=!1}var C=new t,E=new t;function A(e,i,r){var n,o,a,l,u,c=1/Math.max(1,(n=e.position,o=i.position,a=Math.max(Math.abs(n.x),Math.abs(o.x)),l=Math.max(Math.abs(n.y),Math.abs(o.y)),u=Math.max(Math.abs(n.z),Math.abs(o.z)),Math.max(Math.max(a,l),u)));return t.multiplyByScalar(e.position,c,C),t.multiplyByScalar(i.position,c,E),t.equalsEpsilon(C,E,r)&&t.equalsEpsilon(e.direction,i.direction,r)&&t.equalsEpsilon(e.up,i.up,r)&&t.equalsEpsilon(e.right,i.right,r)&&s.equalsEpsilon(e.transform,i.transform,r)&&e.frustum.equalsEpsilon(i.frustum,r)}function S(e,t,i,n,o,a,s,l){a.length=n;for(var u=0;u<n;++u){var c,d;s?(c=Math.min(t-l,e+u*l),d=Math.min(t,c+l)):(d=i*(c=Math.max(e,Math.pow(i,u)*e)),o||(d=Math.min(t,d)));var h=a[u];r(h)?(h.near=c,h.far=d):h=a[u]=new m(c,d)}}function P(e,t,i,n){e.debugShowFrustums&&(i.debugOverlappingFrustums=0);for(var o=t.frustumCommandsList,a=o.length,s=0;s<a;++s){var l=o[s],u=l.near,c=l.far;if(!(n.start>c)){if(n.stop<u)break;var d=i.pass,h=l.indices[d]++;if(l.commands[d][h]=i,e.debugShowFrustums&&(i.debugOverlappingFrustums|=1<<s),i.executeInClosestFrustum)break}}if(e.debugShowFrustums){var p=t.debugFrustumStatistics.commandsInFrustums;p[i.debugOverlappingFrustums]=r(p[i.debugOverlappingFrustums])?p[i.debugOverlappingFrustums]+1:1,++t.debugFrustumStatistics.totalCommands}e.updateDerivedCommands(i)}T.prototype.checkForCameraUpdates=function(e){var t=this.camera,i=this._cameraClone;return A(t,i,a.EPSILON15)?(this._cameraStartFired&&n()-this._cameraMovedTime>e.cameraEventWaitTime&&(t.moveEnd.raiseEvent(),this._cameraStartFired=!1),!1):(this._cameraStartFired||(t.moveStart.raiseEvent(),this._cameraStartFired=!0),this._cameraMovedTime=n(),p.clone(t,i),!0)};var b=new i,D=new o;return T.prototype.createPotentiallyVisibleSet=function(e){var t=e.frameState,i=t.camera,n=i.directionWC,o=i.positionWC,s=e._computeCommandList,l=e._overlayCommandList,u=t.commandList;e.debugShowFrustums&&(this.debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});for(var h=this.frustumCommandsList,p=h.length,m=d.NUMBER_OF_PASSES,f=0;f<p;++f)for(var _=0;_<m;++_)h[f].indices[_]=0;s.length=0,l.length=0;for(var g=Number.MAX_VALUE,v=-Number.MAX_VALUE,y=!1,T=t.shadowState.shadowsEnabled,C=Number.MAX_VALUE,E=-Number.MAX_VALUE,A=Number.MAX_VALUE,O=t.mode===x.SCENE3D?t.occluder:void 0,I=t.cullingVolume,M=b.planes,N=0;N<5;++N)M[N]=I.planes[N];I=b;for(var F=u.length,R=0;R<F;++R){var L=u[R],V=L.pass;if(V===d.COMPUTE)s.push(L);else if(V===d.OVERLAY)l.push(L);else{var U=L.boundingVolume;if(r(U)){if(!e.isVisible(L,I,O))continue;if(D=U.computePlaneDistances(o,n,D),g=Math.min(g,D.start),v=Math.max(v,D.stop),T&&L.receiveShadows&&D.start<w.MAXIMUM_DISTANCE&&!(V===d.GLOBE&&D.start<-100&&D.stop>100)){var z=D.stop-D.start;V!==d.GLOBE&&D.start<100&&(A=Math.min(A,z)),C=Math.min(C,D.start),E=Math.max(E,D.stop)}}else D.start=i.frustum.near,D.stop=i.frustum.far,y=!(L instanceof c);P(e,this,L,D)}}y?(g=i.frustum.near,v=i.frustum.far):(g=Math.min(Math.max(g,i.frustum.near),i.frustum.far),v=Math.max(Math.min(v,i.frustum.far),g),T&&(C=Math.min(Math.max(C,i.frustum.near),i.frustum.far),E=Math.max(Math.min(E,i.frustum.far),C))),T&&(t.shadowState.nearPlane=C,t.shadowState.farPlane=E,t.shadowState.closestObjectSize=A);var B,H=e.mode===x.SCENE2D,k=t.useLogDepth,G=k?e.logarithmicDepthFarToNearRatio:e.farToNearRatio;H?(v=Math.min(v,i.position.z+e.nearToFarDistance2D),g=Math.min(g,v),B=Math.ceil(Math.max(1,v-g)/e.nearToFarDistance2D)):B=Math.ceil(Math.log(v/g)/Math.log(G)),(this.updateFrustums||g!==Number.MAX_VALUE&&(B!==p||0!==h.length&&(g<h[0].near||v>h[p-1].far&&(k||!a.equalsEpsilon(v,h[p-1].far,a.EPSILON8)))))&&(this.updateFrustums=!1,S(g,v,G,B,k,h,H,e.nearToFarDistance2D),this.createPotentiallyVisibleSet(e));var W=t.frustumSplits;W.length=B+1;for(var Y=0;Y<B;++Y)W[Y]=h[Y].near,Y===B-1&&(W[Y+1]=h[Y].far)},T.prototype.destroy=function(){var e,t;this.pickFramebuffer=this.pickFramebuffer&&this.pickFramebuffer.destroy(),this.pickDepthFramebuffer=this.pickDepthFramebuffer&&this.pickDepthFramebuffer.destroy(),this.sceneFramebuffer=this.sceneFramebuffer&&this.sceneFramebuffer.destroy(),this.globeDepth=this.globeDepth&&this.globeDepth.destroy(),this.oit=this.oit&&this.oit.destroy();var i=this.pickDepths,r=this.debugGlobeDepths;for(t=i.length,e=0;e<t;++e)i[e].destroy();for(t=r.length,e=0;e<t;++e)r[e].destroy()},T}.apply(t,r))||(e.exports=n)},1915:function(e,t,i){var r,n;r=[i(9),i(69)],void 0===(n=function(e,t){"use strict";return function(i,r){this.near=e(i,0),this.far=e(r,0);for(var n=t.NUMBER_OF_PASSES,o=new Array(n),a=new Array(n),s=0;s<n;++s)o[s]=[],a[s]=0;this.commands=o,this.indices=a}}.apply(t,r))||(e.exports=n)},1916:function(e,t,i){var r,n;r=[i(62),i(22),i(8),i(20),i(61),i(47),i(123),i(68),i(103),i(66),i(55),i(56),i(63),i(1917),i(1918),i(558),i(559)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";function g(i){this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;var r=i.colorBufferFloat&&i.depthTexture;this._translucentMRTSupport=i.drawBuffers&&r,this._translucentMultipassSupport=!this._translucentMRTSupport&&r,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=void 0,this._alphaFBO=void 0,this._adjustTranslucentFBO=void 0,this._adjustAlphaFBO=void 0,this._opaqueClearCommand=new a({color:new t(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new a({color:new t(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new a({color:new t(0,0,0,0),owner:this}),this._alphaClearCommand=new a({color:new t(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new e,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function v(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function y(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy(),e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy(),e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function x(e){v(e),y(e)}g.prototype.update=function(t,r,a,s){if(this.isSupported()){this._opaqueFBO=a,this._opaqueTexture=a.getColorTexture(0),this._depthStencilTexture=a.depthStencilTexture;var f=this._opaqueTexture.width,_=this._opaqueTexture.height,g=this._accumulationTexture,w=!i(g)||g.width!==f||g.height!==_||s!==this._useHDR;if(w&&function(e,t,i,r){v(e),e._accumulationTexture=new h({context:t,width:i,height:r,pixelFormat:n.RGBA,pixelDatatype:u.FLOAT});var o=new Float32Array(i*r*4);e._revealageTexture=new h({context:t,pixelFormat:n.RGBA,pixelDatatype:u.FLOAT,source:{arrayBufferView:o,width:i,height:r},flipY:!1})}(this,t,f,_),i(this._translucentFBO)&&!w||function(e,t){y(e);var i=o.FRAMEBUFFER_COMPLETE,r=!0;if(e._translucentMRTSupport&&(e._translucentFBO=new l({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new l({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:!1}),e._translucentFBO.status===i&&e._adjustTranslucentFBO.status===i||(y(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO=new l({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._alphaFBO=new l({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new l({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._adjustAlphaFBO=new l({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1});var n=e._translucentFBO.status===i,a=e._alphaFBO.status===i,s=e._adjustTranslucentFBO.status===i,u=e._adjustAlphaFBO.status===i;n&&a&&s&&u||(x(e),e._translucentMultipassSupport=!1,r=!1)}return r}(this,t)){this._useHDR=s;var T,C,E=this;i(this._compositeCommand)||(T=new d({sources:[m]}),this._translucentMRTSupport&&T.defines.push("MRT"),C={u_opaque:function(){return E._opaqueTexture},u_accumulation:function(){return E._accumulationTexture},u_revealage:function(){return E._revealageTexture}},this._compositeCommand=t.createViewportQuadCommand(T,{uniformMap:C,owner:this})),i(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(T=new d({defines:["MRT"],sources:[p]}),C={u_bgColor:function(){return E._translucentMRTClearCommand.color},u_depthTexture:function(){return E._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(T,{uniformMap:C,owner:this})):this._translucentMultipassSupport&&(T=new d({sources:[p]}),C={u_bgColor:function(){return E._translucentMultipassClearCommand.color},u_depthTexture:function(){return E._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(T,{uniformMap:C,owner:this}),C={u_bgColor:function(){return E._alphaClearCommand.color},u_depthTexture:function(){return E._depthStencilTexture}},this._adjustAlphaCommand=t.createViewportQuadCommand(T,{uniformMap:C,owner:this}))),this._viewport.width=f,this._viewport.height=_;var A=!e.equals(this._viewport,r.viewport),S=A!==this._useScissorTest;this._useScissorTest=A,e.equals(this._scissorRectangle,r.viewport)||(this._scissorRectangle=e.clone(r.viewport,this._scissorRectangle),S=!0),i(this._rs)&&e.equals(this._viewport,this._rs.viewport)&&!S||(this._rs=c.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),i(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),i(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)}}};var w={enabled:!0,color:new t(0,0,0,0),equationRgb:f.ADD,equationAlpha:f.ADD,functionSourceRgb:_.ONE,functionDestinationRgb:_.ONE,functionSourceAlpha:_.ZERO,functionDestinationAlpha:_.ONE_MINUS_SOURCE_ALPHA},T={enabled:!0,color:new t(0,0,0,0),equationRgb:f.ADD,equationAlpha:f.ADD,functionSourceRgb:_.ONE,functionDestinationRgb:_.ONE,functionSourceAlpha:_.ONE,functionDestinationAlpha:_.ONE},C={enabled:!0,color:new t(0,0,0,0),equationRgb:f.ADD,equationAlpha:f.ADD,functionSourceRgb:_.ZERO,functionDestinationRgb:_.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:_.ZERO,functionDestinationAlpha:_.ONE_MINUS_SOURCE_ALPHA};function E(e,t,r,n){var o=r[n.id];if(!i(o)){var a=c.getState(n);a.depthMask=!1,a.blending=t,o=c.fromCache(a),r[n.id]=o}return o}var A="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n",S="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n",P="    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n";function b(e,t,r,n){var o=e.shaderCache.getDerivedShaderProgram(t,r);if(!i(o)){var a=t._attributeLocations,s=t.fragmentShaderSource.clone();s.sources=s.sources.map(function(e){return e=(e=(e=(e=d.replaceMain(e,"czm_translucent_main")).replace(/gl_FragColor/g,"czm_gl_FragColor")).replace(/\bdiscard\b/g,"czm_discard = true")).replace(/czm_phong/g,"czm_translucentPhong")}),s.sources.splice(0,0,(-1!==n.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),s.sources.push("void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n"+n+"}\n"),o=e.shaderCache.createDerivedShaderProgram(t,r,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:s,attributeLocations:a})}return o}return g.prototype.createDerivedCommands=function(e,t,r){var n,o,a,l,u,c,d,h;(i(r)||(r={}),this._translucentMRTSupport)?(i(r.translucentCommand)&&(n=r.translucentCommand.shaderProgram,o=r.translucentCommand.renderState),r.translucentCommand=s.shallowClone(e,r.translucentCommand),i(n)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=n,r.translucentCommand.renderState=o):(r.translucentCommand.shaderProgram=function(e,t){return b(e,t,"translucentMRT",A)}(t,e.shaderProgram),r.translucentCommand.renderState=(d=this,h=e.renderState,E(0,w,d._translucentRenderStateCache,h)),r.shaderProgramId=e.shaderProgram.id)):(i(r.translucentCommand)&&(a=r.translucentCommand.shaderProgram,l=r.translucentCommand.renderState,u=r.alphaCommand.shaderProgram,c=r.alphaCommand.renderState),r.translucentCommand=s.shallowClone(e,r.translucentCommand),r.alphaCommand=s.shallowClone(e,r.alphaCommand),i(a)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=a,r.translucentCommand.renderState=l,r.alphaCommand.shaderProgram=u,r.alphaCommand.renderState=c):(r.translucentCommand.shaderProgram=function(e,t){return b(e,t,"translucentMultipass",S)}(t,e.shaderProgram),r.translucentCommand.renderState=function(e,t,i){return E(0,T,e._translucentRenderStateCache,i)}(this,0,e.renderState),r.alphaCommand.shaderProgram=function(e,t){return b(e,t,"alphaMultipass",P)}(t,e.shaderProgram),r.alphaCommand.renderState=function(e,t,i){return E(0,C,e._alphaRenderStateCache,i)}(this,0,e.renderState),r.shaderProgramId=e.shaderProgram.id));return r},g.prototype.executeCommands=function(e,t,r,n,o){this._translucentMRTSupport?function(e,t,r,n,o,a){var s=t.context,l=t.frameState.useLogDepth,u=t._hdr,c=n.framebuffer,d=o.length,h=t.frameState.shadowState.lightShadowsEnabled;n.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(s,n);var p,m=e._opaqueFBO;n.framebuffer=e._translucentFBO;for(var f=0;f<d;++f)p=o[f],p=l?p.derivedCommands.logDepth.command:p,p=u?p.derivedCommands.hdr.command:p,r(h&&p.receiveShadows?p.derivedCommands.oit.shadows.translucentCommand:p.derivedCommands.oit.translucentCommand,t,s,n,m);i(a)&&(p=a.unclassifiedCommand,r(h&&p.receiveShadows?p.derivedCommands.oit.shadows.translucentCommand:p.derivedCommands.oit.translucentCommand,t,s,n,m)),n.framebuffer=c}(this,e,t,r,n,o):function(e,t,r,n,o,a){var s,l,u=t.context,c=t.frameState.useLogDepth,d=t._hdr,h=n.framebuffer,p=o.length,m=t.frameState.shadowState.lightShadowsEnabled;n.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(u,n),n.framebuffer=e._adjustAlphaFBO,e._adjustAlphaCommand.execute(u,n);var f=e._opaqueFBO;for(n.framebuffer=e._translucentFBO,l=0;l<p;++l)s=o[l],s=c?s.derivedCommands.logDepth.command:s,s=d?s.derivedCommands.hdr.command:s,r(m&&s.receiveShadows?s.derivedCommands.oit.shadows.translucentCommand:s.derivedCommands.oit.translucentCommand,t,u,n,f);for(i(a)&&(s=a.unclassifiedCommand,r(m&&s.receiveShadows?s.derivedCommands.oit.shadows.translucentCommand:s.derivedCommands.oit.translucentCommand,t,u,n,f)),n.framebuffer=e._alphaFBO,l=0;l<p;++l)s=o[l],s=c?s.derivedCommands.logDepth.command:s,s=d?s.derivedCommands.hdr.command:s,r(m&&s.receiveShadows?s.derivedCommands.oit.shadows.alphaCommand:s.derivedCommands.oit.alphaCommand,t,u,n,f);i(a)&&(s=a.unclassifiedCommand,r(m&&s.receiveShadows?s.derivedCommands.oit.shadows.alphaCommand:s.derivedCommands.oit.alphaCommand,t,u,n,f)),n.framebuffer=h}(this,e,t,r,n,o)},g.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},g.prototype.clear=function(e,i,r){var n=i.framebuffer;i.framebuffer=this._opaqueFBO,t.clone(r,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,i),i.framebuffer=this._translucentFBO,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,i),this._translucentMultipassSupport&&(i.framebuffer=this._alphaFBO,this._alphaClearCommand.execute(e,i)),i.framebuffer=n},g.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return x(this),i(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),i(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),i(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),r(this)},g}.apply(t,r))||(e.exports=n)},1917:function(e,t,i){var r;void 0===(r=function(){"use strict";return"#ifdef MRT\n#extension GL_EXT_draw_buffers : enable\n#endif\n\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    if (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)\n    {\n#ifdef MRT\n        gl_FragData[0] = u_bgColor;\n        gl_FragData[1] = vec4(u_bgColor.a);\n#else\n        gl_FragColor = u_bgColor;\n#endif\n        return;\n    }\n    \n    discard;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1918:function(e,t,i){var r;void 0===(r=function(){"use strict";return"/**\n * Compositing for Weighted Blended Order-Independent Transparency. See:\n * - http://jcgt.org/published/0002/02/09/\n * - http://casual-effects.blogspot.com/2014/03/weighted-blended-order-independent.html\n */\n\nuniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 opaque = texture2D(u_opaque, v_textureCoordinates);\n    vec4 accum = texture2D(u_accumulation, v_textureCoordinates);\n    float r = texture2D(u_revealage, v_textureCoordinates).r;\n\n#ifdef MRT\n    vec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\n    vec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\n\n    gl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\n\n    if (opaque != czm_backgroundColor)\n    {\n        gl_FragColor.a = 1.0;\n    }\n}\n"}.call(t,i,t,e))||(e.exports=r)},1919:function(e,t,i){var r,n;r=[i(62),i(22),i(9),i(8),i(20),i(61),i(103),i(251),i(66),i(364),i(285),i(63)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d){"use strict";function h(){this._depthStencilTexture=void 0,this._framebuffer=void 0,this._passState=void 0}function p(e){e._framebuffer=e._framebuffer&&e._framebuffer.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy()}return h.prototype.update=function(t,i,n){var u=n.width,c=n.height;r(this._framebuffer)&&u===this._depthStencilTexture.width&&c===this._depthStencilTexture.height||(p(this),function(t,i){var r=i.drawingBufferWidth,n=i.drawingBufferHeight;t._depthStencilTexture=new d({context:i,width:r,height:n,pixelFormat:o.DEPTH_STENCIL,pixelDatatype:l.UNSIGNED_INT_24_8}),t._framebuffer=new a({context:i,depthStencilTexture:t._depthStencilTexture,destroyAttachments:!1});var u=new s(i);u.blendingEnabled=!1,u.scissorTest={enabled:!0,rectangle:new e},u.viewport=new e,t._passState=u}(this,t));var h=this._framebuffer,m=this._passState;return m.framebuffer=h,m.viewport.width=u,m.viewport.height=c,m.scissorTest.rectangle.x=i.x,m.scissorTest.rectangle.y=c-i.y,m.scissorTest.rectangle.width=1,m.scissorTest.rectangle.height=1,m},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return p(this),n(this)},h}.apply(t,r))||(e.exports=n)},1920:function(e,t,i){var r,n;r=[i(62),i(22),i(9),i(8),i(20),i(103),i(251),i(364),i(285),i(63)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u){"use strict";function c(t){var i=new a(t);i.blendingEnabled=!1,i.scissorTest={enabled:!0,rectangle:new e},i.viewport=new e,this._context=t,this._fb=void 0,this._passState=i,this._width=0,this._height=0}c.prototype.begin=function(t,i){var n=this._context,a=i.width,c=i.height;return e.clone(t,this._passState.scissorTest.rectangle),r(this._fb)&&this._width===a&&this._height===c||(this._width=a,this._height=c,this._fb=this._fb&&this._fb.destroy(),this._fb=new o({context:n,colorTextures:[new u({context:n,width:a,height:c})],depthStencilRenderbuffer:new s({context:n,width:a,height:c,format:l.DEPTH_STENCIL})}),this._passState.framebuffer=this._fb),this._passState.viewport.width=a,this._passState.viewport.height=c,this._passState};var d=new t;return c.prototype.end=function(e){for(var n=i(e.width,1),o=i(e.height,1),a=this._context,s=a.readPixels({x:e.x,y:e.y,width:n,height:o,framebuffer:this._fb}),l=Math.max(n,o),u=l*l,c=Math.floor(.5*n),h=Math.floor(.5*o),p=0,m=0,f=0,_=-1,g=0;g<u;++g){if(-c<=p&&p<=c&&-h<=m&&m<=h){var v=4*((h-m)*n+p+c);d.red=t.byteToFloat(s[v]),d.green=t.byteToFloat(s[v+1]),d.blue=t.byteToFloat(s[v+2]),d.alpha=t.byteToFloat(s[v+3]);var y=a.getObjectByPickColor(d);if(r(y))return y}if(p===m||p<0&&-p===m||p>0&&p===1-m){var x=f;f=-_,_=x}p+=f,m+=_}},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._fb=this._fb&&this._fb.destroy(),n(this)},c}.apply(t,r))||(e.exports=n)},1921:function(e,t,i){var r,n;r=[i(12),i(49),i(9),i(8),i(10),i(20),i(26),i(497),i(121),i(14),i(76),i(78),i(68),i(55),i(77),i(56),i(95),i(1922),i(1923),i(87),i(206),i(140),i(44)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T){"use strict";function C(r){r=i(r,a.WGS84),this.show=!0,this._ellipsoid=r,this._command=new h({owner:this}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._spSkyFromSpaceColorCorrect=void 0,this._spSkyFromAtmosphereColorCorrect=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.splitDirection=w.NONE,this._splitDirection=void 0,this._hueSaturationBrightness=new e;var n=new t;n.w=0,n.y=e.maximumComponent(e.multiplyByScalar(r.radii,1.025,new e)),n.z=r.maximumRadius,this._cameraAndRadiiAndDynamicAtmosphereColor=n;var o=this;this._command.uniformMap={u_cameraAndRadiiAndDynamicAtmosphereColor:function(){return o._cameraAndRadiiAndDynamicAtmosphereColor},u_hsbShift:function(){return o._hueSaturationBrightness.x=o.hueShift,o._hueSaturationBrightness.y=o.saturationShift,o._hueSaturationBrightness.z=o.brightnessShift,o._hueSaturationBrightness},u_splitDirection:function(){return o.splitDirection}}}return n(C.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),C.prototype.setDynamicAtmosphereColor=function(e){this._cameraAndRadiiAndDynamicAtmosphereColor.w=e?1:0},C.prototype.update=function(t){if(this.show){var i=t.mode;if((i===T.SCENE3D||i===T.MORPHING)&&t.passes.render){var n=this._command,o=t.context;if(!r(n.vertexArray)){var a=s.createGeometry(new s({radii:e.multiplyByScalar(this._ellipsoid.radii,1.025,new e),slicePartitions:256,stackPartitions:256,vertexFormat:c.POSITION_ONLY}));n.vertexArray=_.fromGeometry({context:o,geometry:a,attributeLocations:l.createAttributeLocations(a),bufferUsage:d.STATIC_DRAW}),n.renderState=p.fromCache({cull:{enabled:!0,face:x.FRONT},blending:y.ALPHA_BLEND,depthMask:!1})}if(this.splitDirection!==this._splitDirection){this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy(),this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy(),this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy(),this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy();var h=new f({defines:["SKY_FROM_SPACE"],sources:[v]}),C=g;this.splitDirection!==w.NONE&&(C=new f({defines:["SPLIT_ATMOSPHERE"],sources:[g]})),this._spSkyFromSpace=m.fromCache({context:o,vertexShaderSource:h,fragmentShaderSource:C}),h=new f({defines:["SKY_FROM_ATMOSPHERE"],sources:[v]}),this._spSkyFromAtmosphere=m.fromCache({context:o,vertexShaderSource:h,fragmentShaderSource:C}),this._splitDirection=this.splitDirection}var E,A=(E=this,!(u.equalsEpsilon(E.hueShift,0,u.EPSILON7)&&u.equalsEpsilon(E.saturationShift,0,u.EPSILON7)&&u.equalsEpsilon(E.brightnessShift,0,u.EPSILON7)));if(A&&(!r(this._spSkyFromSpaceColorCorrect)||!r(this._spSkyFromAtmosphereColorCorrect))){var S=t.context,P=new f({defines:["SKY_FROM_SPACE"],sources:[v]}),b=new f({defines:w.NONE?["COLOR_CORRECT"]:["COLOR_CORRECT","SPLIT_ATMOSPHERE"],sources:[g]});this._spSkyFromSpaceColorCorrect=m.fromCache({context:S,vertexShaderSource:P,fragmentShaderSource:b}),P=new f({defines:["SKY_FROM_ATMOSPHERE"],sources:[v]}),this._spSkyFromAtmosphereColorCorrect=m.fromCache({context:S,vertexShaderSource:P,fragmentShaderSource:b})}var D=t.camera.positionWC,O=e.magnitude(D);return this._cameraAndRadiiAndDynamicAtmosphereColor.x=O,O>this._cameraAndRadiiAndDynamicAtmosphereColor.y?n.shaderProgram=A?this._spSkyFromSpaceColorCorrect:this._spSkyFromSpace:n.shaderProgram=A?this._spSkyFromAtmosphereColorCorrect:this._spSkyFromAtmosphere,n}}},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy(),this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy(),this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy(),this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy(),o(this)},C}.apply(t,r))||(e.exports=n)},1922:function(e,t,i){var r;
/**
 * @license
 * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * * Neither the name of the project nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Modifications made by Analytical Graphics, Inc.
 */void 0===(r=function(){"use strict";return'/**\n * @license\n * Copyright (c) 2000-2005, Sean O\'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Code:  http://sponeil.net/\n // GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor; // Camera height, outer radius, inner radius, dynamic atmosphere color flag\n\n#ifdef SPLIT_ATMOSPHERE\nuniform float u_splitDirection;\n#endif\n\nconst float g = -0.95;\nconst float g2 = g * g;\n\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nvarying vec3 v_positionEC;\n\nvoid main (void)\n{\n#ifdef SPLIT_ATMOSPHERE\n    float splitPosition = czm_imagerySplitPosition;\n    if (u_splitDirection < 0.0 && gl_FragCoord.x > splitPosition) {\n        discard;\n    } else if (u_splitDirection > 0.0 && gl_FragCoord.x < splitPosition) {\n        discard;\n    }\n#endif\n\n    // Extra normalize added for Android\n    float cosAngle = dot(czm_sunDirectionWC, normalize(v_toCamera)) / length(v_toCamera);\n    float rayleighPhase = 0.75 * (1.0 + cosAngle * cosAngle);\n    float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cosAngle * cosAngle) / pow(1.0 + g2 - 2.0 * g * cosAngle, 1.5);\n\n    vec3 rgb = rayleighPhase * v_rayleighColor + miePhase * v_mieColor;\n\n#ifndef HDR\n    const float exposure = 1.1;\n    rgb = vec3(1.0) - exp(-exposure * rgb);\n#endif\n\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n#endif\n\n    // Alter alpha based on how close the viewer is to the ground (1.0 = on ground, 0.0 = at edge of atmosphere)\n    float atmosphereAlpha = clamp((u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.x) / (u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.z), 0.0, 1.0);\n\n    // Alter alpha based on time of day (0.0 = night , 1.0 = day)\n    float nightAlpha = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), 0.0, 1.0) : 1.0;\n    atmosphereAlpha *= pow(nightAlpha, 0.5);\n\n    gl_FragColor = vec4(rgb, mix(rgb.b, 1.0, atmosphereAlpha) * smoothstep(0.0, 1.0, czm_morphTime));\n}\n'}.call(t,i,t,e))||(e.exports=r)},1923:function(e,t,i){var r;
/**
 * @license
 * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * * Neither the name of the project nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Modifications made by Analytical Graphics, Inc.
 */void 0===(r=function(){"use strict";return"/**\n * @license\n * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Code:  http://sponeil.net/\n // GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\nattribute vec4 position;\n\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor; // Camera height, outer radius, inner radius, dynamic atmosphere color flag\n\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * czm_pi;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * czm_pi;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 InvWavelength = vec3(\n    5.60204474633241,  // Red = 1.0 / Math.pow(0.650, 4.0)\n    9.473284437923038, // Green = 1.0 / Math.pow(0.570, 4.0)\n    19.643802610477206); // Blue = 1.0 / Math.pow(0.475, 4.0)\nconst float rayleighScaleDepth = 0.25;\n\nconst int nSamples = 2;\nconst float fSamples = 2.0;\n\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\n\nfloat scale(float cosAngle)\n{\n    float x = 1.0 - cosAngle;\n    return rayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\nvoid main(void)\n{\n    // Unpack attributes\n    float cameraHeight = u_cameraAndRadiiAndDynamicAtmosphereColor.x;\n    float outerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.y;\n    float innerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.z;\n\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n    vec3 positionV3 = position.xyz;\n    vec3 ray = positionV3 - czm_viewerPositionWC;\n    float far = length(ray);\n    ray /= far;\n    float atmosphereScale = 1.0 / (outerRadius - innerRadius);\n\n#ifdef SKY_FROM_SPACE\n    // Calculate the closest intersection of the ray with the outer atmosphere (which is the near point of the ray passing through the atmosphere)\n    float B = 2.0 * dot(czm_viewerPositionWC, ray);\n    float C = cameraHeight * cameraHeight - outerRadius * outerRadius;\n    float det = max(0.0, B*B - 4.0 * C);\n    float near = 0.5 * (-B - sqrt(det));\n\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 start = czm_viewerPositionWC + ray * near;\n    far -= near;\n    float startAngle = dot(ray, start) / outerRadius;\n    float startDepth = exp(-1.0 / rayleighScaleDepth );\n    float startOffset = startDepth*scale(startAngle);\n#else // SKY_FROM_ATMOSPHERE\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 start = czm_viewerPositionWC;\n    float height = length(start);\n    float depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - cameraHeight));\n    float startAngle = dot(ray, start) / height;\n    float startOffset = depth*scale(startAngle);\n#endif\n\n    // Initialize the scattering loop variables\n    float sampleLength = far / fSamples;\n    float scaledLength = sampleLength * atmosphereScale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n\n    // Now loop through the sample rays\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    vec3 lightDir = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? czm_sunPositionWC - czm_viewerPositionWC : czm_viewerPositionWC;\n    lightDir = normalize(lightDir);\n\n    for(int i=0; i<nSamples; i++)\n    {\n        float height = length(samplePoint);\n        float depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - height));\n        float fLightAngle = dot(lightDir, samplePoint) / height;\n        float fCameraAngle = dot(ray, samplePoint) / height;\n        float fScatter = (startOffset + depth*(scale(fLightAngle) - scale(fCameraAngle)));\n        vec3 attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\n        frontColor += attenuate * (depth * scaledLength);\n        samplePoint += sampleRay;\n    }\n\n    // Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader\n    v_mieColor = frontColor * KmESun;\n    v_rayleighColor = frontColor * (InvWavelength * KrESun);\n    v_toCamera = czm_viewerPositionWC - positionV3;\n    gl_Position = czm_modelViewProjection * position;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1924:function(e,t,i){var r,n;r=[i(361),i(12),i(9),i(8),i(20),i(11),i(121),i(28),i(76),i(78),i(233),i(68),i(1925),i(55),i(77),i(56),i(95),i(1926),i(1927),i(87),i(44)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x){"use strict";function w(e){this.sources=e.sources,this._sources=void 0,this.show=i(e.show,!0),this._command=new d({modelMatrix:s.clone(s.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}return w.prototype.update=function(i,n){var o=this;if(this.show&&(i.mode===x.SCENE3D||i.mode===x.MORPHING)&&i.passes.render){var s=i.context;if(this._sources!==this.sources){this._sources=this.sources;var d=this.sources;"string"==typeof d.positiveX?h(s,this._sources).then(function(e){o._cubeMap=o._cubeMap&&o._cubeMap.destroy(),o._cubeMap=e}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new c({context:s,source:d}))}var w=this._command;if(!r(w.vertexArray)){w.uniformMap={u_cubeMap:function(){return o._cubeMap}};var T=e.createGeometry(e.fromDimensions({dimensions:new t(2,2,2),vertexFormat:l.POSITION_ONLY})),C=this._attributeLocations=a.createAttributeLocations(T);w.vertexArray=_.fromGeometry({context:s,geometry:T,attributeLocations:C,bufferUsage:u.STATIC_DRAW}),w.renderState=p.fromCache({blending:y.ALPHA_BLEND})}if(!r(w.shaderProgram)||this._useHdr!==n){var E=new f({defines:[n?"HDR":""],sources:[g]});w.shaderProgram=m.fromCache({context:s,vertexShaderSource:v,fragmentShaderSource:E,attributeLocations:this._attributeLocations}),this._useHdr=n}if(r(this._cubeMap))return w}},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),n(this)},w}.apply(t,r))||(e.exports=n)},1925:function(e,t,i){var r,n;r=[i(16),i(8),i(11),i(37),i(18),i(233)],void 0===(n=function(e,t,i,r,n,o){"use strict";return function(e,t){var i={flipY:!0,preferImageBitmap:!0},a=[r.createIfNeeded(t.positiveX).fetchImage(i),r.createIfNeeded(t.negativeX).fetchImage(i),r.createIfNeeded(t.positiveY).fetchImage(i),r.createIfNeeded(t.negativeY).fetchImage(i),r.createIfNeeded(t.positiveZ).fetchImage(i),r.createIfNeeded(t.negativeZ).fetchImage(i)];return n.all(a,function(t){return new o({context:e,source:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}})})}}.apply(t,r))||(e.exports=n)},1926:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform samplerCube u_cubeMap;\n\nvarying vec3 v_texCoord;\n\nvoid main()\n{\n    vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n    gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1927:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec3 position;\n\nvarying vec3 v_texCoord;\n\nvoid main()\n{\n    vec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n    gl_Position = czm_projection * vec4(p, 1.0);\n    v_texCoord = position.xyz;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1928:function(e,t,i){var r,n;r=[i(33),i(24),i(12),i(49),i(34),i(8),i(10),i(20),i(50),i(14),i(28),i(61),i(45),i(113),i(78),i(404),i(68),i(66),i(55),i(77),i(63),i(95),i(1929),i(1930),i(1931),i(87),i(44),i(212)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P){"use strict";function b(){this.show=!0,this._drawCommand=new _({primitiveType:h.TRIANGLES,boundingVolume:new e,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new e,this._boundingVolume2D=new e,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;var t=this;this._uniformMap={u_texture:function(){return t._texture},u_size:function(){return t._size}}}a(b.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var D=new t,O=new t,I=new r,M=new r;return b.prototype.update=function(r,a,s){if(this.show){var h=r.mode;if(h!==S.SCENE2D&&h!==S.MORPHING&&r.passes.render){var _=r.context,b=a.viewport.width,N=a.viewport.height;if(!o(this._texture)||b!==this._drawingBufferWidth||N!==this._drawingBufferHeight||this._glowFactorDirty||s!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=b,this._drawingBufferHeight=N,this._glowFactorDirty=!1,this._useHdr=s;var F=Math.max(b,N);F=Math.pow(2,Math.ceil(Math.log(F)/Math.log(2))-2),F=Math.max(1,F);var R=s?_.halfFloatingPointTexture?g.HALF_FLOAT:g.FLOAT:g.UNSIGNED_BYTE;this._texture=new x({context:_,width:F,height:F,pixelFormat:d.RGBA,pixelDatatype:R}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var L=this,V={u_radiusTS:function(){return L._radiusTS}};this._commands.computeCommand=new f({fragmentShaderSource:C,outputTexture:this._texture,uniformMap:V,persists:!1,owner:this,postExecute:function(){L._commands.computeCommand=void 0}})}var U=this._drawCommand;if(!o(U.vertexArray)){var z={direction:0},B=new Uint8Array(8);B[0]=0,B[1]=0,B[2]=255,B[3]=0,B[4]=255,B[5]=255,B[6]=0,B[7]=255;var H=p.createVertexBuffer({context:_,typedArray:B,usage:m.STATIC_DRAW}),k=[{index:z.direction,vertexBuffer:H,componentsPerAttribute:2,normalize:!0,componentDatatype:n.UNSIGNED_BYTE}],G=p.createIndexBuffer({context:_,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:m.STATIC_DRAW,indexDatatype:l.UNSIGNED_SHORT});U.vertexArray=new w({context:_,attributes:k,indexBuffer:G}),U.shaderProgram=y.fromCache({context:_,vertexShaderSource:E,fragmentShaderSource:T,attributeLocations:z}),U.renderState=v.fromCache({blending:A.ALPHA_BLEND}),U.uniformMap=this._uniformMap}var W=_.uniformState.sunPositionWC,Y=_.uniformState.sunPositionColumbusView,j=this._boundingVolume,X=this._boundingVolume2D;i.clone(W,j.center),X.center.x=Y.z,X.center.y=Y.x,X.center.z=Y.y,j.radius=u.SOLAR_RADIUS+u.SOLAR_RADIUS*this._glowLengthTS,X.radius=j.radius,h===S.SCENE3D?e.clone(j,U.boundingVolume):h===S.COLUMBUS_VIEW&&e.clone(X,U.boundingVolume);var Q=P.computeActualWgs84Position(r,W,M),q=i.magnitude(i.subtract(Q,r.camera.position,M)),Z=_.uniformState.projection,K=I;K.x=0,K.y=0,K.z=-q,K.w=1;var J=c.multiplyByVector(Z,K,M),$=P.clipToGLWindowCoordinates(a.viewport,J,D);K.x=u.SOLAR_RADIUS;var ee=c.multiplyByVector(Z,K,M),te=P.clipToGLWindowCoordinates(a.viewport,ee,O);return this._size=Math.ceil(t.magnitude(t.subtract(te,$,M))),this._size=2*this._size*(1+2*this._glowLengthTS),this._commands}}},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){var e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),s(this)},b}.apply(t,r))||(e.exports=n)},1929:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D u_texture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color = texture2D(u_texture, v_textureCoordinates);\n    gl_FragColor = czm_gammaCorrect(color);\n}\n"}.call(t,i,t,e))||(e.exports=r)},1930:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform float u_radiusTS;\n\nvarying vec2 v_textureCoordinates;\n\nvec2 rotate(vec2 p, vec2 direction)\n{\n    return vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\n\nvec4 addBurst(vec2 position, vec2 direction, float lengthScalar)\n{\n    vec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\n    float radius = length(rotatedPosition) * lengthScalar;\n    float burst = 1.0 - smoothstep(0.0, 0.55, radius);\n    return vec4(burst);\n}\n\nvoid main()\n{\n    float lengthScalar = 2.0 / sqrt(2.0);\n    vec2 position = v_textureCoordinates - vec2(0.5);\n    float radius = length(position) * lengthScalar;\n    float surface = step(radius, u_radiusTS);\n    vec4 color = vec4(vec2(1.0), surface + 0.2, surface);\n\n    float glow = 1.0 - smoothstep(0.0, 0.55, radius);\n    color.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\n\n    vec4 burst = vec4(0.0);\n\n    // The following loop has been manually unrolled for speed, to\n    // avoid sin() and cos().\n    //\n    //for (float i = 0.4; i < 3.2; i += 1.047) {\n    //    vec2 direction = vec2(sin(i), cos(i));\n    //    burst += 0.4 * addBurst(position, direction, lengthScalar);\n    //\n    //    direction = vec2(sin(i - 0.08), cos(i - 0.08));\n    //    burst += 0.3 * addBurst(position, direction, lengthScalar);\n    //}\n\n    burst += 0.4 * addBurst(position, vec2(0.38942,  0.92106), lengthScalar);  // angle == 0.4\n    burst += 0.4 * addBurst(position, vec2(0.99235,  0.12348), lengthScalar);  // angle == 0.4 + 1.047\n    burst += 0.4 * addBurst(position, vec2(0.60327, -0.79754), lengthScalar);  // angle == 0.4 + 1.047 * 2.0\n\n    burst += 0.3 * addBurst(position, vec2(0.31457,  0.94924), lengthScalar);  // angle == 0.4 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.97931,  0.20239), lengthScalar);  // angle == 0.4 + 1.047 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.66507, -0.74678), lengthScalar);  // angle == 0.4 + 1.047 * 2.0 - 0.08\n\n    // End of manual loop unrolling.\n\n    color += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\n\n    gl_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n"}.call(t,i,t,e))||(e.exports=r)},1931:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec2 direction;\n\nuniform float u_size;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main() \n{\n    vec4 position;\n    if (czm_morphTime == 1.0)\n    {\n        position = vec4(czm_sunPositionWC, 1.0);\n    }\n    else\n    {\n        position = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    }\n    \n    vec4 positionEC = czm_view * position;\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    \n    vec2 halfSize = vec2(u_size * 0.5);\n    halfSize *= ((direction * 2.0) - 1.0);\n    \n    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\n    \n    v_textureCoordinates = direction;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1933:function(e,t,i){e.exports=i.p+"aa1788b9411f5c1262a1e34dc560fc3f.jpg"},1934:function(e,t,i){e.exports=i.p+"1e6c4242b78b7717e8ffce219d09a402.jpg"},1935:function(e,t,i){e.exports=i.p+"2f4b61fff1fc654b6a75d19448eeef25.jpg"},1936:function(e,t,i){e.exports=i.p+"c4725d18f3c291232a047310254e85f2.jpg"},1937:function(e,t,i){e.exports=i.p+"c7fdec957e0d7d159977a6f405a40738.jpg"},1938:function(e,t,i){e.exports=i.p+"e4caa789e1de589c08641109a9a59131.jpg"},1939:function(e,t,i){var r,n;r=[i(9),i(8),i(10),i(20),i(16),i(11),i(500)],void 0===(n=function(e,t,i,r,n,o,a){"use strict";function s(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}return i(s.prototype,{length:{get:function(){return this._length}}}),s.prototype.add=function(i,r){r=e(r,0);var n=this._collections[r];if(!t(n)){(n=new a({destroyPrimitives:!1}))._zIndex=r,this._collections[r]=n;for(var o=this._collectionsArray,s=0;s<o.length&&o[s]._zIndex<r;)s++;o.splice(s,0,n)}return n.add(i),this._length++,i._zIndex=r,i},s.prototype.set=function(e,t){return t===e._zIndex?e:(this.remove(e,!0),this.add(e,t),e)},s.prototype.remove=function(e,t){if(this.contains(e)){var i,r=e._zIndex,n=this._collections[r];return(i=t?n.remove(e):n.removeAndDestroy(e))&&this._length--,0===n.length&&(this._collectionsArray.splice(this._collectionsArray.indexOf(n),1),this._collections[r]=void 0,n.destroy()),i}return!1},s.prototype.removeAll=function(){for(var e=this._collectionsArray,t=0;t<e.length;t++){var i=e[t];i.destroyPrimitives=!0,i.destroy()}this._collections={},this._collectionsArray=[],this._length=0},s.prototype.contains=function(e){if(!t(e))return!1;var i=this._collections[e._zIndex];return t(i)&&i.contains(e)},s.prototype.update=function(e){if(this.show)for(var t=this._collectionsArray,i=0;i<t.length;i++)t[i].update(e)},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this.removeAll(),r(this)},s}.apply(t,r))||(e.exports=n)},1940:function(e,t,i){var r,n;r=[i(81),i(62),i(24),i(12),i(22),i(8),i(20),i(11),i(84),i(173),i(71),i(159),i(152),i(90),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m){"use strict";var f=n.WHITE,_=r.ZERO,g=c.NONE,v=i.ZERO,y=r.ZERO,x=d.CENTER,w=h.CENTER,T=new r,C=new n,E=new r,A=new i,S=new u,P=new u,b=new u,D=new t,O=new l;function I(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function M(t,i){i.collectionChanged.addEventListener(M.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}function N(e,t,i){o(e)&&(e.billboard=void 0,i.removeBillboard(t))}return M.prototype.update=function(e){for(var t=this._items.values,i=this._cluster,r=0,n=t.length;r<n;r++){var a,s,l=t[r],u=l.entity,c=u._billboard,d=l.billboard,h=u.isShowing&&u.isAvailable(e)&&m.getValueOrDefault(c._show,e,!0);if(h&&(s=m.getValueOrUndefined(u._position,e,T),a=m.getValueOrUndefined(c._image,e),h=o(s)&&o(a)),h){m.isConstant(u._position)||(i._clusterDirty=!0),o(d)||((d=i.getBillboard(u)).id=u,d.image=void 0,l.billboard=d),d.show=h,o(d.image)&&l.textureValue===a||(d.image=a,l.textureValue=a),d.position=s,d.color=m.getValueOrDefault(c._color,e,f,C),d.eyeOffset=m.getValueOrDefault(c._eyeOffset,e,_,E),d.heightReference=m.getValueOrDefault(c._heightReference,e,g),d.pixelOffset=m.getValueOrDefault(c._pixelOffset,e,v,A),d.scale=m.getValueOrDefault(c._scale,e,1),d.rotation=m.getValueOrDefault(c._rotation,e,0),d.alignedAxis=m.getValueOrDefault(c._alignedAxis,e,y),d.horizontalOrigin=m.getValueOrDefault(c._horizontalOrigin,e,x),d.verticalOrigin=m.getValueOrDefault(c._verticalOrigin,e,w),d.width=m.getValueOrUndefined(c._width,e),d.height=m.getValueOrUndefined(c._height,e),d.scaleByDistance=m.getValueOrUndefined(c._scaleByDistance,e,S),d.translucencyByDistance=m.getValueOrUndefined(c._translucencyByDistance,e,P),d.pixelOffsetScaleByDistance=m.getValueOrUndefined(c._pixelOffsetScaleByDistance,e,b),d.sizeInMeters=m.getValueOrDefault(c._sizeInMeters,e,!1),d.distanceDisplayCondition=m.getValueOrUndefined(c._distanceDisplayCondition,e,O),d.disableDepthTestDistance=m.getValueOrUndefined(c._disableDepthTestDistance,e);var p=m.getValueOrUndefined(c._imageSubRegion,e,D);o(p)&&d.setImageSubRegion(d._imageId,p)}else N(l,u,i)}return!0},M.prototype.getBoundingSphere=function(e,t){var i=this._items.get(e.id);if(!o(i)||!o(i.billboard))return p.FAILED;var n=i.billboard;if(n.heightReference===c.NONE)t.center=r.clone(n.position,t.center);else{if(!o(n._clampedPosition))return p.PENDING;t.center=r.clone(n._clampedPosition,t.center)}return t.radius=0,p.DONE},M.prototype.isDestroyed=function(){return!1},M.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(M.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return a(this)},M.prototype._onCollectionChanged=function(e,t,i,r){var n,a,s=this._items,l=this._cluster;for(n=t.length-1;n>-1;n--)a=t[n],o(a._billboard)&&o(a._position)&&s.set(a.id,new I(a));for(n=r.length-1;n>-1;n--)a=r[n],o(a._billboard)&&o(a._position)?s.contains(a.id)||s.set(a.id,new I(a)):(N(s.get(a.id),a,l),s.remove(a.id));for(n=i.length-1;n>-1;n--)a=i[n],N(s.get(a.id),a,l),s.remove(a.id)},M}.apply(t,r))||(e.exports=n)},1941:function(e,t,i){var r,n;r=[i(81),i(33),i(16),i(9),i(8),i(20),i(25),i(153),i(122),i(133),i(74),i(102),i(90),i(1948),i(75),i(1949),i(1952),i(763),i(1955),i(1958),i(143),i(1959),i(1962),i(1967),i(1970),i(766),i(767),i(1971),i(1972),i(1976),i(1977)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O){"use strict";var I=[],M=[p,_,f,v,y,w,T,C,E,O];function N(e,t){this.entity=e,this.scene=t;var i=new Array(M.length),r=new a;function n(e){r.raiseEvent(e)}for(var o=new s,l=0;l<i.length;l++){var u=new M[l](e,t);o.add(u.geometryChanged,n),i[l]=u}this.updaters=i,this.geometryChanged=r,this.eventHelper=o,this._removeEntitySubscription=e.definitionChanged.addEventListener(N.prototype._onEntityPropertyChanged,this)}function F(t,i,n,o){n=r(n,t.primitives),o=r(o,t.groundPrimitives),this._scene=t,this._primitives=n,this._groundPrimitives=o,this._entityCollection=void 0,this._addedObjects=new e,this._removedObjects=new e,this._changedObjects=new e;var a=d.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(2*a),this._closedColorBatches=new Array(2*a),this._closedMaterialBatches=new Array(2*a),this._openColorBatches=new Array(2*a),this._openMaterialBatches=new Array(2*a);var s,h=x.supportsMaterialsforEntitiesOnTerrain(t);for(this._supportsMaterialsforEntitiesOnTerrain=h,s=0;s<a;++s)this._outlineBatches[s]=new D(n,t,s,!1),this._outlineBatches[a+s]=new D(n,t,s,!0),this._closedColorBatches[s]=new A(n,c,void 0,!0,s,!0),this._closedColorBatches[a+s]=new A(n,c,void 0,!0,s,!1),this._closedMaterialBatches[s]=new S(n,u,void 0,!0,s,!0),this._closedMaterialBatches[a+s]=new S(n,u,void 0,!0,s,!1),this._openColorBatches[s]=new A(n,c,void 0,!1,s,!0),this._openColorBatches[a+s]=new A(n,c,void 0,!1,s,!1),this._openMaterialBatches[s]=new S(n,u,void 0,!1,s,!0),this._openMaterialBatches[a+s]=new S(n,u,void 0,!1,s,!1);var p=l.NUMBER_OF_CLASSIFICATION_TYPES,m=new Array(p),f=[];if(h)for(s=0;s<p;++s)f.push(new b(o,s,u)),m[s]=new b(o,s,c);else for(s=0;s<p;++s)m[s]=new P(o,s);this._groundColorBatches=m,this._groundMaterialBatches=f,this._dynamicBatch=new g(n,o),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,this._groundMaterialBatches,this._dynamicBatch),this._subscriptions=new e,this._updaterSets=new e,this._entityCollection=i,i.collectionChanged.addEventListener(F.prototype._onCollectionChanged,this),this._onCollectionChanged(i,i.values,I)}N.prototype._onEntityPropertyChanged=function(e,t,i,r){for(var n=this.updaters,o=0;o<n.length;o++)n[o]._onEntityPropertyChanged(e,t,i,r)},N.prototype.forEach=function(e){for(var t=this.updaters,i=0;i<t.length;i++)e(t[i])},N.prototype.destroy=function(){this.eventHelper.removeAll();for(var e=this.updaters,t=0;t<e.length;t++)e[t].destroy();this._removeEntitySubscription(),o(this)},F.prototype.update=function(e){var t,i,r,n,o=this._addedObjects,a=o.values,s=this._removedObjects,l=s.values,u=this._changedObjects,c=u.values,d=this;for(t=c.length-1;t>-1;t--)r=(i=c[t]).id,(n=this._updaterSets.get(r)).entity===i?n.forEach(function(t){d._removeUpdater(t),d._insertUpdaterIntoBatch(e,t)}):(l.push(i),a.push(i));for(t=l.length-1;t>-1;t--)r=(i=l[t]).id,(n=this._updaterSets.get(r)).forEach(this._removeUpdater.bind(this)),n.destroy(),this._updaterSets.remove(r),this._subscriptions.get(r)(),this._subscriptions.remove(r);for(t=a.length-1;t>-1;t--)r=(i=a[t]).id,n=new N(i,this._scene),this._updaterSets.set(r,n),n.forEach(function(t){d._insertUpdaterIntoBatch(e,t)}),this._subscriptions.set(r,n.geometryChanged.addEventListener(F._onGeometryChanged,this));o.removeAll(),s.removeAll(),u.removeAll();var h=!0,p=this._batches,m=p.length;for(t=0;t<m;t++)h=p[t].update(e)&&h;return h};var R=[],L=new t;return F.prototype.getBoundingSphere=function(e,i){for(var r=R,n=L,o=0,a=h.DONE,s=this._batches,l=s.length,u=e.id,c=this._updaterSets.get(u).updaters,d=0;d<c.length;d++)for(var p=c[d],m=0;m<l;m++){if((a=s[m].getBoundingSphere(p,n))===h.PENDING)return h.PENDING;a===h.DONE&&(r[o]=t.clone(n,r[o]),o++)}return 0===o?h.FAILED:(r.length=o,t.fromBoundingSpheres(r,i),h.DONE)},F.prototype.isDestroyed=function(){return!1},F.prototype.destroy=function(){var e;this._entityCollection.collectionChanged.removeEventListener(F.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var r=this._subscriptions.values;for(i=r.length,e=0;e<i;e++)r[e]();this._subscriptions.removeAll();var n=this._updaterSets.values;for(i=n.length,e=0;e<i;e++)n[e].destroy();return this._updaterSets.removeAll(),o(this)},F.prototype._removeUpdater=function(e){for(var t=this._batches,i=t.length,r=0;r<i;r++)t[r].remove(e)},F.prototype._insertUpdaterIntoBatch=function(e,t){if(t.isDynamic)this._dynamicBatch.add(e,t);else{var i;(t.outlineEnabled||t.fillEnabled)&&(i=t.shadowsProperty.getValue(e));var r=d.NUMBER_OF_SHADOW_MODES;if(t.outlineEnabled&&(n(t.terrainOffsetProperty)?this._outlineBatches[r+i].add(e,t):this._outlineBatches[i].add(e,t)),t.fillEnabled)if(t.onTerrain){var o=t.classificationTypeProperty.getValue(e);t.fillMaterialProperty instanceof m?this._groundColorBatches[o].add(e,t):this._groundMaterialBatches[o].add(e,t)}else t.isClosed?t.fillMaterialProperty instanceof m?n(t.terrainOffsetProperty)?this._closedColorBatches[r+i].add(e,t):this._closedColorBatches[i].add(e,t):n(t.terrainOffsetProperty)?this._closedMaterialBatches[r+i].add(e,t):this._closedMaterialBatches[i].add(e,t):t.fillMaterialProperty instanceof m?n(t.terrainOffsetProperty)?this._openColorBatches[r+i].add(e,t):this._openColorBatches[i].add(e,t):n(t.terrainOffsetProperty)?this._openMaterialBatches[r+i].add(e,t):this._openMaterialBatches[i].add(e,t)}},F._onGeometryChanged=function(e){var t=this._removedObjects,i=this._changedObjects,r=e.entity,o=r.id;n(t.get(o))||n(i.get(o))||i.set(o,r)},F.prototype._onCollectionChanged=function(e,t,i){var r,n,o,a=this._addedObjects,s=this._removedObjects,l=this._changedObjects;for(r=i.length-1;r>-1;r--)n=(o=i[r]).id,a.remove(n)||(s.set(n,o),l.remove(n));for(r=t.length-1;r>-1;r--)n=(o=t[r]).id,s.remove(n)?l.set(n,o):a.set(n,o)},F}.apply(t,r))||(e.exports=n)},1942:function(e,t,i){var r;void 0===(r=function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = tangentToEyeMatrix;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}.call(t,i,t,e))||(e.exports=r)},1943:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec3 tangent;\nattribute vec3 bitangent;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_tangentEC = czm_normal * tangent;                       // tangent in eye coordinates\n    v_bitangentEC = czm_normal * bitangent;                   // bitangent in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1944:function(e,t,i){var r;void 0===(r=function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}.call(t,i,t,e))||(e.exports=r)},1945:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1946:function(e,t,i){var r;void 0===(r=function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}.call(t,i,t,e))||(e.exports=r)},1947:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}.call(t,i,t,e))||(e.exports=r)},1948:function(e,t,i){var r,n;r=[i(361),i(326),i(12),i(16),i(22),i(67),i(8),i(10),i(11),i(97),i(64),i(73),i(80),i(147),i(91),i(71),i(133),i(74),i(501),i(75),i(165),i(134),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T){"use strict";var C=i.ZERO,E=new i,A=new i,S=new n;function P(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0,this.offsetAttribute=void 0}function b(e,t){w.call(this,{entity:e,scene:t,geometryOptions:new P(e),geometryPropertyName:"box",observedPropertyNames:["availability","position","orientation","box"]}),this._onEntityPropertyChanged(e,"box",e.box,void 0)}function D(e,t,i){x.call(this,e,t,i)}return a(Object.create)&&(b.prototype=Object.create(w.prototype),b.prototype.constructor=b),s(b.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),b.prototype.createFillGeometryInstance=function(t){var i,r=this._entity,s=r.isAvailable(t),l=new m(s&&r.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),d=this._distanceDisplayConditionProperty.getValue(t),h={show:l,distanceDisplayCondition:u.fromDistanceDisplayCondition(d),color:void 0,offset:void 0};this._materialProperty instanceof y&&(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||s)&&(i=this._materialProperty.color.getValue(t,S)),a(i)||(i=n.WHITE),h.color=o.fromColor(i));return a(this._options.offsetAttribute)&&(h.offset=p.fromCartesian3(T.getValueOrDefault(this._terrainOffsetProperty,t,C,E))),new c({id:r,geometry:e.fromDimensions(this._options),modelMatrix:r.computeModelMatrixForHeightReference(t,r.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:h})},b.prototype.createOutlineGeometryInstance=function(e){var i=this._entity,r=i.isAvailable(e),s=T.getValueOrDefault(this._outlineColorProperty,e,n.BLACK,S),l=this._distanceDisplayConditionProperty.getValue(e),d={show:new m(r&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:o.fromColor(s),distanceDisplayCondition:u.fromDistanceDisplayCondition(l),offset:void 0};return a(this._options.offsetAttribute)&&(d.offset=p.fromCartesian3(T.getValueOrDefault(this._terrainOffsetProperty,e,C,E))),new c({id:i,geometry:t.fromDimensions(this._options),modelMatrix:i.computeModelMatrixForHeightReference(e,i.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:d})},b.prototype._computeCenter=function(e,t){return T.getValueOrUndefined(this._entity.position,e,t)},b.prototype._isHidden=function(e,t){return!a(t.dimensions)||!a(e.position)||w.prototype._isHidden.call(this,e,t)},b.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&T.isConstant(e.orientation)&&t.dimensions.isConstant&&T.isConstant(t.outlineWidth))},b.prototype._setStaticOptions=function(e,t){var i=T.getValueOrDefault(t.heightReference,h.MINIMUM_VALUE,f.NONE),r=this._options;r.vertexFormat=this._materialProperty instanceof y?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat,r.dimensions=t.dimensions.getValue(h.MINIMUM_VALUE,r.dimensions),r.offsetAttribute=i!==f.NONE?d.ALL:void 0},b.prototype._onEntityPropertyChanged=v,b.DynamicGeometryUpdater=D,a(Object.create)&&(D.prototype=Object.create(x.prototype),D.prototype.constructor=D),D.prototype._isHidden=function(e,t,i){var r=T.getValueOrUndefined(e.position,i,A),n=this._options.dimensions;return!a(r)||!a(n)||x.prototype._isHidden.call(this,e,t,i)},D.prototype._setOptions=function(e,t,i){var r=T.getValueOrDefault(t.heightReference,i,f.NONE),n=this._options;n.dimensions=T.getValueOrUndefined(t.dimensions,i,n.dimensions),n.offsetAttribute=r!==f.NONE?d.ALL:void 0},b}.apply(t,r))||(e.exports=n)},1949:function(e,t,i){var r,n;r=[i(144),i(12),i(16),i(22),i(67),i(1950),i(1951),i(8),i(11),i(97),i(64),i(73),i(80),i(147),i(29),i(91),i(170),i(71),i(133),i(74),i(75),i(165),i(134),i(365),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E){"use strict";var A=new r,S=t.ZERO,P=new t,b=new m;function D(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function O(e,t){C.call(this,{entity:e,scene:t,geometryOptions:new D(e),geometryPropertyName:"corridor",observedPropertyNames:["availability","corridor"]}),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}function I(e,t,i){w.call(this,e,t,i)}return s(Object.create)&&(O.prototype=Object.create(C.prototype),O.prototype.constructor=O),O.prototype.createFillGeometryInstance=function(e){var t,i=this._entity,a=i.isAvailable(e),l={show:new f(a&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:u.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof x&&(s(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(t=this._materialProperty.color.getValue(e,A)),s(t)||(t=r.WHITE),l.color=n.fromColor(t));return s(this._options.offsetAttribute)&&(l.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,S,P))),new c({id:i,geometry:new o(this._options),attributes:l})},O.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),o=E.getValueOrDefault(this._outlineColorProperty,e,r.BLACK,A),l={show:new f(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:n.fromColor(o),distanceDisplayCondition:u.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0};return s(this._options.offsetAttribute)&&(l.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,S,P))),new c({id:t,geometry:new a(this._options),attributes:l})},O.prototype._computeCenter=function(e,i){var r=E.getValueOrUndefined(this._entity.corridor.positions,e);if(s(r)&&0!==r.length)return t.clone(r[Math.floor(r.length/2)],i)},O.prototype._isHidden=function(e,t){return!s(t.positions)||!s(t.width)||T.prototype._isHidden.call(this,e,t)},O.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!E.isConstant(t.height)||!E.isConstant(t.extrudedHeight)||!E.isConstant(t.granularity)||!E.isConstant(t.width)||!E.isConstant(t.outlineWidth)||!E.isConstant(t.cornerType)||!E.isConstant(t.zIndex)||this._onTerrain&&!E.isConstant(this._materialProperty)},O.prototype._setStaticOptions=function(t,i){var r=E.getValueOrUndefined(i.height,h.MINIMUM_VALUE),n=E.getValueOrDefault(i.heightReference,h.MINIMUM_VALUE,g.NONE),a=E.getValueOrUndefined(i.extrudedHeight,h.MINIMUM_VALUE),l=E.getValueOrDefault(i.extrudedHeightReference,h.MINIMUM_VALUE,g.NONE);s(a)&&!s(r)&&(r=0);var u=this._options;u.vertexFormat=this._materialProperty instanceof x?y.VERTEX_FORMAT:v.MaterialSupport.TEXTURED.vertexFormat,u.positions=i.positions.getValue(h.MINIMUM_VALUE,u.positions),u.width=i.width.getValue(h.MINIMUM_VALUE),u.granularity=E.getValueOrUndefined(i.granularity,h.MINIMUM_VALUE),u.cornerType=E.getValueOrUndefined(i.cornerType,h.MINIMUM_VALUE),u.offsetAttribute=C.computeGeometryOffsetAttribute(r,n,a,l),u.height=C.getGeometryHeight(r,n),(a=C.getGeometryExtrudedHeight(a,l))===C.CLAMP_TO_GROUND&&(a=e.getMinimumMaximumHeights(o.computeRectangle(u,b)).minimumTerrainHeight),u.extrudedHeight=a},O.DynamicGeometryUpdater=I,s(Object.create)&&(I.prototype=Object.create(w.prototype),I.prototype.constructor=I),I.prototype._isHidden=function(e,t,i){var r=this._options;return!s(r.positions)||!s(r.width)||w.prototype._isHidden.call(this,e,t,i)},I.prototype._setOptions=function(t,i,r){var n=this._options,a=E.getValueOrUndefined(i.height,r),l=E.getValueOrDefault(i.heightReference,r,g.NONE),u=E.getValueOrUndefined(i.extrudedHeight,r),c=E.getValueOrDefault(i.extrudedHeightReference,r,g.NONE);s(u)&&!s(a)&&(a=0),n.positions=E.getValueOrUndefined(i.positions,r),n.width=E.getValueOrUndefined(i.width,r),n.granularity=E.getValueOrUndefined(i.granularity,r),n.cornerType=E.getValueOrUndefined(i.cornerType,r),n.offsetAttribute=C.computeGeometryOffsetAttribute(a,l,u,c),n.height=C.getGeometryHeight(a,l),(u=C.getGeometryExtrudedHeight(u,c))===C.CLAMP_TO_GROUND&&(u=e.getMinimumMaximumHeights(o.computeRectangle(n,b)).minimumTerrainHeight),n.extrudedHeight=u},O}.apply(t,r))||(e.exports=n)},1950:function(e,t,i){var r,n;r=[i(94),i(149),i(33),i(12),i(32),i(16),i(34),i(197),i(761),i(9),i(8),i(10),i(26),i(52),i(53),i(65),i(73),i(50),i(14),i(130),i(45),i(29),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T){"use strict";var C=new r,E=new r,A=new r,S=new r,P=new r,b=new r,D=new r,O=new r;function I(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}function M(e,t,i,n,o,a){var s=e.normals,u=e.tangents,c=e.bitangents,d=r.normalize(r.cross(i,t,D),D);a.normal&&l.addAttribute(s,t,n,o),a.tangent&&l.addAttribute(u,d,n,o),a.bitangent&&l.addAttribute(c,i,n,o)}function N(e,t,i){var n,o,s,u=e.positions,d=e.corners,h=e.endPositions,p=e.lefts,_=e.normals,y=new f,x=0,w=0,T=0;for(o=0;o<u.length;o+=2)x+=s=u[o].length-3,T+=2*s,w+=u[o+1].length-3;for(x+=3,w+=3,o=0;o<d.length;o++){n=d[o];var P=d[o].leftPositions;c(P)?(x+=s=P.length,T+=s):(w+=s=d[o].rightPositions.length,T+=s)}var I,N=c(h);N&&(x+=I=h[0].length-3,w+=I,T+=6*(I/=3));var F,R,L,V,U,z,B=x+w,H=new Float64Array(B),k={normals:t.normal?new Float32Array(B):void 0,tangents:t.tangent?new Float32Array(B):void 0,bitangents:t.bitangent?new Float32Array(B):void 0},G=0,W=B-1,Y=C,j=E,X=I/2,Q=g.createTypedArray(B/3,T),q=0;if(N){z=A,U=S;var Z=h[0];for(Y=r.fromArray(_,0,Y),j=r.fromArray(p,0,j),o=0;o<X;o++)z=r.fromArray(Z,3*(X-1-o),z),U=r.fromArray(Z,3*(X+o),U),l.addAttribute(H,U,G),l.addAttribute(H,z,void 0,W),M(k,Y,j,G,W,t),V=(R=G/3)+1,L=(F=(W-2)/3)-1,Q[q++]=F,Q[q++]=R,Q[q++]=L,Q[q++]=L,Q[q++]=R,Q[q++]=V,G+=3,W-=3}var K,J,$=0,ee=0,te=u[$++],ie=u[$++];for(H.set(te,G),H.set(ie,W-ie.length+1),j=r.fromArray(p,ee,j),s=ie.length-3,o=0;o<s;o+=3)K=i.geodeticSurfaceNormal(r.fromArray(te,o,D),D),J=i.geodeticSurfaceNormal(r.fromArray(ie,s-o,O),O),M(k,Y=r.normalize(r.add(K,J,Y),Y),j,G,W,t),V=(R=G/3)+1,L=(F=(W-2)/3)-1,Q[q++]=F,Q[q++]=R,Q[q++]=L,Q[q++]=L,Q[q++]=R,Q[q++]=V,G+=3,W-=3;for(K=i.geodeticSurfaceNormal(r.fromArray(te,s,D),D),J=i.geodeticSurfaceNormal(r.fromArray(ie,s,O),O),Y=r.normalize(r.add(K,J,Y),Y),ee+=3,o=0;o<d.length;o++){var re,ne,oe,ae=(n=d[o]).leftPositions,se=n.rightPositions,le=b,ue=A,ce=S;if(Y=r.fromArray(_,ee,Y),c(ae)){for(M(k,Y,j,void 0,W,t),W-=3,ne=V,oe=L,re=0;re<ae.length/3;re++)le=r.fromArray(ae,3*re,le),Q[q++]=ne,Q[q++]=oe-re-1,Q[q++]=oe-re,l.addAttribute(H,le,void 0,W),ue=r.fromArray(H,3*(oe-re-1),ue),ce=r.fromArray(H,3*ne,ce),M(k,Y,j=r.normalize(r.subtract(ue,ce,j),j),void 0,W,t),W-=3;le=r.fromArray(H,3*ne,le),ue=r.subtract(r.fromArray(H,3*oe,ue),le,ue),ce=r.subtract(r.fromArray(H,3*(oe-re),ce),le,ce),M(k,Y,j=r.normalize(r.add(ue,ce,j),j),G,void 0,t),G+=3}else{for(M(k,Y,j,G,void 0,t),G+=3,ne=L,oe=V,re=0;re<se.length/3;re++)le=r.fromArray(se,3*re,le),Q[q++]=ne,Q[q++]=oe+re,Q[q++]=oe+re+1,l.addAttribute(H,le,G),ue=r.fromArray(H,3*ne,ue),ce=r.fromArray(H,3*(oe+re),ce),M(k,Y,j=r.normalize(r.subtract(ue,ce,j),j),G,void 0,t),G+=3;le=r.fromArray(H,3*ne,le),ue=r.subtract(r.fromArray(H,3*(oe+re),ue),le,ue),ce=r.subtract(r.fromArray(H,3*oe,ce),le,ce),M(k,Y,j=r.normalize(r.negate(r.add(ce,ue,j),j),j),void 0,W,t),W-=3}for(te=u[$++],ie=u[$++],te.splice(0,3),ie.splice(ie.length-3,3),H.set(te,G),H.set(ie,W-ie.length+1),s=ie.length-3,ee+=3,j=r.fromArray(p,ee,j),re=0;re<ie.length;re+=3)K=i.geodeticSurfaceNormal(r.fromArray(te,re,D),D),J=i.geodeticSurfaceNormal(r.fromArray(ie,s-re,O),O),M(k,Y=r.normalize(r.add(K,J,Y),Y),j,G,W,t),R=(V=G/3)-1,F=(L=(W-2)/3)+1,Q[q++]=F,Q[q++]=R,Q[q++]=L,Q[q++]=L,Q[q++]=R,Q[q++]=V,G+=3,W-=3;G-=3,W+=3}if(M(k,Y=r.fromArray(_,_.length-3,Y),j,G,W,t),N){G+=3,W-=3,z=A,U=S;var de=h[1];for(o=0;o<X;o++)z=r.fromArray(de,3*(I-o-1),z),U=r.fromArray(de,3*o,U),l.addAttribute(H,z,void 0,W),l.addAttribute(H,U,G),M(k,Y,j,G,W,t),R=(V=G/3)-1,F=(L=(W-2)/3)+1,Q[q++]=F,Q[q++]=R,Q[q++]=L,Q[q++]=L,Q[q++]=R,Q[q++]=V,G+=3,W-=3}if(y.position=new m({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:H}),t.st){var he,pe,me=new Float32Array(B/3*2),fe=0;if(N){x/=3,w/=3;var _e,ge=Math.PI/(I+1);pe=1/(x-I+1),he=1/(w-I+1);var ve=I/2;for(o=ve+1;o<I+1;o++)_e=v.PI_OVER_TWO+ge*o,me[fe++]=he*(1+Math.cos(_e)),me[fe++]=.5*(1+Math.sin(_e));for(o=1;o<w-I+1;o++)me[fe++]=o*he,me[fe++]=0;for(o=I;o>ve;o--)_e=v.PI_OVER_TWO-o*ge,me[fe++]=1-he*(1+Math.cos(_e)),me[fe++]=.5*(1+Math.sin(_e));for(o=ve;o>0;o--)_e=v.PI_OVER_TWO-ge*o,me[fe++]=1-pe*(1+Math.cos(_e)),me[fe++]=.5*(1+Math.sin(_e));for(o=x-I;o>0;o--)me[fe++]=o*pe,me[fe++]=1;for(o=1;o<ve+1;o++)_e=v.PI_OVER_TWO+ge*o,me[fe++]=pe*(1+Math.cos(_e)),me[fe++]=.5*(1+Math.sin(_e))}else{for(pe=1/((x/=3)-1),he=1/((w/=3)-1),o=0;o<w;o++)me[fe++]=o*he,me[fe++]=0;for(o=x;o>0;o--)me[fe++]=(o-1)*pe,me[fe++]=1}y.st=new m({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:me})}return t.normal&&(y.normal=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:k.normals})),t.tangent&&(y.tangent=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:k.tangents})),t.bitangent&&(y.bitangent=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:k.bitangents})),{attributes:y,indices:Q}}function F(e,t,i){i[t++]=e[0],i[t++]=e[1],i[t++]=e[2];for(var r=3;r<e.length;r+=3){var n=e[r],o=e[r+1],a=e[r+2];i[t++]=n,i[t++]=o,i[t++]=a,i[t++]=n,i[t++]=o,i[t++]=a}return i[t++]=e[0],i[t++]=e[1],i[t++]=e[2],i}function R(t,i){var n=new T({position:i.position,normal:i.normal||i.bitangent||t.shadowVolume,tangent:i.tangent,bitangent:i.normal||i.bitangent,st:i.st}),o=t.ellipsoid,s=N(l.computePositions(t),n,o),u=t.height,d=t.extrudedHeight,h=s.attributes,p=s.indices,f=h.position.values,v=f.length,x=new Float64Array(6*v),w=new Float64Array(v);w.set(f);var D,O=new Float64Array(4*v);O=F(f=y.scaleToGeodeticHeight(f,u,o),0,O),O=F(w=y.scaleToGeodeticHeight(w,d,o),2*v,O),x.set(f),x.set(w,v),x.set(O,2*v),h.position.values=x,h=function(e,t){if(!(t.normal||t.tangent||t.bitangent||t.st))return e;var i,n,o=e.position.values;(t.normal||t.bitangent)&&(i=e.normal.values,n=e.bitangent.values);var a,s=e.position.values.length/18,u=3*s,c=2*s,d=2*u;if(t.normal||t.bitangent||t.tangent){var h=t.normal?new Float32Array(6*u):void 0,p=t.tangent?new Float32Array(6*u):void 0,m=t.bitangent?new Float32Array(6*u):void 0,f=C,_=E,g=A,v=S,y=P,x=b,w=d;for(a=0;a<u;a+=3){var T=w+d;f=r.fromArray(o,a,f),_=r.fromArray(o,a+u,_),g=r.fromArray(o,(a+3)%u,g),_=r.subtract(_,f,_),g=r.subtract(g,f,g),v=r.normalize(r.cross(_,g,v),v),t.normal&&(l.addAttribute(h,v,T),l.addAttribute(h,v,T+3),l.addAttribute(h,v,w),l.addAttribute(h,v,w+3)),(t.tangent||t.bitangent)&&(x=r.fromArray(i,a,x),t.bitangent&&(l.addAttribute(m,x,T),l.addAttribute(m,x,T+3),l.addAttribute(m,x,w),l.addAttribute(m,x,w+3)),t.tangent&&(y=r.normalize(r.cross(x,v,y),y),l.addAttribute(p,y,T),l.addAttribute(p,y,T+3),l.addAttribute(p,y,w),l.addAttribute(p,y,w+3))),w+=6}if(t.normal){for(h.set(i),a=0;a<u;a+=3)h[a+u]=-i[a],h[a+u+1]=-i[a+1],h[a+u+2]=-i[a+2];e.normal.values=h}else e.normal=void 0;if(t.bitangent?(m.set(n),m.set(n,u),e.bitangent.values=m):e.bitangent=void 0,t.tangent){var D=e.tangent.values;p.set(D),p.set(D,u),e.tangent.values=p}}if(t.st){var O=e.st.values,I=new Float32Array(6*c);I.set(O),I.set(O,c);for(var M=2*c,N=0;N<2;N++){for(I[M++]=O[0],I[M++]=O[1],a=2;a<c;a+=2){var F=O[a],R=O[a+1];I[M++]=F,I[M++]=R,I[M++]=F,I[M++]=R}I[M++]=O[0],I[M++]=O[1]}e.st.values=I}return e}(h,i);var I=v/3;if(t.shadowVolume){var M=h.normal.values;v=M.length;var R=new Float32Array(6*v);for(D=0;D<v;D++)M[D]=-M[D];R.set(M,v),R=F(M,4*v,R),h.extrudeDirection=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:R}),i.normal||(h.normal=void 0)}if(c(t.offsetAttribute)){var L=new Uint8Array(6*I);if(t.offsetAttribute===_.TOP)L=e(L,1,0,I),L=e(L,1,2*I,4*I);else{var V=t.offsetAttribute===_.NONE?0:1;L=e(L,V)}h.applyOffset=new m({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}var U=p.length,z=I+I,B=g.createTypedArray(x.length/3,2*U+3*z);B.set(p);var H,k,G,W,Y=U;for(D=0;D<U;D+=3){var j=p[D],X=p[D+1],Q=p[D+2];B[Y++]=Q+I,B[Y++]=X+I,B[Y++]=j+I}for(D=0;D<z;D+=2)G=(H=D+z)+1,W=(k=H+z)+1,B[Y++]=H,B[Y++]=k,B[Y++]=G,B[Y++]=G,B[Y++]=k,B[Y++]=W;return{attributes:h,indices:B}}var L=new r,V=new r,U=new n;function z(e,t,i,n,o,a){var s=r.subtract(t,e,L);r.normalize(s,s);var l=i.geodeticSurfaceNormal(e,V),u=r.cross(s,l,L);r.multiplyByScalar(u,n,u);var c=o.latitude,d=o.longitude,h=a.latitude,p=a.longitude;r.add(e,u,V),i.cartesianToCartographic(V,U);var m=U.latitude,f=U.longitude;c=Math.min(c,m),d=Math.min(d,f),h=Math.max(h,m),p=Math.max(p,f),r.subtract(e,u,V),i.cartesianToCartographic(V,U),m=U.latitude,f=U.longitude,c=Math.min(c,m),d=Math.min(d,f),h=Math.max(h,m),p=Math.max(p,f),o.latitude=c,o.longitude=d,a.latitude=h,a.longitude=p}var B=new r,H=new r,k=new n,G=new n;function W(e,i,n,o,a){e=I(e,i);var l=t(e,r.equalsEpsilon),u=l.length;if(u<2||n<=0)return new w;var d,h,p=.5*n;if(k.latitude=Number.POSITIVE_INFINITY,k.longitude=Number.POSITIVE_INFINITY,G.latitude=Number.NEGATIVE_INFINITY,G.longitude=Number.NEGATIVE_INFINITY,o===s.ROUNDED){var m=l[0];r.subtract(m,l[1],B),r.normalize(B,B),r.multiplyByScalar(B,p,B),r.add(m,B,H),i.cartesianToCartographic(H,U),d=U.latitude,h=U.longitude,k.latitude=Math.min(k.latitude,d),k.longitude=Math.min(k.longitude,h),G.latitude=Math.max(G.latitude,d),G.longitude=Math.max(G.longitude,h)}for(var f=0;f<u-1;++f)z(l[f],l[f+1],i,p,k,G);var _=l[u-1];r.subtract(_,l[u-2],B),r.normalize(B,B),r.multiplyByScalar(B,p,B),r.add(_,B,H),z(_,H,i,p,k,G),o===s.ROUNDED&&(i.cartesianToCartographic(H,U),d=U.latitude,h=U.longitude,k.latitude=Math.min(k.latitude,d),k.longitude=Math.min(k.longitude,h),G.latitude=Math.max(G.latitude,d),G.longitude=Math.max(G.longitude,h));var g=c(a)?a:new w;return g.north=G.latitude,g.south=k.latitude,g.east=G.longitude,g.west=k.longitude,g}function Y(e){var t=(e=u(e,u.EMPTY_OBJECT)).positions,i=e.width,n=u(e.height,0),o=u(e.extrudedHeight,n);this._positions=t,this._ellipsoid=h.clone(u(e.ellipsoid,h.WGS84)),this._vertexFormat=T.clone(u(e.vertexFormat,T.DEFAULT)),this._width=i,this._height=Math.max(n,o),this._extrudedHeight=Math.min(n,o),this._cornerType=u(e.cornerType,s.ROUNDED),this._granularity=u(e.granularity,v.RADIANS_PER_DEGREE),this._shadowVolume=u(e.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+t.length*r.packedLength+h.packedLength+T.packedLength+7}Y.pack=function(e,t,i){i=u(i,0);var n=e._positions,o=n.length;t[i++]=o;for(var a=0;a<o;++a,i+=r.packedLength)r.pack(n[a],t,i);return h.pack(e._ellipsoid,t,i),i+=h.packedLength,T.pack(e._vertexFormat,t,i),i+=T.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i++]=e._shadowVolume?1:0,t[i]=u(e._offsetAttribute,-1),t};var j=h.clone(h.UNIT_SPHERE),X=new T,Q={positions:void 0,ellipsoid:j,vertexFormat:X,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};return Y.unpack=function(e,t,i){t=u(t,0);for(var n=e[t++],o=new Array(n),a=0;a<n;++a,t+=r.packedLength)o[a]=r.unpack(e,t);var s=h.unpack(e,t,j);t+=h.packedLength;var l=T.unpack(e,t,X);t+=T.packedLength;var d=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t++],g=1===e[t++],v=e[t];return c(i)?(i._positions=o,i._ellipsoid=h.clone(s,i._ellipsoid),i._vertexFormat=T.clone(l,i._vertexFormat),i._width=d,i._height=p,i._extrudedHeight=m,i._cornerType=f,i._granularity=_,i._shadowVolume=g,i._offsetAttribute=-1===v?void 0:v,i):(Q.positions=o,Q.width=d,Q.height=p,Q.extrudedHeight=m,Q.cornerType=f,Q.granularity=_,Q.shadowVolume=g,Q.offsetAttribute=-1===v?void 0:v,new Y(Q))},Y.computeRectangle=function(e,t){var i=(e=u(e,u.EMPTY_OBJECT)).positions,r=e.width;return W(i,u(e.ellipsoid,h.WGS84),r,u(e.cornerType,s.ROUNDED),t)},Y.createGeometry=function(n){var o=n._positions,s=n._width,u=n._ellipsoid;o=I(o,u);var d=t(o,r.equalsEpsilon);if(!(d.length<2||s<=0)){var h,f=n._height,g=n._extrudedHeight,w=!v.equalsEpsilon(f,g,0,v.EPSILON2),T=n._vertexFormat,C={ellipsoid:u,positions:d,width:s,cornerType:n._cornerType,granularity:n._granularity,saveAttributes:!0};if(w)C.height=f,C.extrudedHeight=g,C.shadowVolume=n._shadowVolume,C.offsetAttribute=n._offsetAttribute,h=R(C,T);else if((h=N(l.computePositions(C),T,u)).attributes.position.values=y.scaleToGeodeticHeight(h.attributes.position.values,f,u),c(n._offsetAttribute)){var E=n._offsetAttribute===_.NONE?0:1,A=h.attributes.position.values.length,S=new Uint8Array(A/3);e(S,E),h.attributes.applyOffset=new m({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:S})}var P=h.attributes,b=i.fromVertices(P.position.values,void 0,3);return T.position||(h.attributes.position.values=void 0),new p({attributes:P,indices:h.indices,primitiveType:x.TRIANGLES,boundingSphere:b,offsetAttribute:n._offsetAttribute})}},Y.createShadowVolume=function(e,t,i){var r=e._granularity,n=e._ellipsoid,o=t(r,n),a=i(r,n);return new Y({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:n,granularity:r,extrudedHeight:o,height:a,vertexFormat:T.POSITION_ONLY,shadowVolume:!0})},d(Y.prototype,{rectangle:{get:function(){return c(this._rectangle)||(this._rectangle=W(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}}),Y}.apply(t,r))||(e.exports=n)},1951:function(e,t,i){var r,n;r=[i(94),i(149),i(33),i(12),i(16),i(34),i(197),i(761),i(9),i(8),i(26),i(52),i(53),i(65),i(73),i(50),i(14),i(130),i(45)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v){"use strict";var y=new r,x=new r,w=new r;function T(e,t){var i,n,l,c=[],d=e.positions,m=e.corners,_=e.endPositions,g=new p,v=0,T=0,C=0;for(n=0;n<d.length;n+=2)v+=l=d[n].length-3,C+=l/3*4,T+=d[n+1].length-3;for(v+=3,T+=3,n=0;n<m.length;n++){i=m[n];var E=m[n].leftPositions;u(E)?(v+=l=E.length,C+=l/3*2):(T+=l=m[n].rightPositions.length,C+=l/3*2)}var A,S=u(_);S&&(v+=A=_[0].length-3,T+=A,C+=4*(A/=3));var P,b,D,O,I,M,N=v+T,F=new Float64Array(N),R=0,L=N-1,V=A/2,U=f.createTypedArray(N/3,C+4),z=0;if(U[z++]=R/3,U[z++]=(L-2)/3,S){c.push(R/3),M=y,I=x;var B=_[0];for(n=0;n<V;n++)M=r.fromArray(B,3*(V-1-n),M),I=r.fromArray(B,3*(V+n),I),s.addAttribute(F,I,R),s.addAttribute(F,M,void 0,L),O=(b=R/3)+1,D=(P=(L-2)/3)-1,U[z++]=P,U[z++]=D,U[z++]=b,U[z++]=O,R+=3,L-=3}var H=0,k=d[H++],G=d[H++];for(F.set(k,R),F.set(G,L-G.length+1),l=G.length-3,c.push(R/3,(L-2)/3),n=0;n<l;n+=3)O=(b=R/3)+1,D=(P=(L-2)/3)-1,U[z++]=P,U[z++]=D,U[z++]=b,U[z++]=O,R+=3,L-=3;for(n=0;n<m.length;n++){var W,Y,j=(i=m[n]).leftPositions,X=i.rightPositions,Q=w;if(u(j)){for(L-=3,Y=D,c.push(O),W=0;W<j.length/3;W++)Q=r.fromArray(j,3*W,Q),U[z++]=Y-W-1,U[z++]=Y-W,s.addAttribute(F,Q,void 0,L),L-=3;c.push(Y-Math.floor(j.length/6)),t===a.BEVELED&&c.push((L-2)/3+1),R+=3}else{for(R+=3,Y=O,c.push(D),W=0;W<X.length/3;W++)Q=r.fromArray(X,3*W,Q),U[z++]=Y+W,U[z++]=Y+W+1,s.addAttribute(F,Q,R),R+=3;c.push(Y+Math.floor(X.length/6)),t===a.BEVELED&&c.push(R/3-1),L-=3}for(k=d[H++],G=d[H++],k.splice(0,3),G.splice(G.length-3,3),F.set(k,R),F.set(G,L-G.length+1),l=G.length-3,W=0;W<G.length;W+=3)b=(O=R/3)-1,P=(D=(L-2)/3)+1,U[z++]=P,U[z++]=D,U[z++]=b,U[z++]=O,R+=3,L-=3;R-=3,L+=3,c.push(R/3,(L-2)/3)}if(S){R+=3,L-=3,M=y,I=x;var q=_[1];for(n=0;n<V;n++)M=r.fromArray(q,3*(A-n-1),M),I=r.fromArray(q,3*n,I),s.addAttribute(F,M,void 0,L),s.addAttribute(F,I,R),b=(O=R/3)-1,P=(D=(L-2)/3)+1,U[z++]=P,U[z++]=D,U[z++]=b,U[z++]=O,R+=3,L-=3;c.push(R/3)}else c.push(R/3,(L-2)/3);return U[z++]=R/3,U[z++]=(L-2)/3,g.position=new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:F}),{attributes:g,indices:U,wallIndices:c}}function C(e){var t=(e=l(e,l.EMPTY_OBJECT)).positions,i=e.width,n=l(e.height,0),o=l(e.extrudedHeight,n);this._positions=t,this._ellipsoid=c.clone(l(e.ellipsoid,c.WGS84)),this._width=i,this._height=Math.max(n,o),this._extrudedHeight=Math.min(n,o),this._cornerType=l(e.cornerType,a.ROUNDED),this._granularity=l(e.granularity,_.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*r.packedLength+c.packedLength+6}C.pack=function(e,t,i){i=l(i,0);var n=e._positions,o=n.length;t[i++]=o;for(var a=0;a<o;++a,i+=r.packedLength)r.pack(n[a],t,i);return c.pack(e._ellipsoid,t,i),i+=c.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=l(e._offsetAttribute,-1),t};var E=c.clone(c.UNIT_SPHERE),A={positions:void 0,ellipsoid:E,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};return C.unpack=function(e,t,i){t=l(t,0);for(var n=e[t++],o=new Array(n),a=0;a<n;++a,t+=r.packedLength)o[a]=r.unpack(e,t);var s=c.unpack(e,t,E);t+=c.packedLength;var d=e[t++],h=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t];return u(i)?(i._positions=o,i._ellipsoid=c.clone(s,i._ellipsoid),i._width=d,i._height=h,i._extrudedHeight=p,i._cornerType=m,i._granularity=f,i._offsetAttribute=-1===_?void 0:_,i):(A.positions=o,A.width=d,A.height=h,A.extrudedHeight=p,A.cornerType=m,A.granularity=f,A.offsetAttribute=-1===_?void 0:_,new C(A))},C.createGeometry=function(n){var a=n._positions,l=n._width,c=n._ellipsoid;a=function(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}(a,c);var p=t(a,r.equalsEpsilon);if(!(p.length<2||l<=0)){var y,x=n._height,w=n._extrudedHeight,C=!_.equalsEpsilon(x,w,0,_.EPSILON2),E={ellipsoid:c,positions:p,width:l,cornerType:n._cornerType,granularity:n._granularity,saveAttributes:!1};if(C)E.height=x,E.extrudedHeight=w,E.offsetAttribute=n._offsetAttribute,y=function(t){var i=t.ellipsoid,r=T(s.computePositions(t),t.cornerType),n=r.wallIndices,a=t.height,l=t.extrudedHeight,c=r.attributes,d=r.indices,p=c.position.values,_=p.length,v=new Float64Array(_);v.set(p);var y,x=new Float64Array(2*_);if(p=g.scaleToGeodeticHeight(p,a,i),v=g.scaleToGeodeticHeight(v,l,i),x.set(p),x.set(v,_),c.position.values=x,_/=3,u(t.offsetAttribute)){var w=new Uint8Array(2*_);if(t.offsetAttribute===m.TOP)w=e(w,1,0,_);else{var C=t.offsetAttribute===m.NONE?0:1;w=e(w,C)}c.applyOffset=new h({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}var E=d.length,A=f.createTypedArray(x.length/3,2*(E+n.length));A.set(d);var S,P,b=E;for(y=0;y<E;y+=2){var D=d[y],O=d[y+1];A[b++]=D+_,A[b++]=O+_}for(y=0;y<n.length;y++)P=(S=n[y])+_,A[b++]=S,A[b++]=P;return{attributes:c,indices:A}}(E);else if((y=T(s.computePositions(E),E.cornerType)).attributes.position.values=g.scaleToGeodeticHeight(y.attributes.position.values,x,c),u(n._offsetAttribute)){var A=y.attributes.position.values.length,S=new Uint8Array(A/3),P=n._offsetAttribute===m.NONE?0:1;e(S,P),y.attributes.applyOffset=new h({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:S})}var b=y.attributes,D=i.fromVertices(b.position.values,void 0,3);return new d({attributes:b,indices:y.indices,primitiveType:v.LINES,boundingSphere:D,offsetAttribute:n._offsetAttribute})}},C}.apply(t,r))||(e.exports=n)},1952:function(e,t,i){var r,n;r=[i(12),i(16),i(22),i(67),i(1953),i(1954),i(8),i(10),i(11),i(97),i(64),i(73),i(80),i(147),i(91),i(71),i(133),i(74),i(501),i(75),i(165),i(134),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T){"use strict";var C=e.ZERO,E=new e,A=new e,S=new i;function P(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function b(e,t){w.call(this,{entity:e,scene:t,geometryOptions:new P(e),geometryPropertyName:"cylinder",observedPropertyNames:["availability","position","orientation","cylinder"]}),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}function D(e,t,i){x.call(this,e,t,i)}return a(Object.create)&&(b.prototype=Object.create(w.prototype),b.prototype.constructor=b),s(b.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),b.prototype.createFillGeometryInstance=function(e){var t,o=this._entity,s=o.isAvailable(e),l=new m(s&&o.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),d=this._distanceDisplayConditionProperty.getValue(e),h={show:l,distanceDisplayCondition:u.fromDistanceDisplayCondition(d),color:void 0,offset:void 0};this._materialProperty instanceof y&&(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||s)&&(t=this._materialProperty.color.getValue(e,S)),a(t)||(t=i.WHITE),h.color=r.fromColor(t));return a(this._options.offsetAttribute)&&(h.offset=p.fromCartesian3(T.getValueOrDefault(this._terrainOffsetProperty,e,C,E))),new c({id:o,geometry:new n(this._options),modelMatrix:o.computeModelMatrixForHeightReference(e,o.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:h})},b.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,n=t.isAvailable(e),s=T.getValueOrDefault(this._outlineColorProperty,e,i.BLACK,S),l=this._distanceDisplayConditionProperty.getValue(e),d={show:new m(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(s),distanceDisplayCondition:u.fromDistanceDisplayCondition(l),offset:void 0};return a(this._options.offsetAttribute)&&(d.offset=p.fromCartesian3(T.getValueOrDefault(this._terrainOffsetProperty,e,C,E))),new c({id:t,geometry:new o(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:d})},b.prototype._computeCenter=function(e,t){return T.getValueOrUndefined(this._entity.position,e,t)},b.prototype._isHidden=function(e,t){return!a(e.position)||!a(t.length)||!a(t.topRadius)||!a(t.bottomRadius)||w.prototype._isHidden.call(this,e,t)},b.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&T.isConstant(e.orientation)&&t.length.isConstant&&t.topRadius.isConstant&&t.bottomRadius.isConstant&&T.isConstant(t.slices)&&T.isConstant(t.outlineWidth)&&T.isConstant(t.numberOfVerticalLines))},b.prototype._setStaticOptions=function(e,t){var i=T.getValueOrDefault(t.heightReference,h.MINIMUM_VALUE,f.NONE),r=this._options;r.vertexFormat=this._materialProperty instanceof y?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat,r.length=t.length.getValue(h.MINIMUM_VALUE),r.topRadius=t.topRadius.getValue(h.MINIMUM_VALUE),r.bottomRadius=t.bottomRadius.getValue(h.MINIMUM_VALUE),r.slices=T.getValueOrUndefined(t.slices,h.MINIMUM_VALUE),r.numberOfVerticalLines=T.getValueOrUndefined(t.numberOfVerticalLines,h.MINIMUM_VALUE),r.offsetAttribute=i!==f.NONE?d.ALL:void 0},b.prototype._onEntityPropertyChanged=v,b.DynamicGeometryUpdater=D,a(Object.create)&&(D.prototype=Object.create(x.prototype),D.prototype.constructor=D),D.prototype._isHidden=function(e,t,i){var r=this._options,n=T.getValueOrUndefined(e.position,i,A);return!a(n)||!a(r.length)||!a(r.topRadius)||!a(r.bottomRadius)||x.prototype._isHidden.call(this,e,t,i)},D.prototype._setOptions=function(e,t,i){var r=T.getValueOrDefault(t.heightReference,i,f.NONE),n=this._options;n.length=T.getValueOrUndefined(t.length,i),n.topRadius=T.getValueOrUndefined(t.topRadius,i),n.bottomRadius=T.getValueOrUndefined(t.bottomRadius,i),n.slices=T.getValueOrUndefined(t.slices,i),n.numberOfVerticalLines=T.getValueOrUndefined(t.numberOfVerticalLines,i),n.offsetAttribute=r!==f.NONE?d.ALL:void 0},b}.apply(t,r))||(e.exports=n)},1953:function(e,t,i){var r,n;r=[i(94),i(33),i(24),i(12),i(34),i(762),i(9),i(8),i(11),i(52),i(53),i(65),i(73),i(50),i(14),i(45),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=new i,v=new r,y=new r,x=new r,w=new r;function T(e){var t=(e=a(e,a.EMPTY_OBJECT)).length,i=e.topRadius,r=e.bottomRadius,n=a(e.vertexFormat,_.DEFAULT),o=a(e.slices,128);this._length=t,this._topRadius=i,this._bottomRadius=r,this._vertexFormat=_.clone(n),this._slices=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}T.packedLength=_.packedLength+5,T.pack=function(e,t,i){return i=a(i,0),_.pack(e._vertexFormat,t,i),i+=_.packedLength,t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i]=a(e._offsetAttribute,-1),t};var C,E=new _,A={vertexFormat:E,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};return T.unpack=function(e,t,i){t=a(t,0);var r=_.unpack(e,t,E);t+=_.packedLength;var n=e[t++],o=e[t++],l=e[t++],u=e[t++],c=e[t];return s(i)?(i._vertexFormat=_.clone(r,i._vertexFormat),i._length=n,i._topRadius=o,i._bottomRadius=l,i._slices=u,i._offsetAttribute=-1===c?void 0:c,i):(A.length=n,A.topRadius=o,A.bottomRadius=l,A.slices=u,A.offsetAttribute=-1===c?void 0:c,new T(A))},T.createGeometry=function(a){var l=a._length,_=a._topRadius,T=a._bottomRadius,C=a._vertexFormat,E=a._slices;if(!(l<=0||_<0||T<0||0===_&&0===T)){var A,S=E+E,P=E+S,b=S+S,D=o.computePositions(l,_,T,E,!0),O=C.st?new Float32Array(2*b):void 0,I=C.normal?new Float32Array(3*b):void 0,M=C.tangent?new Float32Array(3*b):void 0,N=C.bitangent?new Float32Array(3*b):void 0,F=C.normal||C.tangent||C.bitangent;if(F){var R=C.tangent||C.bitangent,L=0,V=0,U=0,z=Math.atan2(T-_,l),B=v;B.z=Math.sin(z);var H=Math.cos(z),k=x,G=y;for(A=0;A<E;A++){var W=A/E*m.TWO_PI,Y=H*Math.cos(W),j=H*Math.sin(W);F&&(B.x=Y,B.y=j,R&&(k=r.normalize(r.cross(r.UNIT_Z,B,k),k)),C.normal&&(I[L++]=B.x,I[L++]=B.y,I[L++]=B.z,I[L++]=B.x,I[L++]=B.y,I[L++]=B.z),C.tangent&&(M[V++]=k.x,M[V++]=k.y,M[V++]=k.z,M[V++]=k.x,M[V++]=k.y,M[V++]=k.z),C.bitangent&&(G=r.normalize(r.cross(B,k,G),G),N[U++]=G.x,N[U++]=G.y,N[U++]=G.z,N[U++]=G.x,N[U++]=G.y,N[U++]=G.z))}for(A=0;A<E;A++)C.normal&&(I[L++]=0,I[L++]=0,I[L++]=-1),C.tangent&&(M[V++]=1,M[V++]=0,M[V++]=0),C.bitangent&&(N[U++]=0,N[U++]=-1,N[U++]=0);for(A=0;A<E;A++)C.normal&&(I[L++]=0,I[L++]=0,I[L++]=1),C.tangent&&(M[V++]=1,M[V++]=0,M[V++]=0),C.bitangent&&(N[U++]=0,N[U++]=1,N[U++]=0)}var X=12*E-12,Q=p.createTypedArray(b,X),q=0,Z=0;for(A=0;A<E-1;A++)Q[q++]=Z,Q[q++]=Z+2,Q[q++]=Z+3,Q[q++]=Z,Q[q++]=Z+3,Q[q++]=Z+1,Z+=2;for(Q[q++]=S-2,Q[q++]=0,Q[q++]=1,Q[q++]=S-2,Q[q++]=1,Q[q++]=S-1,A=1;A<E-1;A++)Q[q++]=S+A+1,Q[q++]=S+A,Q[q++]=S;for(A=1;A<E-1;A++)Q[q++]=P,Q[q++]=P+A,Q[q++]=P+A+1;var K=0;if(C.st){var J=Math.max(_,T);for(A=0;A<b;A++){var $=r.fromArray(D,3*A,w);O[K++]=($.x+J)/(2*J),O[K++]=($.y+J)/(2*J)}}var ee=new d;C.position&&(ee.position=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:D})),C.normal&&(ee.normal=new c({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:I})),C.tangent&&(ee.tangent=new c({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:M})),C.bitangent&&(ee.bitangent=new c({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:N})),C.st&&(ee.st=new c({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:O})),g.x=.5*l,g.y=Math.max(T,_);var te=new t(r.ZERO,i.magnitude(g));if(s(a._offsetAttribute)){l=D.length;var ie=new Uint8Array(l/3),re=a._offsetAttribute===h.NONE?0:1;e(ie,re),ee.applyOffset=new c({componentDatatype:n.UNSIGNED_BYTE,componentsPerAttribute:1,values:ie})}return new u({attributes:ee,indices:Q,primitiveType:f.TRIANGLES,boundingSphere:te,offsetAttribute:a._offsetAttribute})}},T.getUnitCylinder=function(){return s(C)||(C=T.createGeometry(new T({topRadius:1,bottomRadius:1,length:1,vertexFormat:_.POSITION_ONLY}))),C},T}.apply(t,r))||(e.exports=n)},1954:function(e,t,i){var r,n;r=[i(94),i(33),i(24),i(12),i(16),i(34),i(762),i(9),i(8),i(11),i(52),i(53),i(65),i(73),i(50),i(45)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f){"use strict";var _=new i;function g(e){var t=(e=s(e,s.EMPTY_OBJECT)).length,i=e.topRadius,r=e.bottomRadius,n=s(e.slices,128),o=Math.max(s(e.numberOfVerticalLines,16),0);this._length=t,this._topRadius=i,this._bottomRadius=r,this._slices=n,this._numberOfVerticalLines=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderOutlineGeometry"}g.packedLength=6,g.pack=function(e,t,i){return i=s(i,0),t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i++]=e._numberOfVerticalLines,t[i]=s(e._offsetAttribute,-1),t};var v={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};return g.unpack=function(e,t,i){t=s(t,0);var r=e[t++],n=e[t++],o=e[t++],a=e[t++],u=e[t++],c=e[t];return l(i)?(i._length=r,i._topRadius=n,i._bottomRadius=o,i._slices=a,i._numberOfVerticalLines=u,i._offsetAttribute=-1===c?void 0:c,i):(v.length=r,v.topRadius=n,v.bottomRadius=o,v.slices=a,v.numberOfVerticalLines=u,v.offsetAttribute=-1===c?void 0:c,new g(v))},g.createGeometry=function(n){var s=n._length,u=n._topRadius,g=n._bottomRadius,v=n._slices,y=n._numberOfVerticalLines;if(!(s<=0||u<0||g<0||0===u&&0===g)){var x,w=2*v,T=a.computePositions(s,u,g,v,!1),C=2*v;if(y>0){var E=Math.min(y,v);x=Math.round(v/E),C+=E}var A,S=m.createTypedArray(w,2*C),P=0;for(A=0;A<v-1;A++)S[P++]=A,S[P++]=A+1,S[P++]=A+v,S[P++]=A+1+v;if(S[P++]=v-1,S[P++]=0,S[P++]=v+v-1,S[P++]=v,y>0)for(A=0;A<v;A+=x)S[P++]=A,S[P++]=A+v;var b=new h;b.position=new d({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:T}),_.x=.5*s,_.y=Math.max(g,u);var D=new t(r.ZERO,i.magnitude(_));if(l(n._offsetAttribute)){s=T.length;var O=new Uint8Array(s/3),I=n._offsetAttribute===p.NONE?0:1;e(O,I),b.applyOffset=new d({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}return new c({attributes:b,indices:S,primitiveType:f.LINES,boundingSphere:D,offsetAttribute:n._offsetAttribute})}},g}.apply(t,r))||(e.exports=n)},1955:function(e,t,i){var r,n;r=[i(144),i(12),i(16),i(22),i(67),i(8),i(11),i(97),i(1956),i(1957),i(64),i(73),i(80),i(147),i(29),i(91),i(170),i(71),i(133),i(74),i(75),i(165),i(134),i(365),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E){"use strict";var A=new r,S=t.ZERO,P=new t,b=new m;function D(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function O(e,t){C.call(this,{entity:e,scene:t,geometryOptions:new D(e),geometryPropertyName:"ellipse",observedPropertyNames:["availability","position","ellipse"]}),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}function I(e,t,i){w.call(this,e,t,i)}return o(Object.create)&&(O.prototype=Object.create(C.prototype),O.prototype.constructor=O),O.prototype.createFillGeometryInstance=function(e){var t,i=this._entity,a=i.isAvailable(e),u={show:new f(a&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:s.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof x&&(o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(t=this._materialProperty.color.getValue(e,A)),o(t)||(t=r.WHITE),u.color=n.fromColor(t));return o(this._options.offsetAttribute)&&(u.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,S,P))),new c({id:i,geometry:new l(this._options),attributes:u})},O.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),a=E.getValueOrDefault(this._outlineColorProperty,e,r.BLACK,A),l=this._distanceDisplayConditionProperty.getValue(e),d={show:new f(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:n.fromColor(a),distanceDisplayCondition:s.fromDistanceDisplayCondition(l),offset:void 0};return o(this._options.offsetAttribute)&&(d.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,S,P))),new c({id:t,geometry:new u(this._options),attributes:d})},O.prototype._computeCenter=function(e,t){return E.getValueOrUndefined(this._entity.position,e,t)},O.prototype._isHidden=function(e,t){var i=e.position;return!o(i)||!o(t.semiMajorAxis)||!o(t.semiMinorAxis)||T.prototype._isHidden.call(this,e,t)},O.prototype._isDynamic=function(e,t){return!e.position.isConstant||!t.semiMajorAxis.isConstant||!t.semiMinorAxis.isConstant||!E.isConstant(t.rotation)||!E.isConstant(t.height)||!E.isConstant(t.extrudedHeight)||!E.isConstant(t.granularity)||!E.isConstant(t.stRotation)||!E.isConstant(t.outlineWidth)||!E.isConstant(t.numberOfVerticalLines)||!E.isConstant(t.zIndex)||this._onTerrain&&!E.isConstant(this._materialProperty)},O.prototype._setStaticOptions=function(t,i){var r=E.getValueOrUndefined(i.height,h.MINIMUM_VALUE),n=E.getValueOrDefault(i.heightReference,h.MINIMUM_VALUE,g.NONE),a=E.getValueOrUndefined(i.extrudedHeight,h.MINIMUM_VALUE),s=E.getValueOrDefault(i.extrudedHeightReference,h.MINIMUM_VALUE,g.NONE);o(a)&&!o(r)&&(r=0);var u=this._options;u.vertexFormat=this._materialProperty instanceof x?y.VERTEX_FORMAT:v.MaterialSupport.TEXTURED.vertexFormat,u.center=t.position.getValue(h.MINIMUM_VALUE,u.center),u.semiMajorAxis=i.semiMajorAxis.getValue(h.MINIMUM_VALUE,u.semiMajorAxis),u.semiMinorAxis=i.semiMinorAxis.getValue(h.MINIMUM_VALUE,u.semiMinorAxis),u.rotation=E.getValueOrUndefined(i.rotation,h.MINIMUM_VALUE),u.granularity=E.getValueOrUndefined(i.granularity,h.MINIMUM_VALUE),u.stRotation=E.getValueOrUndefined(i.stRotation,h.MINIMUM_VALUE),u.numberOfVerticalLines=E.getValueOrUndefined(i.numberOfVerticalLines,h.MINIMUM_VALUE),u.offsetAttribute=C.computeGeometryOffsetAttribute(r,n,a,s),u.height=C.getGeometryHeight(r,n),(a=C.getGeometryExtrudedHeight(a,s))===C.CLAMP_TO_GROUND&&(a=e.getMinimumMaximumHeights(l.computeRectangle(u,b)).minimumTerrainHeight),u.extrudedHeight=a},O.DynamicGeometryUpdater=I,o(Object.create)&&(I.prototype=Object.create(w.prototype),I.prototype.constructor=I),I.prototype._isHidden=function(e,t,i){var r=this._options;return!o(r.center)||!o(r.semiMajorAxis)||!o(r.semiMinorAxis)||w.prototype._isHidden.call(this,e,t,i)},I.prototype._setOptions=function(t,i,r){var n=this._options,a=E.getValueOrUndefined(i.height,r),s=E.getValueOrDefault(i.heightReference,r,g.NONE),u=E.getValueOrUndefined(i.extrudedHeight,r),c=E.getValueOrDefault(i.extrudedHeightReference,r,g.NONE);o(u)&&!o(a)&&(a=0),n.center=E.getValueOrUndefined(t.position,r,n.center),n.semiMajorAxis=E.getValueOrUndefined(i.semiMajorAxis,r),n.semiMinorAxis=E.getValueOrUndefined(i.semiMinorAxis,r),n.rotation=E.getValueOrUndefined(i.rotation,r),n.granularity=E.getValueOrUndefined(i.granularity,r),n.stRotation=E.getValueOrUndefined(i.stRotation,r),n.numberOfVerticalLines=E.getValueOrUndefined(i.numberOfVerticalLines,r),n.offsetAttribute=C.computeGeometryOffsetAttribute(a,s,u,c),n.height=C.getGeometryHeight(a,s),(u=C.getGeometryExtrudedHeight(u,c))===C.CLAMP_TO_GROUND&&(u=e.getMinimumMaximumHeights(l.computeRectangle(n,b)).minimumTerrainHeight),n.extrudedHeight=u},O}.apply(t,r))||(e.exports=n)},1956:function(e,t,i){var r,n;r=[i(94),i(33),i(24),i(12),i(32),i(16),i(34),i(9),i(8),i(10),i(11),i(764),i(26),i(108),i(52),i(53),i(65),i(64),i(73),i(121),i(50),i(14),i(43),i(45),i(54),i(29),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S){"use strict";var P=new r,b=new r,D=new r,O=new r,I=new i,M=new T,N=new T,F=new E,R=new r,L=new r,V=new r,U=new n,z=new r,B=new i,H=new i;function k(t,n,o){var s=n.vertexFormat,u=n.center,c=n.semiMajorAxis,h=n.semiMinorAxis,m=n.ellipsoid,g=n.stRotation,y=o?t.length/3*2:t.length/3,x=n.shadowVolume,w=s.st?new Float32Array(2*y):void 0,C=s.normal?new Float32Array(3*y):void 0,A=s.tangent?new Float32Array(3*y):void 0,S=s.bitangent?new Float32Array(3*y):void 0,O=x?new Float32Array(3*y):void 0,k=0,G=R,W=L,Y=V,j=new p(m),X=j.project(m.cartesianToCartographic(u,U),z),Q=m.scaleToGeodeticSurface(u,P);m.geodeticSurfaceNormal(Q,Q);var q=M,Z=N;if(0!==g){var K=E.fromAxisAngle(Q,g,F);q=T.fromQuaternion(K,q),K=E.fromAxisAngle(Q,-g,F),Z=T.fromQuaternion(K,Z)}else q=T.clone(T.IDENTITY,q),Z=T.clone(T.IDENTITY,Z);for(var J=i.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,B),$=i.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,H),ee=t.length,te=o?ee:0,ie=te/3*2,re=0;re<ee;re+=3){var ne=re+1,oe=re+2,ae=r.fromArray(t,re,P);if(s.st){var se=T.multiplyByVector(q,ae,b),le=j.project(m.cartesianToCartographic(se,U),D);r.subtract(le,X,le),I.x=(le.x+c)/(2*c),I.y=(le.y+h)/(2*h),J.x=Math.min(I.x,J.x),J.y=Math.min(I.y,J.y),$.x=Math.max(I.x,$.x),$.y=Math.max(I.y,$.y),o&&(w[k+ie]=I.x,w[k+1+ie]=I.y),w[k++]=I.x,w[k++]=I.y}(s.normal||s.tangent||s.bitangent||x)&&(G=m.geodeticSurfaceNormal(ae,G),x&&(O[re+te]=-G.x,O[ne+te]=-G.y,O[oe+te]=-G.z),(s.normal||s.tangent||s.bitangent)&&((s.tangent||s.bitangent)&&(W=r.normalize(r.cross(r.UNIT_Z,G,W),W),T.multiplyByVector(Z,W,W)),s.normal&&(C[re]=G.x,C[ne]=G.y,C[oe]=G.z,o&&(C[re+te]=-G.x,C[ne+te]=-G.y,C[oe+te]=-G.z)),s.tangent&&(A[re]=W.x,A[ne]=W.y,A[oe]=W.z,o&&(A[re+te]=-W.x,A[ne+te]=-W.y,A[oe+te]=-W.z)),s.bitangent&&(Y=r.normalize(r.cross(G,W,Y),Y),S[re]=Y.x,S[ne]=Y.y,S[oe]=Y.z,o&&(S[re+te]=Y.x,S[ne+te]=Y.y,S[oe+te]=Y.z))))}if(s.st){ee=w.length;for(var ue=0;ue<ee;ue+=2)w[ue]=(w[ue]-J.x)/($.x-J.x),w[ue+1]=(w[ue+1]-J.y)/($.y-J.y)}var ce=new _;if(s.position){var de=d.raisePositionsToHeight(t,n,o);ce.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:de})}if(s.st&&(ce.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:w})),s.normal&&(ce.normal=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:C})),s.tangent&&(ce.tangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:A})),s.bitangent&&(ce.bitangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:S})),x&&(ce.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:O})),o&&l(n.offsetAttribute)){var he=new Uint8Array(y);if(n.offsetAttribute===v.TOP)he=e(he,1,0,y/2);else{var pe=n.offsetAttribute===v.NONE?0:1;he=e(he,pe)}ce.applyOffset=new f({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:he})}return ce}function G(e){var t,i,r,n,o,a=new Array(e*(e+1)*12-6),s=0;for(t=0,r=1,n=0;n<3;n++)a[s++]=r++,a[s++]=t,a[s++]=r;for(n=2;n<e+1;++n){for(r=n*(n+1)-1,t=(n-1)*n-1,a[s++]=r++,a[s++]=t,a[s++]=r,i=2*n,o=0;o<i-1;++o)a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t,a[s++]=r;a[s++]=r++,a[s++]=t,a[s++]=r}for(i=2*e,++r,++t,n=0;n<i-1;++n)a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t,a[s++]=r;for(a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t++,a[s++]=t,++t,n=e-1;n>1;--n){for(a[s++]=t++,a[s++]=t,a[s++]=r,i=2*n,o=0;o<i-1;++o)a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t,a[s++]=r;a[s++]=t++,a[s++]=t++,a[s++]=r++}for(n=0;n<3;n++)a[s++]=t++,a[s++]=t,a[s++]=r;return a}var W=new r;var Y=new t,j=new t;function X(n){var o=n.center,s=n.ellipsoid,u=n.semiMajorAxis,c=r.multiplyByScalar(s.geodeticSurfaceNormal(o,P),n.height,P);Y.center=r.add(o,c,Y.center),Y.radius=u,c=r.multiplyByScalar(s.geodeticSurfaceNormal(o,c),n.extrudedHeight,c),j.center=r.add(o,c,j.center),j.radius=u;var h=d.computeEllipsePositions(n,!0,!0),w=h.positions,A=h.numPts,S=h.outerPositions,N=t.union(Y,j),W=k(w,n,!0),X=G(A),Q=X.length;X.length=2*Q;for(var q=w.length/3,Z=0;Z<Q;Z+=3)X[Z+Q]=X[Z+2]+q,X[Z+1+Q]=X[Z+1]+q,X[Z+2+Q]=X[Z]+q;var K=x.createTypedArray(2*q/3,X),J=new m({attributes:W,indices:K,primitiveType:C.TRIANGLES}),$=function(t,n){var o=n.vertexFormat,s=n.center,u=n.semiMajorAxis,c=n.semiMinorAxis,d=n.ellipsoid,h=n.height,m=n.extrudedHeight,g=n.stRotation,y=t.length/3*2,x=new Float64Array(3*y),w=o.st?new Float32Array(2*y):void 0,C=o.normal?new Float32Array(3*y):void 0,A=o.tangent?new Float32Array(3*y):void 0,S=o.bitangent?new Float32Array(3*y):void 0,N=n.shadowVolume,k=N?new Float32Array(3*y):void 0,G=0,W=R,Y=L,j=V,X=new p(d),Q=X.project(d.cartesianToCartographic(s,U),z),q=d.scaleToGeodeticSurface(s,P);d.geodeticSurfaceNormal(q,q);for(var Z=E.fromAxisAngle(q,g,F),K=T.fromQuaternion(Z,M),J=i.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,B),$=i.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,H),ee=t.length,te=ee/3*2,ie=0;ie<ee;ie+=3){var re,ne=ie+1,oe=ie+2,ae=r.fromArray(t,ie,P);if(o.st){var se=T.multiplyByVector(K,ae,b),le=X.project(d.cartesianToCartographic(se,U),D);r.subtract(le,Q,le),I.x=(le.x+u)/(2*u),I.y=(le.y+c)/(2*c),J.x=Math.min(I.x,J.x),J.y=Math.min(I.y,J.y),$.x=Math.max(I.x,$.x),$.y=Math.max(I.y,$.y),w[G+te]=I.x,w[G+1+te]=I.y,w[G++]=I.x,w[G++]=I.y}ae=d.scaleToGeodeticSurface(ae,ae),re=r.clone(ae,b),W=d.geodeticSurfaceNormal(ae,W),N&&(k[ie+ee]=-W.x,k[ne+ee]=-W.y,k[oe+ee]=-W.z);var ue=r.multiplyByScalar(W,h,O);if(ae=r.add(ae,ue,ae),ue=r.multiplyByScalar(W,m,ue),re=r.add(re,ue,re),o.position&&(x[ie+ee]=re.x,x[ne+ee]=re.y,x[oe+ee]=re.z,x[ie]=ae.x,x[ne]=ae.y,x[oe]=ae.z),o.normal||o.tangent||o.bitangent){j=r.clone(W,j);var ce=r.fromArray(t,(ie+3)%ee,O);r.subtract(ce,ae,ce);var de=r.subtract(re,ae,D);W=r.normalize(r.cross(de,ce,W),W),o.normal&&(C[ie]=W.x,C[ne]=W.y,C[oe]=W.z,C[ie+ee]=W.x,C[ne+ee]=W.y,C[oe+ee]=W.z),o.tangent&&(Y=r.normalize(r.cross(j,W,Y),Y),A[ie]=Y.x,A[ne]=Y.y,A[oe]=Y.z,A[ie+ee]=Y.x,A[ie+1+ee]=Y.y,A[ie+2+ee]=Y.z),o.bitangent&&(S[ie]=j.x,S[ne]=j.y,S[oe]=j.z,S[ie+ee]=j.x,S[ne+ee]=j.y,S[oe+ee]=j.z)}}if(o.st){ee=w.length;for(var he=0;he<ee;he+=2)w[he]=(w[he]-J.x)/($.x-J.x),w[he+1]=(w[he+1]-J.y)/($.y-J.y)}var pe=new _;if(o.position&&(pe.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:x})),o.st&&(pe.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:w})),o.normal&&(pe.normal=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:C})),o.tangent&&(pe.tangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:A})),o.bitangent&&(pe.bitangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:S})),N&&(pe.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:k})),l(n.offsetAttribute)){var me=new Uint8Array(y);if(n.offsetAttribute===v.TOP)me=e(me,1,0,y/2);else{var fe=n.offsetAttribute===v.NONE?0:1;me=e(me,fe)}pe.applyOffset=new f({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:me})}return pe}(S,n);X=function(e){for(var t=e.length/3,i=x.createTypedArray(t,6*t),r=0,n=0;n<t;n++){var o=n,a=n+t,s=(o+1)%t,l=s+t;i[r++]=o,i[r++]=a,i[r++]=s,i[r++]=s,i[r++]=a,i[r++]=l}return i}(S);var ee=x.createTypedArray(2*S.length/3,X),te=new m({attributes:$,indices:ee,primitiveType:C.TRIANGLES}),ie=y.combineInstances([new g({geometry:J}),new g({geometry:te})]);return{boundingSphere:N,attributes:ie[0].attributes,indices:ie[0].indices}}function Q(e,t,i,n,o,a,s){for(var l=d.computeEllipsePositions({center:e,semiMajorAxis:t,semiMinorAxis:i,rotation:n,granularity:o},!1,!0).outerPositions,u=l.length/3,c=new Array(u),h=0;h<u;++h)c[h]=r.fromArray(l,3*h);var p=A.fromCartesianArray(c,a,s);return p.width>w.PI&&(p.north=p.north>0?w.PI_OVER_TWO-w.EPSILON7:p.north,p.south=p.south<0?w.EPSILON7-w.PI_OVER_TWO:p.south,p.east=w.PI,p.west=-w.PI),p}function q(e){var t=(e=s(e,s.EMPTY_OBJECT)).center,i=s(e.ellipsoid,h.WGS84),n=e.semiMajorAxis,o=e.semiMinorAxis,a=s(e.granularity,w.RADIANS_PER_DEGREE),l=s(e.vertexFormat,S.DEFAULT),u=s(e.height,0),c=s(e.extrudedHeight,u);this._center=r.clone(t),this._semiMajorAxis=n,this._semiMinorAxis=o,this._ellipsoid=h.clone(i),this._rotation=s(e.rotation,0),this._stRotation=s(e.stRotation,0),this._height=Math.max(c,u),this._granularity=a,this._vertexFormat=S.clone(l),this._extrudedHeight=Math.min(c,u),this._shadowVolume=s(e.shadowVolume,!1),this._workerName="createEllipseGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0}q.packedLength=r.packedLength+h.packedLength+S.packedLength+9,q.pack=function(e,t,i){return i=s(i,0),r.pack(e._center,t,i),i+=r.packedLength,h.pack(e._ellipsoid,t,i),i+=h.packedLength,S.pack(e._vertexFormat,t,i),i+=S.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._stRotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._shadowVolume?1:0,t[i]=s(e._offsetAttribute,-1),t};var Z=new r,K=new h,J=new S,$={center:Z,ellipsoid:K,vertexFormat:J,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};return q.unpack=function(e,t,i){t=s(t,0);var n=r.unpack(e,t,Z);t+=r.packedLength;var o=h.unpack(e,t,K);t+=h.packedLength;var a=S.unpack(e,t,J);t+=S.packedLength;var u=e[t++],c=e[t++],d=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t++],g=1===e[t++],v=e[t];return l(i)?(i._center=r.clone(n,i._center),i._ellipsoid=h.clone(o,i._ellipsoid),i._vertexFormat=S.clone(a,i._vertexFormat),i._semiMajorAxis=u,i._semiMinorAxis=c,i._rotation=d,i._stRotation=p,i._height=m,i._granularity=f,i._extrudedHeight=_,i._shadowVolume=g,i._offsetAttribute=-1===v?void 0:v,i):($.height=m,$.extrudedHeight=_,$.granularity=f,$.stRotation=p,$.rotation=d,$.semiMajorAxis=u,$.semiMinorAxis=c,$.shadowVolume=g,$.offsetAttribute=-1===v?void 0:v,new q($))},q.computeRectangle=function(e,t){var i=(e=s(e,s.EMPTY_OBJECT)).center,r=s(e.ellipsoid,h.WGS84),n=e.semiMajorAxis,o=e.semiMinorAxis,a=s(e.granularity,w.RADIANS_PER_DEGREE);return Q(i,n,o,s(e.rotation,0),a,r,t)},q.createGeometry=function(i){if(!(i._semiMajorAxis<=0||i._semiMinorAxis<=0)){var n=i._height,o=i._extrudedHeight,s=!w.equalsEpsilon(n,o,0,w.EPSILON2);i._center=i._ellipsoid.scaleToGeodeticSurface(i._center,i._center);var u,c={center:i._center,semiMajorAxis:i._semiMajorAxis,semiMinorAxis:i._semiMinorAxis,ellipsoid:i._ellipsoid,rotation:i._rotation,height:n,granularity:i._granularity,vertexFormat:i._vertexFormat,stRotation:i._stRotation};if(s)c.extrudedHeight=o,c.shadowVolume=i._shadowVolume,c.offsetAttribute=i._offsetAttribute,u=X(c);else if(u=function(e){var i=e.center;W=r.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(i,W),e.height,W),W=r.add(i,W,W);var n=new t(W,e.semiMajorAxis),o=d.computeEllipsePositions(e,!0,!1),a=o.positions,s=o.numPts,l=k(a,e,!1),u=G(s);return{boundingSphere:n,attributes:l,indices:u=x.createTypedArray(a.length/3,u)}}(c),l(i._offsetAttribute)){var h=u.attributes.position.values.length,p=new Uint8Array(h/3),_=i._offsetAttribute===v.NONE?0:1;e(p,_),u.attributes.applyOffset=new f({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})}return new m({attributes:u.attributes,indices:u.indices,primitiveType:C.TRIANGLES,boundingSphere:u.boundingSphere,offsetAttribute:i._offsetAttribute})}},q.createShadowVolume=function(e,t,i){var r=e._granularity,n=e._ellipsoid,o=t(r,n),a=i(r,n);return new q({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:n,rotation:e._rotation,stRotation:e._stRotation,granularity:r,extrudedHeight:o,height:a,vertexFormat:S.POSITION_ONLY,shadowVolume:!0})},u(q.prototype,{rectangle:{get:function(){return l(this._rectangle)||(this._rectangle=Q(this._center,this._semiMajorAxis,this._semiMinorAxis,this._rotation,this._granularity,this._ellipsoid)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return l(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){var t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];for(var i=d.computeEllipsePositions({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,rotation:e._rotation,granularity:e._granularity},!1,!0).outerPositions,n=i.length/3,o=new Array(n),a=0;a<n;++a)o[a]=r.fromArray(i,3*a);var s=e._ellipsoid,l=e.rectangle;return m._textureCoordinateRotationPoints(o,t,s,l)}(this)),this._textureCoordinateRotationPoints}}}),q}.apply(t,r))||(e.exports=n)},1957:function(e,t,i){var r,n;r=[i(94),i(33),i(12),i(34),i(9),i(8),i(11),i(764),i(26),i(52),i(53),i(65),i(73),i(50),i(14),i(45)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f){"use strict";var _=new i,g=new i;var v=new t,y=new t;function x(e){var t=(e=n(e,n.EMPTY_OBJECT)).center,r=n(e.ellipsoid,l.WGS84),o=e.semiMajorAxis,a=e.semiMinorAxis,s=n(e.granularity,m.RADIANS_PER_DEGREE),u=n(e.height,0),c=n(e.extrudedHeight,u);this._center=i.clone(t),this._semiMajorAxis=o,this._semiMinorAxis=a,this._ellipsoid=l.clone(r),this._rotation=n(e.rotation,0),this._height=Math.max(c,u),this._granularity=s,this._extrudedHeight=Math.min(c,u),this._numberOfVerticalLines=Math.max(n(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}x.packedLength=i.packedLength+l.packedLength+8,x.pack=function(e,t,r){return r=n(r,0),i.pack(e._center,t,r),r+=i.packedLength,l.pack(e._ellipsoid,t,r),r+=l.packedLength,t[r++]=e._semiMajorAxis,t[r++]=e._semiMinorAxis,t[r++]=e._rotation,t[r++]=e._height,t[r++]=e._granularity,t[r++]=e._extrudedHeight,t[r++]=e._numberOfVerticalLines,t[r]=n(e._offsetAttribute,-1),t};var w=new i,T=new l,C={center:w,ellipsoid:T,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};return x.unpack=function(e,t,r){t=n(t,0);var a=i.unpack(e,t,w);t+=i.packedLength;var s=l.unpack(e,t,T);t+=l.packedLength;var u=e[t++],c=e[t++],d=e[t++],h=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t];return o(r)?(r._center=i.clone(a,r._center),r._ellipsoid=l.clone(s,r._ellipsoid),r._semiMajorAxis=u,r._semiMinorAxis=c,r._rotation=d,r._height=h,r._granularity=p,r._extrudedHeight=m,r._numberOfVerticalLines=f,r._offsetAttribute=-1===_?void 0:_,r):(C.height=h,C.extrudedHeight=m,C.granularity=p,C.rotation=d,C.semiMajorAxis=u,C.semiMinorAxis=c,C.numberOfVerticalLines=f,C.offsetAttribute=-1===_?void 0:_,new x(C))},x.createGeometry=function(a){if(!(a._semiMajorAxis<=0||a._semiMinorAxis<=0)){var l=a._height,x=a._extrudedHeight,w=!m.equalsEpsilon(l,x,0,m.EPSILON2);a._center=a._ellipsoid.scaleToGeodeticSurface(a._center,a._center);var T,C={center:a._center,semiMajorAxis:a._semiMajorAxis,semiMinorAxis:a._semiMinorAxis,ellipsoid:a._ellipsoid,rotation:a._rotation,height:l,granularity:a._granularity,numberOfVerticalLines:a._numberOfVerticalLines};if(w)C.extrudedHeight=x,C.offsetAttribute=a._offsetAttribute,T=function(a){var l=a.center,u=a.ellipsoid,f=a.semiMajorAxis,g=i.multiplyByScalar(u.geodeticSurfaceNormal(l,_),a.height,_);v.center=i.add(l,g,v.center),v.radius=f,g=i.multiplyByScalar(u.geodeticSurfaceNormal(l,g),a.extrudedHeight,g),y.center=i.add(l,g,y.center),y.radius=f;var x=s.computeEllipsePositions(a,!1,!0).outerPositions,w=new d({position:new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:s.raisePositionsToHeight(x,a,!0)})});x=w.position.values;var T=t.union(v,y),C=x.length/3;if(o(a.offsetAttribute)){var E=new Uint8Array(C);if(a.offsetAttribute===h.TOP)E=e(E,1,0,C/2);else{var A=a.offsetAttribute===h.NONE?0:1;E=e(E,A)}w.applyOffset=new c({componentDatatype:r.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})}var S=n(a.numberOfVerticalLines,16);S=m.clamp(S,0,C/2);var P=p.createTypedArray(C,2*C+2*S);C/=2;var b,D,O=0;for(b=0;b<C;++b)P[O++]=b,P[O++]=(b+1)%C,P[O++]=b+C,P[O++]=(b+1)%C+C;if(S>0){var I=Math.min(S,C);D=Math.round(C/I);var M=Math.min(D*S,C);for(b=0;b<M;b+=D)P[O++]=b,P[O++]=b+C}return{boundingSphere:T,attributes:w,indices:P}}(C);else if(T=function(e){var n=e.center;g=i.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(n,g),e.height,g),g=i.add(n,g,g);for(var o=new t(g,e.semiMajorAxis),a=s.computeEllipsePositions(e,!1,!0).outerPositions,l=new d({position:new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:s.raisePositionsToHeight(a,e,!1)})}),u=a.length/3,h=p.createTypedArray(u,2*u),m=0,f=0;f<u;++f)h[m++]=f,h[m++]=(f+1)%u;return{boundingSphere:o,attributes:l,indices:h}}(C),o(a._offsetAttribute)){var E=T.attributes.position.values.length,A=new Uint8Array(E/3),S=a._offsetAttribute===h.NONE?0:1;e(A,S),T.attributes.applyOffset=new c({componentDatatype:r.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}return new u({attributes:T.attributes,indices:T.indices,primitiveType:f.LINES,boundingSphere:T.boundingSphere,offsetAttribute:a._offsetAttribute})}},x}.apply(t,r))||(e.exports=n)},1958:function(e,t,i){var r,n;r=[i(12),i(16),i(22),i(67),i(9),i(8),i(10),i(84),i(97),i(497),i(640),i(64),i(73),i(80),i(147),i(28),i(91),i(71),i(133),i(74),i(112),i(44),i(501),i(75),i(165),i(134),i(198),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P){"use strict";var b=new C(i.WHITE),D=e.ZERO,O=new e,I=new e,M=new i,N=new e(1,1,1);function F(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0,this.offsetAttribute=void 0}function R(e,t){A.call(this,{entity:e,scene:t,geometryOptions:new F(e),geometryPropertyName:"ellipsoid",observedPropertyNames:["availability","position","orientation","ellipsoid"]}),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}function L(t,i,r){E.call(this,t,i,r),this._scene=t._scene,this._modelMatrix=new f,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0,this._lastOffset=new e,this._material={}}return o(Object.create)&&(R.prototype=Object.create(A.prototype),R.prototype.constructor=R),a(R.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),R.prototype.createFillGeometryInstance=function(e,t,n){var a,s,c=this._entity,h=c.isAvailable(e),p=new _(h&&c.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),f=this._distanceDisplayConditionProperty.getValue(e),g={show:p,distanceDisplayCondition:l.fromDistanceDisplayCondition(f),color:void 0,offset:void 0};this._materialProperty instanceof C&&(o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||h)&&(s=this._materialProperty.color.getValue(e,M)),o(s)||(s=i.WHITE),a=r.fromColor(s),g.color=a);return o(this._options.offsetAttribute)&&(g.offset=m.fromCartesian3(P.getValueOrDefault(this._terrainOffsetProperty,e,D,O))),new d({id:c,geometry:new u(this._options),modelMatrix:t?void 0:c.computeModelMatrixForHeightReference(e,c.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,n),attributes:g})},R.prototype.createOutlineGeometryInstance=function(e,t,n){var a=this._entity,s=a.isAvailable(e),u=P.getValueOrDefault(this._outlineColorProperty,e,i.BLACK,M),h=this._distanceDisplayConditionProperty.getValue(e),p={show:new _(s&&a.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(u),distanceDisplayCondition:l.fromDistanceDisplayCondition(h),offset:void 0};return o(this._options.offsetAttribute)&&(p.offset=m.fromCartesian3(P.getValueOrDefault(this._terrainOffsetProperty,e,D,O))),new d({id:a,geometry:new c(this._options),modelMatrix:t?void 0:a.computeModelMatrixForHeightReference(e,a.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,n),attributes:p})},R.prototype._computeCenter=function(e,t){return P.getValueOrUndefined(this._entity.position,e,t)},R.prototype._isHidden=function(e,t){return!o(e.position)||!o(t.radii)||A.prototype._isHidden.call(this,e,t)},R.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&P.isConstant(e.orientation)&&t.radii.isConstant&&P.isConstant(t.stackPartitions)&&P.isConstant(t.slicePartitions)&&P.isConstant(t.outlineWidth)&&P.isConstant(t.subdivisions))},R.prototype._setStaticOptions=function(e,t){var i=P.getValueOrDefault(t.heightReference,p.MINIMUM_VALUE,g.NONE),r=this._options;r.vertexFormat=this._materialProperty instanceof C?y.VERTEX_FORMAT:v.MaterialSupport.TEXTURED.vertexFormat,r.radii=t.radii.getValue(p.MINIMUM_VALUE,r.radii),r.stackPartitions=P.getValueOrUndefined(t.stackPartitions,p.MINIMUM_VALUE),r.slicePartitions=P.getValueOrUndefined(t.slicePartitions,p.MINIMUM_VALUE),r.subdivisions=P.getValueOrUndefined(t.subdivisions,p.MINIMUM_VALUE),r.offsetAttribute=i!==g.NONE?h.ALL:void 0},R.prototype._onEntityPropertyChanged=T,R.DynamicGeometryUpdater=L,o(Object.create)&&(L.prototype=Object.create(E.prototype),L.prototype.constructor=L),L.prototype.update=function(t){var a=this._entity,u=a.ellipsoid;if(!a.isShowing||!a.isAvailable(t)||!P.getValueOrDefault(u.show,t,!0))return o(this._primitive)&&(this._primitive.show=!1),void(o(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var c=P.getValueOrUndefined(u.radii,t,I),d=o(c)?a.computeModelMatrixForHeightReference(t,u.heightReference,.5*c.z,this._scene.mapProjection.ellipsoid,this._modelMatrix):void 0;if(!o(d)||!o(c))return o(this._primitive)&&(this._primitive.show=!1),void(o(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var p=P.getValueOrDefault(u.fill,t,!0),T=P.getValueOrDefault(u.outline,t,!1),C=P.getValueOrClonedDefault(u.outlineColor,t,i.BLACK,M),E=S.getValue(t,n(u.material,b),this._material),A=P.getValueOrUndefined(u.stackPartitions,t),F=P.getValueOrUndefined(u.slicePartitions,t),R=P.getValueOrUndefined(u.subdivisions,t),L=P.getValueOrDefault(u.outlineWidth,t,1),V=P.getValueOrDefault(u.heightReference,t,g.NONE),U=V!==g.NONE?h.ALL:void 0,z=this._scene.mode,B=z===w.SCENE3D&&V===g.NONE,H=this._options,k=this._geometryUpdater.shadowsProperty.getValue(t),G=this._geometryUpdater.distanceDisplayConditionProperty.getValue(t),W=P.getValueOrDefault(this._geometryUpdater.terrainOffsetProperty,t,D,O);if(!B||this._lastSceneMode!==z||!o(this._primitive)||H.stackPartitions!==A||H.slicePartitions!==F||H.subdivisions!==R||this._lastOutlineWidth!==L||H.offsetAttribute!==U){var Y=this._primitives;Y.removeAndDestroy(this._primitive),Y.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=z,this._lastOutlineWidth=L,H.stackPartitions=A,H.slicePartitions=F,H.subdivisions=R,H.offsetAttribute=U,H.radii=B?N:c;var j=new v({material:E,translucent:E.isTranslucent(),closed:!0});H.vertexFormat=j.vertexFormat;var X=this._geometryUpdater.createFillGeometryInstance(t,B,this._modelMatrix);this._primitive=Y.add(new x({geometryInstances:X,appearance:j,asynchronous:!1,shadows:k}));var Q=this._geometryUpdater.createOutlineGeometryInstance(t,B,this._modelMatrix);this._outlinePrimitive=Y.add(new x({geometryInstances:Q,appearance:new y({flat:!0,translucent:255!==Q.attributes.color.value[3],renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(L)}}),asynchronous:!1,shadows:k})),this._lastShow=p,this._lastOutlineShow=T,this._lastOutlineColor=i.clone(C,this._lastOutlineColor),this._lastDistanceDisplayCondition=G,this._lastOffset=e.clone(W,this._lastOffset)}else if(this._primitive.ready){var q=this._primitive,Z=this._outlinePrimitive;q.show=!0,Z.show=!0,q.appearance.material=E;var K=this._attributes;o(K)||(K=q.getGeometryInstanceAttributes(a),this._attributes=K),p!==this._lastShow&&(K.show=_.toValue(p,K.show),this._lastShow=p);var J=this._outlineAttributes;o(J)||(J=Z.getGeometryInstanceAttributes(a),this._outlineAttributes=J),T!==this._lastOutlineShow&&(J.show=_.toValue(T,J.show),this._lastOutlineShow=T),i.equals(C,this._lastOutlineColor)||(J.color=r.toValue(C,J.color),i.clone(C,this._lastOutlineColor)),s.equals(G,this._lastDistanceDisplayCondition)||(K.distanceDisplayCondition=l.toValue(G,K.distanceDisplayCondition),J.distanceDisplayCondition=l.toValue(G,J.distanceDisplayCondition),s.clone(G,this._lastDistanceDisplayCondition)),e.equals(W,this._lastOffset)||(K.offset=m.toValue(W,K.offset),J.offset=m.toValue(W,K.offset),e.clone(W,this._lastOffset))}B&&(c.x=Math.max(c.x,.001),c.y=Math.max(c.y,.001),c.z=Math.max(c.z,.001),d=f.multiplyByScale(d,c,d),this._primitive.modelMatrix=d,this._outlinePrimitive.modelMatrix=d)},R}.apply(t,r))||(e.exports=n)},1959:function(e,t,i){var r,n;r=[i(24),i(12),i(16),i(22),i(67),i(8),i(11),i(97),i(64),i(80),i(14),i(43),i(28),i(1960),i(1961),i(54),i(91),i(133),i(74),i(75),i(165),i(134),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T){"use strict";var C=new t,E=new r;function A(e){this.id=e,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function S(e,t){w.call(this,{entity:e,scene:t,geometryOptions:new A(e),geometryPropertyName:"plane",observedPropertyNames:["availability","position","orientation","plane"]}),this._onEntityPropertyChanged(e,"plane",e.plane,void 0)}function P(e,t,i){x.call(this,e,t,i)}o(Object.create)&&(S.prototype=Object.create(w.prototype),S.prototype.constructor=S),S.prototype.createFillGeometryInstance=function(e){var t,i,a=this._entity,u=a.isAvailable(e),c=new _(u&&a.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),d=this._distanceDisplayConditionProperty.getValue(e),h=s.fromDistanceDisplayCondition(d);this._materialProperty instanceof y?(o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||u)&&(i=this._materialProperty.color.getValue(e,E)),o(i)||(i=r.WHITE),t={show:c,distanceDisplayCondition:h,color:n.fromColor(i)}):t={show:c,distanceDisplayCondition:h};var m=a.plane,f=this._options,g=a.computeModelMatrix(e),v=T.getValueOrDefault(m.plane,e,f.plane),x=T.getValueOrUndefined(m.dimensions,e,f.dimensions);return f.plane=v,f.dimensions=x,g=R(v,x,g,this._scene.mapProjection.ellipsoid,g),new l({id:a,geometry:new p(this._options),modelMatrix:g,attributes:t})},S.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),o=T.getValueOrDefault(this._outlineColorProperty,e,r.BLACK,E),a=this._distanceDisplayConditionProperty.getValue(e),u=t.plane,c=this._options,d=t.computeModelMatrix(e),h=T.getValueOrDefault(u.plane,e,c.plane),p=T.getValueOrUndefined(u.dimensions,e,c.dimensions);return c.plane=h,c.dimensions=p,d=R(h,p,d,this._scene.mapProjection.ellipsoid,d),new l({id:t,geometry:new m,modelMatrix:d,attributes:{show:new _(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:n.fromColor(o),distanceDisplayCondition:s.fromDistanceDisplayCondition(a)}})},S.prototype._isHidden=function(e,t){return!o(t.plane)||!o(t.dimensions)||!o(e.position)||w.prototype._isHidden.call(this,e,t)},S.prototype._getIsClosed=function(e){return!1},S.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&T.isConstant(e.orientation)&&t.plane.isConstant&&t.dimensions.isConstant&&T.isConstant(t.outlineWidth))},S.prototype._setStaticOptions=function(e,t){var i=this._materialProperty instanceof y,r=this._options;r.vertexFormat=i?v.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat,r.plane=t.plane.getValue(u.MINIMUM_VALUE,r.plane),r.dimensions=t.dimensions.getValue(u.MINIMUM_VALUE,r.dimensions)},S.DynamicGeometryUpdater=P,o(Object.create)&&(P.prototype=Object.create(x.prototype),P.prototype.constructor=P),P.prototype._isHidden=function(e,t,i){var r=this._options,n=T.getValueOrUndefined(e.position,i,C);return!o(n)||!o(r.plane)||!o(r.dimensions)||x.prototype._isHidden.call(this,e,t,i)},P.prototype._setOptions=function(e,t,i){var r=this._options;r.plane=T.getValueOrDefault(t.plane,i,r.plane),r.dimensions=T.getValueOrUndefined(t.dimensions,i,r.dimensions)};var b=new t,D=new t,O=new t,I=new t,M=new t,N=new f,F=new d;function R(i,r,n,o,a){var s=i.normal,l=i.distance,u=t.multiplyByScalar(s,-l,O);u=h.multiplyByPoint(n,u,u);var p=h.multiplyByPointAsVector(n,s,I);t.normalize(p,p);var m=o.geodeticSurfaceNormal(u,D);c.equalsEpsilon(Math.abs(t.dot(m,p)),1,c.EPSILON8)&&(m=t.clone(t.UNIT_Z,m));var _=t.cross(m,p,b);m=t.cross(p,_,m),t.normalize(_,_),t.normalize(m,m);var g=F;d.setColumn(g,0,_,g),d.setColumn(g,1,m,g),d.setColumn(g,2,p,g);var v=f.fromRotationMatrix(g,N),y=e.clone(r,M);return y.z=1,h.fromTranslationQuaternionRotationScale(u,v,y,a)}return S.createPrimitiveMatrix=R,S}.apply(t,r))||(e.exports=n)},1960:function(e,t,i){var r,n;r=[i(33),i(12),i(16),i(34),i(9),i(8),i(52),i(53),i(65),i(45),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c){"use strict";function d(e){e=n(e,n.EMPTY_OBJECT);var t=n(e.vertexFormat,c.DEFAULT);this._vertexFormat=t,this._workerName="createPlaneGeometry"}d.packedLength=c.packedLength,d.pack=function(e,t,i){return i=n(i,0),c.pack(e._vertexFormat,t,i),t};var h=new c,p={vertexFormat:h};d.unpack=function(e,t,i){t=n(t,0);var r=c.unpack(e,t,h);return o(i)?(i._vertexFormat=c.clone(r,i._vertexFormat),i):new d(p)};var m=new t(-.5,-.5,0),f=new t(.5,.5,0);return d.createGeometry=function(i){var n,o,c=i._vertexFormat,d=new l;if(c.position){if((o=new Float64Array(12))[0]=m.x,o[1]=m.y,o[2]=0,o[3]=f.x,o[4]=m.y,o[5]=0,o[6]=f.x,o[7]=f.y,o[8]=0,o[9]=m.x,o[10]=f.y,o[11]=0,d.position=new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:o}),c.normal){var h=new Float32Array(12);h[0]=0,h[1]=0,h[2]=1,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=1,h[9]=0,h[10]=0,h[11]=1,d.normal=new s({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:h})}if(c.st){var p=new Float32Array(8);p[0]=0,p[1]=0,p[2]=1,p[3]=0,p[4]=1,p[5]=1,p[6]=0,p[7]=1,d.st=new s({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:p})}if(c.tangent){var _=new Float32Array(12);_[0]=1,_[1]=0,_[2]=0,_[3]=1,_[4]=0,_[5]=0,_[6]=1,_[7]=0,_[8]=0,_[9]=1,_[10]=0,_[11]=0,d.tangent=new s({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:_})}if(c.bitangent){var g=new Float32Array(12);g[0]=0,g[1]=1,g[2]=0,g[3]=0,g[4]=1,g[5]=0,g[6]=0,g[7]=1,g[8]=0,g[9]=0,g[10]=1,g[11]=0,d.bitangent=new s({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:g})}(n=new Uint16Array(6))[0]=0,n[1]=1,n[2]=2,n[3]=0,n[4]=2,n[5]=3}return new a({attributes:d,indices:n,primitiveType:u.TRIANGLES,boundingSphere:new e(t.ZERO,Math.sqrt(2))})},d}.apply(t,r))||(e.exports=n)},1961:function(e,t,i){var r,n;r=[i(33),i(12),i(16),i(34),i(8),i(52),i(53),i(65),i(45)],void 0===(n=function(e,t,i,r,n,o,a,s,l){"use strict";function u(){this._workerName="createPlaneOutlineGeometry"}u.packedLength=0,u.pack=function(e,t){return t},u.unpack=function(e,t,i){return n(i)?i:new u};var c=new t(-.5,-.5,0),d=new t(.5,.5,0);return u.createGeometry=function(){var i=new s,n=new Uint16Array(8),u=new Float64Array(12);return u[0]=c.x,u[1]=c.y,u[2]=c.z,u[3]=d.x,u[4]=c.y,u[5]=c.z,u[6]=d.x,u[7]=d.y,u[8]=c.z,u[9]=c.x,u[10]=d.y,u[11]=c.z,i.position=new a({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:u}),n[0]=0,n[1]=1,n[2]=1,n[3]=2,n[4]=2,n[5]=3,n[6]=3,n[7]=0,new o({attributes:i,indices:n,primitiveType:l.LINES,boundingSphere:new e(t.ZERO,Math.sqrt(2))})},u}.apply(t,r))||(e.exports=n)},1962:function(e,t,i){var r,n;r=[i(144),i(148),i(24),i(12),i(16),i(22),i(67),i(1963),i(1964),i(8),i(11),i(97),i(186),i(64),i(80),i(147),i(189),i(1965),i(1966),i(29),i(91),i(71),i(133),i(74),i(75),i(165),i(134),i(365),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b){"use strict";var D=new o,O=r.ZERO,I=new r,M=new y,N=[],F=new i;function R(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.offsetAttribute=void 0,this.arcType=void 0}function L(e,t){P.call(this,{entity:e,scene:t,geometryOptions:new R(e),geometryPropertyName:"polygon",observedPropertyNames:["availability","polygon"]}),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}function V(e,t,i){A.call(this,e,t,i)}return u(Object.create)&&(L.prototype=Object.create(P.prototype),L.prototype.constructor=L),L.prototype.createFillGeometryInstance=function(e){var t,i,r=this._entity,n=r.isAvailable(e),l=this._options,c={show:new x(n&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:d.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof E&&(u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,D)),u(t)||(t=o.WHITE),c.color=a.fromColor(t));return u(l.offsetAttribute)&&(c.offset=f.fromCartesian3(b.getValueOrDefault(this._terrainOffsetProperty,e,O,I))),i=l.perPositionHeight&&!u(l.extrudedHeight)?new s(l):new g(l),new p({id:r,geometry:i,attributes:c})},L.prototype.createOutlineGeometryInstance=function(e){var t,i=this._entity,r=i.isAvailable(e),n=this._options,s=b.getValueOrDefault(this._outlineColorProperty,e,o.BLACK,D),c=this._distanceDisplayConditionProperty.getValue(e),h={show:new x(r&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:a.fromColor(s),distanceDisplayCondition:d.fromDistanceDisplayCondition(c),offset:void 0};return u(n.offsetAttribute)&&(h.offset=f.fromCartesian3(b.getValueOrDefault(this._terrainOffsetProperty,e,O,I))),t=n.perPositionHeight&&!u(n.extrudedHeight)?new l(n):new v(n),new p({id:i,geometry:t,attributes:h})},L.prototype._computeCenter=function(e,t){var r=b.getValueOrUndefined(this._entity.polygon.hierarchy,e);if(u(r)){var n=r.positions;if(0!==n.length){for(var o=this._scene.mapProjection.ellipsoid,a=h.fromPoints(n,o),s=a.projectPointsOntoPlane(n,N),l=s.length,c=0,d=l-1,p=new i,m=0;m<l;d=m++){var f=s[m],_=s[d],g=f.x*_.y-_.x*f.y,v=i.add(f,_,F);v=i.multiplyByScalar(v,g,v),p=i.add(p,v,p),c+=g}var y=1/(3*c);return p=i.multiplyByScalar(p,y,p),a.projectPointOntoEllipsoid(p,t)}}},L.prototype._isHidden=function(e,t){return!u(t.hierarchy)||S.prototype._isHidden.call(this,e,t)},L.prototype._isOnTerrain=function(e,t){var i=P.prototype._isOnTerrain.call(this,e,t),r=t.perPositionHeight,n=u(r)&&(!r.isConstant||r.getValue(m.MINIMUM_VALUE));return i&&!n},L.prototype._isDynamic=function(e,t){return!t.hierarchy.isConstant||!b.isConstant(t.height)||!b.isConstant(t.extrudedHeight)||!b.isConstant(t.granularity)||!b.isConstant(t.stRotation)||!b.isConstant(t.outlineWidth)||!b.isConstant(t.perPositionHeight)||!b.isConstant(t.closeTop)||!b.isConstant(t.closeBottom)||!b.isConstant(t.zIndex)||!b.isConstant(t.arcType)||this._onTerrain&&!b.isConstant(this._materialProperty)},L.prototype._setStaticOptions=function(i,r){var n=this._materialProperty instanceof E,o=this._options;o.vertexFormat=n?C.VERTEX_FORMAT:T.MaterialSupport.TEXTURED.vertexFormat;var a,s=r.hierarchy.getValue(m.MINIMUM_VALUE),l=b.getValueOrUndefined(r.height,m.MINIMUM_VALUE),c=b.getValueOrDefault(r.heightReference,m.MINIMUM_VALUE,w.NONE),d=b.getValueOrUndefined(r.extrudedHeight,m.MINIMUM_VALUE),h=b.getValueOrDefault(r.extrudedHeightReference,m.MINIMUM_VALUE,w.NONE),p=b.getValueOrDefault(r.perPositionHeight,m.MINIMUM_VALUE,!1);l=P.getGeometryHeight(l,c),p?(u(l)&&(l=void 0,_("Entity polygons cannot have both height and perPositionHeight.  height will be ignored")),c!==w.NONE&&p&&(l=void 0,_("heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored"))):(u(d)&&!u(l)&&(l=0),a=P.computeGeometryOffsetAttribute(l,c,d,h)),o.polygonHierarchy=s,o.granularity=b.getValueOrUndefined(r.granularity,m.MINIMUM_VALUE),o.stRotation=b.getValueOrUndefined(r.stRotation,m.MINIMUM_VALUE),o.perPositionHeight=p,o.closeTop=b.getValueOrDefault(r.closeTop,m.MINIMUM_VALUE,!0),o.closeBottom=b.getValueOrDefault(r.closeBottom,m.MINIMUM_VALUE,!0),o.offsetAttribute=a,o.height=l,o.arcType=b.getValueOrDefault(r.arcType,m.MINIMUM_VALUE,t.GEODESIC),(d=P.getGeometryExtrudedHeight(d,h))===P.CLAMP_TO_GROUND&&(d=e.getMinimumMaximumHeights(g.computeRectangle(o,M)).minimumTerrainHeight),o.extrudedHeight=d},L.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight,r=u(i)&&i!==t;return!e.perPositionHeight&&(!r&&0===t||r&&e.closeTop&&e.closeBottom)},L.DynamicGeometryUpdater=V,u(Object.create)&&(V.prototype=Object.create(A.prototype),V.prototype.constructor=V),V.prototype._isHidden=function(e,t,i){return!u(this._options.polygonHierarchy)||A.prototype._isHidden.call(this,e,t,i)},V.prototype._setOptions=function(i,r,n){var o=this._options;o.polygonHierarchy=b.getValueOrUndefined(r.hierarchy,n);var a,s=b.getValueOrUndefined(r.height,n),l=b.getValueOrDefault(r.heightReference,n,w.NONE),c=b.getValueOrDefault(r.extrudedHeightReference,n,w.NONE),d=b.getValueOrUndefined(r.extrudedHeight,n),h=b.getValueOrUndefined(r.perPositionHeight,n);s=P.getGeometryHeight(s,c),h?(u(s)&&(s=void 0,_("Entity polygons cannot have both height and perPositionHeight.  height will be ignored")),l!==w.NONE&&h&&(s=void 0,_("heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored"))):(u(d)&&!u(s)&&(s=0),a=P.computeGeometryOffsetAttribute(s,l,d,c)),o.granularity=b.getValueOrUndefined(r.granularity,n),o.stRotation=b.getValueOrUndefined(r.stRotation,n),o.perPositionHeight=b.getValueOrUndefined(r.perPositionHeight,n),o.closeTop=b.getValueOrDefault(r.closeTop,n,!0),o.closeBottom=b.getValueOrDefault(r.closeBottom,n,!0),o.offsetAttribute=a,o.height=s,o.arcType=b.getValueOrDefault(r.arcType,n,t.GEODESIC),(d=P.getGeometryExtrudedHeight(d,c))===P.CLAMP_TO_GROUND&&(d=e.getMinimumMaximumHeights(g.computeRectangle(o,M)).minimumTerrainHeight),o.extrudedHeight=d},L}.apply(t,r))||(e.exports=n)},1963:function(e,t,i){var r,n;r=[i(149),i(62),i(33),i(24),i(12),i(16),i(34),i(765),i(9),i(8),i(26),i(52),i(53),i(65),i(64),i(121),i(50),i(14),i(43),i(246),i(130),i(45),i(54),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C){"use strict";var E=new n,A=new t,S=new r,P=new r,b=new n,D=new n,O=new n,I=new n,M=new n,N=new n,F=new T,R=new v,L=new v,V=new n;function U(e,t,i,o,s,l,u,c){var m=e.positions,f=x.triangulate(e.positions2D,e.holes);f.length<3&&(f=[0,1,2]);var y=_.createTypedArray(m.length,f.length);y.set(f);var C=R;if(0!==o){var A=T.fromAxisAngle(l,o,F);if(C=v.fromQuaternion(A,C),t.tangent||t.bitangent){A=T.fromAxisAngle(l,-o,F);var b=v.fromQuaternion(A,L);u=n.normalize(v.multiplyByVector(b,u,u),u),t.bitangent&&(c=n.normalize(n.cross(l,u,c),c))}}else C=v.clone(v.IDENTITY,C);var D=P;t.st&&(D.x=i.x,D.y=i.y);for(var O=m.length,I=3*O,M=new Float64Array(I),N=t.normal?new Float32Array(I):void 0,V=t.tangent?new Float32Array(I):void 0,U=t.bitangent?new Float32Array(I):void 0,z=t.st?new Float32Array(2*O):void 0,B=0,H=0,k=0,G=0,W=0,Y=0;Y<O;Y++){var j=m[Y];if(M[B++]=j.x,M[B++]=j.y,M[B++]=j.z,t.st){var X=s(v.multiplyByVector(C,j,E),S);r.subtract(X,D,X);var Q=g.clamp(X.x/i.width,0,1),q=g.clamp(X.y/i.height,0,1);z[W++]=Q,z[W++]=q}t.normal&&(N[H++]=l.x,N[H++]=l.y,N[H++]=l.z),t.tangent&&(V[G++]=u.x,V[G++]=u.y,V[G++]=u.z),t.bitangent&&(U[k++]=c.x,U[k++]=c.y,U[k++]=c.z)}var Z=new p;return t.position&&(Z.position=new h({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:M})),t.normal&&(Z.normal=new h({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:N})),t.tangent&&(Z.tangent=new h({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:V})),t.bitangent&&(Z.bitangent=new h({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:U})),t.st&&(Z.st=new h({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:z})),new d({attributes:Z,indices:y,primitiveType:w.TRIANGLES})}function z(e){var t=(e=l(e,l.EMPTY_OBJECT)).polygonHierarchy,i=l(e.vertexFormat,C.DEFAULT);this._vertexFormat=C.clone(i),this._polygonHierarchy=t,this._stRotation=l(e.stRotation,0),this._ellipsoid=c.clone(l(e.ellipsoid,c.WGS84)),this._workerName="createCoplanarPolygonGeometry",this.packedLength=y.computeHierarchyPackedLength(t)+C.packedLength+c.packedLength+2}z.fromPositions=function(e){return new z({polygonHierarchy:{positions:(e=l(e,l.EMPTY_OBJECT)).positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid})},z.pack=function(e,t,i){return i=l(i,0),i=y.packPolygonHierarchy(e._polygonHierarchy,t,i),c.pack(e._ellipsoid,t,i),i+=c.packedLength,C.pack(e._vertexFormat,t,i),i+=C.packedLength,t[i++]=e._stRotation,t[i]=e.packedLength,t};var B=c.clone(c.UNIT_SPHERE),H=new C,k={polygonHierarchy:{}};return z.unpack=function(e,t,i){t=l(t,0);var r=y.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var n=c.unpack(e,t,B);t+=c.packedLength;var o=C.unpack(e,t,H);t+=C.packedLength;var a=e[t++],s=e[t];return u(i)||(i=new z(k)),i._polygonHierarchy=r,i._ellipsoid=c.clone(n,i._ellipsoid),i._vertexFormat=C.clone(o,i._vertexFormat),i._stRotation=a,i.packedLength=s,i},z.createGeometry=function(t){var r=t._vertexFormat,o=t._polygonHierarchy,a=t._stRotation,l=o.positions;if(!((l=e(l,n.equalsEpsilon,!0)).length<3)){var u=b,c=D,h=O,p=M,v=N;if(s.computeProjectTo2DArguments(l,I,p,v)){if(u=n.cross(p,v,u),u=n.normalize(u,u),!n.equalsEpsilon(I,n.ZERO,g.EPSILON6)){var x=t._ellipsoid.geodeticSurfaceNormal(I,V);n.dot(u,x)<0&&(u=n.negate(u,u),p=n.negate(p,p))}var w=s.createProjectPointsTo2DFunction(I,p,v),T=s.createProjectPointTo2DFunction(I,p,v);r.tangent&&(c=n.clone(p,c)),r.bitangent&&(h=n.clone(v,h));var C=y.polygonsFromHierarchy(o,w,!1),E=C.hierarchy,S=C.polygons;if(0!==E.length){l=E[0].outerRing;for(var P=i.fromPoints(l),F=y.computeBoundingRectangle(u,T,l,a,A),R=[],L=0;L<S.length;L++){var z=new m({geometry:U(S[L],r,F,a,T,u,c,h)});R.push(z)}var B=f.combineInstances(R)[0];B.attributes.position.values=new Float64Array(B.attributes.position.values),B.indices=_.createTypedArray(B.attributes.position.values.length/3,B.indices);var H=B.attributes;return r.position||delete H.position,new d({attributes:H,indices:B.indices,primitiveType:B.primitiveType,boundingSphere:P})}}}},z}.apply(t,r))||(e.exports=n)},1964:function(e,t,i){var r,n;r=[i(149),i(33),i(12),i(16),i(34),i(765),i(9),i(8),i(52),i(53),i(65),i(64),i(121),i(50),i(246),i(130),i(45)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";function g(e){for(var t=e.length,i=new Float64Array(3*t),r=p.createTypedArray(t,2*t),o=0,a=0,s=0;s<t;s++){var d=e[s];i[o++]=d.x,i[o++]=d.y,i[o++]=d.z,r[a++]=s,r[a++]=(s+1)%t}var h=new c({position:new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:i})});return new l({attributes:h,indices:r,primitiveType:_.LINES})}function v(e){var t=(e=a(e,a.EMPTY_OBJECT)).polygonHierarchy;this._polygonHierarchy=t,this._workerName="createCoplanarPolygonOutlineGeometry",this.packedLength=m.computeHierarchyPackedLength(t)+1}v.fromPositions=function(e){return new v({polygonHierarchy:{positions:(e=a(e,a.EMPTY_OBJECT)).positions}})},v.pack=function(e,t,i){return i=a(i,0),t[i=m.packPolygonHierarchy(e._polygonHierarchy,t,i)]=e.packedLength,t};var y={polygonHierarchy:{}};return v.unpack=function(e,t,i){t=a(t,0);var r=m.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var n=e[t];return s(i)||(i=new v(y)),i._polygonHierarchy=r,i.packedLength=n,i},v.createGeometry=function(r){var n=r._polygonHierarchy,a=n.positions;if(!((a=e(a,i.equalsEpsilon,!0)).length<3)&&o.validOutline(a)){var s=m.polygonOutlinesFromHierarchy(n,!1);if(0!==s.length){for(var u=[],c=0;c<s.length;c++){var p=new d({geometry:g(s[c])});u.push(p)}var f=h.combineInstances(u)[0],_=t.fromPoints(n.positions);return new l({attributes:f.attributes,indices:f.indices,primitiveType:f.primitiveType,boundingSphere:_})}}},v}.apply(t,r))||(e.exports=n)},1965:function(e,t,i){var r,n;r=[i(148),i(94),i(62),i(33),i(24),i(12),i(32),i(16),i(34),i(9),i(8),i(10),i(11),i(26),i(209),i(266),i(186),i(52),i(53),i(64),i(73),i(121),i(50),i(14),i(171),i(43),i(246),i(130),i(54),i(29),i(76),i(142)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O,I){"use strict";var M=new a,N=new a;function F(e,t,i,r){var n=r.cartesianToCartographic(e,M).height,o=r.cartesianToCartographic(t,N);o.height=n,r.cartographicToCartesian(o,t);var a=r.cartesianToCartographic(i,N);a.height=n-100,r.cartographicToCartesian(a,i)}var R=new i,L=new o,V=new o,U=new o,z=new o,B=new o,H=new o,k=new o,G=new o,W=new o,Y=new n,j=new n,X=new o,Q=new b,q=new A,Z=new A;function K(e){var i=e.vertexFormat,r=e.geometry,a=e.shadowVolume,s=r.attributes.position.values,u=s.length,d=e.wall,h=e.top||d,p=e.bottom||d;if(i.st||i.normal||i.tangent||i.bitangent||a){var m=e.boundingRectangle,f=e.tangentPlane,_=e.ellipsoid,g=e.stRotation,y=e.perPositionHeight,w=Y;w.x=m.x,w.y=m.y;var T,E=i.st?new Float32Array(u/3*2):void 0;i.normal&&(T=y&&h&&!d?r.attributes.normal.values:new Float32Array(u));var S=i.tangent?new Float32Array(u):void 0,P=i.bitangent?new Float32Array(u):void 0,D=a?new Float32Array(u):void 0,O=0,I=0,M=V,N=U,R=z,K=!0,J=q,$=Z;if(0!==g){var ee=b.fromAxisAngle(f._plane.normal,g,Q);J=A.fromQuaternion(ee,J),ee=b.fromAxisAngle(f._plane.normal,-g,Q),$=A.fromQuaternion(ee,$)}else J=A.clone(A.IDENTITY,J),$=A.clone(A.IDENTITY,$);var te=0,ie=0;h&&p&&(te=u/2,ie=u/3,u/=2);for(var re=0;re<u;re+=3){var ne=o.fromArray(s,re,X);if(i.st){var oe=A.multiplyByVector(J,ne,L);oe=_.scaleToGeodeticSurface(oe,oe);var ae=f.projectPointOntoPlane(oe,j);n.subtract(ae,w,ae);var se=C.clamp(ae.x/m.width,0,1),le=C.clamp(ae.y/m.height,0,1);p&&(E[O+ie]=se,E[O+1+ie]=le),h&&(E[O]=se,E[O+1]=le),O+=2}if(i.normal||i.tangent||i.bitangent||a){var ue=I+1,ce=I+2;if(d){if(re+3<u){var de=o.fromArray(s,re+3,B);if(K){var he=o.fromArray(s,re+u,H);y&&F(ne,de,he,_),o.subtract(de,ne,de),o.subtract(he,ne,he),M=o.normalize(o.cross(he,de,M),M),K=!1}o.equalsEpsilon(de,ne,C.EPSILON10)&&(K=!0)}(i.tangent||i.bitangent)&&(R=_.geodeticSurfaceNormal(ne,R),i.tangent&&(N=o.normalize(o.cross(R,M,N),N)))}else M=_.geodeticSurfaceNormal(ne,M),(i.tangent||i.bitangent)&&(y&&(k=o.fromArray(T,I,k),G=o.cross(o.UNIT_Z,k,G),G=o.normalize(A.multiplyByVector($,G,G),G),i.bitangent&&(W=o.normalize(o.cross(k,G,W),W))),N=o.cross(o.UNIT_Z,M,N),N=o.normalize(A.multiplyByVector($,N,N),N),i.bitangent&&(R=o.normalize(o.cross(M,N,R),R)));i.normal&&(e.wall?(T[I+te]=M.x,T[ue+te]=M.y,T[ce+te]=M.z):p&&(T[I+te]=-M.x,T[ue+te]=-M.y,T[ce+te]=-M.z),(h&&!y||d)&&(T[I]=M.x,T[ue]=M.y,T[ce]=M.z)),a&&(d&&(M=_.geodeticSurfaceNormal(ne,M)),D[I+te]=-M.x,D[ue+te]=-M.y,D[ce+te]=-M.z),i.tangent&&(e.wall?(S[I+te]=N.x,S[ue+te]=N.y,S[ce+te]=N.z):p&&(S[I+te]=-N.x,S[ue+te]=-N.y,S[ce+te]=-N.z),h&&(y?(S[I]=G.x,S[ue]=G.y,S[ce]=G.z):(S[I]=N.x,S[ue]=N.y,S[ce]=N.z))),i.bitangent&&(p&&(P[I+te]=R.x,P[ue+te]=R.y,P[ce+te]=R.z),h&&(y?(P[I]=W.x,P[ue]=W.y,P[ce]=W.z):(P[I]=R.x,P[ue]=R.y,P[ce]=R.z))),I+=3}}i.st&&(r.attributes.st=new v({componentDatatype:l.FLOAT,componentsPerAttribute:2,values:E})),i.normal&&(r.attributes.normal=new v({componentDatatype:l.FLOAT,componentsPerAttribute:3,values:T})),i.tangent&&(r.attributes.tangent=new v({componentDatatype:l.FLOAT,componentsPerAttribute:3,values:S})),i.bitangent&&(r.attributes.bitangent=new v({componentDatatype:l.FLOAT,componentsPerAttribute:3,values:P})),a&&(r.attributes.extrudeDirection=new v({componentDatatype:l.FLOAT,componentsPerAttribute:3,values:D}))}if(e.extrude&&c(e.offsetAttribute)){var pe=s.length/3,me=new Uint8Array(pe);if(e.offsetAttribute===x.TOP)h&&p||d?me=t(me,1,0,pe/2):h&&(me=t(me,1));else{var fe=e.offsetAttribute===x.NONE?0:1;me=t(me,fe)}r.attributes.applyOffset=new v({componentDatatype:l.UNSIGNED_BYTE,componentsPerAttribute:1,values:me})}return r}var J=new a,$=new a,ee={westOverIDL:0,eastOverIDL:0},te=new m;function ie(t,i,r,n,o){if(o=u(o,new D),!c(t)||t.length<3)return o.west=0,o.north=0,o.south=0,o.east=0,o;if(r===e.RHUMB)return D.fromCartesianArray(t,i,o);te.ellipsoid.equals(i)||(te=new m(void 0,void 0,i)),o.west=Number.POSITIVE_INFINITY,o.east=Number.NEGATIVE_INFINITY,o.south=Number.POSITIVE_INFINITY,o.north=Number.NEGATIVE_INFINITY,ee.westOverIDL=Number.POSITIVE_INFINITY,ee.eastOverIDL=Number.NEGATIVE_INFINITY;for(var a,s=1/C.chordLength(n,i.maximumRadius),l=t.length,d=i.cartesianToCartographic(t[0],$),h=J,p=1;p<l;p++)a=h,h=d,d=i.cartesianToCartographic(t[p],a),te.setEndPoints(h,d),ne(te,s,o,ee);return a=h,h=d,d=i.cartesianToCartographic(t[0],a),te.setEndPoints(h,d),ne(te,s,o,ee),o.east-o.west>ee.eastOverIDL-ee.westOverIDL&&(o.west=ee.westOverIDL,o.east=ee.eastOverIDL,o.east>C.PI&&(o.east=o.east-C.TWO_PI),o.west>C.PI&&(o.west=o.west-C.TWO_PI)),o}var re=new a;function ne(e,t,i,r){for(var n=e.surfaceDistance,o=Math.ceil(n*t),a=o>0?n/(o-1):Number.POSITIVE_INFINITY,s=0,l=0;l<o;l++){var u=e.interpolateUsingSurfaceDistance(s,re);s+=a;var c=u.longitude,d=u.latitude;i.west=Math.min(i.west,c),i.east=Math.max(i.east,c),i.south=Math.min(i.south,d),i.north=Math.max(i.north,d);var h=c>=0?c:c+C.TWO_PI;r.westOverIDL=Math.min(r.westOverIDL,h),r.eastOverIDL=Math.max(r.eastOverIDL,h)}}var oe=[];function ae(e,t,i,r,n,o,a,s,l){var u,c={walls:[]};if(o||a){var d,h,p=S.createGeometryFromPositions(e,t,i,n,s,l),m=p.attributes.position.values,f=p.indices;if(o&&a){var g=m.concat(m);d=g.length/3,(h=T.createTypedArray(d,2*f.length)).set(f);var v=f.length,x=d/2;for(u=0;u<v;u+=3){var w=h[u]+x,C=h[u+1]+x,E=h[u+2]+x;h[u+v]=E,h[u+1+v]=C,h[u+2+v]=w}if(p.attributes.position.values=g,n&&s.normal){var A=p.attributes.normal.values;p.attributes.normal.values=new Float32Array(g.length),p.attributes.normal.values.set(A)}p.indices=h}else if(a){for(d=m.length/3,h=T.createTypedArray(d,f.length),u=0;u<f.length;u+=3)h[u]=f[u+2],h[u+1]=f[u+1],h[u+2]=f[u];p.indices=h}c.topAndBottom=new y({geometry:p})}var b=r.outerRing,D=_.fromPoints(b,e),O=D.projectPointsOntoPlane(b,oe),M=P.computeWindingOrder2D(O);M===I.CLOCKWISE&&(b=b.slice().reverse());var N=S.computeWallGeometry(b,e,i,n,l);c.walls.push(new y({geometry:N}));var F=r.holes;for(u=0;u<F.length;u++){var R=F[u];O=(D=_.fromPoints(R,e)).projectPointsOntoPlane(R,oe),(M=P.computeWindingOrder2D(O))===I.COUNTER_CLOCKWISE&&(R=R.slice().reverse()),N=S.computeWallGeometry(R,e,i,n,l),c.walls.push(new y({geometry:N}))}return c}function se(t){var i=t.polygonHierarchy,r=u(t.vertexFormat,O.DEFAULT),n=u(t.ellipsoid,p.WGS84),o=u(t.granularity,C.RADIANS_PER_DEGREE),a=u(t.stRotation,0),s=u(t.perPositionHeight,!1),l=s&&c(t.extrudedHeight),d=u(t.height,0),h=u(t.extrudedHeight,d);if(!l){var m=Math.max(d,h);h=Math.min(d,h),d=m}this._vertexFormat=O.clone(r),this._ellipsoid=p.clone(n),this._granularity=o,this._stRotation=a,this._height=d,this._extrudedHeight=h,this._closeTop=u(t.closeTop,!0),this._closeBottom=u(t.closeBottom,!0),this._polygonHierarchy=i,this._perPositionHeight=s,this._perPositionHeightExtrude=l,this._shadowVolume=u(t.shadowVolume,!1),this._workerName="createPolygonGeometry",this._offsetAttribute=t.offsetAttribute,this._arcType=u(t.arcType,e.GEODESIC),this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this.packedLength=S.computeHierarchyPackedLength(i)+p.packedLength+O.packedLength+12}se.fromPositions=function(e){return new se({polygonHierarchy:{positions:(e=u(e,u.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom,offsetAttribute:e.offsetAttribute,arcType:e.arcType})},se.pack=function(e,t,i){return i=u(i,0),i=S.packPolygonHierarchy(e._polygonHierarchy,t,i),p.pack(e._ellipsoid,t,i),i+=p.packedLength,O.pack(e._vertexFormat,t,i),i+=O.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._stRotation,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._closeTop?1:0,t[i++]=e._closeBottom?1:0,t[i++]=e._shadowVolume?1:0,t[i++]=u(e._offsetAttribute,-1),t[i++]=e._arcType,t[i]=e.packedLength,t};var le=p.clone(p.UNIT_SPHERE),ue=new O,ce={polygonHierarchy:{}};return se.unpack=function(e,t,i){t=u(t,0);var r=S.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var n=p.unpack(e,t,le);t+=p.packedLength;var o=O.unpack(e,t,ue);t+=O.packedLength;var a=e[t++],s=e[t++],l=e[t++],d=e[t++],h=1===e[t++],m=1===e[t++],f=1===e[t++],_=1===e[t++],g=1===e[t++],v=e[t++],y=e[t++],x=e[t];return c(i)||(i=new se(ce)),i._polygonHierarchy=r,i._ellipsoid=p.clone(n,i._ellipsoid),i._vertexFormat=O.clone(o,i._vertexFormat),i._height=a,i._extrudedHeight=s,i._granularity=l,i._stRotation=d,i._perPositionHeightExtrude=h,i._perPositionHeight=m,i._closeTop=f,i._closeBottom=_,i._shadowVolume=g,i._offsetAttribute=-1===v?void 0:v,i._arcType=y,i.packedLength=x,i},se.computeRectangle=function(t,i){var r=u(t.granularity,C.RADIANS_PER_DEGREE),n=u(t.arcType,e.GEODESIC),o=t.polygonHierarchy,a=u(t.ellipsoid,p.WGS84);return ie(o.positions,a,n,r,i)},se.createGeometry=function(e){var i=e._vertexFormat,n=e._ellipsoid,o=e._granularity,a=e._stRotation,s=e._polygonHierarchy,u=e._perPositionHeight,d=e._closeTop,h=e._closeBottom,p=e._arcType,m=s.positions;if(!(m.length<3)){var f=_.fromPoints(m,n),E=S.polygonsFromHierarchy(s,f.projectPointsOntoPlane.bind(f),!u,n),A=E.hierarchy,b=E.polygons;if(0!==A.length){m=A[0].outerRing;var D,O=S.computeBoundingRectangle(f.plane.normal,f.projectPointOntoPlane.bind(f),m,a,R),I=[],M=e._height,N=e._extrudedHeight,F={perPositionHeight:u,vertexFormat:i,geometry:void 0,tangentPlane:f,boundingRectangle:O,ellipsoid:n,stRotation:a,bottom:!1,top:!0,wall:!1,extrude:!1,arcType:p};if(e._perPositionHeightExtrude||!C.equalsEpsilon(M,N,0,C.EPSILON2))for(F.extrude=!0,F.top=d,F.bottom=h,F.shadowVolume=e._shadowVolume,F.offsetAttribute=e._offsetAttribute,D=0;D<b.length;D++){var L,V=ae(n,b[D],o,A[D],u,d,h,i,p);d&&h?(L=V.topAndBottom,F.geometry=S.scaleToGeodeticHeightExtruded(L.geometry,M,N,n,u)):d?((L=V.topAndBottom).geometry.attributes.position.values=P.scaleToGeodeticHeight(L.geometry.attributes.position.values,M,n,!u),F.geometry=L.geometry):h&&((L=V.topAndBottom).geometry.attributes.position.values=P.scaleToGeodeticHeight(L.geometry.attributes.position.values,N,n,!0),F.geometry=L.geometry),(d||h)&&(F.wall=!1,L.geometry=K(F),I.push(L));var U=V.walls;F.wall=!0;for(var z=0;z<U.length;z++){var B=U[z];F.geometry=S.scaleToGeodeticHeightExtruded(B.geometry,M,N,n,u),B.geometry=K(F),I.push(B)}}else for(D=0;D<b.length;D++){var H=new y({geometry:S.createGeometryFromPositions(n,b[D],o,u,i,p)});if(H.geometry.attributes.position.values=P.scaleToGeodeticHeight(H.geometry.attributes.position.values,M,n,!u),F.geometry=H.geometry,H.geometry=K(F),c(e._offsetAttribute)){var k=H.geometry.attributes.position.values.length,G=new Uint8Array(k/3),W=e._offsetAttribute===x.NONE?0:1;t(G,W),H.geometry.attributes.applyOffset=new v({componentDatatype:l.UNSIGNED_BYTE,componentsPerAttribute:1,values:G})}I.push(H)}var Y=w.combineInstances(I)[0];Y.attributes.position.values=new Float64Array(Y.attributes.position.values),Y.indices=T.createTypedArray(Y.attributes.position.values.length/3,Y.indices);var j=Y.attributes,X=r.fromVertices(j.position.values);return i.position||delete j.position,new g({attributes:j,indices:Y.indices,primitiveType:Y.primitiveType,boundingSphere:X,offsetAttribute:e._offsetAttribute})}}},se.createShadowVolume=function(e,t,i){var r=e._granularity,n=e._ellipsoid,o=t(r,n),a=i(r,n);return new se({polygonHierarchy:e._polygonHierarchy,ellipsoid:n,stRotation:e._stRotation,granularity:r,perPositionHeight:!1,extrudedHeight:o,height:a,vertexFormat:O.POSITION_ONLY,shadowVolume:!0,arcType:e._arcType})},d(se.prototype,{rectangle:{get:function(){if(!c(this._rectangle)){var e=this._polygonHierarchy.positions;this._rectangle=ie(e,this._ellipsoid,this._arcType,this._granularity)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return c(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){var t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];var i=e._ellipsoid,r=e._polygonHierarchy.positions,n=e.rectangle;return g._textureCoordinateRotationPoints(r,t,i,n)}(this)),this._textureCoordinateRotationPoints}}}),se}.apply(t,r))||(e.exports=n)},1966:function(e,t,i){var r,n;r=[i(148),i(94),i(149),i(33),i(12),i(16),i(34),i(9),i(8),i(11),i(26),i(186),i(52),i(53),i(65),i(64),i(73),i(121),i(50),i(14),i(246),i(130),i(45),i(323),i(142)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E){"use strict";var A=[],S=[];function P(t,i,r,n,o){var s,l,u=d.fromPoints(i,t).projectPointsOntoPlane(i,A);w.computeWindingOrder2D(u)===E.CLOCKWISE&&(u.reverse(),i=i.slice().reverse());var c=i.length,_=0;if(n)for(s=new Float64Array(2*c*3),l=0;l<c;l++){var g=i[l],y=i[(l+1)%c];s[_++]=g.x,s[_++]=g.y,s[_++]=g.z,s[_++]=y.x,s[_++]=y.y,s[_++]=y.z}else{var C=0;if(o===e.GEODESIC)for(l=0;l<c;l++)C+=x.subdivideLineCount(i[l],i[(l+1)%c],r);else if(o===e.RHUMB)for(l=0;l<c;l++)C+=x.subdivideRhumbLineCount(t,i[l],i[(l+1)%c],r);for(s=new Float64Array(3*C),l=0;l<c;l++){var P;o===e.GEODESIC?P=x.subdivideLine(i[l],i[(l+1)%c],r,S):o===e.RHUMB&&(P=x.subdivideRhumbLine(t,i[l],i[(l+1)%c],r,S));for(var b=P.length,D=0;D<b;++D)s[_++]=P[D]}}var O=2*(c=s.length/3),I=v.createTypedArray(c,O);for(_=0,l=0;l<c-1;l++)I[_++]=l,I[_++]=l+1;return I[_++]=c-1,I[_++]=0,new f({geometry:new h({attributes:new m({position:new p({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:s})}),indices:I,primitiveType:T.LINES})})}function b(t,i,r,n,o){var s,l,u=d.fromPoints(i,t).projectPointsOntoPlane(i,A);w.computeWindingOrder2D(u)===E.CLOCKWISE&&(u.reverse(),i=i.slice().reverse());var c=i.length,_=new Array(c),g=0;if(n)for(s=new Float64Array(2*c*3*2),l=0;l<c;++l){_[l]=g/3;var y=i[l],C=i[(l+1)%c];s[g++]=y.x,s[g++]=y.y,s[g++]=y.z,s[g++]=C.x,s[g++]=C.y,s[g++]=C.z}else{var P=0;if(o===e.GEODESIC)for(l=0;l<c;l++)P+=x.subdivideLineCount(i[l],i[(l+1)%c],r);else if(o===e.RHUMB)for(l=0;l<c;l++)P+=x.subdivideRhumbLineCount(t,i[l],i[(l+1)%c],r);for(s=new Float64Array(3*P*2),l=0;l<c;++l){var b;_[l]=g/3,o===e.GEODESIC?b=x.subdivideLine(i[l],i[(l+1)%c],r,S):o===e.RHUMB&&(b=x.subdivideRhumbLine(t,i[l],i[(l+1)%c],r,S));for(var D=b.length,O=0;O<D;++O)s[g++]=b[O]}}c=s.length/6;var I=_.length,M=2*(2*c+I),N=v.createTypedArray(c+I,M);for(g=0,l=0;l<c;++l)N[g++]=l,N[g++]=(l+1)%c,N[g++]=l+c,N[g++]=(l+1)%c+c;for(l=0;l<I;l++){var F=_[l];N[g++]=F,N[g++]=F+c}return new f({geometry:new h({attributes:new m({position:new p({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:s})}),indices:N,primitiveType:T.LINES})})}function D(t){var i=t.polygonHierarchy,r=s(t.ellipsoid,c.WGS84),n=s(t.granularity,y.RADIANS_PER_DEGREE),o=s(t.perPositionHeight,!1),a=o&&l(t.extrudedHeight),u=s(t.arcType,e.GEODESIC),d=s(t.height,0),h=s(t.extrudedHeight,d);if(!a){var p=Math.max(d,h);h=Math.min(d,h),d=p}this._ellipsoid=c.clone(r),this._granularity=n,this._height=d,this._extrudedHeight=h,this._arcType=u,this._polygonHierarchy=i,this._perPositionHeight=o,this._perPositionHeightExtrude=a,this._offsetAttribute=t.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=x.computeHierarchyPackedLength(i)+c.packedLength+8}D.pack=function(e,t,i){return i=s(i,0),i=x.packPolygonHierarchy(e._polygonHierarchy,t,i),c.pack(e._ellipsoid,t,i),i+=c.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._arcType,t[i++]=s(e._offsetAttribute,-1),t[i]=e.packedLength,t};var O=c.clone(c.UNIT_SPHERE),I={polygonHierarchy:{}};return D.unpack=function(e,t,i){t=s(t,0);var r=x.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var n=c.unpack(e,t,O);t+=c.packedLength;var o=e[t++],a=e[t++],u=e[t++],d=1===e[t++],h=1===e[t++],p=e[t++],m=e[t++],f=e[t];return l(i)||(i=new D(I)),i._polygonHierarchy=r,i._ellipsoid=c.clone(n,i._ellipsoid),i._height=o,i._extrudedHeight=a,i._granularity=u,i._perPositionHeight=h,i._perPositionHeightExtrude=d,i._arcType=p,i._offsetAttribute=-1===m?void 0:m,i.packedLength=f,i},D.fromPositions=function(e){return new D({polygonHierarchy:{positions:(e=s(e,s.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},D.createGeometry=function(e){var i=e._ellipsoid,n=e._granularity,o=e._polygonHierarchy,s=e._perPositionHeight,u=e._arcType,c=x.polygonOutlinesFromHierarchy(o,!s,i);if(0!==c.length){var d,m,f,v=[],T=y.chordLength(n,i.maximumRadius),C=e._height,E=e._extrudedHeight;if(e._perPositionHeightExtrude||!y.equalsEpsilon(C,E,0,y.EPSILON2))for(f=0;f<c.length;f++){if((d=b(i,c[f],T,s,u)).geometry=x.scaleToGeodeticHeightExtruded(d.geometry,C,E,i,s),l(e._offsetAttribute)){var A=d.geometry.attributes.position.values.length/3,S=new Uint8Array(A);e._offsetAttribute===_.TOP?S=t(S,1,0,A/2):(m=e._offsetAttribute===_.NONE?0:1,S=t(S,m)),d.geometry.attributes.applyOffset=new p({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:S})}v.push(d)}else for(f=0;f<c.length;f++){if((d=P(i,c[f],T,s,u)).geometry.attributes.position.values=w.scaleToGeodeticHeight(d.geometry.attributes.position.values,C,i,!s),l(e._offsetAttribute)){var D=d.geometry.attributes.position.values.length,O=new Uint8Array(D/3);m=e._offsetAttribute===_.NONE?0:1,t(O,m),d.geometry.attributes.applyOffset=new p({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}v.push(d)}var I=g.combineInstances(v)[0],M=r.fromVertices(I.attributes.position.values);return new h({attributes:I.attributes,indices:I.indices,primitiveType:I.primitiveType,boundingSphere:M,offsetAttribute:e._offsetAttribute})}},D}.apply(t,r))||(e.exports=n)},1967:function(e,t,i){var r,n;r=[i(16),i(22),i(67),i(8),i(11),i(97),i(64),i(80),i(1968),i(1969),i(91),i(133),i(74),i(75),i(165),i(134),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=new t;function v(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function y(e,t){f.call(this,{entity:e,scene:t,geometryOptions:new v(e),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function x(e,t,i){m.call(this,e,t,i)}return r(Object.create)&&(y.prototype=Object.create(f.prototype),y.prototype.constructor=y),y.prototype.createFillGeometryInstance=function(e){var n,s,u=this._entity,d=u.isAvailable(e),h=new c(d&&u.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),m=this._distanceDisplayConditionProperty.getValue(e),f=o.fromDistanceDisplayCondition(m);this._materialProperty instanceof p?(r(this._materialProperty.color)&&(this._materialProperty.color.isConstant||d)&&(s=this._materialProperty.color.getValue(e,g)),r(s)||(s=t.WHITE),n={show:h,distanceDisplayCondition:f,color:i.fromColor(s)}):n={show:h,distanceDisplayCondition:f};return new a({id:u,geometry:new l(this._options),attributes:n})},y.prototype.createOutlineGeometryInstance=function(e){var r=this._entity,n=r.isAvailable(e),s=_.getValueOrDefault(this._outlineColorProperty,e,t.BLACK,g),l=this._distanceDisplayConditionProperty.getValue(e);return new a({id:r,geometry:new u(this._options),attributes:{show:new c(n&&r.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:i.fromColor(s),distanceDisplayCondition:o.fromDistanceDisplayCondition(l)}})},y.prototype._isHidden=function(e,t){return!r(t.positions)||!r(t.shape)||f.prototype._isHidden.call(this,e,t)},y.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&t.shape.isConstant&&_.isConstant(t.granularity)&&_.isConstant(t.outlineWidth)&&_.isConstant(t.cornerType))},y.prototype._setStaticOptions=function(e,t){var i=t.granularity,n=t.cornerType,o=this._options,a=this._materialProperty instanceof p;o.vertexFormat=a?h.VERTEX_FORMAT:d.MaterialSupport.TEXTURED.vertexFormat,o.polylinePositions=t.positions.getValue(s.MINIMUM_VALUE,o.polylinePositions),o.shapePositions=t.shape.getValue(s.MINIMUM_VALUE,o.shape),o.granularity=r(i)?i.getValue(s.MINIMUM_VALUE):void 0,o.cornerType=r(n)?n.getValue(s.MINIMUM_VALUE):void 0},y.DynamicGeometryUpdater=x,r(Object.create)&&(x.prototype=Object.create(m.prototype),x.prototype.constructor=x),x.prototype._isHidden=function(e,t,i){var n=this._options;return!r(n.polylinePositions)||!r(n.shapePositions)||m.prototype._isHidden.call(this,e,t,i)},x.prototype._setOptions=function(e,t,i){var r=this._options;r.polylinePositions=_.getValueOrUndefined(t.positions,i,r.polylinePositions),r.shapePositions=_.getValueOrUndefined(t.shape,i),r.granularity=_.getValueOrUndefined(t.granularity,i),r.cornerType=_.getValueOrUndefined(t.cornerType,i)},y}.apply(t,r))||(e.exports=n)},1968:function(e,t,i){var r,n;r=[i(149),i(62),i(33),i(24),i(12),i(34),i(197),i(9),i(8),i(11),i(26),i(52),i(53),i(65),i(121),i(50),i(14),i(189),i(130),i(502),i(45),i(76),i(142)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T){"use strict";function C(e){var t=(e=s(e,s.EMPTY_OBJECT)).polylinePositions,i=e.shapePositions;this._positions=t,this._shape=i,this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84)),this._cornerType=s(e.cornerType,a.ROUNDED),this._vertexFormat=w.clone(s(e.vertexFormat,w.DEFAULT)),this._granularity=s(e.granularity,_.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";var o=1+t.length*n.packedLength;o+=1+i.length*r.packedLength,this.packedLength=o+c.packedLength+w.packedLength+2}C.pack=function(e,t,i){var o;i=s(i,0);var a=e._positions,l=a.length;for(t[i++]=l,o=0;o<l;++o,i+=n.packedLength)n.pack(a[o],t,i);var u=e._shape;for(l=u.length,t[i++]=l,o=0;o<l;++o,i+=r.packedLength)r.pack(u[o],t,i);return c.pack(e._ellipsoid,t,i),i+=c.packedLength,w.pack(e._vertexFormat,t,i),i+=w.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var E=c.clone(c.UNIT_SPHERE),A=new w,S={polylinePositions:void 0,shapePositions:void 0,ellipsoid:E,vertexFormat:A,cornerType:void 0,granularity:void 0};C.unpack=function(e,t,i){var o;t=s(t,0);var a=e[t++],u=new Array(a);for(o=0;o<a;++o,t+=n.packedLength)u[o]=n.unpack(e,t);a=e[t++];var d=new Array(a);for(o=0;o<a;++o,t+=r.packedLength)d[o]=r.unpack(e,t);var h=c.unpack(e,t,E);t+=c.packedLength;var p=w.unpack(e,t,A);t+=w.packedLength;var m=e[t++],f=e[t];return l(i)?(i._positions=u,i._shape=d,i._ellipsoid=c.clone(h,i._ellipsoid),i._vertexFormat=w.clone(p,i._vertexFormat),i._cornerType=m,i._granularity=f,i):(S.polylinePositions=u,S.shapePositions=d,S.cornerType=m,S.granularity=f,new C(S))};var P=new t;return C.createGeometry=function(r){var a=r._positions,s=e(a,n.equalsEpsilon),l=r._shape;if(l=y.removeDuplicatesFromShape(l),!(s.length<2||l.length<3)){v.computeWindingOrder2D(l)===T.CLOCKWISE&&l.reverse();var u=t.fromPoints(l,P);return function(e,t,r,n){var a=new p;n.position&&(a.position=new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:e}));var s,l,u,c,_,y,w=t.length,T=e.length/3,C=(T-2*w)/(2*w),E=v.triangulate(t),A=(C-1)*w*6+2*E.length,S=f.createTypedArray(T,A),P=2*w,b=0;for(s=0;s<C-1;s++){for(l=0;l<w-1;l++)y=(u=2*l+s*w*2)+P,_=(c=u+1)+P,S[b++]=c,S[b++]=u,S[b++]=_,S[b++]=_,S[b++]=u,S[b++]=y;_=(c=1+(u=2*w-2+s*w*2))+P,y=u+P,S[b++]=c,S[b++]=u,S[b++]=_,S[b++]=_,S[b++]=u,S[b++]=y}if(n.st||n.tangent||n.bitangent){var D,O,I=new Float32Array(2*T),M=1/(C-1),N=1/r.height,F=r.height/2,R=0;for(s=0;s<C;s++){for(D=s*M,O=N*(t[0].y+F),I[R++]=D,I[R++]=O,l=1;l<w;l++)O=N*(t[l].y+F),I[R++]=D,I[R++]=O,I[R++]=D,I[R++]=O;O=N*(t[0].y+F),I[R++]=D,I[R++]=O}for(l=0;l<w;l++)D=0,O=N*(t[l].y+F),I[R++]=D,I[R++]=O;for(l=0;l<w;l++)D=(C-1)*M,O=N*(t[l].y+F),I[R++]=D,I[R++]=O;a.st=new h({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:new Float32Array(I)})}var L=T-2*w;for(s=0;s<E.length;s+=3){var V=E[s]+L,U=E[s+1]+L,z=E[s+2]+L;S[b++]=V,S[b++]=U,S[b++]=z,S[b++]=z+w,S[b++]=U+w,S[b++]=V+w}var B=new d({attributes:a,indices:S,boundingSphere:i.fromVertices(e),primitiveType:x.TRIANGLES});if(n.normal&&(B=m.computeNormal(B)),n.tangent||n.bitangent){try{B=m.computeTangentAndBitangent(B)}catch(e){g("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}n.tangent||(B.attributes.tangent=void 0),n.bitangent||(B.attributes.bitangent=void 0),n.st||(B.attributes.st=void 0)}return B}(y.computePositions(s,l,u,r,!0),l,u,r._vertexFormat)}},C}.apply(t,r))||(e.exports=n)},1969:function(e,t,i){var r,n;r=[i(149),i(62),i(33),i(24),i(12),i(34),i(197),i(9),i(8),i(11),i(26),i(52),i(53),i(65),i(50),i(14),i(130),i(502),i(45),i(142)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y){"use strict";function x(e){var t=(e=s(e,s.EMPTY_OBJECT)).polylinePositions,i=e.shapePositions;this._positions=t,this._shape=i,this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84)),this._cornerType=s(e.cornerType,a.ROUNDED),this._granularity=s(e.granularity,f.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var o=1+t.length*n.packedLength;o+=1+i.length*r.packedLength,this.packedLength=o+c.packedLength+2}x.pack=function(e,t,i){var o;i=s(i,0);var a=e._positions,l=a.length;for(t[i++]=l,o=0;o<l;++o,i+=n.packedLength)n.pack(a[o],t,i);var u=e._shape;for(l=u.length,t[i++]=l,o=0;o<l;++o,i+=r.packedLength)r.pack(u[o],t,i);return c.pack(e._ellipsoid,t,i),i+=c.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var w=c.clone(c.UNIT_SPHERE),T={polylinePositions:void 0,shapePositions:void 0,ellipsoid:w,height:void 0,cornerType:void 0,granularity:void 0};x.unpack=function(e,t,i){var o;t=s(t,0);var a=e[t++],u=new Array(a);for(o=0;o<a;++o,t+=n.packedLength)u[o]=n.unpack(e,t);a=e[t++];var d=new Array(a);for(o=0;o<a;++o,t+=r.packedLength)d[o]=r.unpack(e,t);var h=c.unpack(e,t,w);t+=c.packedLength;var p=e[t++],m=e[t];return l(i)?(i._positions=u,i._shape=d,i._ellipsoid=c.clone(h,i._ellipsoid),i._cornerType=p,i._granularity=m,i):(T.polylinePositions=u,T.shapePositions=d,T.cornerType=p,T.granularity=m,new x(T))};var C=new t;return x.createGeometry=function(r){var a=r._positions,s=e(a,n.equalsEpsilon),l=r._shape;if(l=g.removeDuplicatesFromShape(l),!(s.length<2||l.length<3)){_.computeWindingOrder2D(l)===y.CLOCKWISE&&l.reverse();var u=t.fromPoints(l,C);return function(e,t){var r=new p;r.position=new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:e});var n,a,s=t.length,l=r.position.values.length/3,u=e.length/3/s,c=m.createTypedArray(l,2*s*(u+1)),f=0,_=(n=0)*s;for(a=0;a<s-1;a++)c[f++]=a+_,c[f++]=a+_+1;for(c[f++]=s-1+_,c[f++]=_,_=(n=u-1)*s,a=0;a<s-1;a++)c[f++]=a+_,c[f++]=a+_+1;for(c[f++]=s-1+_,c[f++]=_,n=0;n<u-1;n++){var g=s*n,y=g+s;for(a=0;a<s;a++)c[f++]=a+g,c[f++]=a+y}return new d({attributes:r,indices:m.createTypedArray(l,c),boundingSphere:i.fromVertices(e),primitiveType:v.LINES})}(g.computePositions(s,l,u,r,!1),l)}},x}.apply(t,r))||(e.exports=n)},197:function(e,t,i){var r,n;r=[i(17)],void 0===(n=function(e){"use strict";return e({ROUNDED:0,MITERED:1,BEVELED:2})}.apply(t,r))||(e.exports=n)},1970:function(e,t,i){var r,n;r=[i(144),i(12),i(32),i(16),i(22),i(67),i(8),i(11),i(97),i(26),i(64),i(73),i(80),i(147),i(29),i(554),i(638),i(91),i(170),i(71),i(133),i(74),i(75),i(165),i(134),i(365),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S){"use strict";var P=new n,b=t.ZERO,D=new t,O=new m,I=new m,M=new i;function N(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0,this.offsetAttribute=void 0}function F(e,t){A.call(this,{entity:e,scene:t,geometryOptions:new N(e),geometryPropertyName:"rectangle",observedPropertyNames:["availability","rectangle"]}),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}function R(e,t,i){C.call(this,e,t,i)}return a(Object.create)&&(F.prototype=Object.create(A.prototype),F.prototype.constructor=F),F.prototype.createFillGeometryInstance=function(e){var t,i=this._entity,r=i.isAvailable(e),s={show:new g(r&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:l.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof T&&(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(t=this._materialProperty.color.getValue(e,P)),a(t)||(t=n.WHITE),s.color=o.fromColor(t));return a(this._options.offsetAttribute)&&(s.offset=p.fromCartesian3(S.getValueOrDefault(this._terrainOffsetProperty,e,b,D))),new c({id:i,geometry:new f(this._options),attributes:s})},F.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),r=S.getValueOrDefault(this._outlineColorProperty,e,n.BLACK,P),s=this._distanceDisplayConditionProperty.getValue(e),u={show:new g(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:o.fromColor(r),distanceDisplayCondition:l.fromDistanceDisplayCondition(s),offset:void 0};return a(this._options.offsetAttribute)&&(u.offset=p.fromCartesian3(S.getValueOrDefault(this._terrainOffsetProperty,e,b,D))),new c({id:t,geometry:new _(this._options),attributes:u})},F.prototype._computeCenter=function(e,t){var r=S.getValueOrUndefined(this._entity.rectangle.coordinates,e,I);if(a(r)){var n=m.center(r,M);return i.toCartesian(n,u.WGS84,t)}},F.prototype._isHidden=function(e,t){return!a(t.coordinates)||E.prototype._isHidden.call(this,e,t)},F.prototype._isDynamic=function(e,t){return!t.coordinates.isConstant||!S.isConstant(t.height)||!S.isConstant(t.extrudedHeight)||!S.isConstant(t.granularity)||!S.isConstant(t.stRotation)||!S.isConstant(t.rotation)||!S.isConstant(t.outlineWidth)||!S.isConstant(t.zIndex)||this._onTerrain&&!S.isConstant(this._materialProperty)},F.prototype._setStaticOptions=function(t,i){var r=this._materialProperty instanceof T,n=S.getValueOrUndefined(i.height,h.MINIMUM_VALUE),o=S.getValueOrDefault(i.heightReference,h.MINIMUM_VALUE,y.NONE),s=S.getValueOrUndefined(i.extrudedHeight,h.MINIMUM_VALUE),l=S.getValueOrDefault(i.extrudedHeightReference,h.MINIMUM_VALUE,y.NONE);a(s)&&!a(n)&&(n=0);var u=this._options;u.vertexFormat=r?w.VERTEX_FORMAT:x.MaterialSupport.TEXTURED.vertexFormat,u.rectangle=i.coordinates.getValue(h.MINIMUM_VALUE,u.rectangle),u.granularity=S.getValueOrUndefined(i.granularity,h.MINIMUM_VALUE),u.stRotation=S.getValueOrUndefined(i.stRotation,h.MINIMUM_VALUE),u.rotation=S.getValueOrUndefined(i.rotation,h.MINIMUM_VALUE),u.offsetAttribute=A.computeGeometryOffsetAttribute(n,o,s,l),u.height=A.getGeometryHeight(n,o),(s=A.getGeometryExtrudedHeight(s,l))===A.CLAMP_TO_GROUND&&(s=e.getMinimumMaximumHeights(f.computeRectangle(u,O)).minimumTerrainHeight),u.extrudedHeight=s},F.DynamicGeometryUpdater=R,a(Object.create)&&(R.prototype=Object.create(C.prototype),R.prototype.constructor=R),R.prototype._isHidden=function(e,t,i){return!a(this._options.rectangle)||C.prototype._isHidden.call(this,e,t,i)},R.prototype._setOptions=function(t,i,r){var n=this._options,o=S.getValueOrUndefined(i.height,r),s=S.getValueOrDefault(i.heightReference,r,y.NONE),l=S.getValueOrUndefined(i.extrudedHeight,r),u=S.getValueOrDefault(i.extrudedHeightReference,r,y.NONE);a(l)&&!a(o)&&(o=0),n.rectangle=S.getValueOrUndefined(i.coordinates,r,n.rectangle),n.granularity=S.getValueOrUndefined(i.granularity,r),n.stRotation=S.getValueOrUndefined(i.stRotation,r),n.rotation=S.getValueOrUndefined(i.rotation,r),n.offsetAttribute=A.computeGeometryOffsetAttribute(o,s,l,u),n.height=A.getGeometryHeight(o,s),(l=A.getGeometryExtrudedHeight(l,u))===A.CLAMP_TO_GROUND&&(l=e.getMinimumMaximumHeights(f.computeRectangle(n,O)).minimumTerrainHeight),n.extrudedHeight=l},F}.apply(t,r))||(e.exports=n)},1971:function(e,t,i){var r,n;r=[i(81),i(22),i(8),i(84),i(97),i(91),i(170),i(90),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l){"use strict";var u=new t,c=new r,d=new r;function h(t,i,r,n,o){this.primitives=t,this.zIndex=o,this.classificationType=i,this.color=r,this.key=n,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.subscriptions=new e,this.showsUpdated=new e,this.itemsToRemove=[],this.isDirty=!1}h.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&l.isConstant(e.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener(function(t,i,n,o){"isShowing"===i&&r.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(i,e)},h.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);return i(r)&&(r(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};var p=new Array(4);function m(t,i){this._batches=new e,this._primitives=t,this._classificationType=i}return h.prototype.update=function(e){var s,h=!0,m=0,f=this.primitive,_=this.primitives;if(this.createPrimitive){var g=this.geometry.values;if(g.length>0)i(f)&&(i(this.oldPrimitive)?_.remove(f):this.oldPrimitive=f),f=new a({show:!1,asynchronous:!0,geometryInstances:g,classificationType:this.classificationType}),_.add(f,this.zIndex),h=!1;else{i(f)&&(_.remove(f),f=void 0);var v=this.oldPrimitive;i(v)&&(_.remove(v),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=f,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(i(f)&&f.ready){f.show=!0,i(this.oldPrimitive)&&(_.remove(this.oldPrimitive),this.oldPrimitive=void 0);var y=this.updatersWithAttributes.values,x=y.length,w=this.waitingOnCreate;for(s=0;s<x;s++){var T=y[s],C=this.geometry.get(T.id),E=this.attributes.get(C.id.id);if(i(E)||(E=f.getGeometryInstanceAttributes(C.id),this.attributes.set(C.id.id,E)),!T.fillMaterialProperty.isConstant||w){var A=T.fillMaterialProperty.color,S=l.getValueOrDefault(A,e,t.WHITE,u);if(!t.equals(E._lastColor,S)){E._lastColor=t.clone(S,E._lastColor);var P=this.color,b=S.toBytes(p);P[0]===b[0]&&P[1]===b[1]&&P[2]===b[2]&&P[3]===b[3]||(this.itemsToRemove[m++]=T)}}var D=T.entity.isShowing&&(T.hasConstantFill||T.isFilled(e));D!==(1===E.show[0])&&(E.show=o.toValue(D,E.show));var O=T.distanceDisplayConditionProperty;if(!l.isConstant(O)){var I=l.getValueOrDefault(O,e,d,c);r.equals(I,E._lastDistanceDisplayCondition)||(E._lastDistanceDisplayCondition=r.clone(I,E._lastDistanceDisplayCondition),E.distanceDisplayCondition=n.toValue(I,E.distanceDisplayCondition))}}this.updateShows(f),this.waitingOnCreate=!1}else i(f)&&!f.ready&&(h=!1);return this.itemsToRemove.length=m,h},h.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,r=t.length,n=0;n<r;n++){var a=t[n],s=this.geometry.get(a.id),l=this.attributes.get(s.id.id);i(l)||(l=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,l));var u=a.entity.isShowing;u!==(1===l.show[0])&&(l.show=o.toValue(u,l.show),s.attributes.show.value[0]=l.show[0])}this.showsUpdated.removeAll()},h.prototype.contains=function(e){return this.updaters.contains(e.id)},h.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready)return s.PENDING;var n=r.getBoundingSphere(e.entity);return i(n)?(n.clone(t),s.DONE):s.FAILED},h.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;i(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var r=this.oldPrimitive;i(r)&&(e.remove(r),this.oldPrimitive=void 0)},m.prototype.add=function(e,t){var i,r=t.createFillGeometryInstance(e),n=this._batches,o=l.getValueOrDefault(t.zIndex,0),a=new Uint32Array(r.attributes.color.value.buffer)[0]+":"+o;return n.contains(a)?i=n.get(a):(i=new h(this._primitives,this._classificationType,r.attributes.color.value,a,o),n.set(a,i)),i.add(t,r),i},m.prototype.remove=function(e){for(var t=this._batches.values,i=t.length,r=0;r<i;++r)if(t[r].remove(e))return},m.prototype.update=function(e){var t,i,r=!0,n=this._batches,o=n.values,a=o.length;for(t=0;t<a;++t)r=o[t].update(e)&&r;for(t=0;t<a;++t)for(var s=o[t],l=s.itemsToRemove,u=l.length,c=0;c<u;c++){i=l[c],s.remove(i);var d=this.add(e,i);s.isDirty=!0,d.isDirty=!0}var h=o.slice(),p=h.length;for(t=0;t<p;++t){var m=h[t];m.isDirty&&(r=h[t].update(e)&&r,m.isDirty=!1),0===m.geometry.length&&n.remove(m.key)}return r},m.prototype.getBoundingSphere=function(e,t){for(var i=this._batches.values,r=i.length,n=0;n<r;++n){var o=i[n];if(o.contains(e))return o.getBoundingSphere(e,t)}return s.FAILED},m.prototype.removeAllPrimitives=function(){for(var e=this._batches.values,t=e.length,i=0;i<t;++i)e[i].removeAllPrimitives()},m}.apply(t,r))||(e.exports=n)},1972:function(e,t,i){var r,n;r=[i(81),i(67),i(8),i(84),i(97),i(91),i(1973),i(122),i(170),i(388),i(90),i(75),i(198),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p){"use strict";var m=new r,f=new r;function _(t,i,r,n,o,s){this.primitives=t,this.classificationType=i,this.appearanceType=r,this.materialProperty=n,this.updaters=new e,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.material=void 0,this.updatersWithAttributes=new e,this.attributes=new e,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(_.prototype.onMaterialChanged,this),this.subscriptions=new e,this.showsUpdated=new e,this.usingSphericalTextureCoordinates=o,this.zIndex=s,this.rectangleCollisionCheck=new a}function g(e,t,i){this._items=[],this._primitives=e,this._classificationType=t,this._appearanceType=i}return _.prototype.onMaterialChanged=function(){this.invalidated=!0},_.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)},_.prototype.isMaterial=function(e){var t=this.materialProperty,r=e.fillMaterialProperty;return r===t||r instanceof d&&t instanceof d||i(t)&&t.equals(r)},_.prototype.add=function(e,t,i){var r=t.id;if(this.updaters.set(r,t),this.geometry.set(r,i),this.rectangleCollisionCheck.insert(r,i.geometry.rectangle),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&p.isConstant(t.distanceDisplayConditionProperty)){var n=this;this.subscriptions.set(r,t.entity.definitionChanged.addEventListener(function(e,i,r,o){"isShowing"===i&&n.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(r,t);this.createPrimitive=!0},_.prototype.remove=function(e){var t=e.id,r=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,r.geometry.rectangle),this.updatersWithAttributes.remove(t);var n=this.subscriptions.get(t);return i(n)&&(n(),this.subscriptions.remove(t)),!0}return!1},_.prototype.update=function(e){var t,a=!0,s=this.primitive,u=this.primitives,c=this.geometry.values;if(this.createPrimitive){if(c.length>0)i(s)&&(i(this.oldPrimitive)?u.remove(s):this.oldPrimitive=s),this.material=h.getValue(e,this.materialProperty,this.material),s=new l({show:!1,asynchronous:!0,geometryInstances:c,appearance:new this.appearanceType({material:this.material}),classificationType:this.classificationType}),u.add(s,this.zIndex),a=!1;else{i(s)&&(u.remove(s),s=void 0);var d=this.oldPrimitive;i(d)&&(u.remove(d),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=s,this.createPrimitive=!1}else if(i(s)&&s.ready){s.show=!0,i(this.oldPrimitive)&&(u.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=h.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material;var _=this.updatersWithAttributes.values,g=_.length;for(t=0;t<g;t++){var v=_[t],y=v.entity,x=this.geometry.get(v.id),w=this.attributes.get(x.id.id);i(w)||(w=s.getGeometryInstanceAttributes(x.id),this.attributes.set(x.id.id,w));var T=y.isShowing&&(v.hasConstantFill||v.isFilled(e));T!==(1===w.show[0])&&(w.show=o.toValue(T,w.show));var C=v.distanceDisplayConditionProperty;if(!p.isConstant(C)){var E=p.getValueOrDefault(C,e,f,m);r.equals(E,w._lastDistanceDisplayCondition)||(w._lastDistanceDisplayCondition=r.clone(E,w._lastDistanceDisplayCondition),w.distanceDisplayCondition=n.toValue(E,w.distanceDisplayCondition))}}this.updateShows(s)}else i(s)&&!s.ready&&(a=!1);return a},_.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,r=t.length,n=0;n<r;n++){var a=t[n],s=a.entity,l=this.geometry.get(a.id),u=this.attributes.get(l.id.id);i(u)||(u=e.getGeometryInstanceAttributes(l.id),this.attributes.set(l.id.id,u));var c=s.isShowing;c!==(1===u.show[0])&&(u.show=o.toValue(c,u.show),l.attributes.show.value[0]=u.show[0])}this.showsUpdated.removeAll()},_.prototype.contains=function(e){return this.updaters.contains(e.id)},_.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready)return c.PENDING;var n=r.getGeometryInstanceAttributes(e.entity);return!i(n)||!i(n.boundingSphere)||i(n.show)&&0===n.show[0]?c.FAILED:(n.boundingSphere.clone(t),c.DONE)},_.prototype.destroy=function(){var e=this.primitive,t=this.primitives;i(e)&&t.remove(e);var r=this.oldPrimitive;i(r)&&t.remove(r),this.removeMaterialSubscription()},g.prototype.add=function(e,t){for(var i=this._items,r=i.length,n=t.createFillGeometryInstance(e),o=u.shouldUseSphericalCoordinates(n.geometry.rectangle),a=p.getValueOrDefault(t.zIndex,0),s=0;s<r;++s){var l=i[s];if(l.isMaterial(t)&&l.usingSphericalTextureCoordinates===o&&l.zIndex===a&&!l.overlapping(n.geometry.rectangle))return void l.add(e,t,n)}var c=new _(this._primitives,this._classificationType,this._appearanceType,t.fillMaterialProperty,o,a);c.add(e,t,n),i.push(c)},g.prototype.remove=function(e){for(var t=this._items,i=t.length-1;i>=0;i--){var r=t[i];if(r.remove(e)){0===r.updaters.length&&(t.splice(i,1),r.destroy());break}}},g.prototype.update=function(e){var t,i=this._items;for(t=i.length-1;t>=0;t--){var r=i[t];if(r.invalidated){i.splice(t,1);for(var n=r.updaters.values,o=n.length,a=0;a<o;a++)this.add(e,n[a]);r.destroy()}}var s=!0;for(t=0;t<i.length;t++)s=i[t].update(e)&&s;return s},g.prototype.getBoundingSphere=function(e,t){for(var i=this._items,r=i.length,n=0;n<r;n++){var o=i[n];if(o.contains(e))return o.getBoundingSphere(e,t)}return c.FAILED},g.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0},g}.apply(t,r))||(e.exports=n)},1973:function(e,t,i){var r,n;r=[i(1974),i(16)],void 0===(n=function(e,t){"use strict";function i(){this._tree=e()}function r(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.id=""}function n(e,t){return e.id===t.id}r.fromRectangleAndId=function(e,t,i){return i.minX=t.west,i.minY=t.south,i.maxX=t.east,i.maxY=t.north,i.id=e,i},i.prototype.insert=function(e,t){var i=r.fromRectangleAndId(e,t,new r);this._tree.insert(i)};var o=new r;i.prototype.remove=function(e,t){var i=r.fromRectangleAndId(e,t,o);this._tree.remove(i,n)};var a=new r;return i.prototype.collides=function(e){var t=r.fromRectangleAndId("",e,a);return this._tree.collides(t)},i}.apply(t,r))||(e.exports=n)},1974:function(e,t,i){var r,n;r=[i(1975)],void 0===(n=function(e){"use strict";function t(e,i){if(!(this instanceof t))return new t(e,i);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&this._initFormat(i),this.clear()}function i(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function r(e,t){n(e,0,e.children.length,t,e)}function n(e,t,i,r,n){n||(n=h(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,s=t;s<i;s++)a=e.children[s],o(n,e.leaf?r(a):a);return n}function o(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function a(e,t){return e.minX-t.minX}function s(e,t){return e.minY-t.minY}function l(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function u(e){return e.maxX-e.minX+(e.maxY-e.minY)}function c(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function h(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function p(t,i,r,n,o){for(var a,s=[i,r];s.length;)(r=s.pop())-(i=s.pop())<=n||(a=i+Math.ceil((r-i)/n/2)*n,e(t,a,i,r,o),s.push(i,a,a,r))}return t.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],r=this.toBBox;if(!d(e,t))return i;for(var n,o,a,s,l=[];t;){for(n=0,o=t.children.length;n<o;n++)a=t.children[n],d(e,s=t.leaf?r(a):a)&&(t.leaf?i.push(a):c(e,s)?this._all(a,i):l.push(a));t=l.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!d(e,t))return!1;for(var r,n,o,a,s=[];t;){for(r=0,n=t.children.length;r<n;r++)if(o=t.children[r],d(e,a=t.leaf?i(o):o)){if(t.leaf||c(e,a))return!0;s.push(o)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=h([]),this},remove:function(e,t){if(!e)return this;for(var r,n,o,a,s=this.data,l=this.toBBox(e),u=[],d=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],r=d.pop(),a=!0),s.leaf&&-1!==(o=i(e,s.children,t)))return s.children.splice(o,1),u.push(s),this._condense(u),this;a||s.leaf||!c(s,l)?n?(r++,s=n.children[r],a=!1):s=null:(u.push(s),d.push(r),r=0,n=s,s=s.children[0])}return this},toBBox:function(e){return e},compareMinX:a,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,n){var o,a=i-t+1,s=this._maxEntries;if(a<=s)return r(o=h(e.slice(t,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(o=h([])).leaf=!1,o.height=n;var l,u,c,d,m=Math.ceil(a/s),f=m*Math.ceil(Math.sqrt(s));for(p(e,t,i,f,this.compareMinX),l=t;l<=i;l+=f)for(p(e,l,c=Math.min(l+f-1,i),m,this.compareMinY),u=l;u<=c;u+=m)d=Math.min(u+m-1,c),o.children.push(this._build(e,u,d,n-1));return r(o,this.toBBox),o},_chooseSubtree:function(e,t,i,r){for(var n,o,a,s,u,c,d,h,p,m;r.push(t),!t.leaf&&r.length-1!==i;){for(d=h=1/0,n=0,o=t.children.length;n<o;n++)u=l(a=t.children[n]),p=e,m=a,(c=(Math.max(m.maxX,p.maxX)-Math.min(m.minX,p.minX))*(Math.max(m.maxY,p.maxY)-Math.min(m.minY,p.minY))-u)<h?(h=c,d=u<d?u:d,s=a):c===h&&u<d&&(d=u,s=a);t=s||t.children[0]}return t},_insert:function(e,t,i){var r=this.toBBox,n=i?e:r(e),a=[],s=this._chooseSubtree(n,this.data,t,a);for(s.children.push(e),o(s,n);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(n,a,t)},_split:function(e,t){var i=e[t],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var a=this._chooseSplitIndex(i,o,n),s=h(i.children.splice(a,i.children.length-a));s.height=i.height,s.leaf=i.leaf,r(i,this.toBBox),r(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(e,t){this.data=h([e,t]),this.data.height=e.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var r,o,a,s,u,c,d,h,p,m,f,_,g,v;for(c=d=1/0,r=t;r<=i-t;r++)o=n(e,0,r,this.toBBox),a=n(e,r,i,this.toBBox),p=o,m=a,f=void 0,_=void 0,g=void 0,v=void 0,f=Math.max(p.minX,m.minX),_=Math.max(p.minY,m.minY),g=Math.min(p.maxX,m.maxX),v=Math.min(p.maxY,m.maxY),s=Math.max(0,g-f)*Math.max(0,v-_),u=l(o)+l(a),s<c?(c=s,h=r,d=u<d?u:d):s===c&&u<d&&(d=u,h=r);return h},_chooseSplitAxis:function(e,t,i){var r=e.leaf?this.compareMinX:a,n=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,n)&&e.children.sort(r)},_allDistMargin:function(e,t,i,r){e.children.sort(r);var a,s,l=this.toBBox,c=n(e,0,t,l),d=n(e,i-t,i,l),h=u(c)+u(d);for(a=t;a<i-t;a++)s=e.children[a],o(c,e.leaf?l(s):s),h+=u(c);for(a=i-t-1;a>=t;a--)s=e.children[a],o(d,e.leaf?l(s):s),h+=u(d);return h},_adjustParentBBoxes:function(e,t,i){for(var r=i;r>=0;r--)o(t[r],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():r(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},t}.apply(t,r))||(e.exports=n)},1975:function(e,t,i){var r;void 0===(r=function(){"use strict";function e(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function t(e,t){return e<t?-1:e>t?1:0}return function(i,r,n,o,a){!function t(i,r,n,o,a){for(;o>n;){if(o-n>600){var s=o-n+1,l=r-n+1,u=Math.log(s),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),h=Math.max(n,Math.floor(r-l*c/s+d)),p=Math.min(o,Math.floor(r+(s-l)*c/s+d));t(i,r,h,p,a)}var m=i[r],f=n,_=o;for(e(i,n,r),a(i[o],m)>0&&e(i,n,o);f<_;){for(e(i,f,_),f++,_--;a(i[f],m)<0;)f++;for(;a(i[_],m)>0;)_--}0===a(i[n],m)?e(i,n,_):e(i,++_,o),_<=r&&(n=_+1),r<=_&&(o=_-1)}}(i,r,n||0,o||i.length-1,a||t)}}.apply(t,[]))||(e.exports=r)},1976:function(e,t,i){var r,n;r=[i(81),i(12),i(22),i(67),i(8),i(84),i(97),i(147),i(91),i(74),i(112),i(90),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h){"use strict";var p=new i,m=new o,f=new o,_=t.ZERO,g=new t;function v(t,i,r,n){this.translucent=i,this.width=r,this.shadows=n,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.itemsToRemove=[],this.subscriptions=new e,this.showsUpdated=new e}function y(t,i,r){this._primitives=t,this._scene=i,this._shadows=r,this._solidBatches=new e,this._translucentBatches=new e}return v.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantOutline&&e.outlineColorProperty.isConstant&&h.isConstant(e.distanceDisplayConditionProperty)&&h.isConstant(e.terrainOffsetProperty)){var r=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener(function(t,i,n,o){"isShowing"===i&&r.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(i,e)},v.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return n(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},v.prototype.update=function(e){var d,v=!0,y=0,x=this.primitive,w=this.primitives;if(this.createPrimitive){var T=this.geometry.values;if(T.length>0)n(x)&&(n(this.oldPrimitive)?w.remove(x):this.oldPrimitive=x),x=new c({show:!1,asynchronous:!0,geometryInstances:T,appearance:new u({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),w.add(x),v=!1;else{n(x)&&(w.remove(x),x=void 0);var C=this.oldPrimitive;n(C)&&(w.remove(C),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=x,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(n(x)&&x.ready){x.show=!0,n(this.oldPrimitive)&&(w.remove(this.oldPrimitive),this.oldPrimitive=void 0);var E=this.updatersWithAttributes.values,A=E.length,S=this.waitingOnCreate;for(d=0;d<A;d++){var P=E[d],b=this.geometry.get(P.id),D=this.attributes.get(b.id.id);if(n(D)||(D=x.getGeometryInstanceAttributes(b.id),this.attributes.set(b.id.id,D)),!P.outlineColorProperty.isConstant||S){var O=P.outlineColorProperty,I=h.getValueOrDefault(O,e,i.WHITE,p);i.equals(D._lastColor,I)||(D._lastColor=i.clone(I,D._lastColor),D.color=r.toValue(I,D.color),(this.translucent&&255===D.color[3]||!this.translucent&&255!==D.color[3])&&(this.itemsToRemove[y++]=P))}var M=P.entity.isShowing&&(P.hasConstantOutline||P.isOutlineVisible(e));M!==(1===D.show[0])&&(D.show=l.toValue(M,D.show));var N=P.distanceDisplayConditionProperty;if(!h.isConstant(N)){var F=h.getValueOrDefault(N,e,f,m);o.equals(F,D._lastDistanceDisplayCondition)||(D._lastDistanceDisplayCondition=o.clone(F,D._lastDistanceDisplayCondition),D.distanceDisplayCondition=a.toValue(F,D.distanceDisplayCondition))}var R=P.terrainOffsetProperty;if(!h.isConstant(R)){var L=h.getValueOrDefault(R,e,_,g);t.equals(L,D._lastOffset)||(D._lastOffset=t.clone(L,D._lastOffset),D.offset=s.toValue(L,D.offset))}}this.updateShows(x),this.waitingOnCreate=!1}else n(x)&&!x.ready&&(v=!1);return this.itemsToRemove.length=y,v},v.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,r=0;r<i;r++){var o=t[r],a=this.geometry.get(o.id),s=this.attributes.get(a.id.id);n(s)||(s=e.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,s));var u=o.entity.isShowing;u!==(1===s.show[0])&&(s.show=l.toValue(u,s.show),a.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},v.prototype.contains=function(e){return this.updaters.contains(e.id)},v.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return d.PENDING;var r=i.getGeometryInstanceAttributes(e.entity);return!n(r)||!n(r.boundingSphere)||n(r.show)&&0===r.show[0]?d.FAILED:(r.boundingSphere.clone(t),d.DONE)},v.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;n(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var i=this.oldPrimitive;n(i)&&(e.remove(i),this.oldPrimitive=void 0)},y.prototype.add=function(e,t){var i,r,o=t.createOutlineGeometryInstance(e),a=this._scene.clampLineWidth(t.outlineWidth);255===o.attributes.color.value[3]?(r=(i=this._solidBatches).get(a),n(r)||(r=new v(this._primitives,!1,a,this._shadows),i.set(a,r)),r.add(t,o)):(r=(i=this._translucentBatches).get(a),n(r)||(r=new v(this._primitives,!0,a,this._shadows),i.set(a,r)),r.add(t,o))},y.prototype.remove=function(e){var t,i=this._solidBatches.values,r=i.length;for(t=0;t<r;t++)if(i[t].remove(e))return;var n=this._translucentBatches.values,o=n.length;for(t=0;t<o;t++)if(n[t].remove(e))return},y.prototype.update=function(e){var t,i,r,n,o,a=this._solidBatches.values,s=a.length,l=this._translucentBatches.values,u=l.length,c=!0,d=!1;do{for(d=!1,i=0;i<s;i++){c=(n=a[i]).update(e);var h=(o=n.itemsToRemove).length;if(h>0)for(d=!0,t=0;t<h;t++)r=o[t],n.remove(r),this.add(e,r)}for(i=0;i<u;i++){c=(n=l[i]).update(e);var p=(o=n.itemsToRemove).length;if(p>0)for(d=!0,t=0;t<p;t++)r=o[t],n.remove(r),this.add(e,r)}}while(d);return c},y.prototype.getBoundingSphere=function(e,t){var i,r=this._solidBatches.values,n=r.length;for(i=0;i<n;i++){var o=r[i];if(o.contains(e))return o.getBoundingSphere(e,t)}var a=this._translucentBatches.values,s=a.length;for(i=0;i<s;i++){var l=a[i];if(l.contains(e))return l.getBoundingSphere(e,t)}return d.FAILED},y.prototype.removeAllPrimitives=function(){var e,t=this._solidBatches.values,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var r=this._translucentBatches.values,n=r.length;for(e=0;e<n;e++)r[e].removeAllPrimitives()},y}.apply(t,r))||(e.exports=n)},1977:function(e,t,i){var r,n;r=[i(16),i(22),i(67),i(8),i(11),i(97),i(64),i(80),i(91),i(1978),i(1979),i(133),i(74),i(75),i(165),i(134),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=new t;function v(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function y(e,t){f.call(this,{entity:e,scene:t,geometryOptions:new v(e),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}function x(e,t,i){m.call(this,e,t,i)}return r(Object.create)&&(y.prototype=Object.create(f.prototype),y.prototype.constructor=y),y.prototype.createFillGeometryInstance=function(e){var n,s,c=this._entity,d=c.isAvailable(e),h=new l(d&&c.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),m=this._distanceDisplayConditionProperty.getValue(e),f=o.fromDistanceDisplayCondition(m);this._materialProperty instanceof p?(r(this._materialProperty.color)&&(this._materialProperty.color.isConstant||d)&&(s=this._materialProperty.color.getValue(e,g)),r(s)||(s=t.WHITE),n={show:h,distanceDisplayCondition:f,color:i.fromColor(s)}):n={show:h,distanceDisplayCondition:f};return new a({id:c,geometry:new u(this._options),attributes:n})},y.prototype.createOutlineGeometryInstance=function(e){var r=this._entity,n=r.isAvailable(e),s=_.getValueOrDefault(this._outlineColorProperty,e,t.BLACK,g),u=this._distanceDisplayConditionProperty.getValue(e);return new a({id:r,geometry:new c(this._options),attributes:{show:new l(n&&r.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:i.fromColor(s),distanceDisplayCondition:o.fromDistanceDisplayCondition(u)}})},y.prototype._isHidden=function(e,t){return!r(t.positions)||f.prototype._isHidden.call(this,e,t)},y.prototype._getIsClosed=function(e){return!1},y.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&_.isConstant(t.minimumHeights)&&_.isConstant(t.maximumHeights)&&_.isConstant(t.outlineWidth)&&_.isConstant(t.granularity))},y.prototype._setStaticOptions=function(e,t){var i=t.minimumHeights,n=t.maximumHeights,o=t.granularity,a=this._materialProperty instanceof p,l=this._options;l.vertexFormat=a?h.VERTEX_FORMAT:d.MaterialSupport.TEXTURED.vertexFormat,l.positions=t.positions.getValue(s.MINIMUM_VALUE,l.positions),l.minimumHeights=r(i)?i.getValue(s.MINIMUM_VALUE,l.minimumHeights):void 0,l.maximumHeights=r(n)?n.getValue(s.MINIMUM_VALUE,l.maximumHeights):void 0,l.granularity=r(o)?o.getValue(s.MINIMUM_VALUE):void 0},y.DynamicGeometryUpdater=x,r(Object.create)&&(x.prototype=Object.create(m.prototype),x.prototype.constructor=x),x.prototype._isHidden=function(e,t,i){return!r(this._options.positions)||m.prototype._isHidden.call(this,e,t,i)},x.prototype._setOptions=function(e,t,i){var r=this._options;r.positions=_.getValueOrUndefined(t.positions,i,r.positions),r.minimumHeights=_.getValueOrUndefined(t.minimumHeights,i,r.minimumHeights),r.maximumHeights=_.getValueOrUndefined(t.maximumHeights,i,r.maximumHeights),r.granularity=_.getValueOrUndefined(t.granularity,i)},y}.apply(t,r))||(e.exports=n)},1978:function(e,t,i){var r,n;r=[i(33),i(12),i(34),i(9),i(8),i(11),i(26),i(52),i(53),i(65),i(50),i(14),i(45),i(76),i(768)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m){"use strict";var f=new t,_=new t,g=new t,v=new t,y=new t,x=new t,w=new t,T=new t;function C(e){var i=(e=r(e,r.EMPTY_OBJECT)).positions,o=e.maximumHeights,s=e.minimumHeights,l=r(e.vertexFormat,p.DEFAULT),u=r(e.granularity,d.RADIANS_PER_DEGREE),c=r(e.ellipsoid,a.WGS84);this._positions=i,this._minimumHeights=s,this._maximumHeights=o,this._vertexFormat=p.clone(l),this._granularity=u,this._ellipsoid=a.clone(c),this._workerName="createWallGeometry";var h=1+i.length*t.packedLength+2;n(s)&&(h+=s.length),n(o)&&(h+=o.length),this.packedLength=h+a.packedLength+p.packedLength+1}C.pack=function(e,i,o){var s;o=r(o,0);var l=e._positions,u=l.length;for(i[o++]=u,s=0;s<u;++s,o+=t.packedLength)t.pack(l[s],i,o);var c=e._minimumHeights;if(u=n(c)?c.length:0,i[o++]=u,n(c))for(s=0;s<u;++s)i[o++]=c[s];var d=e._maximumHeights;if(u=n(d)?d.length:0,i[o++]=u,n(d))for(s=0;s<u;++s)i[o++]=d[s];return a.pack(e._ellipsoid,i,o),o+=a.packedLength,p.pack(e._vertexFormat,i,o),i[o+=p.packedLength]=e._granularity,i};var E=a.clone(a.UNIT_SPHERE),A=new p,S={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:E,vertexFormat:A,granularity:void 0};return C.unpack=function(e,i,o){var s;i=r(i,0);var l,u,c=e[i++],d=new Array(c);for(s=0;s<c;++s,i+=t.packedLength)d[s]=t.unpack(e,i);if((c=e[i++])>0)for(l=new Array(c),s=0;s<c;++s)l[s]=e[i++];if((c=e[i++])>0)for(u=new Array(c),s=0;s<c;++s)u[s]=e[i++];var h=a.unpack(e,i,E);i+=a.packedLength;var m=p.unpack(e,i,A),f=e[i+=p.packedLength];return n(o)?(o._positions=d,o._minimumHeights=l,o._maximumHeights=u,o._ellipsoid=a.clone(h,o._ellipsoid),o._vertexFormat=p.clone(m,o._vertexFormat),o._granularity=f,o):(S.positions=d,S.minimumHeights=l,S.maximumHeights=u,S.granularity=f,new C(S))},C.fromConstantHeights=function(e){var t,i,o=(e=r(e,r.EMPTY_OBJECT)).positions,a=e.minimumHeight,s=e.maximumHeight,l=n(a),u=n(s);if(l||u){var c=o.length;t=l?new Array(c):void 0,i=u?new Array(c):void 0;for(var d=0;d<c;++d)l&&(t[d]=a),u&&(i[d]=s)}return new C({positions:o,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat})},C.createGeometry=function(r){var o=r._positions,a=r._minimumHeights,p=r._maximumHeights,C=r._vertexFormat,E=r._granularity,A=r._ellipsoid,S=m.computePositions(A,o,p,a,E,!0);if(n(S)){var P,b=S.bottomPositions,D=S.topPositions,O=S.numCorners,I=D.length,M=2*I,N=C.position?new Float64Array(M):void 0,F=C.normal?new Float32Array(M):void 0,R=C.tangent?new Float32Array(M):void 0,L=C.bitangent?new Float32Array(M):void 0,V=C.st?new Float32Array(M/3*2):void 0,U=0,z=0,B=0,H=0,k=0,G=T,W=w,Y=x,j=!0,X=0,Q=1/((I/=3)-o.length+1);for(P=0;P<I;++P){var q=3*P,Z=t.fromArray(D,q,f),K=t.fromArray(b,q,_);if(C.position&&(N[U++]=K.x,N[U++]=K.y,N[U++]=K.z,N[U++]=Z.x,N[U++]=Z.y,N[U++]=Z.z),C.st&&(V[k++]=X,V[k++]=0,V[k++]=X,V[k++]=1),C.normal||C.tangent||C.bitangent){var J,$=t.clone(t.ZERO,y),ee=A.scaleToGeodeticSurface(t.fromArray(D,q,_),_);if(P+1<I&&(J=A.scaleToGeodeticSurface(t.fromArray(D,q+3,g),g),$=t.fromArray(D,q+3,y)),j){var te=t.subtract($,Z,v),ie=t.subtract(ee,Z,f);G=t.normalize(t.cross(ie,te,G),G),j=!1}t.equalsEpsilon(J,ee,d.EPSILON10)?j=!0:(X+=Q,C.tangent&&(W=t.normalize(t.subtract(J,ee,W),W)),C.bitangent&&(Y=t.normalize(t.cross(G,W,Y),Y))),C.normal&&(F[z++]=G.x,F[z++]=G.y,F[z++]=G.z,F[z++]=G.x,F[z++]=G.y,F[z++]=G.z),C.tangent&&(R[H++]=W.x,R[H++]=W.y,R[H++]=W.z,R[H++]=W.x,R[H++]=W.y,R[H++]=W.z),C.bitangent&&(L[B++]=Y.x,L[B++]=Y.y,L[B++]=Y.z,L[B++]=Y.x,L[B++]=Y.y,L[B++]=Y.z)}}var re=new u;C.position&&(re.position=new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:N})),C.normal&&(re.normal=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:F})),C.tangent&&(re.tangent=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:R})),C.bitangent&&(re.bitangent=new l({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:L})),C.st&&(re.st=new l({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:V}));var ne=M/3;M-=6*(O+1);var oe=c.createTypedArray(ne,M),ae=0;for(P=0;P<ne-2;P+=2){var se=P,le=P+2,ue=t.fromArray(N,3*se,f),ce=t.fromArray(N,3*le,_);if(!t.equalsEpsilon(ue,ce,d.EPSILON10)){var de=P+1,he=P+3;oe[ae++]=de,oe[ae++]=se,oe[ae++]=he,oe[ae++]=he,oe[ae++]=se,oe[ae++]=le}}return new s({attributes:re,indices:oe,primitiveType:h.TRIANGLES,boundingSphere:new e.fromVertices(N)})}},C}.apply(t,r))||(e.exports=n)},1979:function(e,t,i){var r,n;r=[i(33),i(12),i(34),i(9),i(8),i(11),i(26),i(52),i(53),i(65),i(50),i(14),i(45),i(768)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p){"use strict";var m=new t,f=new t;function _(e){var i=(e=r(e,r.EMPTY_OBJECT)).positions,o=e.maximumHeights,s=e.minimumHeights,l=r(e.granularity,d.RADIANS_PER_DEGREE),u=r(e.ellipsoid,a.WGS84);this._positions=i,this._minimumHeights=s,this._maximumHeights=o,this._granularity=l,this._ellipsoid=a.clone(u),this._workerName="createWallOutlineGeometry";var c=1+i.length*t.packedLength+2;n(s)&&(c+=s.length),n(o)&&(c+=o.length),this.packedLength=c+a.packedLength+1}_.pack=function(e,i,o){var s;o=r(o,0);var l=e._positions,u=l.length;for(i[o++]=u,s=0;s<u;++s,o+=t.packedLength)t.pack(l[s],i,o);var c=e._minimumHeights;if(u=n(c)?c.length:0,i[o++]=u,n(c))for(s=0;s<u;++s)i[o++]=c[s];var d=e._maximumHeights;if(u=n(d)?d.length:0,i[o++]=u,n(d))for(s=0;s<u;++s)i[o++]=d[s];return a.pack(e._ellipsoid,i,o),i[o+=a.packedLength]=e._granularity,i};var g=a.clone(a.UNIT_SPHERE),v={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:g,granularity:void 0};return _.unpack=function(e,i,o){var s;i=r(i,0);var l,u,c=e[i++],d=new Array(c);for(s=0;s<c;++s,i+=t.packedLength)d[s]=t.unpack(e,i);if((c=e[i++])>0)for(l=new Array(c),s=0;s<c;++s)l[s]=e[i++];if((c=e[i++])>0)for(u=new Array(c),s=0;s<c;++s)u[s]=e[i++];var h=a.unpack(e,i,g),p=e[i+=a.packedLength];return n(o)?(o._positions=d,o._minimumHeights=l,o._maximumHeights=u,o._ellipsoid=a.clone(h,o._ellipsoid),o._granularity=p,o):(v.positions=d,v.minimumHeights=l,v.maximumHeights=u,v.granularity=p,new _(v))},_.fromConstantHeights=function(e){var t,i,o=(e=r(e,r.EMPTY_OBJECT)).positions,a=e.minimumHeight,s=e.maximumHeight,l=n(a),u=n(s);if(l||u){var c=o.length;t=l?new Array(c):void 0,i=u?new Array(c):void 0;for(var d=0;d<c;++d)l&&(t[d]=a),u&&(i[d]=s)}return new _({positions:o,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid})},_.createGeometry=function(r){var o=r._positions,a=r._minimumHeights,_=r._maximumHeights,g=r._granularity,v=r._ellipsoid,y=p.computePositions(v,o,_,a,g,!1);if(n(y)){var x,w=y.bottomPositions,T=y.topPositions,C=T.length,E=2*C,A=new Float64Array(E),S=0;for(C/=3,x=0;x<C;++x){var P=3*x,b=t.fromArray(T,P,m),D=t.fromArray(w,P,f);A[S++]=D.x,A[S++]=D.y,A[S++]=D.z,A[S++]=b.x,A[S++]=b.y,A[S++]=b.z}var O=new u({position:new l({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:A})}),I=E/3;E=2*I-4+I;var M=c.createTypedArray(I,E),N=0;for(x=0;x<I-2;x+=2){var F=x,R=x+2,L=t.fromArray(A,3*F,m),V=t.fromArray(A,3*R,f);if(!t.equalsEpsilon(L,V,d.EPSILON10)){var U=x+1,z=x+3;M[N++]=U,M[N++]=F,M[N++]=U,M[N++]=z,M[N++]=F,M[N++]=R}}return M[N++]=I-2,M[N++]=I-1,new s({attributes:O,indices:M,primitiveType:h.LINES,boundingSphere:new e.fromVertices(A)})}},_}.apply(t,r))||(e.exports=n)},198:function(e,t,i){var r,n;r=[i(22),i(8),i(10),i(11),i(210)],void 0===(n=function(e,t,i,r,n){"use strict";function o(){r.throwInstantiationError()}return i(o.prototype,{isConstant:{get:r.throwInstantiationError},definitionChanged:{get:r.throwInstantiationError}}),o.prototype.getType=r.throwInstantiationError,o.prototype.getValue=r.throwInstantiationError,o.prototype.equals=r.throwInstantiationError,o.getValue=function(i,r,o){var a;return t(r)&&(a=r.getType(i),t(a))?(t(o)&&o.type===a||(o=n.fromType(a)),r.getValue(i,o.uniforms),o):(t(o)&&o.type===n.ColorType||(o=n.fromType(n.ColorType)),e.clone(e.WHITE,o.uniforms.color),o)},o}.apply(t,r))||(e.exports=n)},1980:function(e,t,i){var r,n;r=[i(81),i(24),i(12),i(22),i(9),i(8),i(20),i(11),i(84),i(173),i(71),i(159),i(237),i(152),i(90),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f){"use strict";var _=h.FILL,g=r.WHITE,v=r.BLACK,y=new r(.165,.165,.165,.8),x=new t(7,5),w=t.ZERO,T=i.ZERO,C=c.NONE,E=d.CENTER,A=p.CENTER,S=new i,P=new r,b=new r,D=new r,O=new t,I=new i,M=new t,N=new u,F=new u,R=new u,L=new l;function V(e){this.entity=e,this.label=void 0,this.index=void 0}function U(t,i){i.collectionChanged.addEventListener(U.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}function z(e,t,i){o(e)&&(e.label=void 0,i.removeLabel(t))}return U.prototype.update=function(e){for(var t=this._items.values,r=this._cluster,n=0,a=t.length;n<a;n++){var s,l,u=t[n],c=u.entity,d=c._label,h=u.label,p=c.isShowing&&c.isAvailable(e)&&f.getValueOrDefault(d._show,e,!0);if(p&&(l=f.getValueOrUndefined(c._position,e,S),s=f.getValueOrUndefined(d._text,e),p=o(l)&&o(s)),p){f.isConstant(c._position)||(r._clusterDirty=!0);var m=!1,V=f.getValueOrDefault(d._heightReference,e,C);o(h)||((h=r.getLabel(c)).id=c,u.label=h,m=i.equals(h.position,l)&&h.heightReference===V),h.show=!0,h.position=l,h.text=s,h.scale=f.getValueOrDefault(d._scale,e,1),h.font=f.getValueOrDefault(d._font,e,"30px sans-serif"),h.style=f.getValueOrDefault(d._style,e,_),h.fillColor=f.getValueOrDefault(d._fillColor,e,g,P),h.outlineColor=f.getValueOrDefault(d._outlineColor,e,v,b),h.outlineWidth=f.getValueOrDefault(d._outlineWidth,e,1),h.showBackground=f.getValueOrDefault(d._showBackground,e,!1),h.backgroundColor=f.getValueOrDefault(d._backgroundColor,e,y,D),h.backgroundPadding=f.getValueOrDefault(d._backgroundPadding,e,x,O),h.pixelOffset=f.getValueOrDefault(d._pixelOffset,e,w,M),h.eyeOffset=f.getValueOrDefault(d._eyeOffset,e,T,I),h.heightReference=V,h.horizontalOrigin=f.getValueOrDefault(d._horizontalOrigin,e,E),h.verticalOrigin=f.getValueOrDefault(d._verticalOrigin,e,A),h.translucencyByDistance=f.getValueOrUndefined(d._translucencyByDistance,e,N),h.pixelOffsetScaleByDistance=f.getValueOrUndefined(d._pixelOffsetScaleByDistance,e,F),h.scaleByDistance=f.getValueOrUndefined(d._scaleByDistance,e,R),h.distanceDisplayCondition=f.getValueOrUndefined(d._distanceDisplayCondition,e,L),h.disableDepthTestDistance=f.getValueOrUndefined(d._disableDepthTestDistance,e),m&&h._updateClamping()}else z(u,c,r)}return!0},U.prototype.getBoundingSphere=function(e,t){var r=this._items.get(e.id);if(!o(r)||!o(r.label))return m.FAILED;var a=r.label;return t.center=i.clone(n(a._clampedPosition,a.position),t.center),t.radius=0,m.DONE},U.prototype.isDestroyed=function(){return!1},U.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(U.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return a(this)},U.prototype._onCollectionChanged=function(e,t,i,r){var n,a,s=this._items,l=this._cluster;for(n=t.length-1;n>-1;n--)a=t[n],o(a._label)&&o(a._position)&&s.set(a.id,new V(a));for(n=r.length-1;n>-1;n--)a=r[n],o(a._label)&&o(a._position)?s.contains(a.id)||s.set(a.id,new V(a)):(z(s.get(a.id),a,l),s.remove(a.id));for(n=i.length-1;n>-1;n--)a=i[n],z(s.get(a.id),a,l),s.remove(a.id)},U}.apply(t,r))||(e.exports=n)},1981:function(e,t,i){var r,n;r=[i(81),i(33),i(24),i(22),i(8),i(20),i(11),i(28),i(37),i(190),i(430),i(71),i(272),i(433),i(102),i(90),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=m.ENABLED,v=d.NONE,y=r.RED,x=r.WHITE,w=c.HIGHLIGHT,T=new i(1,1),C=u.Y,E=new s,A=new s;function S(t,i){i.collectionChanged.addEventListener(S.prototype._onCollectionChanged,this),this._scene=t,this._primitives=t.primitives,this._entityCollection=i,this._modelHash={},this._entitiesToVisualize=new e,this._onCollectionChanged(i,i.values,[],[])}function P(e,t,i,r){var o=i[t.id];n(o)&&(r.removeAndDestroy(o.modelPrimitive),delete i[t.id])}function b(e,t){var i=t[e.id];n(i)&&(i.nodeTransformationsScratch={},i.articulationsScratch={})}function D(e,t,i){e.readyPromise.otherwise(function(e){console.error(e),i[t.id].loadFail=!0})}return S.prototype.update=function(e){for(var t=this._entitiesToVisualize.values,i=this._modelHash,r=this._primitives,o=0,a=t.length;o<a;o++){var u,c,d=t[o],m=d._model,f=i[d.id],S=d.isShowing&&d.isAvailable(e)&&_.getValueOrDefault(m._show,e,!0);if(S&&(c=d.computeModelMatrix(e,E),u=l.createIfNeeded(_.getValueOrUndefined(m._uri,e)),S=n(c)&&n(u)),S){var P=n(f)?f.modelPrimitive:void 0;if(n(P)&&u.url===f.url||(n(P)&&(r.removeAndDestroy(P),delete i[d.id]),(P=h.fromGltf({url:u,incrementallyLoadTextures:_.getValueOrDefault(m._incrementallyLoadTextures,e,!0),scene:this._scene})).id=d,r.add(P),f={modelPrimitive:P,url:u.url,animationsRunning:!1,nodeTransformationsScratch:{},articulationsScratch:{},loadFail:!1},i[d.id]=f,D(P,d,i)),P.show=!0,P.scale=_.getValueOrDefault(m._scale,e,1),P.minimumPixelSize=_.getValueOrDefault(m._minimumPixelSize,e,0),P.maximumScale=_.getValueOrUndefined(m._maximumScale,e),P.modelMatrix=s.clone(c,P.modelMatrix),P.shadows=_.getValueOrDefault(m._shadows,e,g),P.heightReference=_.getValueOrDefault(m._heightReference,e,v),P.distanceDisplayCondition=_.getValueOrUndefined(m._distanceDisplayCondition,e),P.silhouetteColor=_.getValueOrDefault(m._silhouetteColor,e,y,P._silhouetteColor),P.silhouetteSize=_.getValueOrDefault(m._silhouetteSize,e,0),P.color=_.getValueOrDefault(m._color,e,x,P._color),P.colorBlendMode=_.getValueOrDefault(m._colorBlendMode,e,w),P.colorBlendAmount=_.getValueOrDefault(m._colorBlendAmount,e,.5),P.clippingPlanes=_.getValueOrUndefined(m._clippingPlanes,e),P.clampAnimations=_.getValueOrDefault(m._clampAnimations,e,!0),P.imageBasedLightingFactor=_.getValueOrDefault(m._imageBasedLightingFactor,e,T),P.lightColor=_.getValueOrUndefined(m._lightColor,e),P._upAxis=_.getValueOrDefault(m._upAxis,e,C),P._forwardAxis=_.getValueOrUndefined(m._forwardAxis,e),P.ready){var b=_.getValueOrDefault(m._runAnimations,e,!0);f.animationsRunning!==b&&(b?P.activeAnimations.addAll({loop:p.REPEAT}):P.activeAnimations.removeAll(),f.animationsRunning=b);var O=_.getValueOrUndefined(m._nodeTransformations,e,f.nodeTransformationsScratch);if(n(O))for(var I=Object.keys(O),M=0,N=I.length;M<N;++M){var F=I[M],R=O[F];if(n(R)){var L=P.getNode(F);if(n(L)){var V=s.fromTranslationRotationScale(R,A);L.matrix=s.multiply(L.originalMatrix,V,V)}}}var U=!1,z=_.getValueOrUndefined(m._articulations,e,f.articulationsScratch);if(n(z))for(var B=Object.keys(z),H=0,k=B.length;H<k;++H){var G=B[H],W=z[G];n(W)&&(U=!0,P.setArticulationStage(G,W))}U&&P.applyArticulations()}}else n(f)&&(f.modelPrimitive.show=!1)}return!0},S.prototype.isDestroyed=function(){return!1},S.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(S.prototype._onCollectionChanged,this);for(var e=this._entitiesToVisualize.values,t=this._modelHash,i=this._primitives,r=e.length-1;r>-1;r--)P(this,e[r],t,i);return o(this)},S.prototype.getBoundingSphere=function(e,i){var r=this._modelHash[e.id];if(!n(r)||r.loadFail)return f.FAILED;var o=r.modelPrimitive;if(!n(o)||!o.show)return f.FAILED;if(!o.ready)return f.PENDING;if(o.heightReference===d.NONE)t.transform(o.boundingSphere,o.modelMatrix,i);else{if(!n(o._clampedModelMatrix)||o._heightChanged)return f.PENDING;t.transform(o.boundingSphere,o._clampedModelMatrix,i)}return f.DONE},S.prototype._onCollectionChanged=function(e,t,i,r){var o,a,s=this._entitiesToVisualize,l=this._modelHash,u=this._primitives;for(o=t.length-1;o>-1;o--)a=t[o],n(a._model)&&n(a._position)&&s.set(a.id,a);for(o=r.length-1;o>-1;o--)a=r[o],n(a._model)&&n(a._position)?(b(a,l),s.set(a.id,a)):(P(this,a,l,u),s.remove(a.id));for(o=i.length-1;o>-1;o--)P(this,a=i[o],l,u),s.remove(a.id)},S}.apply(t,r))||(e.exports=n)},1982:function(e,t,i){var r,n;r=[i(81),i(12),i(8),i(20),i(11),i(42),i(43),i(28),i(150),i(107),i(60),i(434),i(44),i(358),i(312),i(198),i(38),i(359),i(319),i(495),i(417)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x){"use strict";var w=new u,T=new u,C=new u;function E(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function A(e,t,r,n,a,s,l,c){for(;e instanceof g;)e=e.resolvedProperty;e instanceof v?l=function(e,t,r,n,a,s,l,u,c){var d,h=u;d=e.getValueInReferenceFrame(t,s,c[h]),i(d)&&(c[h++]=d);for(var p,m,f,_=!i(a)||o.lessThanOrEquals(a,t)||o.greaterThanOrEquals(a,r),g=0,v=n.length,y=n[g],x=r,w=!1;g<v;){if(!_&&o.greaterThanOrEquals(y,a)&&(d=e.getValueInReferenceFrame(a,s,c[h]),i(d)&&(c[h++]=d),_=!0),o.greaterThan(y,t)&&o.lessThan(y,x)&&!y.equals(a)&&(d=e.getValueInReferenceFrame(y,s,c[h]),i(d)&&(c[h++]=d)),g<v-1){if(l>0&&!w){var T=n[g+1],C=o.secondsDifference(T,y);(w=C>l)&&(p=Math.ceil(C/l),m=0,f=C/Math.max(p,2),p=Math.max(p-1,1))}if(w&&m<p){y=o.addSeconds(y,f,new o),m++;continue}}w=!1,y=n[++g]}return d=e.getValueInReferenceFrame(r,s,c[h]),i(d)&&(c[h++]=d),h}(e,t,r,e._property._times,n,a,s,l,c):l=e instanceof p?function(e,t,i,r,n,a,s,l){T.start=t,T.stop=i;for(var c=s,d=e.intervals,h=0;h<d.length;h++){var p=d.get(h);if(!u.intersect(p,T,w).isEmpty){var m=p.start,f=p.stop,_=t;o.greaterThan(m,_)&&(_=m);var g=i;o.lessThan(f,g)&&(g=f),c=A(p.data,_,g,r,n,a,c,l)}}return c}(e,t,r,n,a,s,l,c):e instanceof x?function(e,t,r,n,a,s,l,c){C.start=t,C.stop=r;for(var d=l,h=e.intervals,p=0;p<h.length;p++){var m=h.get(p);if(!u.intersect(m,C,w).isEmpty){var f=m.start;m.isStartIncluded||(f=m.isStopIncluded?m.stop:o.addSeconds(m.start,o.secondsDifference(m.stop,m.start)/2,new o));var _=e.getValueInReferenceFrame(f,a,c[d]);i(_)&&(c[d]=_,d++)}}return d}(e,t,r,0,a,0,l,c):e instanceof m||e instanceof y&&_.isConstant(e)?function(e,t,r,n,o,a,s,l){var u=e.getValueInReferenceFrame(t,o,l[s]);return i(u)&&(l[s++]=u),s}(e,t,0,0,a,0,l,c):function(e,t,r,n,a,s,l,u){for(var c,d=0,h=l,p=t,m=Math.max(s,60),f=!i(n)||o.lessThanOrEquals(n,t)||o.greaterThanOrEquals(n,r);o.lessThan(p,r);)!f&&o.greaterThanOrEquals(p,n)&&(f=!0,c=e.getValueInReferenceFrame(n,a,u[h]),i(c)&&(u[h]=c,h++)),c=e.getValueInReferenceFrame(p,a,u[h]),i(c)&&(u[h]=c,h++),d++,p=o.addSeconds(t,m*d,new o);return c=e.getValueInReferenceFrame(r,a,u[h]),i(c)&&(u[h]=c,h++),h}(e,t,r,n,a,s,l,c);return l}function S(e,t,r,n,o,a,s){i(s)||(s=[]);var l=A(e,t,r,n,o,a,0,s);return s.length=l,s}var P=new a;function b(e,t){this._unusedIndexes=[],this._polylineCollection=new d,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}function D(t,i){i.collectionChanged.addEventListener(D.prototype._onCollectionChanged,this),this._scene=t,this._updaters={},this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}return b.prototype.update=function(e){if(this._referenceFrame===l.INERTIAL){var r=c.computeIcrfToFixedMatrix(e,P);i(r)||(r=c.computeTemeToPseudoFixedMatrix(e,P)),s.fromRotationTranslation(r,t.ZERO,this._polylineCollection.modelMatrix)}},b.prototype.updateObject=function(e,t){var r,n,a=t.entity,s=a._path,l=a._position,u=s._show,c=t.polyline,d=a.isShowing&&(!i(u)||u.getValue(e));if(d){var h=_.getValueOrUndefined(s._leadTime,e),p=_.getValueOrUndefined(s._trailTime,e),m=a._availability,g=i(m),v=i(h),y=i(p);if(d=g||v&&y){if(y&&(r=o.addSeconds(e,-p,new o)),v&&(n=o.addSeconds(e,h,new o)),g){var x=m.start,w=m.stop;y&&!o.greaterThan(x,r)||(r=x),v&&!o.lessThan(w,n)||(n=w)}d=o.lessThan(r,n)}}if(d){if(!i(c)){var T=this._unusedIndexes;if(T.length>0){var C=T.pop();c=this._polylineCollection.get(C),t.index=C}else t.index=this._polylineCollection.length,c=this._polylineCollection.add();c.id=a,t.polyline=c}var E=_.getValueOrDefault(s._resolution,e,60);c.show=!0,c.positions=S(l,r,n,e,this._referenceFrame,E,c.positions.slice()),c.material=f.getValue(e,s._material,c.material),c.width=_.getValueOrDefault(s._width,e,1),c.distanceDisplayCondition=_.getValueOrUndefined(s._distanceDisplayCondition,e,c.distanceDisplayCondition)}else i(c)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,c.show=!1,t.index=void 0)},b.prototype.removeObject=function(e){var t=e.polyline;i(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)},b.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),r(this)},D.prototype.update=function(e){var t=this._updaters;for(var r in t)t.hasOwnProperty(r)&&t[r].update(e);for(var n=this._items.values,o=0,a=n.length;o<a;o++){var s=n[o],u=s.entity._position,c=s.updater,d=l.FIXED;this._scene.mode===h.SCENE3D&&(d=u.referenceFrame);var p=this._updaters[d];c===p&&i(p)?p.updateObject(e,s):(i(c)&&c.removeObject(s),i(p)||((p=new b(this._scene,d)).update(e),this._updaters[d]=p),s.updater=p,i(p)&&p.updateObject(e,s))}return!0},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(D.prototype._onCollectionChanged,this);var e=this._updaters;for(var t in e)e.hasOwnProperty(t)&&e[t].destroy();return r(this)},D.prototype._onCollectionChanged=function(e,t,r,n){var o,a,s,l=this._items;for(o=t.length-1;o>-1;o--)a=t[o],i(a._path)&&i(a._position)&&l.set(a.id,new E(a));for(o=n.length-1;o>-1;o--)a=n[o],i(a._path)&&i(a._position)?l.contains(a.id)||l.set(a.id,new E(a)):(s=l.get(a.id),i(s)&&(i(s.updater)&&s.updater.removeObject(s),l.remove(a.id)));for(o=r.length-1;o>-1;o--)a=r[o],s=l.get(a.id),i(s)&&(i(s.updater)&&s.updater.removeObject(s),l.remove(a.id))},D._subSample=S,D}.apply(t,r))||(e.exports=n)},1983:function(e,t,i){var r,n;r=[i(81),i(12),i(22),i(8),i(20),i(11),i(84),i(173),i(634),i(71),i(90),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d){"use strict";var h=i.WHITE,p=i.BLACK,m=new i,f=new t,_=new i,g=new s,v=new s,y=new a;function x(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function w(t,i){i.collectionChanged.addEventListener(w.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}function T(e,t,i){if(r(e)){var n=e.pointPrimitive;if(r(n))return e.pointPrimitive=void 0,void i.removePoint(t);var o=e.billboard;r(o)&&(e.billboard=void 0,i.removeBillboard(t))}}return w.prototype.update=function(e){for(var n=this._items.values,o=this._cluster,a=0,s=n.length;a<s;a++){var c,x=n[a],w=x.entity,C=w._point,E=x.pointPrimitive,A=x.billboard,S=d.getValueOrDefault(C._heightReference,e,u.NONE),P=w.isShowing&&w.isAvailable(e)&&d.getValueOrDefault(C._show,e,!0);if(P&&(c=d.getValueOrUndefined(w._position,e,f),P=r(c)),P){d.isConstant(w._position)||(o._clusterDirty=!0);var b=!1,D=!1;if(S===u.NONE||r(A)?S!==u.NONE||r(E)||(r(A)&&(T(x,w,o),A=void 0),(E=o.getPoint(w)).id=w,x.pointPrimitive=E):(r(E)&&(T(x,w,o),E=void 0),(A=o.getBillboard(w)).id=w,A.image=void 0,x.billboard=A,b=!0,D=t.equals(A.position,c)&&A.heightReference===S),r(E))E.show=!0,E.position=c,E.scaleByDistance=d.getValueOrUndefined(C._scaleByDistance,e,g),E.translucencyByDistance=d.getValueOrUndefined(C._translucencyByDistance,e,v),E.color=d.getValueOrDefault(C._color,e,h,m),E.outlineColor=d.getValueOrDefault(C._outlineColor,e,p,_),E.outlineWidth=d.getValueOrDefault(C._outlineWidth,e,0),E.pixelSize=d.getValueOrDefault(C._pixelSize,e,1),E.distanceDisplayCondition=d.getValueOrUndefined(C._distanceDisplayCondition,e,y),E.disableDepthTestDistance=d.getValueOrDefault(C._disableDepthTestDistance,e,0);else if(r(A)){A.show=!0,A.position=c,A.scaleByDistance=d.getValueOrUndefined(C._scaleByDistance,e,g),A.translucencyByDistance=d.getValueOrUndefined(C._translucencyByDistance,e,v),A.distanceDisplayCondition=d.getValueOrUndefined(C._distanceDisplayCondition,e,y),A.disableDepthTestDistance=d.getValueOrDefault(C._disableDepthTestDistance,e,0),A.heightReference=S;var O=d.getValueOrDefault(C._color,e,h,m),I=d.getValueOrDefault(C._outlineColor,e,p,_),M=Math.round(d.getValueOrDefault(C._outlineWidth,e,0)),N=Math.max(1,Math.round(d.getValueOrDefault(C._pixelSize,e,1)));if(M>0?(A.scale=1,b=b||M!==x.outlineWidth||N!==x.pixelSize||!i.equals(O,x.color)||!i.equals(I,x.outlineColor)):(A.scale=N/50,N=50,b=b||M!==x.outlineWidth||!i.equals(O,x.color)||!i.equals(I,x.outlineColor)),b){x.color=i.clone(O,x.color),x.outlineColor=i.clone(I,x.outlineColor),x.pixelSize=N,x.outlineWidth=M;var F=O.alpha,R=O.toCssColorString(),L=I.toCssColorString(),V=JSON.stringify([R,N,L,M]);A.setImage(V,l(F,R,L,M,N))}D&&A._updateClamping()}}else T(x,w,o)}return!0},w.prototype.getBoundingSphere=function(e,i){var n=this._items.get(e.id);if(!r(n)||!r(n.pointPrimitive)&&!r(n.billboard))return c.FAILED;if(r(n.pointPrimitive))i.center=t.clone(n.pointPrimitive.position,i.center);else{var o=n.billboard;if(!r(o._clampedPosition))return c.PENDING;i.center=t.clone(o._clampedPosition,i.center)}return i.radius=0,c.DONE},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(w.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return n(this)},w.prototype._onCollectionChanged=function(e,t,i,n){var o,a,s=this._items,l=this._cluster;for(o=t.length-1;o>-1;o--)a=t[o],r(a._point)&&r(a._position)&&s.set(a.id,new x(a));for(o=n.length-1;o>-1;o--)a=n[o],r(a._point)&&r(a._position)?s.contains(a.id)||s.set(a.id,new x(a)):(T(s.get(a.id),a,l),s.remove(a.id));for(o=i.length-1;o>-1;o--)a=i[o],T(s.get(a.id),a,l),s.remove(a.id)},w}.apply(t,r))||(e.exports=n)},1984:function(e,t,i){var r,n;r=[i(81),i(33),i(16),i(9),i(8),i(20),i(122),i(308),i(310),i(102),i(90),i(75),i(763),i(1985),i(766),i(767),i(1987)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=[];function v(e,t){for(var i=e._batches,r=i.length,n=0;n<r;n++)i[n].remove(t)}function y(e,t,i){if(i.isDynamic)e._dynamicBatch.add(t,i);else if(i.clampToGround&&i.fillEnabled){var r=i.classificationTypeProperty.getValue(t);e._groundBatches[r].add(t,i)}else{var o;i.fillEnabled&&(o=i.shadowsProperty.getValue(t));var a,s=0;n(i.depthFailMaterialProperty)&&(s=i.depthFailMaterialProperty instanceof d?1:2),n(o)&&(a=o+s*u.NUMBER_OF_SHADOW_MODES),i.fillEnabled&&(i.fillMaterialProperty instanceof d?e._colorBatches[a].add(t,i):e._materialBatches[a].add(t,i))}}function x(t,i,n,o){var c;o=r(o,t.groundPrimitives),n=r(n,t.primitives),this._scene=t,this._primitives=n,this._entityCollection=void 0,this._addedObjects=new e,this._removedObjects=new e,this._changedObjects=new e;var d=u.NUMBER_OF_SHADOW_MODES;for(this._colorBatches=new Array(3*d),this._materialBatches=new Array(3*d),c=0;c<d;++c)this._colorBatches[c]=new m(n,s,void 0,!1,c),this._materialBatches[c]=new f(n,l,void 0,!1,c),this._colorBatches[c+d]=new m(n,s,s,!1,c),this._materialBatches[c+d]=new f(n,l,s,!1,c),this._colorBatches[c+2*d]=new m(n,s,l,!1,c),this._materialBatches[c+2*d]=new f(n,l,l,!1,c);this._dynamicBatch=new h(n,o);var p=a.NUMBER_OF_CLASSIFICATION_TYPES;for(this._groundBatches=new Array(p),c=0;c<p;++c)this._groundBatches[c]=new _(o,c);this._batches=this._colorBatches.concat(this._materialBatches,this._dynamicBatch,this._groundBatches),this._subscriptions=new e,this._updaters=new e,this._entityCollection=i,i.collectionChanged.addEventListener(x.prototype._onCollectionChanged,this),this._onCollectionChanged(i,i.values,g)}x.prototype.update=function(e){var t,i,r,n,o=this._addedObjects,a=o.values,s=this._removedObjects,l=s.values,u=this._changedObjects,c=u.values;for(t=c.length-1;t>-1;t--)r=(i=c[t]).id,(n=this._updaters.get(r)).entity===i?(v(this,n),y(this,e,n)):(l.push(i),a.push(i));for(t=l.length-1;t>-1;t--)r=(i=l[t]).id,v(this,n=this._updaters.get(r)),n.destroy(),this._updaters.remove(r),this._subscriptions.get(r)(),this._subscriptions.remove(r);for(t=a.length-1;t>-1;t--)r=(i=a[t]).id,n=new p(i,this._scene),this._updaters.set(r,n),y(this,e,n),this._subscriptions.set(r,n.geometryChanged.addEventListener(x._onGeometryChanged,this));o.removeAll(),s.removeAll(),u.removeAll();var d=!0,h=this._batches,m=h.length;for(t=0;t<m;t++)d=h[t].update(e)&&d;return d};var w=[],T=new t;return x.prototype.getBoundingSphere=function(e,i){for(var r=w,n=T,o=0,a=c.DONE,s=this._batches,l=s.length,u=this._updaters.get(e.id),d=0;d<l;d++){if((a=s[d].getBoundingSphere(u,n))===c.PENDING)return c.PENDING;a===c.DONE&&(r[o]=t.clone(n,r[o]),o++)}return 0===o?c.FAILED:(r.length=o,t.fromBoundingSpheres(r,i),c.DONE)},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){var e;this._entityCollection.collectionChanged.removeEventListener(x.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var r=this._subscriptions.values;for(i=r.length,e=0;e<i;e++)r[e]();return this._subscriptions.removeAll(),o(this)},x._onGeometryChanged=function(e){var t=this._removedObjects,i=this._changedObjects,r=e.entity,o=r.id;n(t.get(o))||n(i.get(o))||i.set(o,r)},x.prototype._onCollectionChanged=function(e,t,i){var r,n,o,a=this._addedObjects,s=this._removedObjects,l=this._changedObjects;for(r=i.length-1;r>-1;r--)n=(o=i[r]).id,a.remove(n)||(s.set(n,o),l.remove(n));for(r=t.length-1;r>-1;r--)n=(o=t[r]).id,s.remove(n)?l.set(n,o):a.set(n,o)},x}.apply(t,r))||(e.exports=n)},1985:function(e,t,i){var r,n;r=[i(148),i(33),i(16),i(22),i(67),i(9),i(8),i(10),i(20),i(11),i(84),i(97),i(25),i(64),i(563),i(80),i(189),i(1986),i(244),i(91),i(143),i(122),i(307),i(434),i(308),i(310),i(102),i(90),i(75),i(182),i(198),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O,I){"use strict";var M=new D(0),N={},F=new r,R=new b(r.WHITE),L=new D(!0),V=new D(S.DISABLED),U=new D(new c),z=new D(w.BOTH);function B(){this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function H(){this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function k(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(k.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new h,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._depthFailMaterialProperty=void 0,this._geometryOptions=new B,this._groundGeometryOptions=new H,this._id="polyline-"+e.id,this._clampToGround=!1,this._supportsPolylinesOnTerrain=x.supportsPolylinesOnTerrain(t),this._zIndex=0,this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}s(k.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&I.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}},arcType:{get:function(){return this._arcType}},clampToGround:{get:function(){return this._clampToGround&&this._supportsPolylinesOnTerrain}},zIndex:{get:function(){return this._zIndex}}}),k.prototype.isOutlineVisible=function(e){return!1},k.prototype.isFilled=function(e){var t=this._entity,i=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e);return o(i,!1)},k.prototype.createFillGeometryInstance=function(e){var t,i=this._entity,o=i.isAvailable(e),s=new y(o&&i.isShowing&&this._showProperty.getValue(e)),l=this._distanceDisplayConditionProperty.getValue(e),u={show:s,distanceDisplayCondition:d.fromDistanceDisplayCondition(l)};return this._materialProperty instanceof b&&(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)&&(t=this._materialProperty.color.getValue(e,F)),a(t)||(t=r.WHITE),u.color=n.fromColor(t)),this.clampToGround?new p({id:i,geometry:new m(this._groundGeometryOptions),attributes:u}):(a(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof b&&(a(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||o)&&(t=this._depthFailMaterialProperty.color.getValue(e,F)),a(t)||(t=r.WHITE),u.depthFailColor=n.fromColor(t)),new p({id:i,geometry:new g(this._geometryOptions),attributes:u}))},k.prototype.createOutlineGeometryInstance=function(e){},k.prototype.isDestroyed=function(){return!1},k.prototype.destroy=function(){this._entitySubscription(),l(this)},k.prototype._onEntityPropertyChanged=function(e,t,i,r){if("availability"===t||"polyline"===t){var n=this._entity.polyline;if(a(n)){var s=n.positions,l=n.show;if(a(l)&&l.isConstant&&!l.getValue(f.MINIMUM_VALUE)||!a(s))this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));else{var u=n.zIndex,c=o(n.material,R),d=c instanceof b;this._materialProperty=c,this._depthFailMaterialProperty=n.depthFailMaterial,this._showProperty=o(l,L),this._shadowsProperty=o(n.shadows,V),this._distanceDisplayConditionProperty=o(n.distanceDisplayCondition,U),this._classificationTypeProperty=o(n.classificationType,z),this._fillEnabled=!0,this._zIndex=o(u,M);var h=n.width,p=n.arcType,m=n.clampToGround,g=n.granularity;if(s.isConstant&&I.isConstant(h)&&I.isConstant(p)&&I.isConstant(g)&&I.isConstant(m)&&I.isConstant(u)){var v,y=this._geometryOptions,x=s.getValue(f.MINIMUM_VALUE,y.positions);if(!a(x)||x.length<2)return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));v=d&&(!a(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof b)?E.VERTEX_FORMAT:A.VERTEX_FORMAT,y.vertexFormat=v,y.positions=x,y.width=a(h)?h.getValue(f.MINIMUM_VALUE):void 0,y.arcType=a(p)?p.getValue(f.MINIMUM_VALUE):void 0,y.granularity=a(g)?g.getValue(f.MINIMUM_VALUE):void 0;var w=this._groundGeometryOptions;w.positions=x,w.width=y.width,w.arcType=y.arcType,w.granularity=y.granularity,this._clampToGround=!!a(m)&&m.getValue(f.MINIMUM_VALUE),!this._clampToGround&&a(u)&&_("Entity polylines must have clampToGround: true when using zIndex.  zIndex will be ignored."),this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this))}},k.prototype.createDynamicUpdater=function(e,t){return new W(e,t,this)};var G={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};function W(e,t,i){this._line=void 0,this._primitives=e,this._groundPrimitives=t,this._groundPolylinePrimitive=void 0,this._material=void 0,this._geometryUpdater=i,this._positions=[]}function Y(e){if(a(e._line))return e._line;var t=e._geometryUpdater._scene.id,i=N[t],r=e._primitives;!a(i)||i.isDestroyed()?(i=new C,N[t]=i,r.add(i)):r.contains(i)||r.add(i);var n=i.add();return n.id=e._geometryUpdater._entity,e._line=n,n}return W.prototype.update=function(t){var i=this._geometryUpdater,r=i._entity,n=r.polyline,o=n.positions,s=I.getValueOrUndefined(o,t,this._positions);i._clampToGround=I.getValueOrDefault(n._clampToGround,t,!1),i._groundGeometryOptions.positions=s,i._groundGeometryOptions.width=I.getValueOrDefault(n._width,t,1),i._groundGeometryOptions.arcType=I.getValueOrDefault(n._arcType,t,e.GEODESIC),i._groundGeometryOptions.granularity=I.getValueOrDefault(n._granularity,t,9999);var l=this._groundPrimitives;if(a(this._groundPolylinePrimitive)&&(l.remove(this._groundPolylinePrimitive),this._groundPolylinePrimitive=void 0),i.clampToGround){if(!r.isShowing||!r.isAvailable(t)||!I.getValueOrDefault(n._show,t,!0))return;if(!a(s)||s.length<2)return;var u,c=i.fillMaterialProperty;if(c instanceof b)u=new E;else{var d=O.getValue(t,c,this._material);u=new A({material:d,translucent:d.isTranslucent()}),this._material=d}return this._groundPolylinePrimitive=l.add(new T({geometryInstances:i.createFillGeometryInstance(t),appearance:u,classificationType:i.classificationTypeProperty.getValue(t),asynchronous:!1}),I.getValueOrUndefined(i.zIndex,t)),void(a(this._line)&&(this._line.show=!1))}var h=Y(this);if(r.isShowing&&r.isAvailable(t)&&I.getValueOrDefault(n._show,t,!0))if(!a(s)||s.length<2)h.show=!1;else{var p=e.GEODESIC;p=I.getValueOrDefault(n._arcType,t,p);var m=i._scene.globe;p!==e.NONE&&a(m)&&(G.ellipsoid=m.ellipsoid,G.positions=s,G.granularity=I.getValueOrUndefined(n._granularity,t),G.height=v.extractHeights(s,m.ellipsoid),s=v.generateCartesianArc(G)),h.show=!0,h.positions=s.slice(),h.material=O.getValue(t,i.fillMaterialProperty,h.material),h.width=I.getValueOrDefault(n._width,t,1),h.distanceDisplayCondition=I.getValueOrUndefined(n._distanceDisplayCondition,t,h.distanceDisplayCondition)}else h.show=!1},W.prototype.getBoundingSphere=function(e){if(this._geometryUpdater.clampToGround){var i=this._groundPolylinePrimitive;if(a(i)&&i.show&&i.ready){var r=i.getGeometryInstanceAttributes(this._geometryUpdater._entity);if(a(r)&&a(r.boundingSphere))return t.clone(r.boundingSphere,e),P.DONE}return a(i)&&!i.ready?P.PENDING:P.DONE}var n=Y(this);return n.show&&n.positions.length>0?(t.fromPoints(n.positions,e),P.DONE):P.FAILED},W.prototype.isDestroyed=function(){return!1},W.prototype.destroy=function(){var e=this._geometryUpdater._scene.id,t=N[e];a(t)&&(t.remove(this._line),0===t.length&&(this._primitives.removeAndDestroy(t),delete N[e])),a(this._groundPolylinePrimitive)&&this._groundPrimitives.remove(this._groundPolylinePrimitive),l(this)},k}.apply(t,r))||(e.exports=n)},1986:function(e,t,i){var r,n;r=[i(148),i(149),i(33),i(12),i(22),i(34),i(9),i(8),i(11),i(26),i(52),i(53),i(65),i(386),i(50),i(14),i(244),i(45),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v){"use strict";var y=[];function x(e,t,i,r,o){var a,s=y;s.length=o;var l=i.red,u=i.green,c=i.blue,d=i.alpha,h=r.red,p=r.green,m=r.blue,f=r.alpha;if(n.equals(i,r)){for(a=0;a<o;a++)s[a]=n.clone(i);return s}var _=(h-l)/o,g=(p-u)/o,v=(m-c)/o,x=(f-d)/o;for(a=0;a<o;a++)s[a]=new n(l+a*_,u+a*g,c+a*v,d+a*x);return s}function w(t){var i=(t=a(t,a.EMPTY_OBJECT)).positions,o=t.colors,l=a(t.width,1),c=a(t.colorsPerVertex,!1);this._positions=i,this._colors=o,this._width=l,this._colorsPerVertex=c,this._vertexFormat=v.clone(a(t.vertexFormat,v.DEFAULT)),this._arcType=a(t.arcType,e.GEODESIC),this._granularity=a(t.granularity,f.RADIANS_PER_DEGREE),this._ellipsoid=u.clone(a(t.ellipsoid,u.WGS84)),this._workerName="createPolylineGeometry";var d=1+i.length*r.packedLength;d+=s(o)?1+o.length*n.packedLength:1,this.packedLength=d+u.packedLength+v.packedLength+4}w.pack=function(e,t,i){var o;i=a(i,0);var l=e._positions,c=l.length;for(t[i++]=c,o=0;o<c;++o,i+=r.packedLength)r.pack(l[o],t,i);var d=e._colors;for(c=s(d)?d.length:0,t[i++]=c,o=0;o<c;++o,i+=n.packedLength)n.pack(d[o],t,i);return u.pack(e._ellipsoid,t,i),i+=u.packedLength,v.pack(e._vertexFormat,t,i),i+=v.packedLength,t[i++]=e._width,t[i++]=e._colorsPerVertex?1:0,t[i++]=e._arcType,t[i]=e._granularity,t};var T=u.clone(u.UNIT_SPHERE),C=new v,E={positions:void 0,colors:void 0,ellipsoid:T,vertexFormat:C,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};w.unpack=function(e,t,i){var o;t=a(t,0);var l=e[t++],c=new Array(l);for(o=0;o<l;++o,t+=r.packedLength)c[o]=r.unpack(e,t);var d=(l=e[t++])>0?new Array(l):void 0;for(o=0;o<l;++o,t+=n.packedLength)d[o]=n.unpack(e,t);var h=u.unpack(e,t,T);t+=u.packedLength;var p=v.unpack(e,t,C);t+=v.packedLength;var m=e[t++],f=1===e[t++],_=e[t++],g=e[t];return s(i)?(i._positions=c,i._colors=d,i._ellipsoid=u.clone(h,i._ellipsoid),i._vertexFormat=v.clone(p,i._vertexFormat),i._width=m,i._colorsPerVertex=f,i._arcType=_,i._granularity=g,i):(E.positions=c,E.colors=d,E.width=m,E.colorsPerVertex=f,E.arcType=_,E.granularity=g,new w(E))};var A=new r,S=new r,P=new r,b=new r;return w.createGeometry=function(a){var l,u,v,w=a._width,T=a._vertexFormat,C=a._colors,E=a._colorsPerVertex,D=a._arcType,O=a._granularity,I=a._ellipsoid,M=t(a._positions,r.equalsEpsilon),N=M.length;if(!(N<2||w<=0)){if(D===e.GEODESIC||D===e.RHUMB){var F,R;D===e.GEODESIC?(F=f.chordLength(O,I.maximumRadius),R=_.numberOfPoints):(F=O,R=_.numberOfPointsRhumbLine);var L=_.extractHeights(M,I);if(s(C)){var V=1;for(l=0;l<N-1;++l)V+=R(M[l],M[l+1],F);var U=new Array(V),z=0;for(l=0;l<N-1;++l){var B=M[l],H=M[l+1],k=C[l],G=R(B,H,F);if(E&&l<V){var W=x(0,0,k,C[l+1],G),Y=W.length;for(u=0;u<Y;++u)U[z++]=W[u]}else for(u=0;u<G;++u)U[z++]=n.clone(k)}U[z]=n.clone(C[C.length-1]),C=U,y.length=0}M=D===e.GEODESIC?_.generateCartesianArc({positions:M,minDistance:F,ellipsoid:I,height:L}):_.generateCartesianRhumbArc({positions:M,granularity:F,ellipsoid:I,height:L})}var j,X=4*(N=M.length)-4,Q=new Float64Array(3*X),q=new Float64Array(3*X),Z=new Float64Array(3*X),K=new Float32Array(2*X),J=T.st?new Float32Array(2*X):void 0,$=s(C)?new Uint8Array(4*X):void 0,ee=0,te=0,ie=0,re=0;for(u=0;u<N;++u){var ne,oe;0===u?(j=A,r.subtract(M[0],M[1],j),r.add(M[0],j,j)):j=M[u-1],r.clone(j,P),r.clone(M[u],S),u===N-1?(j=A,r.subtract(M[N-1],M[N-2],j),r.add(M[N-1],j,j)):j=M[u+1],r.clone(j,b),s($)&&(ne=0===u||E?C[u]:C[u-1],u!==N-1&&(oe=C[u]));var ae=u===N-1?2:4;for(v=0===u?2:0;v<ae;++v){r.pack(S,Q,ee),r.pack(P,q,ee),r.pack(b,Z,ee),ee+=3;var se=v-2<0?-1:1;if(K[te++]=v%2*2-1,K[te++]=se*w,T.st&&(J[ie++]=u/(N-1),J[ie++]=Math.max(K[te-2],0)),s($)){var le=v<2?ne:oe;$[re++]=n.floatToByte(le.red),$[re++]=n.floatToByte(le.green),$[re++]=n.floatToByte(le.blue),$[re++]=n.floatToByte(le.alpha)}}}var ue=new h;ue.position=new d({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:Q}),ue.prevPosition=new d({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:q}),ue.nextPosition=new d({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:Z}),ue.expandAndWidth=new d({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:K}),T.st&&(ue.st=new d({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:J})),s($)&&(ue.color=new d({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:4,values:$,normalize:!0}));var ce=m.createTypedArray(X,6*N-6),de=0,he=0,pe=N-1;for(u=0;u<pe;++u)ce[he++]=de,ce[he++]=de+2,ce[he++]=de+1,ce[he++]=de+1,ce[he++]=de+2,ce[he++]=de+3,de+=4;return new c({attributes:ue,indices:ce,primitiveType:g.TRIANGLES,boundingSphere:i.fromPoints(M),geometryType:p.POLYLINES})}},w}.apply(t,r))||(e.exports=n)},1987:function(e,t,i){var r,n;r=[i(9),i(81),i(22),i(67),i(8),i(84),i(97),i(91),i(307),i(308),i(310),i(90),i(75),i(198),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m){"use strict";var f=new i,_=new o,g=new o;function v(e,i,r,n,o){var a;a=r instanceof h?u:c,this.orderedGroundPrimitives=e,this.classificationType=i,this.appearanceType=a,this.materialProperty=r,this.updaters=new t,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new t,this.material=void 0,this.updatersWithAttributes=new t,this.attributes=new t,this.invalidated=!1,this.removeMaterialSubscription=r.definitionChanged.addEventListener(v.prototype.onMaterialChanged,this),this.subscriptions=new t,this.showsUpdated=new t,this.zIndex=n,this._asynchronous=o}function y(t,i,r){this._items=[],this._orderedGroundPrimitives=t,this._classificationType=i,this._asynchronous=e(r,!0)}return v.prototype.onMaterialChanged=function(){this.invalidated=!0},v.prototype.isMaterial=function(e){var t=this.materialProperty,i=e.fillMaterialProperty;return i===t||i instanceof h&&t instanceof h||n(t)&&t.equals(i)},v.prototype.add=function(e,t,i){var r=t.id;if(this.updaters.set(r,t),this.geometry.set(r,i),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&m.isConstant(t.distanceDisplayConditionProperty)){var n=this;this.subscriptions.set(r,t.entity.definitionChanged.addEventListener(function(e,i,r,o){"isShowing"===i&&n.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(r,t);this.createPrimitive=!0},v.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return n(i)&&(i(),this.subscriptions.remove(t)),!0}return!1},v.prototype.update=function(e){var t,u=!0,d=this.primitive,h=this.orderedGroundPrimitives,v=this.geometry.values;if(this.createPrimitive){if(v.length>0)n(d)&&(n(this.oldPrimitive)?h.remove(d):this.oldPrimitive=d),d=new l({show:!1,asynchronous:this._asynchronous,geometryInstances:v,appearance:new this.appearanceType,classificationType:this.classificationType}),this.appearanceType===c&&(this.material=p.getValue(e,this.materialProperty,this.material),d.appearance.material=this.material),h.add(d,this.zIndex),u=!1;else{n(d)&&(h.remove(d),d=void 0);var y=this.oldPrimitive;n(y)&&(h.remove(y),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=d,this.createPrimitive=!1}else if(n(d)&&d.ready){d.show=!0,n(this.oldPrimitive)&&(h.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===c&&(this.material=p.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material);var x=this.updatersWithAttributes.values,w=x.length;for(t=0;t<w;t++){var T=x[t],C=T.entity,E=this.geometry.get(T.id),A=this.attributes.get(E.id.id);if(n(A)||(A=d.getGeometryInstanceAttributes(E.id),this.attributes.set(E.id.id,A)),!T.fillMaterialProperty.isConstant){var S=T.fillMaterialProperty.color,P=m.getValueOrDefault(S,e,i.WHITE,f);i.equals(A._lastColor,P)||(A._lastColor=i.clone(P,A._lastColor),A.color=r.toValue(P,A.color))}var b=C.isShowing&&(T.hasConstantFill||T.isFilled(e));b!==(1===A.show[0])&&(A.show=s.toValue(b,A.show));var D=T.distanceDisplayConditionProperty;if(!m.isConstant(D)){var O=m.getValueOrDefault(D,e,g,_);o.equals(O,A._lastDistanceDisplayCondition)||(A._lastDistanceDisplayCondition=o.clone(O,A._lastDistanceDisplayCondition),A.distanceDisplayCondition=a.toValue(O,A.distanceDisplayCondition))}}this.updateShows(d)}else n(d)&&!d.ready&&(u=!1);return u},v.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,r=0;r<i;r++){var o=t[r],a=o.entity,l=this.geometry.get(o.id),u=this.attributes.get(l.id.id);n(u)||(u=e.getGeometryInstanceAttributes(l.id),this.attributes.set(l.id.id,u));var c=a.isShowing;c!==(1===u.show[0])&&(u.show=s.toValue(c,u.show),l.attributes.show.value[0]=u.show[0])}this.showsUpdated.removeAll()},v.prototype.contains=function(e){return this.updaters.contains(e.id)},v.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return d.PENDING;var r=i.getGeometryInstanceAttributes(e.entity);return!n(r)||!n(r.boundingSphere)||n(r.show)&&0===r.show[0]?d.FAILED:(r.boundingSphere.clone(t),d.DONE)},v.prototype.destroy=function(){var e=this.primitive,t=this.orderedGroundPrimitives;n(e)&&t.remove(e);var i=this.oldPrimitive;n(i)&&t.remove(i),this.removeMaterialSubscription()},y.prototype.add=function(e,t){for(var i=this._items,r=i.length,n=t.createFillGeometryInstance(e),o=m.getValueOrDefault(t.zIndex,0),a=0;a<r;++a){var s=i[a];if(s.isMaterial(t)&&s.zIndex===o)return void s.add(e,t,n)}var l=new v(this._orderedGroundPrimitives,this._classificationType,t.fillMaterialProperty,o,this._asynchronous);l.add(e,t,n),i.push(l)},y.prototype.remove=function(e){for(var t=this._items,i=t.length-1;i>=0;i--){var r=t[i];if(r.remove(e)){0===r.updaters.length&&(t.splice(i,1),r.destroy());break}}},y.prototype.update=function(e){var t,i=this._items;for(t=i.length-1;t>=0;t--){var r=i[t];if(r.invalidated){i.splice(t,1);for(var n=r.updaters.values,o=n.length,a=0;a<o;a++)this.add(e,n[a]);r.destroy()}}var s=!0;for(t=0;t<i.length;t++)s=i[t].update(e)&&s;return s},y.prototype.getBoundingSphere=function(e,t){for(var i=this._items,r=i.length,n=0;n<r;n++){var o=i[n];if(o.contains(e))return o.getBoundingSphere(e,t)}return d.FAILED},y.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0},y}.apply(t,r))||(e.exports=n)},251:function(e,t,i){var r;void 0===(r=function(){"use strict";return function(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}}.apply(t,[]))||(e.exports=r)},283:function(e,t,i){var r,n;r=[i(8),i(10),i(11),i(25),i(153),i(127),i(38)],void 0===(n=function(e,t,i,r,n,o,a){"use strict";function s(){this._eventHelper=new n,this._definitionChanged=new r,this._intervals=new o,this._intervals.changedEvent.addEventListener(s.prototype._intervalsChanged,this)}return t(s.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),s.prototype.getValue=function(t,i){var r=this._intervals.findDataForIntervalContainingDate(t);if(e(r))return r.getValue(t,i)},s.prototype.equals=function(e){return this===e||e instanceof s&&this._intervals.equals(e._intervals,a.equals)},s.prototype._intervalsChanged=function(){!function(t,i,r,n){function o(){r.raiseEvent(t)}var a=[];i.removeAll();for(var s=n.length,l=0;l<s;l++){var u=n.get(l);e(u.data)&&-1===a.indexOf(u.data)&&i.add(u.data.definitionChanged,o)}}(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)},s}.apply(t,r))||(e.exports=n)},284:function(e,t,i){var r;void 0===(r=function(){"use strict";var e={NONE:0,CULLED:1,RENDERED:2,REFINED:3,RENDERED_AND_KICKED:6,REFINED_AND_KICKED:7,CULLED_BUT_NEEDED:9,wasKicked:function(t){return t>=e.RENDERED_AND_KICKED},originalResult:function(e){return 3&e},kick:function(e){return 4|e}};return e}.apply(t,[]))||(e.exports=r)},285:function(e,t,i){var r,n;r=[i(17),i(47)],void 0===(n=function(e,t){"use strict";var i={RGBA4:t.RGBA4,RGB5_A1:t.RGB5_A1,RGB565:t.RGB565,DEPTH_COMPONENT16:t.DEPTH_COMPONENT16,STENCIL_INDEX8:t.STENCIL_INDEX8,DEPTH_STENCIL:t.DEPTH_STENCIL,validate:function(e){return e===i.RGBA4||e===i.RGB5_A1||e===i.RGB565||e===i.DEPTH_COMPONENT16||e===i.STENCIL_INDEX8||e===i.DEPTH_STENCIL}};return e(i)}.apply(t,r))||(e.exports=n)},358:function(e,t,i){var r,n;r=[i(9),i(8),i(10),i(11),i(25),i(150),i(283),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s){"use strict";function l(t){this._referenceFrame=e(t,o.FIXED),this._definitionChanged=new n,this._composite=new a,this._composite.definitionChanged.addEventListener(l.prototype._raiseDefinitionChanged,this)}return i(l.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}}),l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},l.prototype.getValueInReferenceFrame=function(e,i,r){var n=this._composite._intervals.findDataForIntervalContainingDate(e);if(t(n))return n.getValueInReferenceFrame(e,i,r)},l.prototype.equals=function(e){return this===e||e instanceof l&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,s.equals)},l.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},l}.apply(t,r))||(e.exports=n)},359:function(e,t,i){var r,n;r=[i(8),i(10),i(11),i(25),i(40),i(38)],void 0===(n=function(e,t,i,r,n,o){"use strict";function a(t){var i=t._targetProperty;if(t._resolveProperty){var r=function(t){var i=!0;if(t._resolveEntity){var r=t._targetCollection.getById(t._targetId);if(e(r)?(r.definitionChanged.addEventListener(s.prototype._onTargetEntityDefinitionChanged,t),t._targetEntity=r,t._resolveEntity=!1):(r=t._targetEntity,i=!1),!e(r))throw new n('target entity "'+t._targetId+'" could not be resolved.')}return i}(t),o=t._targetPropertyNames;i=t._targetEntity;for(var a=o.length,l=0;l<a&&e(i);l++)i=i[o[l]];if(e(i))t._targetProperty=i,t._resolveProperty=!r;else if(!e(t._targetProperty))throw new n('targetProperty "'+t._targetId+"."+o.join(".")+'" could not be resolved.')}return i}function s(e,t,i){this._targetCollection=e,this._targetId=t,this._targetPropertyNames=i,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new r,this._resolveEntity=!0,this._resolveProperty=!0,e.collectionChanged.addEventListener(s.prototype._onCollectionChanged,this)}return t(s.prototype,{isConstant:{get:function(){return o.isConstant(a(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return a(this).referenceFrame}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return a(this)}}}),s.fromString=function(e,t){for(var i,r=[],n=!0,o=!1,a="",l=0;l<t.length;++l){var u=t.charAt(l);o?(a+=u,o=!1):"\\"===u?o=!0:n&&"#"===u?(i=a,n=!1,a=""):n||"."!==u?a+=u:(r.push(a),a="")}return r.push(a),new s(e,i,r)},s.prototype.getValue=function(e,t){return a(this).getValue(e,t)},s.prototype.getValueInReferenceFrame=function(e,t,i){return a(this).getValueInReferenceFrame(e,t,i)},s.prototype.getType=function(e){return a(this).getType(e)},s.prototype.equals=function(e){if(this===e)return!0;var t=this._targetPropertyNames,i=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==i.length)return!1;for(var r=this._targetPropertyNames.length,n=0;n<r;n++)if(t[n]!==i[n])return!1;return!0},s.prototype._onTargetEntityDefinitionChanged=function(e,t,i,r){this._targetPropertyNames[0]===t&&(this._resolveProperty=!0,this._definitionChanged.raiseEvent(this))},s.prototype._onCollectionChanged=function(t,i,r){var n=this._targetEntity;e(n)&&(-1!==r.indexOf(n)?(n.definitionChanged.removeEventListener(s.prototype._onTargetEntityDefinitionChanged,this),this._resolveEntity=!0,this._resolveProperty=!0):this._resolveEntity&&(a(this),this._resolveEntity||this._definitionChanged.raiseEvent(this)))},s}.apply(t,r))||(e.exports=n)},360:function(e,t,i){var r,n;r=[i(17)],void 0===(n=function(e){"use strict";return e({START:0,LOADING:1,DONE:2,FAILED:3})}.apply(t,r))||(e.exports=n)},361:function(e,t,i){var r,n;r=[i(94),i(33),i(12),i(16),i(34),i(9),i(8),i(11),i(52),i(53),i(65),i(73),i(45),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p){"use strict";var m=new i;function f(e){var t=(e=o(e,o.EMPTY_OBJECT)).minimum,r=e.maximum,n=o(e.vertexFormat,p.DEFAULT);this._minimum=i.clone(t),this._maximum=i.clone(r),this._vertexFormat=n,this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxGeometry"}f.fromDimensions=function(e){var t=(e=o(e,o.EMPTY_OBJECT)).dimensions,r=i.multiplyByScalar(t,.5,new i);return new f({minimum:i.negate(r,new i),maximum:r,vertexFormat:e.vertexFormat,offsetAttribute:e.offsetAttribute})},f.fromAxisAlignedBoundingBox=function(e){return new f({minimum:e.minimum,maximum:e.maximum})},f.packedLength=2*i.packedLength+p.packedLength+1,f.pack=function(e,t,r){return r=o(r,0),i.pack(e._minimum,t,r),i.pack(e._maximum,t,r+i.packedLength),p.pack(e._vertexFormat,t,r+2*i.packedLength),t[r+2*i.packedLength+p.packedLength]=o(e._offsetAttribute,-1),t};var _,g=new i,v=new i,y=new p,x={minimum:g,maximum:v,vertexFormat:y,offsetAttribute:void 0};return f.unpack=function(e,t,r){t=o(t,0);var n=i.unpack(e,t,g),s=i.unpack(e,t+i.packedLength,v),l=p.unpack(e,t+2*i.packedLength,y),u=e[t+2*i.packedLength+p.packedLength];return a(r)?(r._minimum=i.clone(n,r._minimum),r._maximum=i.clone(s,r._maximum),r._vertexFormat=p.clone(l,r._vertexFormat),r._offsetAttribute=-1===u?void 0:u,r):(x.offsetAttribute=-1===u?void 0:u,new f(x))},f.createGeometry=function(r){var o=r._minimum,s=r._maximum,p=r._vertexFormat;if(!i.equals(o,s)){var f,_,g=new c;if(p.position&&(p.st||p.normal||p.tangent||p.bitangent)){if(p.position&&((_=new Float64Array(72))[0]=o.x,_[1]=o.y,_[2]=s.z,_[3]=s.x,_[4]=o.y,_[5]=s.z,_[6]=s.x,_[7]=s.y,_[8]=s.z,_[9]=o.x,_[10]=s.y,_[11]=s.z,_[12]=o.x,_[13]=o.y,_[14]=o.z,_[15]=s.x,_[16]=o.y,_[17]=o.z,_[18]=s.x,_[19]=s.y,_[20]=o.z,_[21]=o.x,_[22]=s.y,_[23]=o.z,_[24]=s.x,_[25]=o.y,_[26]=o.z,_[27]=s.x,_[28]=s.y,_[29]=o.z,_[30]=s.x,_[31]=s.y,_[32]=s.z,_[33]=s.x,_[34]=o.y,_[35]=s.z,_[36]=o.x,_[37]=o.y,_[38]=o.z,_[39]=o.x,_[40]=s.y,_[41]=o.z,_[42]=o.x,_[43]=s.y,_[44]=s.z,_[45]=o.x,_[46]=o.y,_[47]=s.z,_[48]=o.x,_[49]=s.y,_[50]=o.z,_[51]=s.x,_[52]=s.y,_[53]=o.z,_[54]=s.x,_[55]=s.y,_[56]=s.z,_[57]=o.x,_[58]=s.y,_[59]=s.z,_[60]=o.x,_[61]=o.y,_[62]=o.z,_[63]=s.x,_[64]=o.y,_[65]=o.z,_[66]=s.x,_[67]=o.y,_[68]=s.z,_[69]=o.x,_[70]=o.y,_[71]=s.z,g.position=new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:_})),p.normal){var v=new Float32Array(72);v[0]=0,v[1]=0,v[2]=1,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=1,v[9]=0,v[10]=0,v[11]=1,v[12]=0,v[13]=0,v[14]=-1,v[15]=0,v[16]=0,v[17]=-1,v[18]=0,v[19]=0,v[20]=-1,v[21]=0,v[22]=0,v[23]=-1,v[24]=1,v[25]=0,v[26]=0,v[27]=1,v[28]=0,v[29]=0,v[30]=1,v[31]=0,v[32]=0,v[33]=1,v[34]=0,v[35]=0,v[36]=-1,v[37]=0,v[38]=0,v[39]=-1,v[40]=0,v[41]=0,v[42]=-1,v[43]=0,v[44]=0,v[45]=-1,v[46]=0,v[47]=0,v[48]=0,v[49]=1,v[50]=0,v[51]=0,v[52]=1,v[53]=0,v[54]=0,v[55]=1,v[56]=0,v[57]=0,v[58]=1,v[59]=0,v[60]=0,v[61]=-1,v[62]=0,v[63]=0,v[64]=-1,v[65]=0,v[66]=0,v[67]=-1,v[68]=0,v[69]=0,v[70]=-1,v[71]=0,g.normal=new u({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:v})}if(p.st){var y=new Float32Array(48);y[0]=0,y[1]=0,y[2]=1,y[3]=0,y[4]=1,y[5]=1,y[6]=0,y[7]=1,y[8]=1,y[9]=0,y[10]=0,y[11]=0,y[12]=0,y[13]=1,y[14]=1,y[15]=1,y[16]=0,y[17]=0,y[18]=1,y[19]=0,y[20]=1,y[21]=1,y[22]=0,y[23]=1,y[24]=1,y[25]=0,y[26]=0,y[27]=0,y[28]=0,y[29]=1,y[30]=1,y[31]=1,y[32]=1,y[33]=0,y[34]=0,y[35]=0,y[36]=0,y[37]=1,y[38]=1,y[39]=1,y[40]=0,y[41]=0,y[42]=1,y[43]=0,y[44]=1,y[45]=1,y[46]=0,y[47]=1,g.st=new u({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:y})}if(p.tangent){var x=new Float32Array(72);x[0]=1,x[1]=0,x[2]=0,x[3]=1,x[4]=0,x[5]=0,x[6]=1,x[7]=0,x[8]=0,x[9]=1,x[10]=0,x[11]=0,x[12]=-1,x[13]=0,x[14]=0,x[15]=-1,x[16]=0,x[17]=0,x[18]=-1,x[19]=0,x[20]=0,x[21]=-1,x[22]=0,x[23]=0,x[24]=0,x[25]=1,x[26]=0,x[27]=0,x[28]=1,x[29]=0,x[30]=0,x[31]=1,x[32]=0,x[33]=0,x[34]=1,x[35]=0,x[36]=0,x[37]=-1,x[38]=0,x[39]=0,x[40]=-1,x[41]=0,x[42]=0,x[43]=-1,x[44]=0,x[45]=0,x[46]=-1,x[47]=0,x[48]=-1,x[49]=0,x[50]=0,x[51]=-1,x[52]=0,x[53]=0,x[54]=-1,x[55]=0,x[56]=0,x[57]=-1,x[58]=0,x[59]=0,x[60]=1,x[61]=0,x[62]=0,x[63]=1,x[64]=0,x[65]=0,x[66]=1,x[67]=0,x[68]=0,x[69]=1,x[70]=0,x[71]=0,g.tangent=new u({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:x})}if(p.bitangent){var w=new Float32Array(72);w[0]=0,w[1]=1,w[2]=0,w[3]=0,w[4]=1,w[5]=0,w[6]=0,w[7]=1,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=1,w[14]=0,w[15]=0,w[16]=1,w[17]=0,w[18]=0,w[19]=1,w[20]=0,w[21]=0,w[22]=1,w[23]=0,w[24]=0,w[25]=0,w[26]=1,w[27]=0,w[28]=0,w[29]=1,w[30]=0,w[31]=0,w[32]=1,w[33]=0,w[34]=0,w[35]=1,w[36]=0,w[37]=0,w[38]=1,w[39]=0,w[40]=0,w[41]=1,w[42]=0,w[43]=0,w[44]=1,w[45]=0,w[46]=0,w[47]=1,w[48]=0,w[49]=0,w[50]=1,w[51]=0,w[52]=0,w[53]=1,w[54]=0,w[55]=0,w[56]=1,w[57]=0,w[58]=0,w[59]=1,w[60]=0,w[61]=0,w[62]=1,w[63]=0,w[64]=0,w[65]=1,w[66]=0,w[67]=0,w[68]=1,w[69]=0,w[70]=0,w[71]=1,g.bitangent=new u({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:w})}(f=new Uint16Array(36))[0]=0,f[1]=1,f[2]=2,f[3]=0,f[4]=2,f[5]=3,f[6]=6,f[7]=5,f[8]=4,f[9]=7,f[10]=6,f[11]=4,f[12]=8,f[13]=9,f[14]=10,f[15]=8,f[16]=10,f[17]=11,f[18]=14,f[19]=13,f[20]=12,f[21]=15,f[22]=14,f[23]=12,f[24]=18,f[25]=17,f[26]=16,f[27]=19,f[28]=18,f[29]=16,f[30]=20,f[31]=21,f[32]=22,f[33]=20,f[34]=22,f[35]=23}else(_=new Float64Array(24))[0]=o.x,_[1]=o.y,_[2]=o.z,_[3]=s.x,_[4]=o.y,_[5]=o.z,_[6]=s.x,_[7]=s.y,_[8]=o.z,_[9]=o.x,_[10]=s.y,_[11]=o.z,_[12]=o.x,_[13]=o.y,_[14]=s.z,_[15]=s.x,_[16]=o.y,_[17]=s.z,_[18]=s.x,_[19]=s.y,_[20]=s.z,_[21]=o.x,_[22]=s.y,_[23]=s.z,g.position=new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:_}),(f=new Uint16Array(36))[0]=4,f[1]=5,f[2]=6,f[3]=4,f[4]=6,f[5]=7,f[6]=1,f[7]=0,f[8]=3,f[9]=1,f[10]=3,f[11]=2,f[12]=1,f[13]=6,f[14]=5,f[15]=1,f[16]=2,f[17]=6,f[18]=2,f[19]=3,f[20]=7,f[21]=2,f[22]=7,f[23]=6,f[24]=3,f[25]=0,f[26]=4,f[27]=3,f[28]=4,f[29]=7,f[30]=0,f[31]=1,f[32]=5,f[33]=0,f[34]=5,f[35]=4;var T=i.subtract(s,o,m),C=.5*i.magnitude(T);if(a(r._offsetAttribute)){var E=_.length,A=new Uint8Array(E/3),S=r._offsetAttribute===d.NONE?0:1;e(A,S),g.applyOffset=new u({componentDatatype:n.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}return new l({attributes:g,indices:f,primitiveType:h.TRIANGLES,boundingSphere:new t(i.ZERO,C),offsetAttribute:r._offsetAttribute})}},f.getUnitBox=function(){return a(_)||(_=f.createGeometry(f.fromDimensions({dimensions:new i(1,1,1),vertexFormat:p.POSITION_ONLY}))),_},f}.apply(t,r))||(e.exports=n)},362:function(e,t,i){var r,n;r=[i(33),i(24),i(12),i(49),i(32),i(9),i(8),i(10),i(11),i(204),i(26),i(209),i(25),i(111),i(338),i(265),i(93),i(145),i(14),i(43),i(28),i(115),i(174),i(193),i(54),i(146),i(29),i(60),i(714),i(498),i(44)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O){"use strict";function I(e){this._scene=e,this._transform=x.clone(x.IDENTITY),this._invTransform=x.clone(x.IDENTITY),this._actualTransform=x.clone(x.IDENTITY),this._actualInvTransform=x.clone(x.IDENTITY),this._transformChanged=!1,this.position=new i,this._position=new i,this._positionWC=new i,this._positionCartographic=new n,this._oldPositionWC=void 0,this.positionWCDeltaMagnitude=0,this.positionWCDeltaMagnitudeLastFrame=0,this.timeSinceMoved=0,this._lastMovedTimestamp=0,this.direction=new i,this._direction=new i,this._directionWC=new i,this.up=new i,this._up=new i,this._upWC=new i,this.right=new i,this._right=new i,this._rightWC=new i,this.frustum=new C,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=v.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new h,this._moveEnd=new h,this._changed=new h,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this.percentageChanged=.5,this._viewMatrix=new x,this._invViewMatrix=new x,M(this),this._mode=O.SCENE3D,this._modeChanged=!0;var t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new n(Math.PI,v.PI_OVER_TWO)),this._max2Dfrustum=void 0,this._suspendTerrainAdjustment=!1,qe(this,I.DEFAULT_VIEW_RECTANGLE,this.position,!0);var r=i.magnitude(this.position);r+=r*I.DEFAULT_VIEW_FACTOR,i.normalize(this.position,this.position),i.multiplyByScalar(this.position,r,this.position)}function M(e){x.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),x.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),x.inverseTransformation(e._viewMatrix,e._invViewMatrix)}I.TRANSFORM_2D=new x(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),I.TRANSFORM_2D_INVERSE=x.inverseTransformation(I.TRANSFORM_2D,new x),I.DEFAULT_VIEW_RECTANGLE=S.fromDegrees(-95,-20,-70,90),I.DEFAULT_VIEW_FACTOR=.5,I.DEFAULT_OFFSET=new m(0,-v.PI_OVER_FOUR,0),I.prototype.hasCurrentFlight=function(){return a(this._currentFlight)&&a(this._scene.preloadFlightCamera)},I.prototype._updateCameraChanged=function(){if(function(e){if(a(e._oldPositionWC)){e.positionWCDeltaMagnitudeLastFrame=e.positionWCDeltaMagnitude;var t=i.subtract(e.positionWC,e._oldPositionWC,e._oldPositionWC);e.positionWCDeltaMagnitude=i.magnitude(t),e._oldPositionWC=i.clone(e.positionWC,e._oldPositionWC),e.positionWCDeltaMagnitude>0?(e.timeSinceMoved=0,e._lastMovedTimestamp=p()):e.timeSinceMoved=Math.max(p()-e._lastMovedTimestamp,0)/1e3}else e._oldPositionWC=i.clone(e.positionWC,e._oldPositionWC)}(this),0!==this._changed.numberOfListeners){var e=this.percentageChanged;if(this._mode!==O.SCENE2D){if(!a(this._changedDirection))return this._changedPosition=i.clone(this.positionWC,this._changedPosition),void(this._changedDirection=i.clone(this.directionWC,this._changedDirection));var t,r=v.acosClamped(i.dot(this.directionWC,this._changedDirection));t=a(this.frustum.fovy)?r/(.5*this.frustum.fovy):r;var n=i.distance(this.positionWC,this._changedPosition)/this.positionCartographic.height;(t>e||n>e)&&(this._changed.raiseEvent(Math.max(t,n)),this._changedPosition=i.clone(this.positionWC,this._changedPosition),this._changedDirection=i.clone(this.directionWC,this._changedDirection))}else{if(!a(this._changedFrustum))return this._changedPosition=i.clone(this.position,this._changedPosition),void(this._changedFrustum=this.frustum.clone());var o,s=this.position,l=this._changedPosition,u=this.frustum,c=this._changedFrustum,d=s.x+u.left,h=s.x+u.right,m=l.x+c.left,f=l.x+c.right,_=s.y+u.bottom,g=s.y+u.top,y=l.y+c.bottom,x=l.y+c.top,w=Math.max(d,m),T=Math.min(h,f),C=Math.max(_,y),E=Math.min(g,x);if(w>=T||C>=g)o=1;else{var A=c;d<m&&h>f&&_<y&&g>x&&(A=u),o=1-(T-w)*(E-C)/((A.right-A.left)*(A.top-A.bottom))}o>e&&(this._changed.raiseEvent(o),this._changedPosition=i.clone(this.position,this._changedPosition),this._changedFrustum=this.frustum.clone(this._changedFrustum))}}};var N=new x,F=new n;I.prototype._adjustHeightForTerrain=function(){var e=this._scene,t=e.screenSpaceCameraController,r=t.enableCollisionDetection,n=t.minimumCollisionTerrainHeight,o=t.minimumZoomDistance;if(!this._suspendTerrainAdjustment&&r){var s=this._mode,l=e.globe;if(a(l)&&s!==O.SCENE2D&&s!==O.MORPHING){var u,c,d=l.ellipsoid,h=e.mapProjection;x.equals(this.transform,x.IDENTITY)||(u=x.clone(this.transform,N),c=i.magnitude(this.position),this._setTransform(x.IDENTITY));var p=F;s===O.SCENE3D?d.cartesianToCartographic(this.position,p):h.unproject(this.position,p);var m=!1;if(p.height<n){var f=l.getHeight(p);a(f)&&(f+=o,p.height<f&&(p.height=f,s===O.SCENE3D?d.cartographicToCartesian(p,this.position):h.project(p,this.position),m=!0))}a(u)&&(this._setTransform(u),m&&(i.normalize(this.position,this.position),i.negate(this.position,this.direction),i.multiplyByScalar(this.position,Math.max(c,o),this.position),i.normalize(this.direction,this.direction),i.cross(this.direction,this.up,this.right),i.cross(this.right,this.direction,this.up)))}}};var R=new n,L=new i,V=new i,U=new r,z=new r,B=new r,H=new r,k=new r;var G=new i;function W(e){var t=e._mode,n=!1,o=0;t===O.SCENE2D&&(n=(o=e.frustum.right-e.frustum.left)!==e._positionCartographic.height);var a=e._position,s=!i.equals(a,e.position)||n;s&&(a=i.clone(e.position,e._position));var l=e._direction,u=!i.equals(l,e.direction);u&&(i.normalize(e.direction,e.direction),l=i.clone(e.direction,e._direction));var c=e._up,d=!i.equals(c,e.up);d&&(i.normalize(e.up,e.up),c=i.clone(e.up,e._up));var h=e._right,p=!i.equals(h,e.right);p&&(i.normalize(e.right,e.right),h=i.clone(e.right,e._right));var m=e._transformChanged||e._modeChanged;e._transformChanged=!1,m&&(x.inverseTransformation(e._transform,e._invTransform),e._mode===O.COLUMBUS_VIEW||e._mode===O.SCENE2D?x.equals(x.IDENTITY,e._transform)?x.clone(I.TRANSFORM_2D,e._actualTransform):e._mode===O.COLUMBUS_VIEW?function(e){P.basisTo2D(e._projection,e._transform,e._actualTransform)}(e):function(e){var t=e._projection,n=t.ellipsoid,o=x.getColumn(e._transform,3,U),a=n.cartesianToCartographic(o,R),s=t.project(a,L),l=z;l.x=s.z,l.y=s.x,l.z=s.y,l.w=1;var u=r.clone(r.UNIT_X,k),c=r.add(x.getColumn(e._transform,0,V),o,V);n.cartesianToCartographic(c,a),t.project(a,s);var d=B;d.x=s.z,d.y=s.x,d.z=s.y,d.w=0,i.subtract(d,l,d),d.x=0;var h=H;if(i.magnitudeSquared(d)>v.EPSILON10)i.cross(u,d,h);else{var p=r.add(x.getColumn(e._transform,1,V),o,V);n.cartesianToCartographic(p,a),t.project(a,s),h.x=s.z,h.y=s.x,h.z=s.y,h.w=0,i.subtract(h,l,h),h.x=0,i.magnitudeSquared(h)<v.EPSILON10&&(r.clone(r.UNIT_Y,d),r.clone(r.UNIT_Z,h))}i.cross(h,u,d),i.normalize(d,d),i.cross(u,d,h),i.normalize(h,h),x.setColumn(e._actualTransform,0,d,e._actualTransform),x.setColumn(e._actualTransform,1,h,e._actualTransform),x.setColumn(e._actualTransform,2,u,e._actualTransform),x.setColumn(e._actualTransform,3,l,e._actualTransform)}(e):x.clone(e._transform,e._actualTransform),x.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);var f=e._actualTransform;if(s||m)if(e._positionWC=x.multiplyByPoint(f,a,e._positionWC),t===O.SCENE3D||t===O.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{var _=G;_.x=e._positionWC.y,_.y=e._positionWC.z,_.z=e._positionWC.x,t===O.SCENE2D&&(_.z=o),e._projection.unproject(_,e._positionCartographic)}if(u||d||p){var g=i.dot(l,i.cross(c,h,G));if(Math.abs(1-g)>v.EPSILON2){var y=1/i.magnitudeSquared(c),w=i.dot(c,l)*y,T=i.multiplyByScalar(l,w,G);c=i.normalize(i.subtract(c,T,e._up),e._up),i.clone(c,e.up),h=i.cross(l,c,e._right),i.clone(h,e.right)}}(u||m)&&(e._directionWC=x.multiplyByPointAsVector(f,l,e._directionWC),i.normalize(e._directionWC,e._directionWC)),(d||m)&&(e._upWC=x.multiplyByPointAsVector(f,c,e._upWC),i.normalize(e._upWC,e._upWC)),(p||m)&&(e._rightWC=x.multiplyByPointAsVector(f,h,e._rightWC),i.normalize(e._rightWC,e._rightWC)),(s||u||d||p||m)&&M(e)}function Y(e,t){var i;return i=v.equalsEpsilon(Math.abs(e.z),1,v.EPSILON3)?Math.atan2(t.y,t.x)-v.PI_OVER_TWO:Math.atan2(e.y,e.x)-v.PI_OVER_TWO,v.TWO_PI-v.zeroToTwoPi(i)}function j(e){return v.PI_OVER_TWO-v.acosClamped(e.z)}function X(e,t,i){var r=0;return v.equalsEpsilon(Math.abs(e.z),1,v.EPSILON3)||(r=Math.atan2(-i.z,t.z),r=v.zeroToTwoPi(r+v.TWO_PI)),r}var Q=new x,q=new x;s(I.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return W(this),this._invTransform}},viewMatrix:{get:function(){return W(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return W(this),this._invViewMatrix}},positionCartographic:{get:function(){return W(this),this._positionCartographic}},positionWC:{get:function(){return W(this),this._positionWC}},directionWC:{get:function(){return W(this),this._directionWC}},upWC:{get:function(){return W(this),this._upWC}},rightWC:{get:function(){return W(this),this._rightWC}},heading:{get:function(){if(this._mode!==O.MORPHING){var e=this._projection.ellipsoid,t=x.clone(this._transform,Q),i=P.eastNorthUpToFixedFrame(this.positionWC,e,q);this._setTransform(i);var r=Y(this.direction,this.up);return this._setTransform(t),r}}},pitch:{get:function(){if(this._mode!==O.MORPHING){var e=this._projection.ellipsoid,t=x.clone(this._transform,Q),i=P.eastNorthUpToFixedFrame(this.positionWC,e,q);this._setTransform(i);var r=j(this.direction);return this._setTransform(t),r}}},roll:{get:function(){if(this._mode!==O.MORPHING){var e=this._projection.ellipsoid,t=x.clone(this._transform,Q),i=P.eastNorthUpToFixedFrame(this.positionWC,e,q);this._setTransform(i);var r=X(this.direction,this.up,this.right);return this._setTransform(t),r}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),I.prototype.update=function(e){var t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==O.MORPHING,t=this._mode===O.SCENE2D),t){var i=this._max2Dfrustum=this.frustum.clone(),r=i.top/i.right;i.right=2*this._maxCoord.x,i.left=-i.right,i.top=r*i.right,i.bottom=-i.top}this._mode===O.SCENE2D&&_e(this,this.position);var n=this._scene.globe,o=!a(n)||n._surface.tileProvider.ready&&0===n._surface._tileLoadQueueHigh.length&&0===n._surface._tileLoadQueueMedium.length&&0===n._surface._tileLoadQueueLow.length&&0===n._surface._debug.tilesWaitingForChildren;this._suspendTerrainAdjustment&&(this._suspendTerrainAdjustment=!o),o&&this._adjustHeightForTerrain()};var Z=new i,K=new i,J=new i;I.prototype._setTransform=function(e){var t=i.clone(this.positionWC,Z),r=i.clone(this.upWC,K),n=i.clone(this.directionWC,J);x.clone(e,this._transform),this._transformChanged=!0,W(this);var o=this._actualInvTransform;x.multiplyByPoint(o,t,this.position),x.multiplyByPointAsVector(o,n,this.direction),x.multiplyByPointAsVector(o,r,this.up),i.cross(this.direction,this.up,this.right),W(this)};var $=new t,ee=new A,te=new i,ie=new i;I.prototype._adjustOrthographicFrustum=function(e){if(this.frustum instanceof w&&(e||!(this._positionCartographic.height<15e4)))if(x.equals(x.IDENTITY,this.transform)){var t,r,n=this._scene,o=n.globe;if(a(o)){var s=$;s.x=n.drawingBufferWidth/2,s.y=n.drawingBufferHeight/2;var l=this.getPickRay(s,ee);if(t=o.pickWorldCoordinates(l,n,te),n.pickPositionSupported&&(r=n.pickPositionWorldCoordinates(s,ie)),a(t)&&a(r)){var u=a(r)?i.distance(r,this.positionWC):Number.POSITIVE_INFINITY,c=a(t)?i.distance(t,this.positionWC):Number.POSITIVE_INFINITY;this.frustum.width=Math.min(u,c)}else a(r)?this.frustum.width=i.distance(r,this.positionWC):a(t)&&(this.frustum.width=i.distance(t,this.positionWC))}if(!a(o)||!a(t)&&!a(r)){var d=Math.max(this.positionCartographic.height,0);this.frustum.width=d}}else this.frustum.width=i.magnitude(this.position)};var re=new i,ne=new x,oe=new x,ae=new E,se=new y,le=new n;var ue=new i,ce=new i,de=new i;function he(e,t,r,n){var o=i.clone(r.direction,ue),a=i.clone(r.up,ce);if(e._scene.mode===O.SCENE3D){var s=e._projection.ellipsoid,l=P.eastNorthUpToFixedFrame(t,s,Q),u=x.inverseTransformation(l,q);x.multiplyByPointAsVector(u,o,o),x.multiplyByPointAsVector(u,a,a)}var c=i.cross(o,a,de);return n.heading=Y(o,a),n.pitch=j(o),n.roll=X(o,a,c),n}var pe={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},me=new f;I.prototype.setView=function(e){e=o(e,o.EMPTY_OBJECT);var r=o(e.orientation,o.EMPTY_OBJECT),n=this._mode;if(n!==O.MORPHING){a(e.endTransform)&&this._setTransform(e.endTransform);var s=o(e.convert,!0),l=o(e.destination,i.clone(this.positionWC,re));a(l)&&a(l.west)&&(l=this.getRectangleCameraCoordinates(l,re),s=!1),a(r.direction)&&(r=he(this,l,r,pe.orientation)),me.heading=o(r.heading,0),me.pitch=o(r.pitch,-v.PI_OVER_TWO),me.roll=o(r.roll,0),this._suspendTerrainAdjustment=!0,n===O.SCENE3D?function(e,t,r){var n=x.clone(e.transform,ne),o=P.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,oe);e._setTransform(o),i.clone(i.ZERO,e.position),r.heading=r.heading-v.PI_OVER_TWO;var a=E.fromHeadingPitchRoll(r,ae),s=y.fromQuaternion(a,se);y.getColumn(s,0,e.direction),y.getColumn(s,2,e.up),i.cross(e.direction,e.up,e.right),e._setTransform(n),e._adjustOrthographicFrustum(!0)}(this,l,me):n===O.SCENE2D?function(e,r,n,o){var a=x.clone(e.transform,ne);if(e._setTransform(x.IDENTITY),!i.equals(r,e.positionWC)){if(o){var s=e._projection,l=s.ellipsoid.cartesianToCartographic(r,le);r=s.project(l,re)}t.clone(r,e.position);var u=.5*-r.z,c=-u,d=e.frustum;if(c>u){var h=d.top/d.right;d.right=c,d.left=u,d.top=d.right*h,d.bottom=-d.top}}if(e._scene.mapMode2D===D.ROTATE){n.heading=n.heading-v.PI_OVER_TWO,n.pitch=-v.PI_OVER_TWO,n.roll=0;var p=E.fromHeadingPitchRoll(n,ae),m=y.fromQuaternion(p,se);y.getColumn(m,2,e.up),i.cross(e.direction,e.up,e.right)}e._setTransform(a)}(this,l,me,s):function(e,t,r,n){var o=x.clone(e.transform,ne);if(e._setTransform(x.IDENTITY),!i.equals(t,e.positionWC)){if(n){var a=e._projection,s=a.ellipsoid.cartesianToCartographic(t,le);t=a.project(s,re)}i.clone(t,e.position)}r.heading=r.heading-v.PI_OVER_TWO;var l=E.fromHeadingPitchRoll(r,ae),u=y.fromQuaternion(l,se);y.getColumn(u,0,e.direction),y.getColumn(u,2,e.up),i.cross(e.direction,e.up,e.right),e._setTransform(o),e._adjustOrthographicFrustum(!0)}(this,l,me,s)}};var fe=new i;function _e(e,t){var i,r,n=e._scene.mapMode2D===D.ROTATE,o=e._maxCoord.x,a=e._maxCoord.y;n?i=-(r=o):(r=t.x-2*o,i=t.x+2*o),t.x>o&&(t.x=r),t.x<-o&&(t.x=i),t.y>a&&(t.y=a),t.y<-a&&(t.y=-a)}I.prototype.flyHome=function(e){var t=this._mode;if(t===O.MORPHING&&this._scene.completeMorph(),t===O.SCENE2D)this.flyTo({destination:I.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:x.IDENTITY});else if(t===O.SCENE3D){var r=this.getRectangleCameraCoordinates(I.DEFAULT_VIEW_RECTANGLE),n=i.magnitude(r);n+=n*I.DEFAULT_VIEW_FACTOR,i.normalize(r,r),i.multiplyByScalar(r,n,r),this.flyTo({destination:r,duration:e,endTransform:x.IDENTITY})}else if(t===O.COLUMBUS_VIEW){var o=this._projection.ellipsoid.maximumRadius,a=new i(0,-1,1);a=i.multiplyByScalar(i.normalize(a,a),5*o,a),this.flyTo({destination:a,duration:e,orientation:{heading:0,pitch:-Math.acos(i.normalize(a,fe).z),roll:0},endTransform:x.IDENTITY,convert:!1})}},I.prototype.worldToCameraCoordinates=function(e,t){return a(t)||(t=new r),W(this),x.multiplyByVector(this._actualInvTransform,e,t)},I.prototype.worldToCameraCoordinatesPoint=function(e,t){return a(t)||(t=new i),W(this),x.multiplyByPoint(this._actualInvTransform,e,t)},I.prototype.worldToCameraCoordinatesVector=function(e,t){return a(t)||(t=new i),W(this),x.multiplyByPointAsVector(this._actualInvTransform,e,t)},I.prototype.cameraToWorldCoordinates=function(e,t){return a(t)||(t=new r),W(this),x.multiplyByVector(this._actualTransform,e,t)},I.prototype.cameraToWorldCoordinatesPoint=function(e,t){return a(t)||(t=new i),W(this),x.multiplyByPoint(this._actualTransform,e,t)},I.prototype.cameraToWorldCoordinatesVector=function(e,t){return a(t)||(t=new i),W(this),x.multiplyByPointAsVector(this._actualTransform,e,t)};var ge=new i;I.prototype.move=function(e,t){var r=this.position;i.multiplyByScalar(e,t,ge),i.add(r,ge,r),this._mode===O.SCENE2D&&_e(this,r),this._adjustOrthographicFrustum(!0)},I.prototype.moveForward=function(e){e=o(e,this.defaultMoveAmount),this._mode===O.SCENE2D?be(this,e):this.move(this.direction,e)},I.prototype.moveBackward=function(e){e=o(e,this.defaultMoveAmount),this._mode===O.SCENE2D?be(this,-e):this.move(this.direction,-e)},I.prototype.moveUp=function(e){e=o(e,this.defaultMoveAmount),this.move(this.up,e)},I.prototype.moveDown=function(e){e=o(e,this.defaultMoveAmount),this.move(this.up,-e)},I.prototype.moveRight=function(e){e=o(e,this.defaultMoveAmount),this.move(this.right,e)},I.prototype.moveLeft=function(e){e=o(e,this.defaultMoveAmount),this.move(this.right,-e)},I.prototype.lookLeft=function(e){e=o(e,this.defaultLookAmount),this._mode!==O.SCENE2D&&this.look(this.up,-e)},I.prototype.lookRight=function(e){e=o(e,this.defaultLookAmount),this._mode!==O.SCENE2D&&this.look(this.up,e)},I.prototype.lookUp=function(e){e=o(e,this.defaultLookAmount),this._mode!==O.SCENE2D&&this.look(this.right,-e)},I.prototype.lookDown=function(e){e=o(e,this.defaultLookAmount),this._mode!==O.SCENE2D&&this.look(this.right,e)};var ve=new E,ye=new y;I.prototype.look=function(e,t){var i=o(t,this.defaultLookAmount),r=E.fromAxisAngle(e,-i,ve),n=y.fromQuaternion(r,ye),a=this.direction,s=this.up,l=this.right;y.multiplyByVector(n,a,a),y.multiplyByVector(n,s,s),y.multiplyByVector(n,l,l)},I.prototype.twistLeft=function(e){e=o(e,this.defaultLookAmount),this.look(this.direction,e)},I.prototype.twistRight=function(e){e=o(e,this.defaultLookAmount),this.look(this.direction,-e)};var xe=new E,we=new y;I.prototype.rotate=function(e,t){var r=o(t,this.defaultRotateAmount),n=E.fromAxisAngle(e,-r,xe),a=y.fromQuaternion(n,we);y.multiplyByVector(a,this.position,this.position),y.multiplyByVector(a,this.direction,this.direction),y.multiplyByVector(a,this.up,this.up),i.cross(this.direction,this.up,this.right),i.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)},I.prototype.rotateDown=function(e){Se(this,e=o(e,this.defaultRotateAmount))},I.prototype.rotateUp=function(e){Se(this,-(e=o(e,this.defaultRotateAmount)))};var Te=new i,Ce=new i,Ee=new i,Ae=new i;function Se(e,t){var r=e.position;if(a(e.constrainedAxis)&&!i.equalsEpsilon(e.position,i.ZERO,v.EPSILON2)){var n=i.normalize(r,Te),o=i.equalsEpsilon(n,e.constrainedAxis,v.EPSILON2),s=i.equalsEpsilon(n,i.negate(e.constrainedAxis,Ae),v.EPSILON2);if(o||s)(o&&t<0||s&&t>0)&&e.rotate(e.right,t);else{var l=i.normalize(e.constrainedAxis,Ce),u=i.dot(n,l),c=v.acosClamped(u);t>0&&t>c&&(t=c-v.EPSILON4),u=i.dot(n,i.negate(l,Ae)),c=v.acosClamped(u),t<0&&-t>c&&(t=-c+v.EPSILON4);var d=i.cross(l,n,Ee);e.rotate(d,t)}}else e.rotate(e.right,t)}function Pe(e,t){a(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function be(e,t){var i,r=e.frustum;if(t*=.5,Math.abs(r.top)+Math.abs(r.bottom)>Math.abs(r.left)+Math.abs(r.right)){var n=r.top-t,o=r.bottom+t,a=e._maxCoord.y;e._scene.mapMode2D===D.ROTATE&&(a*=e.maximumZoomFactor),o>a&&(o=a,n=-a),n<=o&&(n=1,o=-1),i=r.right/r.top,r.top=n,r.bottom=o,r.right=r.top*i,r.left=-r.right}else{var s=r.right-t,l=r.left+t,u=e._maxCoord.x;e._scene.mapMode2D===D.ROTATE&&(u*=e.maximumZoomFactor),s>u&&(s=u,l=-u),s<=l&&(s=1,l=-1),i=r.top/r.right,r.right=s,r.left=l,r.top=r.right*i,r.bottom=-r.top}}function De(e,t){e.move(e.direction,t)}I.prototype.rotateRight=function(e){Pe(this,-(e=o(e,this.defaultRotateAmount)))},I.prototype.rotateLeft=function(e){Pe(this,e=o(e,this.defaultRotateAmount))},I.prototype.zoomIn=function(e){e=o(e,this.defaultZoomAmount),this._mode===O.SCENE2D?be(this,e):De(this,e)},I.prototype.zoomOut=function(e){e=o(e,this.defaultZoomAmount),this._mode===O.SCENE2D?be(this,-e):De(this,-e)},I.prototype.getMagnitude=function(){return this._mode===O.SCENE3D?i.magnitude(this.position):this._mode===O.COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===O.SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};var Oe=new x;I.prototype.lookAt=function(e,t){var i=P.eastNorthUpToFixedFrame(e,c.WGS84,Oe);this.lookAtTransform(i,t)};var Ie=new i,Me=new E,Ne=new E,Fe=new y;function Re(e,t,r){t=v.clamp(t,-v.PI_OVER_TWO,v.PI_OVER_TWO),e=v.zeroToTwoPi(e)-v.PI_OVER_TWO;var n=E.fromAxisAngle(i.UNIT_Y,-t,Me),o=E.fromAxisAngle(i.UNIT_Z,-e,Ne),a=E.multiply(o,n,o),s=y.fromQuaternion(a,Fe),l=i.clone(i.UNIT_X,Ie);return y.multiplyByVector(s,l,l),i.negate(l,l),i.multiplyByScalar(l,r,l),l}I.prototype.lookAtTransform=function(e,r){if(this._setTransform(e),a(r)){var n;if(n=a(r.heading)?Re(r.heading,r.pitch,r.range):r,this._mode===O.SCENE2D){t.clone(t.ZERO,this.position),i.negate(n,this.up),this.up.z=0,i.magnitudeSquared(this.up)<v.EPSILON10&&i.clone(i.UNIT_Y,this.up),i.normalize(this.up,this.up),this._setTransform(x.IDENTITY),i.negate(i.UNIT_Z,this.direction),i.cross(this.direction,this.up,this.right),i.normalize(this.right,this.right);var o=this.frustum,s=o.top/o.right;return o.right=.5*i.magnitude(n),o.left=-o.right,o.top=s*o.right,o.bottom=-o.top,void this._setTransform(e)}i.clone(n,this.position),i.negate(this.position,this.direction),i.normalize(this.direction,this.direction),i.cross(this.direction,i.UNIT_Z,this.right),i.magnitudeSquared(this.right)<v.EPSILON10&&i.clone(i.UNIT_X,this.right),i.normalize(this.right,this.right),i.cross(this.right,this.direction,this.up),i.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)}};var Le,Ve=new n,Ue=new n,ze=new i,Be=new i,He=new i,ke=new i,Ge=new i,We=new i,Ye=new i,je=new i,Xe={direction:new i,right:new i,up:new i};function Qe(e,t,r,n){return Math.abs(i.dot(t,r))/n-i.dot(e,r)}function qe(e,t,r,n){var o=e._projection.ellipsoid,s=n?e:Xe,l=t.north,u=t.south,c=t.east,h=t.west;h>c&&(c+=v.TWO_PI);var p,m=.5*(h+c);if(u<-v.PI_OVER_TWO+v.RADIANS_PER_DEGREE&&l>v.PI_OVER_TWO-v.RADIANS_PER_DEGREE)p=0;else{var f=Ve;f.longitude=m,f.latitude=l,f.height=0;var _=Ue;_.longitude=m,_.latitude=u,_.height=0;var g=Le;a(g)&&g.ellipsoid===o||(Le=g=new d(void 0,void 0,o)),g.setEndPoints(f,_),p=g.interpolateUsingFraction(.5,Ve).latitude}var y=Ve;y.longitude=m,y.latitude=p,y.height=0;var x=o.cartographicToCartesian(y,Ye),T=Ve;T.longitude=c,T.latitude=l;var C=o.cartographicToCartesian(T,ze);T.longitude=h;var E=o.cartographicToCartesian(T,He);T.longitude=m;var A=o.cartographicToCartesian(T,Ge);T.latitude=u;var S=o.cartographicToCartesian(T,We);T.longitude=c;var P=o.cartographicToCartesian(T,ke);T.longitude=h;var b=o.cartographicToCartesian(T,Be);i.subtract(E,x,E),i.subtract(P,x,P),i.subtract(C,x,C),i.subtract(b,x,b),i.subtract(A,x,A),i.subtract(S,x,S);var D=o.geodeticSurfaceNormal(x,s.direction);i.negate(D,D);var O=i.cross(D,i.UNIT_Z,s.right);i.normalize(O,O);var I,M=i.cross(O,D,s.up);if(e.frustum instanceof w){var N,F,R=Math.max(i.distance(C,E),i.distance(P,b)),L=Math.max(i.distance(C,P),i.distance(E,b)),V=e.frustum._offCenterFrustum.right/e.frustum._offCenterFrustum.top,U=L*V;R>U?F=(N=R)/V:(F=L,N=U),I=Math.max(N,F)}else{var z=Math.tan(.5*e.frustum.fovy),B=e.frustum.aspectRatio*z;if(I=Math.max(Qe(D,M,E,z),Qe(D,M,P,z),Qe(D,M,C,z),Qe(D,M,b,z),Qe(D,M,A,z),Qe(D,M,S,z),Qe(D,O,E,B),Qe(D,O,P,B),Qe(D,O,C,B),Qe(D,O,b,B),Qe(D,O,A,B),Qe(D,O,S,B)),u<0&&l>0){var H=Ve;H.longitude=h,H.latitude=0,H.height=0;var k=o.cartographicToCartesian(H,je);i.subtract(k,x,k),I=Math.max(I,Qe(D,M,k,z),Qe(D,O,k,B)),H.longitude=c,k=o.cartographicToCartesian(H,je),i.subtract(k,x,k),I=Math.max(I,Qe(D,M,k,z),Qe(D,O,k,B))}}return i.add(x,i.multiplyByScalar(D,-I,je),r)}var Ze=new n,Ke=new i,Je=new i;var $e=new n,et=new i,tt=new i;I.prototype.getRectangleCameraCoordinates=function(e,t){var r=this._mode;return a(t)||(t=new i),r===O.SCENE3D?qe(this,e,t):r===O.COLUMBUS_VIEW?function(e,t,i){var r=e._projection;t.west>t.east&&(t=S.MAX_VALUE);var n=e._actualTransform,o=e._actualInvTransform,s=Ze;s.longitude=t.east,s.latitude=t.north;var l=r.project(s,Ke);x.multiplyByPoint(n,l,l),x.multiplyByPoint(o,l,l),s.longitude=t.west,s.latitude=t.south;var u=r.project(s,Je);if(x.multiplyByPoint(n,u,u),x.multiplyByPoint(o,u,u),i.x=.5*(l.x-u.x)+u.x,i.y=.5*(l.y-u.y)+u.y,a(e.frustum.fovy)){var c=Math.tan(.5*e.frustum.fovy),d=e.frustum.aspectRatio*c;i.z=.5*Math.max((l.x-u.x)/d,(l.y-u.y)/c)}else{var h=l.x-u.x,p=l.y-u.y;i.z=Math.max(h,p)}return i}(this,e,t):r===O.SCENE2D?function(e,t,i){var r=e._projection;t.west>t.east&&(t=S.MAX_VALUE);var n=$e;n.longitude=t.east,n.latitude=t.north;var o=r.project(n,et);n.longitude=t.west,n.latitude=t.south;var a,s,l=r.project(n,tt),u=.5*Math.abs(o.x-l.x),c=.5*Math.abs(o.y-l.y),d=e.frustum.right/e.frustum.top,h=c*d;return u>h?s=(a=u)/d:(s=c,a=h),c=Math.max(2*a,2*s),i.x=.5*(o.x-l.x)+l.x,i.y=.5*(o.y-l.y)+l.y,(n=r.unproject(i,n)).height=c,i=r.project(n,i)}(this,e,t):void 0};var it=new A;var rt=new A;var nt=new A;I.prototype.pickEllipsoid=function(e,t,r){var n=this._scene.canvas;if(0!==n.clientWidth&&0!==n.clientHeight){if(a(r)||(r=new i),t=o(t,c.WGS84),this._mode===O.SCENE3D)r=function(e,t,i,r){i=o(i,c.WGS84);var n=e.getPickRay(t,it),a=g.rayEllipsoid(n,i);if(a){var s=a.start>0?a.start:a.stop;return A.getPoint(n,s,r)}}(this,e,t,r);else if(this._mode===O.SCENE2D)r=function(e,t,r,n){var o=e.getPickRay(t,rt).origin;o=i.fromElements(o.y,o.z,0,o);var a=r.unproject(o);if(!(a.latitude<-v.PI_OVER_TWO||a.latitude>v.PI_OVER_TWO))return r.ellipsoid.cartographicToCartesian(a,n)}(this,e,this._projection,r);else{if(this._mode!==O.COLUMBUS_VIEW)return;r=function(e,t,r,n){var o=e.getPickRay(t,nt),a=-o.origin.x/o.direction.x;A.getPoint(o,a,n);var s=r.unproject(new i(n.y,n.z,0));if(!(s.latitude<-v.PI_OVER_TWO||s.latitude>v.PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI))return r.ellipsoid.cartographicToCartesian(s,n)}(this,e,this._projection,r)}return r}};var ot=new i,at=new i,st=new i;var lt=new i;I.prototype.getPickRay=function(e,t){a(t)||(t=new A);var r=this.frustum;return a(r.aspectRatio)&&a(r.fov)&&a(r.near)?function(e,t,r){var n=e._scene.canvas,o=n.clientWidth,a=n.clientHeight,s=Math.tan(.5*e.frustum.fovy),l=e.frustum.aspectRatio*s,u=e.frustum.near,c=2/o*t.x-1,d=2/a*(a-t.y)-1,h=e.positionWC;i.clone(h,r.origin);var p=i.multiplyByScalar(e.directionWC,u,ot);i.add(h,p,p);var m=i.multiplyByScalar(e.rightWC,c*u*l,at),f=i.multiplyByScalar(e.upWC,d*u*s,st),_=i.add(p,m,r.direction);return i.add(_,f,_),i.subtract(_,h,_),i.normalize(_,_),r}(this,e,t):function(e,t,r){var n=e._scene.canvas,o=n.clientWidth,s=n.clientHeight,l=e.frustum;a(l._offCenterFrustum)&&(l=l._offCenterFrustum);var u=2/o*t.x-1;u*=.5*(l.right-l.left);var c=2/s*(s-t.y)-1;c*=.5*(l.top-l.bottom);var d=r.origin;return i.clone(e.position,d),i.multiplyByScalar(e.right,u,lt),i.add(lt,d,d),i.multiplyByScalar(e.up,c,lt),i.add(lt,d,d),i.clone(e.directionWC,r.direction),e._mode!==O.COLUMBUS_VIEW&&e._mode!==O.SCENE2D||i.fromElements(r.origin.z,r.origin.x,r.origin.y,r.origin),r}(this,e,t)};var ut=new i,ct=new i;I.prototype.distanceToBoundingSphere=function(e){var t=i.subtract(this.positionWC,e.center,ut),r=i.multiplyByScalar(this.directionWC,i.dot(t,this.directionWC),ct);return Math.max(0,i.magnitude(r)-e.radius)};var dt=new t;I.prototype.getPixelSize=function(e,t,i){var r=this.distanceToBoundingSphere(e),n=this.frustum.getPixelDimensions(t,i,r,dt);return Math.max(n.x,n.y)};var ht=new i,pt=new i,mt=new i,ft=new i;function _t(e,t){var r=e.position,n=e.direction,o=e.worldToCameraCoordinatesVector(i.UNIT_X,ht),a=-i.dot(o,r)/i.dot(o,n),s=i.add(r,i.multiplyByScalar(n,a,pt),pt);e.cameraToWorldCoordinatesPoint(s,s),r=e.cameraToWorldCoordinatesPoint(e.position,mt);var l=Math.tan(.5*e.frustum.fovy),c=e.frustum.aspectRatio*l,d=i.magnitude(i.subtract(r,s,ft)),h=c*d,p=l*d,m=e._maxCoord.x,f=e._maxCoord.y,_=Math.max(h-m,m),g=Math.max(p-f,f);if(r.z<-_||r.z>_||r.y<-g||r.y>g){var v=s.y<-_||s.y>_,y=s.z<-g||s.z>g;if(v||y)return function(e,t,r,n,o,a){var s=i.clone(t);return r.y>n?s.y-=r.y-n:r.y<-n&&(s.y+=-n-r.y),r.z>o?s.z-=r.z-o:r.z<-o&&(s.z+=-o-r.z),{easingFunction:u.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:a,update:function(r){var n=i.lerp(t,s,r.time,new i);e.worldToCameraCoordinatesPoint(n,e.position)}}}(e,r,s,_,g,t)}}I.prototype.createCorrectPositionTween=function(e){if(this._mode===O.COLUMBUS_VIEW)return _t(this,e)};var gt=new i,vt={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};I.prototype.cancelFlight=function(){a(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},I.prototype.flyTo=function(e){var t=(e=o(e,o.EMPTY_OBJECT)).destination;if(this._mode!==O.MORPHING){this.cancelFlight();var i=o(e.orientation,o.EMPTY_OBJECT);if(a(i.direction)&&(i=he(this,t,i,pe.orientation)),a(e.duration)&&e.duration<=0){var r=pe;return r.destination=e.destination,r.orientation.heading=i.heading,r.orientation.pitch=i.pitch,r.orientation.roll=i.roll,r.convert=e.convert,r.endTransform=e.endTransform,this.setView(r),void("function"==typeof e.complete&&e.complete())}var n=a(t.west);n&&(t=this.getRectangleCameraCoordinates(t,gt));var s,l=this;vt.destination=t,vt.heading=i.heading,vt.pitch=i.pitch,vt.roll=i.roll,vt.duration=e.duration,vt.complete=function(){s===l._currentFlight&&(l._currentFlight=void 0),a(e.complete)&&e.complete()},vt.cancel=e.cancel,vt.endTransform=e.endTransform,vt.convert=!n&&e.convert,vt.maximumHeight=e.maximumHeight,vt.pitchAdjustHeight=e.pitchAdjustHeight,vt.flyOverLongitude=e.flyOverLongitude,vt.flyOverLongitudeWeight=e.flyOverLongitudeWeight,vt.easingFunction=e.easingFunction;var u=this._scene;s=u.tweens.add(b.createTween(u,vt)),this._currentFlight=s;var c=this._scene.preloadFlightCamera;this._mode!==O.SCENE2D?(a(c)||(c=I.clone(this)),c.setView({destination:t,orientation:i}),this._scene.preloadFlightCullingVolume=c.frustum.computeCullingVolume(c.positionWC,c.directionWC,c.upWC)):c=void 0}};var yt=100;function xt(e,t,i){a(i)||(i=m.clone(I.DEFAULT_OFFSET));var r=e._scene.screenSpaceCameraController.minimumZoomDistance,n=e._scene.screenSpaceCameraController.maximumZoomDistance,o=i.range;if(!a(o)||0===o){var s=t.radius;0===s?i.range=yt:e.frustum instanceof w||e._mode===O.SCENE2D?i.range=function(e,t){var i,r,n=e.frustum;a(n._offCenterFrustum)&&(n=n._offCenterFrustum);var o=n.right/n.top,s=t*o;return t>s?r=(i=t)/o:(r=t,i=s),1.5*Math.max(i,r)}(e,s):i.range=function(e,t){var i=e.frustum,r=Math.tan(.5*i.fovy),n=i.aspectRatio*r;return Math.max(t/n,t/r)}(e,s),i.range=v.clamp(i.range,r,n)}return i}I.prototype.viewBoundingSphere=function(e,t){t=xt(this,e,t),this.lookAt(e.center,t)};var wt=new x,Tt=new i,Ct=new i,Et=new i,At=new i,St=new r,Pt=new E,bt=new y;I.prototype.flyToBoundingSphere=function(e,t){t=o(t,o.EMPTY_OBJECT);var r=this._mode===O.SCENE2D||this._mode===O.COLUMBUS_VIEW;this._setTransform(x.IDENTITY);var n,a=xt(this,e,t.offset);n=r?i.multiplyByScalar(i.UNIT_Z,a.range,Tt):Re(a.heading,a.pitch,a.range);var s,l,u=P.eastNorthUpToFixedFrame(e.center,c.WGS84,wt);if(x.multiplyByPoint(u,n,n),!r){if(s=i.subtract(e.center,n,Ct),i.normalize(s,s),l=x.multiplyByPointAsVector(u,i.UNIT_Z,Et),1-Math.abs(i.dot(s,l))<v.EPSILON6){var d=E.fromAxisAngle(s,a.heading,Pt),h=y.fromQuaternion(d,bt);i.fromCartesian4(x.getColumn(u,1,St),l),y.multiplyByVector(h,l,l)}var p=i.cross(s,l,At);i.cross(p,s,l),i.normalize(l,l)}this.flyTo({destination:n,orientation:{direction:s,up:l},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var Dt=new i,Ot=new i,It=new i,Mt=new i,Nt=[new i,new i,new i,new i];var Ft=new t,Rt=new i,Lt=[new n,new n,new n,new n];function Vt(e,t,i,r,n,o){Ft.x=e,Ft.y=t;var s=r.pickEllipsoid(Ft,n,Rt);return a(s)?(Lt[i]=n.cartesianToCartographic(s,Lt[i]),1):(Lt[i]=n.cartesianToCartographic(o[i],Lt[i]),0)}return I.prototype.computeViewRectangle=function(t,r){t=o(t,c.WGS84);var n=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),a=new e(i.ZERO,t.maximumRadius);if(n.computeVisibility(a)!==_.OUTSIDE){var s=this._scene.canvas,l=s.clientWidth,u=s.clientHeight,d=0,h=function(e,t){var r,n,o=t.radii,a=e.positionWC,s=i.multiplyComponents(t.oneOverRadii,a,Dt),l=i.magnitude(s),u=i.normalize(s,Ot);i.equalsEpsilon(u,i.UNIT_Z,v.EPSILON10)?(r=new i(0,1,0),n=new i(0,0,1)):(r=i.normalize(i.cross(i.UNIT_Z,u,It),It),n=i.normalize(i.cross(u,r,Mt),Mt));var c=Math.sqrt(i.magnitudeSquared(s)-1),d=i.multiplyByScalar(u,1/l,Dt),h=c/l,p=i.multiplyByScalar(r,h,Ot),m=i.multiplyByScalar(n,h,It),f=i.add(d,m,Nt[0]);i.subtract(f,p,f),i.multiplyComponents(o,f,f);var _=i.subtract(d,m,Nt[1]);i.subtract(_,p,_),i.multiplyComponents(o,_,_);var g=i.subtract(d,m,Nt[2]);i.add(g,p,g),i.multiplyComponents(o,g,g);var y=i.add(d,m,Nt[3]);return i.add(y,p,y),i.multiplyComponents(o,y,y),Nt}(this,t);if(d+=Vt(0,0,0,this,t,h),d+=Vt(0,u,1,this,t,h),d+=Vt(l,u,2,this,t,h),(d+=Vt(l,0,3,this,t,h))<2)return S.MAX_VALUE;r=S.fromCartographicArray(Lt,r);for(var p=0,m=Lt[3].longitude,f=0;f<4;++f){var g=Lt[f].longitude,y=Math.abs(g-m);y>v.PI?p+=v.TWO_PI-y:p+=y,m=g}return v.equalsEpsilon(Math.abs(p),v.TWO_PI,v.EPSILON9)&&(r.west=-v.PI,r.east=v.PI,Lt[0].latitude>=0?r.north=v.PI_OVER_TWO:r.south=-v.PI_OVER_TWO),r}},I.prototype.switchToPerspectiveFrustum=function(){if(!(this._mode===O.SCENE2D||this.frustum instanceof C)){var e=this._scene;this.frustum=new C,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=v.toRadians(60)}},I.prototype.switchToOrthographicFrustum=function(){if(!(this._mode===O.SCENE2D||this.frustum instanceof w)){var e=this._scene;this.frustum=new w,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.width=i.magnitude(this.position);var t=this.frustum.projectionMatrix;a(t)&&this._adjustOrthographicFrustum(!0)}},I.clone=function(e,t){return a(t)||(t=new I(e._scene)),i.clone(e.position,t.position),i.clone(e.direction,t.direction),i.clone(e.up,t.up),i.clone(e.right,t.right),x.clone(e._transform,t.transform),t._transformChanged=!0,t.frustum=e.frustum.clone(),t},I}.apply(t,r))||(e.exports=n)},363:function(e,t,i){var r;void 0===(r=function(){"use strict";return"uniform sampler2D colorTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    gl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n}\n"}.call(t,i,t,e))||(e.exports=r)},364:function(e,t,i){var r,n;r=[i(16),i(9),i(8),i(10),i(20),i(11),i(83),i(285)],void 0===(n=function(e,t,i,r,n,o,a,s){"use strict";function l(e){var r=(e=t(e,t.EMPTY_OBJECT)).context._gl,n=(a.maximumRenderbufferSize,t(e.format,s.RGBA4)),o=i(e.width)?e.width:r.drawingBufferWidth,l=i(e.height)?e.height:r.drawingBufferHeight;this._gl=r,this._format=n,this._width=o,this._height=l,this._renderbuffer=this._gl.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this._renderbuffer),r.renderbufferStorage(r.RENDERBUFFER,n,o,l),r.bindRenderbuffer(r.RENDERBUFFER,null)}return r(l.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),l.prototype._getRenderbuffer=function(){return this._renderbuffer},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),n(this)},l}.apply(t,r))||(e.exports=n)},365:function(e,t,i){var r,n;r=[i(144),i(12),i(16),i(9),i(8),i(10),i(11),i(73),i(80),i(189),i(170),i(71),i(180),i(182),i(134),i(38),i(760)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=new p(0);function v(e){m.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}return n(Object.create)&&(v.prototype=Object.create(m.prototype),v.prototype.constructor=v),o(v.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),v.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!n(t.height)&&!n(t.extrudedHeight)&&c.isSupported(this._scene)},v.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight;return 0===t||n(i)&&i!==t},v.prototype._computeCenter=a.throwInstantiationError,v.prototype._onEntityPropertyChanged=function(e,t,i,o){if(m.prototype._onEntityPropertyChanged.call(this,e,t,i,o),-1!==this._observedPropertyNames.indexOf(t)){var a=this._entity[this._geometryPropertyName];if(n(a)){n(a.zIndex)&&(n(a.height)||n(a.extrudedHeight))&&u(u.geometryZIndex),this._zIndex=r(a.zIndex,g),n(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);var s=a.heightReference,l=a.extrudedHeightReference;if(n(s)||n(l)){var c=new h(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new _(this._scene,c,s,l)}}}},v.prototype.destroy=function(){n(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),m.prototype.destroy.call(this)},v.getGeometryHeight=function(e,t){if(n(e))return t!==d.CLAMP_TO_GROUND?e:0;t!==d.NONE&&u(u.geometryHeightReference)},v.getGeometryExtrudedHeight=function(e,t){if(n(e))return t!==d.CLAMP_TO_GROUND?e:v.CLAMP_TO_GROUND;t!==d.NONE&&u(u.geometryExtrudedHeightReference)},v.CLAMP_TO_GROUND="clamp",v.computeGeometryOffsetAttribute=function(e,t,i,r){n(e)&&n(t)||(t=d.NONE),n(i)&&n(r)||(r=d.NONE);var o=0;return t!==d.NONE&&o++,r===d.RELATIVE_TO_GROUND&&o++,2===o?s.ALL:1===o?s.TOP:void 0},v}.apply(t,r))||(e.exports=n)},495:function(e,t,i){var r,n;r=[i(8),i(10),i(11),i(26),i(25),i(150),i(38)],void 0===(n=function(e,t,i,r,n,o,a){"use strict";function s(e){this._definitionChanged=new n,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}return t(s.prototype,{isConstant:{get:function(){return a.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return e(this._value)?this._value.referenceFrame:o.FIXED}}}),s.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},s.prototype.setValue=function(t){this._value!==t&&(this._value=t,e(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),e(t)&&(this._removeSubscription=t.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},s.prototype.getValueInReferenceFrame=function(t,i,n){if(e(this._value))return n=this._value.getValueInReferenceFrame(t,i,n),e(n)?r.WGS84.scaleToGeodeticSurface(n,n):void 0},s.prototype.equals=function(e){return this===e||e instanceof s&&this._value===e._value},s.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},s}.apply(t,r))||(e.exports=n)},496:function(e,t,i){var r,n;r=[i(17)],void 0===(n=function(e){"use strict";return e({NONE:-1,PARTIAL:0,FULL:1})}.apply(t,r))||(e.exports=n)},497:function(e,t,i){var r,n;r=[i(94),i(33),i(24),i(12),i(34),i(9),i(8),i(11),i(26),i(52),i(53),i(65),i(73),i(50),i(14),i(45),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=new r,v=new r,y=new r,x=new r,w=new r,T=new r(1,1,1),C=Math.cos,E=Math.sin;function A(e){e=o(e,o.EMPTY_OBJECT);var t=o(e.radii,T),i=Math.round(o(e.stackPartitions,64)),n=Math.round(o(e.slicePartitions,64)),a=o(e.vertexFormat,_.DEFAULT);this._radii=r.clone(t),this._stackPartitions=i,this._slicePartitions=n,this._vertexFormat=_.clone(a),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}A.packedLength=r.packedLength+_.packedLength+3,A.pack=function(e,t,i){return i=o(i,0),r.pack(e._radii,t,i),i+=r.packedLength,_.pack(e._vertexFormat,t,i),i+=_.packedLength,t[i++]=e._stackPartitions,t[i++]=e._slicePartitions,t[i]=o(e._offsetAttribute,-1),t};var S,P=new r,b=new _,D={radii:P,vertexFormat:b,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};return A.unpack=function(e,t,i){t=o(t,0);var n=r.unpack(e,t,P);t+=r.packedLength;var s=_.unpack(e,t,b);t+=_.packedLength;var l=e[t++],u=e[t++],c=e[t];return a(i)?(i._radii=r.clone(n,i._radii),i._vertexFormat=_.clone(s,i._vertexFormat),i._stackPartitions=l,i._slicePartitions=u,i._offsetAttribute=-1===c?void 0:c,i):(D.stackPartitions=l,D.slicePartitions=u,D.offsetAttribute=-1===c?void 0:c,new A(D))},A.createGeometry=function(o){var s=o._radii;if(!(s.x<=0||s.y<=0||s.z<=0)){var _,T,A=l.fromCartesian3(s),S=o._vertexFormat,P=o._slicePartitions+1,b=o._stackPartitions+1,D=b*P,O=new Float64Array(3*D),I=6*(P-1)*(b-2),M=p.createTypedArray(D,I),N=S.normal?new Float32Array(3*D):void 0,F=S.tangent?new Float32Array(3*D):void 0,R=S.bitangent?new Float32Array(3*D):void 0,L=S.st?new Float32Array(2*D):void 0,V=new Array(P),U=new Array(P),z=0;for(_=0;_<P;_++){var B=m.TWO_PI*_/(P-1);V[_]=C(B),U[_]=E(B),O[z++]=0,O[z++]=0,O[z++]=s.z}for(_=1;_<b-1;_++){var H=Math.PI*_/(b-1),k=E(H),G=s.x*k,W=s.y*k,Y=s.z*C(H);for(T=0;T<P;T++)O[z++]=V[T]*G,O[z++]=U[T]*W,O[z++]=Y}for(_=0;_<P;_++)O[z++]=0,O[z++]=0,O[z++]=-s.z;var j=new d;S.position&&(j.position=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:O}));var X,Q,q=0,Z=0,K=0,J=0;if(S.st||S.normal||S.tangent||S.bitangent){for(_=0;_<D;_++){var $=r.fromArray(O,3*_,g),ee=A.geodeticSurfaceNormal($,v);if(S.st){var te=i.negate(ee,w);i.magnitude(te)<m.EPSILON6&&((z=3*(_+P*Math.floor(.5*b)))>O.length&&(z=3*(_-P*Math.floor(.5*b))),r.fromArray(O,z,te),A.geodeticSurfaceNormal(te,te),i.negate(te,te)),L[q++]=Math.atan2(te.y,te.x)/m.TWO_PI+.5,L[q++]=Math.asin(ee.z)/Math.PI+.5}if(S.normal&&(N[Z++]=ee.x,N[Z++]=ee.y,N[Z++]=ee.z),S.tangent||S.bitangent){var ie=y;if(_<P||_>D-P-1?(r.cross(r.UNIT_X,ee,ie),r.normalize(ie,ie)):(r.cross(r.UNIT_Z,ee,ie),r.normalize(ie,ie)),S.tangent&&(F[K++]=ie.x,F[K++]=ie.y,F[K++]=ie.z),S.bitangent){var re=r.cross(ee,ie,x);r.normalize(re,re),R[J++]=re.x,R[J++]=re.y,R[J++]=re.z}}}S.st&&(j.st=new c({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:L})),S.normal&&(j.normal=new c({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:N})),S.tangent&&(j.tangent=new c({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:F})),S.bitangent&&(j.bitangent=new c({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:R}))}if(a(o._offsetAttribute)){var ne=O.length,oe=new Uint8Array(ne/3),ae=o._offsetAttribute===h.NONE?0:1;e(oe,ae),j.applyOffset=new c({componentDatatype:n.UNSIGNED_BYTE,componentsPerAttribute:1,values:oe})}for(z=0,T=0;T<P-1;T++)M[z++]=P+T,M[z++]=P+T+1,M[z++]=T+1;for(_=1;_<b-2;_++)for(X=_*P,Q=(_+1)*P,T=0;T<P-1;T++)M[z++]=Q+T,M[z++]=Q+T+1,M[z++]=X+T+1,M[z++]=Q+T,M[z++]=X+T+1,M[z++]=X+T;for(X=(_=b-2)*P,Q=(_+1)*P,T=0;T<P-1;T++)M[z++]=Q+T,M[z++]=X+T+1,M[z++]=X+T;return new u({attributes:j,indices:M,primitiveType:f.TRIANGLES,boundingSphere:t.fromEllipsoid(A),offsetAttribute:o._offsetAttribute})}},A.getUnitEllipsoid=function(){return a(S)||(S=A.createGeometry(new A({radii:new r(1,1,1),vertexFormat:_.POSITION_ONLY}))),S},A}.apply(t,r))||(e.exports=n)},498:function(e,t,i){var r,n;r=[i(17)],void 0===(n=function(e){"use strict";return e({ROTATE:0,INFINITE_SCROLL:1})}.apply(t,r))||(e.exports=n)},499:function(e,t,i){var r;void 0===(r=function(){"use strict";return{NEAREST:0,LINEAR:1}}.call(t,i,t,e))||(e.exports=r)},500:function(e,t,i){var r,n;r=[i(72),i(9),i(8),i(10),i(20),i(11)],void 0===(n=function(e,t,i,r,n,o){"use strict";function a(i){i=t(i,t.EMPTY_OBJECT),this._primitives=[],this._guid=e(),this._zIndex=void 0,this.show=t(i.show,!0),this.destroyPrimitives=t(i.destroyPrimitives,!0)}function s(e,t){return e._primitives.indexOf(t)}return r(a.prototype,{length:{get:function(){return this._primitives.length}}}),a.prototype.add=function(e,t){var r=i(t),n=e._external=e._external||{};return(n._composites=n._composites||{})[this._guid]={collection:this},r?this._primitives.splice(t,0,e):this._primitives.push(e),e},a.prototype.remove=function(e){if(this.contains(e)){var t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),!0}return!1},a.prototype.removeAndDestroy=function(e){var t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},a.prototype.removeAll=function(){for(var e=this._primitives,t=e.length,i=0;i<t;++i)delete e[i]._external._composites[this._guid],this.destroyPrimitives&&e[i].destroy();this._primitives=[]},a.prototype.contains=function(e){return!!(i(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},a.prototype.raise=function(e){if(i(e)){var t=s(this,e),r=this._primitives;if(t!==r.length-1){var n=r[t];r[t]=r[t+1],r[t+1]=n}}},a.prototype.raiseToTop=function(e){if(i(e)){var t=s(this,e),r=this._primitives;t!==r.length-1&&(r.splice(t,1),r.push(e))}},a.prototype.lower=function(e){if(i(e)){var t=s(this,e),r=this._primitives;if(0!==t){var n=r[t];r[t]=r[t-1],r[t-1]=n}}},a.prototype.lowerToBottom=function(e){if(i(e)){var t=s(this,e),r=this._primitives;0!==t&&(r.splice(t,1),r.unshift(e))}},a.prototype.get=function(e){return this._primitives[e]},a.prototype.update=function(e){if(this.show)for(var t=this._primitives,i=0;i<t.length;++i)t[i].update(e)},a.prototype.prePassesUpdate=function(e){for(var t=this._primitives,r=0;r<t.length;++r){var n=t[r];i(n.prePassesUpdate)&&n.prePassesUpdate(e)}},a.prototype.updateForPass=function(e,t){for(var r=this._primitives,n=0;n<r.length;++n){var o=r[n];i(o.updateForPass)&&o.updateForPass(e,t)}},a.prototype.postPassesUpdate=function(e){for(var t=this._primitives,r=0;r<t.length;++r){var n=t[r];i(n.postPassesUpdate)&&n.postPassesUpdate(e)}},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this.removeAll(),n(this)},a}.apply(t,r))||(e.exports=n)},501:function(e,t,i){var r,n;r=[i(9),i(8),i(180),i(134),i(760)],void 0===(n=function(e,t,i,r,n){"use strict";return function(e,o,a,s){if(r.prototype._onEntityPropertyChanged.call(this,e,o,a,s),-1!==this._observedPropertyNames.indexOf(o)){var l=this._entity[this._geometryPropertyName];if(t(l)){t(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);var u=l.heightReference;if(t(u)){var c=new i(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new n(this._scene,c,u)}}}}}.apply(t,r))||(e.exports=n)},502:function(e,t,i){var r,n;r=[i(24),i(12),i(49),i(32),i(197),i(186),i(14),i(43),i(28),i(244),i(54),i(60)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d){"use strict";var h=[new t,new t],p=new t,m=new t,f=new t,_=new t,g=new t,v=new t,y=new t,x=new t,w=new t,T=new t,C=new t,E={},A=new r;function S(e,i,r,n){var o,a=e[0],s=e[1],l=t.angleBetween(a,s),u=Math.ceil(l/n),c=new Array(u);if(i===r){for(o=0;o<u;o++)c[o]=i;return c.push(r),c}var d=(r-i)/u;for(o=1;o<u;o++){var h=i+o*d;c[o]=h}return c[0]=i,c.push(r),c}var P=new t,b=new t;var D=new t(-1,0,0),O=new l,I=new l,M=new s,N=s.IDENTITY.clone(),F=new t,R=new i,L=new t;function V(i,r,n,a,u,c,h,p){var m=F,f=R;O=d.eastNorthUpToFixedFrame(i,u,O),m=l.multiplyByPointAsVector(O,D,m);var _=function(i,r,n,a){var s=new o(n,a),l=s.projectPointOntoPlane(t.add(n,i,P),P),u=s.projectPointOntoPlane(t.add(n,r,b),b),c=e.angleBetween(l,u);return u.x*l.y-u.y*l.x>=0?-c:c}(m=t.normalize(m,m),r,i,u);M=s.fromRotationZ(_,M),L.z=c,O=l.multiplyTransformation(O,l.fromRotationTranslation(M,L,I),O);var g=N;g[0]=h;for(var v=0;v<p;v++)for(var y=0;y<n.length;y+=3)f=t.fromArray(n,y,f),f=s.multiplyByVector(g,f,f),f=l.multiplyByPoint(O,f,f),a.push(f.x,f.y,f.z);return a}var U=new t;function z(e,i,r,n,o,a,s){for(var l=0;l<e.length;l+=3){n=V(t.fromArray(e,l,U),i,r,n,o,a[l/3],s,1)}return n}function B(e,t){for(var i=e.length,r=new Array(3*i),n=0,o=t.x+t.width/2,a=t.y+t.height/2,s=0;s<i;s++)r[n++]=e[s].x-o,r[n++]=0,r[n++]=e[s].y-a;return r}var H=new c,k=new t,G=new s;function W(e,i,r,o,l,u,d,h,p,m){var f,_,g=t.angleBetween(t.subtract(i,e,T),t.subtract(r,e,C)),v=o===n.BEVELED?0:Math.ceil(g/a.toRadians(5));if(f=l?s.fromQuaternion(c.fromAxisAngle(t.negate(e,T),g/(v+1),H),G):s.fromQuaternion(c.fromAxisAngle(e,g/(v+1),H),G),i=t.clone(i,k),v>0)for(var y=m?2:1,x=0;x<v;x++)i=s.multiplyByVector(f,i,i),_=t.subtract(i,e,T),_=t.normalize(_,_),l||(_=t.negate(_,_)),d=V(u.scaleToGeodeticSurface(i,C),_,h,d,u,p,1,y);else _=t.subtract(i,e,T),_=t.normalize(_,_),l||(_=t.negate(_,_)),d=V(u.scaleToGeodeticSurface(i,C),_,h,d,u,p,1,1),r=t.clone(r,k),_=t.subtract(r,e,T),_=t.normalize(_,_),l||(_=t.negate(_,_)),d=V(u.scaleToGeodeticSurface(r,C),_,h,d,u,p,1,1);return d}E.removeDuplicatesFromShape=function(t){for(var i=t.length,r=[],n=i-1,o=0;o<i;n=o++){var a=t[n],s=t[o];e.equals(a,s)||r.push(s)}return r},E.angleIsGreaterThanPi=function(e,i,r,n){var a=new o(r,n),s=a.projectPointOntoPlane(t.add(r,e,P),P),l=a.projectPointOntoPlane(t.add(r,i,b),b);return l.x*s.y-l.y*s.x>=0};var Y=new t,j=new t;return E.computePositions=function(e,i,r,o,s){var l=o._ellipsoid,c=function(e,t){for(var i=new Array(e.length),r=0;r<e.length;r++){var n=e[r];A=t.cartesianToCartographic(n,A),i[r]=A.height,e[r]=t.scaleToGeodeticSurface(n,n)}return i}(e,l),d=o._granularity,C=o._cornerType,P=s?function(e,t){var i=e.length,r=new Array(6*i),n=0,o=t.x+t.width/2,a=t.y+t.height/2,s=e[0];r[n++]=s.x-o,r[n++]=0,r[n++]=s.y-a;for(var l=1;l<i;l++){var u=(s=e[l]).x-o,c=s.y-a;r[n++]=u,r[n++]=0,r[n++]=c,r[n++]=u,r[n++]=0,r[n++]=c}return s=e[0],r[n++]=s.x-o,r[n++]=0,r[n++]=s.y-a,r}(i,r):B(i,r),b=s?B(i,r):void 0,D=r.height/2,O=r.width/2,I=e.length,M=[],N=s?[]:void 0,F=p,R=m,L=f,U=_,H=g,k=v,G=y,X=x,Q=w,q=e[0],Z=e[1];U=l.geodeticSurfaceNormal(q,U),F=t.subtract(Z,q,F),F=t.normalize(F,F),X=t.cross(U,F,X),X=t.normalize(X,X);var K,J=c[0],$=c[1];s&&(N=V(q,X,b,N,l,J+D,1,1)),Q=t.clone(q,Q),q=Z,R=t.negate(F,R);for(var ee=1;ee<I-1;ee++){var te=s?2:1;Z=e[ee+1],F=t.subtract(Z,q,F),F=t.normalize(F,F),L=t.add(F,R,L),L=t.normalize(L,L),U=l.geodeticSurfaceNormal(q,U);var ie=t.multiplyByScalar(U,t.dot(F,U),Y);t.subtract(F,ie,ie),t.normalize(ie,ie);var re=t.multiplyByScalar(U,t.dot(R,U),j);if(t.subtract(R,re,re),t.normalize(re,re),!a.equalsEpsilon(Math.abs(t.dot(ie,re)),1,a.EPSILON7)){L=t.cross(L,U,L),L=t.cross(U,L,L),L=t.normalize(L,L);var ne=1/Math.max(.25,t.magnitude(t.cross(L,R,T))),oe=E.angleIsGreaterThanPi(F,R,q,l);oe?(H=t.add(q,t.multiplyByScalar(L,ne*O,L),H),k=t.add(H,t.multiplyByScalar(X,O,k),k),h[0]=t.clone(Q,h[0]),h[1]=t.clone(k,h[1]),K=S(h,J+D,$+D,d),M=z(u.generateArc({positions:h,granularity:d,ellipsoid:l}),X,P,M,l,K,1),X=t.cross(U,F,X),X=t.normalize(X,X),G=t.add(H,t.multiplyByScalar(X,O,G),G),C===n.ROUNDED||C===n.BEVELED?W(H,k,G,C,oe,l,M,P,$+D,s):M=V(q,L=t.negate(L,L),P,M,l,$+D,ne,te),Q=t.clone(G,Q)):(H=t.add(q,t.multiplyByScalar(L,ne*O,L),H),k=t.add(H,t.multiplyByScalar(X,-O,k),k),h[0]=t.clone(Q,h[0]),h[1]=t.clone(k,h[1]),K=S(h,J+D,$+D,d),M=z(u.generateArc({positions:h,granularity:d,ellipsoid:l}),X,P,M,l,K,1),X=t.cross(U,F,X),X=t.normalize(X,X),G=t.add(H,t.multiplyByScalar(X,-O,G),G),C===n.ROUNDED||C===n.BEVELED?W(H,k,G,C,oe,l,M,P,$+D,s):M=V(q,L,P,M,l,$+D,ne,te),Q=t.clone(G,Q)),R=t.negate(F,R)}else M=V(Q,X,P,M,l,J+D,1,1),Q=q;J=$,$=c[ee+1],q=Z}h[0]=t.clone(Q,h[0]),h[1]=t.clone(q,h[1]),K=S(h,J+D,$+D,d),M=z(u.generateArc({positions:h,granularity:d,ellipsoid:l}),X,P,M,l,K,1),s&&(N=V(q,X,b,N,l,$+D,1,1)),I=M.length;var ae=s?I+N.length:I,se=new Float64Array(ae);return se.set(M),s&&se.set(N,I),se},E}.apply(t,r))||(e.exports=n)},744:function(e,t,i){var r,n;r=[i(110),i(12),i(373),i(9),i(8),i(10),i(20),i(11),i(26),i(48),i(201),i(383),i(276),i(1836),i(1837),i(1851),i(1859),i(44),i(102),i(1921),i(1924),i(1928),i(348)],void 0===(n=function(e,t,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C){"use strict";function E(e){return i(1932)("./tycho2t3_80_"+e+".jpg")}function A(e){var t=window.devicePixelRatio,i=e._resolutionScale*t;return o(e._scene)&&(e._scene.pixelRatio=i),i}function S(e){var t=e._canvas,i=t.clientWidth,r=t.clientHeight,n=A(e);e._canvasWidth=i,e._canvasHeight=r,i*=n,r*=n,t.width=i,t.height=r,e._canRender=0!==i&&0!==r,e._lastDevicePixelRatio=window.devicePixelRatio}function P(e){var t=e._canvas,i=t.width,r=t.height;if(0!==i&&0!==r){var n=e._scene.camera.frustum;o(n.aspectRatio)?n.aspectRatio=i/r:(n.top=n.right*(r/i),n.bottom=-n.top)}}function b(e,i){e=C(e),i=n(i,n.EMPTY_OBJECT);var a=document.createElement("div");a.className="cesium-widget",e.appendChild(a);var s=document.createElement("canvas"),l=c.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=l,l&&(s.style.imageRendering=c.imageRenderingValue()),s.oncontextmenu=function(){return!1},s.onselectstart=function(){return!1},a.appendChild(s);var d=document.createElement("div");d.className="cesium-widget-credits";var h=o(i.creditContainer)?C(i.creditContainer):a;h.appendChild(d);var b=o(i.creditViewport)?C(i.creditViewport):a,D=n(i.showRenderLoopErrors,!0);this._element=a,this._container=e,this._canvas=s,this._canvasWidth=0,this._canvasHeight=0,this._lastDevicePixelRatio=0,this._creditViewport=b,this._creditContainer=h,this._innerCreditContainer=d,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=D,this._resolutionScale=1,this._forceResize=!1,this._clock=o(i.clock)?i.clock:new r,S(this);try{var O=new g({canvas:s,contextOptions:i.contextOptions,creditContainer:d,creditViewport:b,mapProjection:i.mapProjection,orderIndependentTranslucency:i.orderIndependentTranslucency,scene3DOnly:n(i.scene3DOnly,!1),terrainExaggeration:i.terrainExaggeration,shadows:i.shadows,mapMode2D:i.mapMode2D,requestRenderMode:i.requestRenderMode,maximumRenderTimeChange:i.maximumRenderTimeChange});this._scene=O,O.camera.constrainedAxis=t.UNIT_Z,A(this),P(this);var I=n(O.mapProjection.ellipsoid,u.WGS84),M=i.globe;o(M)||(M=new f(I)),!1!==M&&(O.globe=M,O.globe.shadows=n(i.terrainShadows,y.RECEIVE_ONLY));var N=i.skyBox;o(N)||(N=new w({sources:{positiveX:E("px"),negativeX:E("mx"),positiveY:E("py"),negativeY:E("my"),positiveZ:E("pz"),negativeZ:E("mz")}})),!1!==N&&(O.skyBox=N,O.sun=new T,O.moon=new _);var F=i.skyAtmosphere;o(F)||(F=new x(I)),!1!==F&&(O.skyAtmosphere=F);var R=!1!==i.globe&&i.imageryProvider;o(R)||(R=m()),!1!==R&&O.imageryLayers.addImageryProvider(R),o(i.terrainProvider)&&!1!==i.globe&&(O.terrainProvider=i.terrainProvider),this._screenSpaceEventHandler=new p(s,!1),o(i.sceneMode)&&(i.sceneMode===v.SCENE2D&&this._scene.morphTo2D(0),i.sceneMode===v.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=n(i.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=i.targetFrameRate;var L=this;O.renderError.addEventListener(function(e,t){if(L._useDefaultRenderLoop=!1,L._renderLoopRunning=!1,L._showRenderLoopErrors){L.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}})}catch(e){if(D){this.showErrorPanel("Error constructing CesiumWidget.",'Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:',e)}throw e}}return a(b.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e,e&&!this._renderLoopRunning&&function(e){e._renderLoopRunning=!0;var t=0;h(function i(r){if(!e.isDestroyed())if(e._useDefaultRenderLoop)try{var n=e._targetFrameRate;if(o(n)){var a=1e3/n,s=r-t;s>a&&(e.resize(),e.render(),t=r-s%a),h(i)}else e.resize(),e.render(),h(i)}catch(t){e._useDefaultRenderLoop=!1,e._renderLoopRunning=!1,e._showRenderLoopErrors&&e.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}else e._renderLoopRunning=!1})}(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){this._resolutionScale=e,this._forceResize=!0}}}),b.prototype.showErrorPanel=function(e,t,i){var r=this._element,n=document.createElement("div");n.className="cesium-widget-errorPanel";var a=document.createElement("div");a.className="cesium-widget-errorPanel-content",n.appendChild(a);var s=document.createElement("div");s.className="cesium-widget-errorPanel-header",s.appendChild(document.createTextNode(e)),a.appendChild(s);var l=document.createElement("div");function u(){l.style.maxHeight=Math.max(Math.round(.9*r.clientHeight-100),30)+"px"}if(l.className="cesium-widget-errorPanel-scroll",a.appendChild(l),u(),o(window.addEventListener)&&window.addEventListener("resize",u,!1),o(t)){var c=document.createElement("div");c.className="cesium-widget-errorPanel-message",c.innerHTML="<p>"+t+"</p>",l.appendChild(c)}var h="(no error details available)";o(i)&&(h=d(i));var p=document.createElement("div");p.className="cesium-widget-errorPanel-message",p.appendChild(document.createTextNode(h)),l.appendChild(p);var m=document.createElement("div");m.className="cesium-widget-errorPanel-buttonPanel",a.appendChild(m);var f=document.createElement("button");f.setAttribute("type","button"),f.className="cesium-button",f.appendChild(document.createTextNode("OK")),f.onclick=function(){o(u)&&o(window.removeEventListener)&&window.removeEventListener("resize",u,!1),r.removeChild(n)},m.appendChild(f),r.appendChild(n),"undefined"!=typeof console&&console.error(e+"\n"+t+"\n"+h)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){this._scene=this._scene&&this._scene.destroy(),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),s(this)},b.prototype.resize=function(){var e=this._canvas,t=e.clientWidth,i=e.clientHeight;(this._forceResize||this._canvasWidth!==t||this._canvasHeight!==i||this._lastDevicePixelRatio!==window.devicePixelRatio)&&(this._forceResize=!1,S(this),P(this),this._scene.requestRender())},b.prototype.forceResize=function(){this._lastWidth=0,this.resize()},b.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();var e=this._clock.tick();this._scene.render(e)}else this._clock.tick()},b}.apply(t,r))||(e.exports=n)},745:function(e,t,i){var r,n;r=[i(33),i(12),i(49),i(8),i(10),i(50),i(145),i(120),i(61),i(226),i(227),i(178),i(169),i(113),i(78),i(66),i(88),i(63),i(96),i(89),i(114),i(95),i(268),i(360),i(44),i(746),i(274),i(18)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P){"use strict";function b(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new i(0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.orientedBoundingBox=void 0,this.boundingVolumeSourceTile=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new t,this.terrainState=A.UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new e,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}function D(e,i,n,o,a,s){if(e.decodePosition(o,a,s),r(i)&&i!==E.SCENE3D){var l=n.ellipsoid.cartesianToCartographic(s);n.project(l,s),t.fromElements(s.z,s.x,s.y,s)}return s}n(b.prototype,{eligibleForUnloading:{get:function(){for(var e=this.terrainState,t=!(e===A.RECEIVING||e===A.TRANSFORMING),i=this.imagery,n=0,o=i.length;t&&n<o;++n){var a=i[n];t=!r(a.loadingImagery)||a.loadingImagery.state!==T.TRANSITIONING}return t}},renderedMesh:{get:function(){return r(this.vertexArray)?this.mesh:r(this.fill)?this.fill.mesh:void 0}}});var O=new t,I=new t,M=new t,N=new t;return b.prototype.pick=function(e,i,n,o,s){var l=this.renderedMesh;if(r(l))for(var u=l.vertices,c=l.indices,d=l.encoding,h=c.length,p=0;p<h;p+=3){var m=c[p],f=c[p+1],_=c[p+2],g=D(d,i,n,u,m,O),v=D(d,i,n,u,f,I),y=D(d,i,n,u,_,M),x=a.rayTriangle(e,g,v,y,o,N);if(r(x))return t.clone(x,s)}},b.prototype.pickTriangle=function(e,t,i,n){var o=this.renderedMesh;if(r(o))for(var s=o.vertices,l=o.indices,u=o.encoding,c=l.length,d=0;d<c;d+=3){var h=l[d],p=l[d+1],m=l[d+2],f=D(u,t,i,s,h,O),_=D(u,t,i,s,p,I),g=D(u,t,i,s,m,M),v=a.rayTriangle(e,f,_,g,n,N);if(r(v))return{intersection:v,v0:f,v1:_,v2:g}}},b.prototype.freeResources=function(){r(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=A.UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();for(var e=this.imagery,t=0,i=e.length;t<i;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()},b.prototype.freeVertexArray=function(){b._freeVertexArray(this.vertexArray),this.vertexArray=void 0,b._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0},b.initialize=function(e,t,i){var n=e.data;r(n)||(n=e.data=new b),e.state===C.START&&(!function(e,t,i){var n=t.getTileDataAvailable(e.x,e.y,e.level);if(!r(n)&&r(e.parent)){var o=e.parent,a=o.data;r(a)&&r(a.terrainData)&&(n=a.terrainData.isChildAvailable(o.x,o.y,e.x,e.y))}!1===n&&(e.data.terrainState=A.FAILED);for(var s=0,l=i.length;s<l;++s){var u=i.get(s);u.show&&u._createTileImagerySkeletons(e,t)}}(e,t,i),e.state=C.LOADING)},b.processStateMachine=function(e,n,o,a,p,m){b.initialize(e,o,a);var w=e.data;if(e.state===C.LOADING&&function(e,n,o,a,p){var m=e.data,w=e.parent;if(m.terrainState===A.FAILED&&void 0!==w){var T=void 0!==w.data&&void 0!==w.data.terrainData&&!1!==w.data.terrainData.canUpsample;T||b.processStateMachine(w,n,o,a,!0)}m.terrainState===A.FAILED&&function(e,t,i,n,o,a,s){var l=t.parent;if(!l)return void(t.state=C.FAILED);var u=l.data.terrainData,c=l.x,d=l.y,h=l.level;if(!r(u))return;var p=u.upsample(n.tilingScheme,c,d,h,o,a,s);if(!r(p))return;e.terrainState=A.RECEIVING,P(p,function(t){e.terrainData=t,e.terrainState=A.RECEIVED},function(){e.terrainState=A.FAILED})}(m,e,0,o,e.x,e.y,e.level);m.terrainState===A.UNLOADED&&function(e,t,i,n,o){function a(t){e.terrainData=t,e.terrainState=A.RECEIVED,e.request=void 0}function s(){if(e.request.state===c.CANCELLED)return e.terrainData=void 0,e.terrainState=A.UNLOADED,void(e.request=void 0);e.terrainState=A.FAILED,e.request=void 0;var r="Failed to obtain terrain tile X: "+i+" Y: "+n+" Level: "+o+".";t._requestError=h.handleError(t._requestError,t,t.errorEvent,r,i,n,o,l)}function l(){var l=new u({throttle:!1,throttleByServer:!0,type:d.TERRAIN});e.request=l;var c=t.requestTileGeometry(i,n,o,l);r(c)?(e.terrainState=A.RECEIVING,P(c,a,s)):(e.terrainState=A.UNLOADED,e.request=void 0)}l()}(m,o,e.x,e.y,e.level);m.terrainState===A.RECEIVED&&function(e,i,n,o,a,l){var u=n.tilingScheme,c=e.terrainData.createMesh(u,o,a,l,i.terrainExaggeration);if(!r(c))return;e.terrainState=A.TRANSFORMING,P(c,function(i){e.mesh=i,e.orientedBoundingBox=s.clone(i.orientedBoundingBox,e.orientedBoundingBox),e.occludeePointInScaledSpace=t.clone(i.occludeePointInScaledSpace,e.occludeePointInScaledSpace),e.terrainState=A.TRANSFORMED},function(){e.terrainState=A.FAILED})}(m,n,o,e.x,e.y,e.level);m.terrainState===A.TRANSFORMED&&function(e,t,i,r,n,o,a){e.vertexArray=b._createVertexArrayForMesh(t,e.mesh),e.terrainState=A.READY,e.fill=e.fill&&e.fill.destroy(a)}(m,n.context,0,e.x,e.y,e.level,p);if(m.terrainState>=A.RECEIVED&&void 0===m.waterMaskTexture&&o.hasWaterMask){var E=m.terrainData;if(void 0!==E.waterMask)!function(e,t){var n,o=t.terrainData.waterMask,a=function(e){var t=e.cache.tile_waterMaskData;if(!r(t)){var i=g.create({context:e,pixelFormat:l.LUMINANCE,pixelDatatype:f.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});i.referenceCount=1;var n=new _({wrapS:x.CLAMP_TO_EDGE,wrapT:x.CLAMP_TO_EDGE,minificationFilter:y.LINEAR,magnificationFilter:v.LINEAR});t={allWaterTexture:i,sampler:n,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}(e),s=o.length;if(1===s){if(0===o[0])return;n=a.allWaterTexture}else{var u=Math.sqrt(s);(n=g.create({context:e,pixelFormat:l.LUMINANCE,pixelDatatype:f.UNSIGNED_BYTE,source:{width:u,height:u,arrayBufferView:o},sampler:a.sampler,flipY:!1})).referenceCount=0}++n.referenceCount,t.waterMaskTexture=n,i.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}(n.context,m);else{var S=m._findAncestorTileWithTerrainData(e);r(S)&&r(S.data.waterMaskTexture)&&(m.waterMaskTexture=S.data.waterMaskTexture,++m.waterMaskTexture.referenceCount,m._computeWaterMaskTranslationAndScale(e,S,m.waterMaskTranslationAndScale))}}}(e,n,o,a,p),!m){var T=e.renderable;e.renderable=r(w.vertexArray);var E=w.terrainState===A.READY;e.upsampledFromParent=r(w.terrainData)&&w.terrainData.wasCreatedByUpsampling();var S=w.processImagery(e,o,n);if(E&&S){var D=e._loadedCallbacks,O={};for(var I in D)D.hasOwnProperty(I)&&(D[I](e)||(O[I]=D[I]));e._loadedCallbacks=O,e.state=C.DONE}T&&(e.renderable=!0)}},b.prototype.processImagery=function(e,t,i,n){var o,a,s=e.data,l=e.upsampledFromParent,u=e.renderable,c=!0,d=s.imagery;for(o=0,a=d.length;o<a;++o){var h=d[o];if(r(h.loadingImagery)){if(h.loadingImagery.state===T.PLACEHOLDER){var p=h.loadingImagery.imageryLayer;if(p.imageryProvider.ready){h.freeResources(),d.splice(o,1),p._createTileImagerySkeletons(e,t,o),--o,a=d.length;continue}l=!1}var m=h.processStateMachine(e,i,n);c=c&&m,u=u&&(m||r(h.readyImagery)),l=l&&r(h.loadingImagery)&&(h.loadingImagery.state===T.FAILED||h.loadingImagery.state===T.INVALID)}else l=!1}return e.upsampledFromParent=l,e.renderable=u,c},b._createVertexArrayForMesh=function(e,t){var i=t.vertices,n=p.createVertexBuffer({context:e,typedArray:i,usage:m.STATIC_DRAW}),a=t.encoding.getAttributes(n),s=t.indices.indexBuffers||{},l=s[e.id];if(!r(l)||l.isDestroyed()){var u=t.indices;(l=p.createIndexBuffer({context:e,typedArray:u,usage:m.STATIC_DRAW,indexDatatype:o.fromSizeInBytes(u.BYTES_PER_ELEMENT)})).vertexArrayDestroyable=!1,l.referenceCount=1,s[e.id]=l,t.indices.indexBuffers=s}else++l.referenceCount;return new w({context:e,attributes:a,indexBuffer:l})},b._freeVertexArray=function(e){if(r(e)){var t=e.indexBuffer;e.destroy(),r(t)&&!t.isDestroyed()&&r(t.referenceCount)&&(--t.referenceCount,0===t.referenceCount&&t.destroy())}},b.prototype._findAncestorTileWithTerrainData=function(e){for(var t=e.parent;r(t)&&(!r(t.data)||!r(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling());)t=t.parent;return t},b.prototype._computeWaterMaskTranslationAndScale=function(e,t,i){var r=t.rectangle,n=e.rectangle,o=n.width,a=n.height,s=o/r.width,l=a/r.height;return i.x=s*(n.west-r.west)/o,i.y=l*(n.south-r.south)/a,i.z=s,i.w=l,i},b}.apply(t,r))||(e.exports=n)},746:function(e,t,i){var r,n;r=[i(17)],void 0===(n=function(e){"use strict";return e({FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6})}.apply(t,r))||(e.exports=n)},747:function(e,t,i){var r,n;r=[i(12),i(8),i(11),i(42),i(14),i(43),i(199),i(290)],void 0===(n=function(e,t,i,r,n,o,a,s){"use strict";var l={};var u=32.184,c=2451545;function d(e,t){t=r.addSeconds(e,u,t);var i,n=r.totalDays(t)-c;return t=r.addSeconds(t,(i=6.239996+.0172019696544*n,.001657*Math.sin(i+.01671*Math.sin(i))),t)}var h=new r(2451545,0,s.TAI),p=1e3,m=n.RADIANS_PER_DEGREE,f=n.RADIANS_PER_ARCSECOND,_=new o;function g(i,r,a,s,l,u,c){a<0&&(a=-a,l+=n.PI);var d=i*(1-r),h=s-l,p=l,m=function(e,t){return function(e,t){var i=Math.floor(e/n.TWO_PI);e-=i*n.TWO_PI;var r=Math.cos(e)-t,o=Math.sin(e)*Math.sqrt(1-t*t),a=Math.atan2(o,r);a=n.zeroToTwoPi(a),e<0&&(a-=n.TWO_PI);return a+=i*n.TWO_PI}(function(e,t){var i,r=Math.floor(e/n.TWO_PI),o=(e-=r*n.TWO_PI)+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),a=Number.MAX_VALUE;for(i=0;i<v&&Math.abs(a-o)>y;++i){var s=(a=o)-t*Math.sin(a)-e,l=1-t*Math.cos(a);o=a-s/l}return a=o+r*n.TWO_PI}(e,t),t)}(u-s,r);!function(e,t){if(e<=t)return"Circular";if(e<1-t)return"Elliptical";if(e<=1+t)return"Parabolic"}(r,0);!function(e,i,r,n){var a=Math.cos(e),s=Math.sin(e),l=Math.cos(i),u=Math.sin(i),c=Math.cos(r),d=Math.sin(r);t(n)?(n[0]=c*a-d*s*l,n[1]=d*a+c*s*l,n[2]=s*u,n[3]=-c*s-d*a*l,n[4]=-d*s+c*a*l,n[5]=a*u,n[6]=d*u,n[7]=-c*u,n[8]=l):n=new o(c*a-d*s*l,-c*s-d*a*l,d*u,d*a+c*s*l,-d*s+c*a*l,-c*u,s*u,a*u,l)}(h,a,p,_);var f=d*(1+r),g=Math.cos(m),x=Math.sin(m),w=f/(1+r*g);return t(c)?(c.x=w*g,c.y=w*x,c.z=0):c=new e(w*g,w*x,0),o.multiplyByVector(_,c,c)}var v=50,y=n.EPSILON8;var x=149598022260.7121,w=100.46645683*m,T=1295977422.83429*f,C=16002,E=21863,A=32004,S=10931,P=14529,b=16368,D=15318,O=32794,I=64e-7*14959787e4,M=-2273887.624,N=927506.794,F=14959787e4*-8e-7,R=32e-7*14959787e4,L=-613351.267,V=284235.953,U=-164557.657,z=-2243968.05,B=-688150.202,H=1017265.516,k=807828.498,G=14e-7*14959787e4,W=359034.888,Y=14959787e4*-28e-7,j=329115.314,X=10,Q=16002,q=21863,Z=10931,K=1473,J=32004,$=4387,ee=73,te=-325e-7,ie=-322e-7,re=1e-7*-79,ne=232*1e-7,oe=1e-7*-52,ae=97e-7,se=55e-7,le=-41e-7,ue=-105e-7,ce=-137e-7,de=258e-7,he=35e-7,pe=1e-7*-116,me=-88e-7,fe=-112e-7,_e=-8e-6,ge=new r(0,0,s.TAI);function ve(e,t){d(e,ge);var i=(ge.dayNumber-h.dayNumber+(ge.secondsOfDay-h.secondsOfDay)/a.SECONDS_PER_DAY)/a.DAYS_PER_JULIAN_CENTURY,r=i*i,n=r*i,o=n*i,s=383397.7725+.004*i,l=.055545526-1.6e-8*i,u=5.15668983*m,c=-8e-5*i+.02966*r-42e-6*n-1.3e-7*o,_=83.35324312*m,v=14643420.2669*i-38.2702*r-.045047*n+21301e-8*o,y=125.04455501*m,x=-6967919.3631*i+6.3602*r+.007625*n-3586e-8*o,w=218.31664563*m,T=1732559343.4847*i-6.391*r+.006588*n-3169e-8*o,C=297.85019547*m+f*(1602961601.209*i-6.3706*r+.006593*n-3169e-8*o),E=134.96340251*m+f*(1717915923.2178*i+31.8792*r+.051635*n-2447e-7*o),A=357.52910918*m+f*(129596581.0481*i-.5532*r+136e-6*n-1149e-8*o),S=310.17137918*m-f*(6967051.436*i+6.2068*r+.007618*n-3219e-8*o),P=2*C,b=4*C,D=6*C,O=2*E,I=3*E,M=4*E,N=2*(93.27209062*m+f*(1739527262.8478*i-12.7512*r-.001037*n+417e-8*o));s+=3400.4*Math.cos(P)-635.6*Math.cos(P-E)-235.6*Math.cos(E)+218.1*Math.cos(P-A)+181*Math.cos(P+E),l+=.014216*Math.cos(P-E)+.008551*Math.cos(P-O)-.001383*Math.cos(E)+.001356*Math.cos(P+E)-.001147*Math.cos(b-I)-914e-6*Math.cos(b-O)+869e-6*Math.cos(P-A-E)-627e-6*Math.cos(P)-394e-6*Math.cos(b-M)+282e-6*Math.cos(P-A-O)-279e-6*Math.cos(C-E)-236e-6*Math.cos(O)+231e-6*Math.cos(b)+229e-6*Math.cos(D-M)-201e-6*Math.cos(O-N),c+=486.26*Math.cos(P-N)-40.13*Math.cos(P)+37.51*Math.cos(N)+25.73*Math.cos(O-N)+19.97*Math.cos(P-A-N),v+=-55609*Math.sin(P-E)-34711*Math.sin(P-O)-9792*Math.sin(E)+9385*Math.sin(b-I)+7505*Math.sin(b-O)+5318*Math.sin(P+E)+3484*Math.sin(b-M)-3417*Math.sin(P-A-E)-2530*Math.sin(D-M)-2376*Math.sin(P)-2075*Math.sin(P-I)-1883*Math.sin(O)-1736*Math.sin(D-5*E)+1626*Math.sin(A)-1370*Math.sin(D-I),x+=-5392*Math.sin(P-N)-540*Math.sin(A)-441*Math.sin(P)+423*Math.sin(N)-288*Math.sin(O-N),T+=-3332.9*Math.sin(P)+1197.4*Math.sin(P-E)-662.5*Math.sin(A)+396.3*Math.sin(E)-218*Math.sin(P-A);var F=2*S,R=3*S;c+=46.997*Math.cos(S)*i-.614*Math.cos(P-N+S)*i+.614*Math.cos(P-N-S)*i-.0297*Math.cos(F)*r-.0335*Math.cos(S)*r+.0012*Math.cos(P-N+F)*r-16e-5*Math.cos(S)*n+4e-5*Math.cos(R)*n+4e-5*Math.cos(F)*n;var L=2.116*Math.sin(S)*i-.111*Math.sin(P-N-S)*i-.0015*Math.sin(S)*r;return v+=L,T+=L,x+=-520.77*Math.sin(S)*i+13.66*Math.sin(P-N+S)*i+1.12*Math.sin(P-S)*i-1.06*Math.sin(N-S)*i+.66*Math.sin(F)*r+.371*Math.sin(S)*r-.035*Math.sin(P-N+F)*r-.015*Math.sin(P-N+S)*r+.0014*Math.sin(S)*n-.0011*Math.sin(R)*n-9e-4*Math.sin(F)*n,g(s*=p,l,u+c*f,_+v*f,y+x*f,w+T*f,t)}var ye=-.01215058143522694;var xe=new o(1.0000000000000002,5.619723173785822e-16,4.690511510146299e-19,-5.154129427414611e-16,.9174820620691819,-.39777715593191376,-2.23970096136568e-16,.39777715593191376,.9174820620691819),we=new e;return l.computeSunPositionInEarthInertialFrame=function(i,n){return t(i)||(i=r.now()),t(n)||(n=new e),we=function(e,t){d(e,ge);var i=(ge.dayNumber-h.dayNumber+(ge.secondsOfDay-h.secondsOfDay)/a.SECONDS_PER_DAY)/(10*a.DAYS_PER_JULIAN_CENTURY),r=.3595362*i,n=x+I*Math.cos(C*r)+z*Math.sin(C*r)+M*Math.cos(E*r)+B*Math.sin(E*r)+N*Math.cos(A*r)+H*Math.sin(A*r)+F*Math.cos(S*r)+k*Math.sin(S*r)+R*Math.cos(P*r)+G*Math.sin(P*r)+L*Math.cos(b*r)+W*Math.sin(b*r)+V*Math.cos(D*r)+Y*Math.sin(D*r)+U*Math.cos(O*r)+j*Math.sin(O*r),o=w+T*i+te*Math.cos(X*r)+ue*Math.sin(X*r)+ie*Math.cos(Q*r)+ce*Math.sin(Q*r)+re*Math.cos(q*r)+de*Math.sin(q*r)+ne*Math.cos(Z*r)+he*Math.sin(Z*r)+oe*Math.cos(K*r)+pe*Math.sin(K*r)+ae*Math.cos(J*r)+me*Math.sin(J*r)+se*Math.cos($*r)+fe*Math.sin($*r)+le*Math.cos(ee*r)+_e*Math.sin(ee*r);return g(n,.0167086342-.0004203654*i,469.97289*f*i,102.93734808*m+11612.3529*f*i,174.87317577*m-8679.27034*f*i,o,t)}(i,we),n=e.negate(we,n),function(t,i){i=ve(t,i),e.multiplyByScalar(i,ye,i)}(i,we),e.subtract(n,we,n),o.multiplyByVector(xe,n,n),n},l.computeMoonPositionInEarthInertialFrame=function(e,i){return t(e)||(e=r.now()),i=ve(e,i),o.multiplyByVector(xe,i,i),i},l}.apply(t,r))||(e.exports=n)},748:function(e,t,i){var r;void 0===(r=function(){"use strict";return"attribute vec4 position;\nattribute vec2 textureCoordinates;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main() \n{\n    gl_Position = position;\n    v_textureCoordinates = textureCoordinates;\n}\n"}.call(t,i,t,e))||(e.exports=r)},749:function(e,t,i){var r,n;r=[i(12),i(22),i(67),i(9),i(8),i(20),i(11),i(750),i(1869),i(64),i(43),i(115),i(174),i(193),i(350),i(54),i(74),i(112)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g){"use strict";function v(e){e=r(e,r.EMPTY_OBJECT),this._camera=e.camera,this._color=r(e.color,t.CYAN),this._updateOnChange=r(e.updateOnChange,!0),this.show=r(e.show,!0),this.id=e.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}var y=new e,x=new c,w=new f,T=new p,C=new m,E=new d,A=new h,S=new t,P=[1,1e5];return v.prototype.update=function(r){if(this.show){var n,o,a=this._planesPrimitives,h=this._outlinePrimitives;if(this._updateOnChange){for(o=a.length,n=0;n<o;++n)h[n]=h[n]&&h[n].destroy(),a[n]=a[n]&&a[n].destroy();a.length=0,h.length=0}if(0===a.length){var v,b=this._camera,D=b.frustum;v=D instanceof p?T:D instanceof m?C:D instanceof d?E:A,v=D.clone(v);var O=r.frustumSplits,I=O.length-1;I<=0&&((O=P)[0]=this._camera.frustum.near,O[1]=this._camera.frustum.far,I=1);var M=b.positionWC,N=b.directionWC,F=b.upWC,R=b.rightWC;R=e.negate(R,y);var L=x;c.setColumn(L,0,R,L),c.setColumn(L,1,F,L),c.setColumn(L,2,N,L);var V=f.fromRotationMatrix(L,w);for(a.length=h.length=I,n=0;n<I;++n)v.near=O[n],v.far=O[n+1],a[n]=new g({geometryInstances:new u({geometry:new s({origin:M,orientation:V,frustum:v,_drawNearPlane:0===n}),attributes:{color:i.fromColor(t.fromAlpha(this._color,.1,S))},id:this.id,pickPrimitive:this}),appearance:new _({translucent:!0,flat:!0}),asynchronous:!1}),h[n]=new g({geometryInstances:new u({geometry:new l({origin:M,orientation:V,frustum:v,_drawNearPlane:0===n}),attributes:{color:i.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new _({translucent:!1,flat:!0}),asynchronous:!1})}for(o=a.length,n=0;n<o;++n)h[n].update(r),a[n].update(r)}},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){for(var e=this._planesPrimitives.length,t=0;t<e;++t)this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy(),this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy();return o(this)},v}.apply(t,r))||(e.exports=n)},750:function(e,t,i){var r,n;r=[i(33),i(12),i(49),i(16),i(34),i(9),i(8),i(52),i(53),i(65),i(43),i(28),i(115),i(193),i(45),i(54),i(76)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_){"use strict";var g=0,v=1;function y(e){var i,r,n=e.frustum,a=e.orientation,s=e.origin,l=o(e.vertexFormat,_.DEFAULT),u=o(e._drawNearPlane,!0);n instanceof p?(i=g,r=p.packedLength):n instanceof h&&(i=v,r=h.packedLength),this._frustumType=i,this._frustum=n.clone(),this._origin=t.clone(s),this._orientation=f.clone(a),this._drawNearPlane=u,this._vertexFormat=l,this._workerName="createFrustumGeometry",this.packedLength=2+r+t.packedLength+f.packedLength+_.packedLength}y.pack=function(e,i,r){r=o(r,0);var n=e._frustumType,a=e._frustum;return i[r++]=n,n===g?(p.pack(a,i,r),r+=p.packedLength):(h.pack(a,i,r),r+=h.packedLength),t.pack(e._origin,i,r),r+=t.packedLength,f.pack(e._orientation,i,r),r+=f.packedLength,_.pack(e._vertexFormat,i,r),i[r+=_.packedLength]=e._drawNearPlane?1:0,i};var x=new p,w=new h,T=new f,C=new t,E=new _;function A(e,t,i,r,n,o,s,l){for(var u=e/3*2,c=0;c<4;++c)a(t)&&(t[e]=o.x,t[e+1]=o.y,t[e+2]=o.z),a(i)&&(i[e]=s.x,i[e+1]=s.y,i[e+2]=s.z),a(r)&&(r[e]=l.x,r[e+1]=l.y,r[e+2]=l.z),e+=3;n[u]=0,n[u+1]=0,n[u+2]=1,n[u+3]=0,n[u+4]=1,n[u+5]=1,n[u+6]=0,n[u+7]=1}y.unpack=function(e,i,r){i=o(i,0);var n,s=e[i++];s===g?(n=p.unpack(e,i,x),i+=p.packedLength):(n=h.unpack(e,i,w),i+=h.packedLength);var l=t.unpack(e,i,C);i+=t.packedLength;var u=f.unpack(e,i,T);i+=f.packedLength;var c=_.unpack(e,i,E),d=1===e[i+=_.packedLength];if(!a(r))return new y({frustum:n,origin:l,orientation:u,vertexFormat:c,_drawNearPlane:d});var m=s===r._frustumType?r._frustum:void 0;return r._frustum=n.clone(m),r._frustumType=s,r._origin=t.clone(l,r._origin),r._orientation=f.clone(u,r._orientation),r._vertexFormat=_.clone(c,r._vertexFormat),r._drawNearPlane=d,r};var S=new c,P=new d,b=new d,D=new t,O=new t,I=new t,M=new t,N=new t,F=new t,R=new Array(3),L=new Array(4);L[0]=new i(-1,-1,1,1),L[1]=new i(1,-1,1,1),L[2]=new i(1,1,1,1),L[3]=new i(-1,1,1,1);for(var V=new Array(4),U=0;U<4;++U)V[U]=new i;return y._computeNearFarPlanes=function(e,r,n,s,l,u,h,p){var m=c.fromQuaternion(r,S),f=o(u,D),_=o(h,O),v=o(p,I);f=c.getColumn(m,0,f),_=c.getColumn(m,1,_),v=c.getColumn(m,2,v),t.normalize(f,f),t.normalize(_,_),t.normalize(v,v),t.negate(f,f);var y,x,w=d.computeView(e,v,_,f,P);if(n===g){var T=s.projectionMatrix,C=d.multiply(T,w,b);x=d.inverse(C,b)}else y=d.inverseTransformation(w,b);a(x)?(R[0]=s.near,R[1]=s.far):(R[0]=0,R[1]=s.near,R[2]=s.far);for(var E=0;E<2;++E)for(var A=0;A<4;++A){var M=i.clone(L[A],V[A]);if(a(x)){var N=1/(M=d.multiplyByVector(x,M,M)).w;t.multiplyByScalar(M,N,M),t.subtract(M,e,M),t.normalize(M,M);var F=t.dot(v,M);t.multiplyByScalar(M,R[E]/F,M),t.add(M,e,M)}else{a(s._offCenterFrustum)&&(s=s._offCenterFrustum);var U=R[E],z=R[E+1];M.x=.5*(M.x*(s.right-s.left)+s.left+s.right),M.y=.5*(M.y*(s.top-s.bottom)+s.bottom+s.top),M.z=.5*(M.z*(U-z)-U-z),M.w=1,d.multiplyByVector(y,M,M)}l[12*E+3*A]=M.x,l[12*E+3*A+1]=M.y,l[12*E+3*A+2]=M.z}},y.createGeometry=function(i){var r=i._frustumType,o=i._frustum,c=i._origin,d=i._orientation,h=i._drawNearPlane,p=i._vertexFormat,f=h?6:5,_=new Float64Array(72);y._computeNearFarPlanes(c,d,r,o,_);var g=24;_[g]=_[12],_[g+1]=_[13],_[g+2]=_[14],_[g+3]=_[0],_[g+4]=_[1],_[g+5]=_[2],_[g+6]=_[9],_[g+7]=_[10],_[g+8]=_[11],_[g+9]=_[21],_[g+10]=_[22],_[g+11]=_[23],_[g+=12]=_[15],_[g+1]=_[16],_[g+2]=_[17],_[g+3]=_[3],_[g+4]=_[4],_[g+5]=_[5],_[g+6]=_[0],_[g+7]=_[1],_[g+8]=_[2],_[g+9]=_[12],_[g+10]=_[13],_[g+11]=_[14],_[g+=12]=_[3],_[g+1]=_[4],_[g+2]=_[5],_[g+3]=_[15],_[g+4]=_[16],_[g+5]=_[17],_[g+6]=_[18],_[g+7]=_[19],_[g+8]=_[20],_[g+9]=_[6],_[g+10]=_[7],_[g+11]=_[8],_[g+=12]=_[6],_[g+1]=_[7],_[g+2]=_[8],_[g+3]=_[18],_[g+4]=_[19],_[g+5]=_[20],_[g+6]=_[21],_[g+7]=_[22],_[g+8]=_[23],_[g+9]=_[9],_[g+10]=_[10],_[g+11]=_[11],h||(_=_.subarray(12));var v=new u({position:new l({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:_})});if(a(p.normal)||a(p.tangent)||a(p.bitangent)||a(p.st)){var x=a(p.normal)?new Float32Array(12*f):void 0,w=a(p.tangent)?new Float32Array(12*f):void 0,T=a(p.bitangent)?new Float32Array(12*f):void 0,C=a(p.st)?new Float32Array(8*f):void 0,E=D,S=O,P=I,b=t.negate(E,M),R=t.negate(S,N),L=t.negate(P,F);g=0,h&&(A(g,x,w,T,C,L,E,S),g+=12),A(g,x,w,T,C,P,b,S),A(g+=12,x,w,T,C,b,L,S),A(g+=12,x,w,T,C,R,L,b),A(g+=12,x,w,T,C,E,P,S),A(g+=12,x,w,T,C,S,P,b),a(x)&&(v.normal=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:x})),a(w)&&(v.tangent=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:w})),a(T)&&(v.bitangent=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:T})),a(C)&&(v.st=new l({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:C}))}for(var V=new Uint16Array(6*f),U=0;U<f;++U){var z=6*U,B=4*U;V[z]=B,V[z+1]=B+1,V[z+2]=B+2,V[z+3]=B,V[z+4]=B+2,V[z+5]=B+3}return new s({attributes:v,indices:V,primitiveType:m.TRIANGLES,boundingSphere:e.fromVertices(_)})},y}.apply(t,r))||(e.exports=n)},751:function(e,t,i){var r,n;r=[i(62),i(22),i(8),i(20),i(61),i(123),i(103),i(66),i(55),i(56),i(88),i(63),i(114),i(96),i(89),i(1877),i(363),i(1878),i(156),i(207),i(208)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x){"use strict";function w(){this._colorTexture=void 0,this._depthStencilTexture=void 0,this._globeDepthTexture=void 0,this._tempGlobeDepthTexture=void 0,this._tempCopyDepthTexture=void 0,this.framebuffer=void 0,this._copyDepthFramebuffer=void 0,this._tempCopyDepthFramebuffer=void 0,this._updateDepthFramebuffer=void 0,this._clearColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._tempCopyDepthCommand=void 0,this._updateDepthCommand=void 0,this._viewport=new e,this._rs=void 0,this._rsUpdate=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useLogDepth=void 0,this._useHdr=void 0,this._debugGlobeDepthViewportCommand=void 0}function T(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy()}function C(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy(),e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}function E(e){e._tempCopyDepthFramebuffer=e._tempCopyDepthFramebuffer&&!e._tempCopyDepthFramebuffer.isDestroyed()&&e._tempCopyDepthFramebuffer.destroy(),e._updateDepthFramebuffer=e._updateDepthFramebuffer&&!e._updateDepthFramebuffer.isDestroyed()&&e._updateDepthFramebuffer.destroy(),e._tempGlobeDepthTexture=e._tempGlobeDepthTexture&&!e._tempGlobeDepthTexture.isDestroyed()&&e._tempGlobeDepthTexture.destroy()}function A(e,t,r,o,l){var u=e._colorTexture,f=!i(u)||u.width!==r||u.height!==o||l!==e._useHdr;i(e.framebuffer)&&!f||(T(e),C(e),function(e,t,i,r,o){var a=o?t.halfFloatingPointTexture?s.HALF_FLOAT:s.FLOAT:s.UNSIGNED_BYTE;e._colorTexture=new d({context:t,width:i,height:r,pixelFormat:n.RGBA,pixelDatatype:a,sampler:new c({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:m.NEAREST,magnificationFilter:p.NEAREST})}),e._depthStencilTexture=new d({context:t,width:i,height:r,pixelFormat:n.DEPTH_STENCIL,pixelDatatype:s.UNSIGNED_INT_24_8}),e._globeDepthTexture=new d({context:t,width:i,height:r,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new c({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:m.NEAREST,magnificationFilter:p.NEAREST})})}(e,t,r,o,l),function(e,t){e.framebuffer=new a({context:t,colorTextures:[e._colorTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._copyDepthFramebuffer=new a({context:t,colorTextures:[e._globeDepthTexture],destroyAttachments:!1})}(e,t))}function S(r,n,a,s,u){r._viewport.width=a,r._viewport.height=s;var c=!e.equals(r._viewport,u.viewport),d=c!==r._useScissorTest;r._useScissorTest=c,e.equals(r._scissorRectangle,u.viewport)||(r._scissorRectangle=e.clone(u.viewport,r._scissorRectangle),d=!0),i(r._rs)&&e.equals(r._viewport,r._rs.viewport)&&!d||(r._rs=l.fromCache({viewport:r._viewport,scissorTest:{enabled:r._useScissorTest,rectangle:r._scissorRectangle}}),r._rsUpdate=l.fromCache({viewport:r._viewport,scissorTest:{enabled:r._useScissorTest,rectangle:r._scissorRectangle},stencilTest:{enabled:!0,frontFunction:y.EQUAL,frontOperation:{fail:x.KEEP,zFail:x.KEEP,zPass:x.KEEP},backFunction:y.NEVER,reference:v.CESIUM_3D_TILE_MASK,mask:v.CESIUM_3D_TILE_MASK}})),i(r._copyDepthCommand)||(r._copyDepthCommand=n.createViewportQuadCommand(g,{uniformMap:{u_depthTexture:function(){return r._depthStencilTexture}},owner:r})),r._copyDepthCommand.framebuffer=r._copyDepthFramebuffer,r._copyDepthCommand.renderState=r._rs,i(r._copyColorCommand)||(r._copyColorCommand=n.createViewportQuadCommand(_,{uniformMap:{colorTexture:function(){return r._colorTexture}},owner:r})),r._copyColorCommand.renderState=r._rs,i(r._tempCopyDepthCommand)||(r._tempCopyDepthCommand=n.createViewportQuadCommand(g,{uniformMap:{u_depthTexture:function(){return r._tempCopyDepthTexture}},owner:r})),r._tempCopyDepthCommand.framebuffer=r._tempCopyDepthFramebuffer,r._tempCopyDepthCommand.renderState=r._rs,i(r._updateDepthCommand)||(r._updateDepthCommand=n.createViewportQuadCommand(_,{uniformMap:{colorTexture:function(){return r._tempGlobeDepthTexture}},owner:r})),r._updateDepthCommand.framebuffer=r._updateDepthFramebuffer,r._updateDepthCommand.renderState=r._rsUpdate,i(r._clearColorCommand)||(r._clearColorCommand=new o({color:new t(0,0,0,0),stencil:0,owner:r})),r._clearColorCommand.framebuffer=r.framebuffer}return w.prototype.executeDebugGlobeDepth=function(e,t,r){!function(e,t,r,n){if(!i(e._debugGlobeDepthViewportCommand)||n!==e._useLogDepth){var o=new u({defines:[n?"LOG_DEPTH":""],sources:["uniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"]});e._debugGlobeDepthViewportCommand=t.createViewportQuadCommand(o,{uniformMap:{u_depthTexture:function(){return e._globeDepthTexture}},owner:e}),e._useLogDepth=n}e._debugGlobeDepthViewportCommand.execute(t,r)}(this,e,t,r)},w.prototype.update=function(e,t,i,r){var n=i.width,o=i.height;A(this,e,n,o,r),S(this,e,n,o,t),e.uniformState.globeDepthTexture=void 0,this._useHdr=r},w.prototype.executeCopyDepth=function(e,t){i(this._copyDepthCommand)&&(this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._globeDepthTexture)},w.prototype.executeUpdateDepth=function(e,t,r){var o=t.framebuffer.depthStencilTexture;if(r||o!==this._depthStencilTexture){if(i(this._updateDepthCommand)){if(!i(this._updateDepthFramebuffer)||this._updateDepthFramebuffer.depthStencilTexture!==o||this._updateDepthFramebuffer.getColorTexture(0)!==this._globeDepthTexture){var l=this._globeDepthTexture.width,u=this._globeDepthTexture.height;E(this),function(e,t,i,r,o){e._tempGlobeDepthTexture=new d({context:t,width:i,height:r,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new c({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:m.NEAREST,magnificationFilter:p.NEAREST})}),e._tempCopyDepthFramebuffer=new a({context:t,colorTextures:[e._tempGlobeDepthTexture],destroyAttachments:!1}),e._updateDepthFramebuffer=new a({context:t,colorTextures:[e._globeDepthTexture],depthStencilTexture:o.framebuffer.depthStencilTexture,destroyAttachments:!1})}(this,e,l,u,t),S(this,e,l,u,t)}this._tempCopyDepthTexture=o,this._tempCopyDepthCommand.execute(e,t),this._updateDepthCommand.execute(e,t)}}else i(this._copyDepthCommand)&&this._copyDepthCommand.execute(e,t)},w.prototype.executeCopyColor=function(e,t){i(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},w.prototype.clear=function(e,r,n){var o=this._clearColorCommand;i(o)&&(t.clone(n,o.color),o.execute(e,r))},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){T(this),C(this),E(this),i(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),i(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy());var e=this._debugGlobeDepthViewportCommand;return i(e)&&(e.shaderProgram=e.shaderProgram.destroy()),r(this)},w}.apply(t,r))||(e.exports=n)},752:function(e,t,i){var r;void 0===(r=function(){"use strict";return"#define SAMPLES 8\n\nuniform float delta;\nuniform float sigma;\nuniform float direction; // 0.0 for x direction, 1.0 for y direction\n\nuniform sampler2D colorTexture;\n\n#ifdef USE_STEP_SIZE\nuniform float stepSize;\n#else\nuniform vec2 step;\n#endif\n\nvarying vec2 v_textureCoordinates;\n\n//  Incremental Computation of the Gaussian:\n//  https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch40.html\n\nvoid main()\n{\n    vec2 st = v_textureCoordinates;\n    vec2 dir = vec2(1.0 - direction, direction);\n\n#ifdef USE_STEP_SIZE\n    vec2 step = vec2(stepSize / czm_viewport.zw);\n#else\n    vec2 step = step;\n#endif\n\n    vec3 g;\n    g.x = 1.0 / (sqrt(czm_twoPi) * sigma);\n    g.y = exp((-0.5 * delta * delta) / (sigma * sigma));\n    g.z = g.y * g.y;\n\n    vec4 result = texture2D(colorTexture, st) * g.x;\n    for (int i = 1; i < SAMPLES; ++i)\n    {\n        g.xy *= g.yz;\n\n        vec2 offset = float(i) * dir * step;\n        result += texture2D(colorTexture, st - offset) * g.x;\n        result += texture2D(colorTexture, st + offset) * g.x;\n    }\n\n    gl_FragColor = result;\n}\n"}.call(t,i,t,e))||(e.exports=r)},753:function(e,t,i){var r,n;r=[i(62),i(16),i(22),i(58),i(72),i(9),i(8),i(10),i(20),i(11),i(14),i(61),i(37),i(251),i(66),i(55),i(88),i(56),i(63),i(96),i(89),i(114),i(18),i(499)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C){"use strict";function E(t){var r=(t=o(t,o.EMPTY_OBJECT)).fragmentShader,s=o(t.textureScale,1),l=o(t.pixelFormat,d.RGBA);this._fragmentShader=r,this._uniforms=t.uniforms,this._textureScale=s,this._forcePowerOfTwo=o(t.forcePowerOfTwo,!1),this._sampleMode=o(t.sampleMode,C.NEAREST),this._pixelFormat=l,this._pixelDatatype=o(t.pixelDatatype,m.UNSIGNED_BYTE),this._clearColor=o(t.clearColor,i.BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;var u=new p;u.scissorTest={enabled:!0,rectangle:a(t.scissorRectangle)?e.clone(t.scissorRectangle):new e},this._passState=u,this._ready=!1;var c=t.name;a(c)||(c=n()),this._name=c,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}s(E.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(a(this._textureCache)){var e=this._textureCache.getFramebuffer(this._name);if(a(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});var A=/uniform\s+sampler2D\s+depthTexture/g;function S(e,t,i){var r=t[i];return("string"==typeof r||r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof HTMLVideoElement||r instanceof ImageData)&&e._dirtyUniforms.push(i),{get:function(){return t[i]},set:function(r){var n=t[i];t[i]=r;var o=e._actualUniforms,s=o[i];a(s)&&s!==n&&s instanceof v&&!a(e._textureCache.getStageByName(i))&&(e._texturesToRelease.push(s),delete o[i],delete o[i+"Dimensions"]),n instanceof v&&e._texturesToRelease.push(n),"string"==typeof r||r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof HTMLVideoElement||r instanceof ImageData?e._dirtyUniforms.push(i):o[i]=r}}}function P(e,t){return function(){var i=e._actualUniforms[t];return"function"==typeof i?i():i}}function b(e,t){return function(){var i=e[t]();if(a(i))return i.dimensions}}function D(e,t){return function(i){e._texturesToCreate.push({name:t,source:i})}}function O(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function I(e){a(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();var t=e._textureCache;if(a(t)){var i=e._uniforms,r=e._actualUniforms;for(var n in r)r.hasOwnProperty(n)&&r[n]instanceof v&&(a(t.getStageByName(i[n]))||r[n].destroy(),e._dirtyUniforms.push(n))}}return E.prototype._isSupported=function(e){return!A.test(this._fragmentShader)||e.depthTexture},E.prototype.update=function(t,n){if(this.enabled===this._enabled||this.enabled||I(this),this._enabled=this.enabled,this._enabled&&(this._logDepthChanged=n!==this._useLogDepth,this._useLogDepth=n,this._selectedDirty=function(e){var t=a(e._selected)?e._selected.length:0,i=a(e._parentSelected)?e._parentSelected:0,r=e._selected!==e._selectedShadow||t!==e._selectedLength;if(r=r||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,a(e._selected)&&a(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):a(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!r&&a(e._combinedSelected)){if(!a(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var n=0;n<t;++n)if(e._combinedSelected[n]!==e._combinedSelectedShadow[n])return!0}return r}(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=a(this._selected)?this._selected.length:0,this._parentSelectedLength=a(this._parentSelected)?this._parentSelected.length:0,function(e,t){if(e._selectedDirty){e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;var r=e._combinedSelected;if(a(r)){var n,o,s,l=0,u=r.length;for(n=0;n<u;++n)o=r[n],a(o.pickIds)?l+=o.pickIds.length:a(o.pickId)&&++l;if(0===u||0===l){var c=new Uint8Array(4);return c[0]=255,c[1]=255,c[2]=255,c[3]=255,void(e._selectedIdTexture=new v({context:t,pixelFormat:d.RGBA,pixelDatatype:m.UNSIGNED_BYTE,source:{arrayBufferView:c,width:1,height:1},sampler:new _({wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE,minificationFilter:x.NEAREST,magnificationFilter:y.NEAREST})}))}var h=0,p=new Uint8Array(4*l);for(n=0;n<u;++n)if(o=r[n],a(o.pickIds))for(var f=o.pickIds,g=f.length,T=0;T<g;++T)s=f[T].color,p[h]=i.floatToByte(s.red),p[h+1]=i.floatToByte(s.green),p[h+2]=i.floatToByte(s.blue),p[h+3]=i.floatToByte(s.alpha),h+=4;else a(o.pickId)&&(s=o.pickId.color,p[h]=i.floatToByte(s.red),p[h+1]=i.floatToByte(s.green),p[h+2]=i.floatToByte(s.blue),p[h+3]=i.floatToByte(s.alpha),h+=4);e._selectedIdTexture=new v({context:t,pixelFormat:d.RGBA,pixelDatatype:m.UNSIGNED_BYTE,source:{arrayBufferView:p,width:l,height:1},sampler:new _({wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE,minificationFilter:x.NEAREST,magnificationFilter:y.NEAREST})})}}}(this,t),function(e){if(!a(e._uniformMap)){var t={},i={},n=e._uniforms,o=e._actualUniforms;for(var l in n)if(n.hasOwnProperty(l)){"function"!=typeof n[l]?(t[l]=P(e,l),i[l]=S(e,n,l)):(t[l]=n[l],i[l]=n[l]),o[l]=n[l];var u=t[l]();("string"==typeof u||u instanceof v||u instanceof HTMLImageElement||u instanceof HTMLCanvasElement||u instanceof HTMLVideoElement)&&(t[l+"Dimensions"]=b(t,l))}e._uniforms={},s(e._uniforms,i),e._uniformMap=r(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}}(this),function(e,t){var i,r,n,o=e._texturesToRelease,s=o.length;for(i=0;i<s;++i)r=(r=o[i])&&r.destroy();o.length=0;var l=e._texturesToCreate;for(s=l.length,i=0;i<s;++i){var u=l[i];n=u.name;var c=u.source;e._actualUniforms[n]=new v({context:t,source:c})}l.length=0;var d=e._dirtyUniforms;if(0!==d.length||a(e._texturePromise)){if(0!==d.length&&!a(e._texturePromise)){s=d.length;var p=e._uniforms,m=[];for(i=0;i<s;++i){var f=p[n=d[i]],_=e._textureCache.getStageByName(f);if(a(_))e._actualUniforms[n]=O(e,f);else if("string"==typeof f){var g=new h({url:f});m.push(g.fetchImage().then(D(e,n)))}else e._texturesToCreate.push({name:n,source:f})}d.length=0,m.length>0?(e._ready=!1,e._texturePromise=T.all(m).then(function(){e._ready=!0,e._texturePromise=void 0})):e._ready=!0}}else e._ready=!0}(this,t),function(e,t){if(!a(e._command)||e._logDepthChanged||e._selectedDirty){var i=e._fragmentShader;a(e._selectedIdTexture)&&(i="#define CZM_SELECTED_FEATURE \nuniform sampler2D czm_idTexture; \nuniform sampler2D czm_selectedIdTexture; \nuniform float czm_selectedIdTextureStep; \nvarying vec2 v_textureCoordinates; \nbool czm_selected(vec2 offset) \n{ \n    bool selected = false;\n    vec4 id = texture2D(czm_idTexture, v_textureCoordinates + offset); \n    for (int i = 0; i < "+e._selectedIdTexture.width+"; ++i) \n    { \n        vec4 selectedId = texture2D(czm_selectedIdTexture, vec2(float(i) * czm_selectedIdTextureStep, 0.5)); \n        if (all(equal(id, selectedId))) \n        { \n            return true; \n        } \n    } \n    return false; \n} \n\nbool czm_selected() \n{ \n    return czm_selected(vec2(0.0)); \n} \n\n"+(i=i.replace(/varying\s+vec2\s+v_textureCoordinates;/g,"")));var r=new g({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[i]});e._command=t.createViewportQuadCommand(r,{uniformMap:e._uniformMap,owner:e})}}(this,t),function(e){var t,i;e._sampleMode===C.LINEAR?(t=x.LINEAR,i=y.LINEAR):(t=x.NEAREST,i=y.NEAREST);var r=e._sampler;a(r)&&r.minificationFilter===t&&r.magnificationFilter===i||(e._sampler=new _({wrapS:w.CLAMP_TO_EDGE,wrapT:w.CLAMP_TO_EDGE,minificationFilter:t,magnificationFilter:i}))}(this),this._selectedDirty=!1,this._ready)){var o=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=o,a(o)){var l,u=o.getColorTexture(0);u.width===t.drawingBufferWidth&&u.height===t.drawingBufferHeight||(l=this._renderState,a(l)&&u.width===l.viewport.width&&u.height===l.viewport.height||(this._renderState=f.fromCache({viewport:new e(0,0,u.width,u.height)}))),this._command.renderState=l}}},E.prototype.execute=function(e,t,i,r){if(a(this._command)&&a(this._command.framebuffer)&&this._ready&&this._enabled){this._colorTexture=t,this._depthTexture=i,this._idTexture=r,_.equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);var n=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;a(n)&&(n.context=e),this._command.execute(e,n)}},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return I(this),l(this)},E}.apply(t,r))||(e.exports=n)},754:function(e,t,i){var r,n;r=[i(16),i(72),i(9),i(8),i(10),i(20)],void 0===(n=function(e,t,i,r,n,o){"use strict";function a(e){e=i(e,i.EMPTY_OBJECT),this._stages=e.stages,this._inputPreviousStageTexture=i(e.inputPreviousStageTexture,!0);var n=e.name;r(n)||(n=t()),this._name=n,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}return n(a.prototype,{ready:{get:function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)if(!e[i].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){for(var t=this._stages,i=t.length,r=0;r<i;++r)t[r].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}}),a.prototype._isSupported=function(e){for(var t=this._stages,i=t.length,r=0;r<i;++r)if(!t[r]._isSupported(e))return!1;return!0},a.prototype.get=function(e){return this._stages[e]},a.prototype.update=function(e,t){this._selectedDirty=function(e){var t=r(e._selected)?e._selected.length:0,i=r(e._parentSelected)?e._parentSelected:0,n=e._selected!==e._selectedShadow||t!==e._selectedLength;if(n=n||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,r(e._selected)&&r(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):r(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!n&&r(e._combinedSelected)){if(!r(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var o=0;o<t;++o)if(e._combinedSelected[o]!==e._combinedSelectedShadow[o])return!0}return n}(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=r(this._selected)?this._selected.length:0,this._parentSelectedLength=r(this._parentSelected)?this._parentSelected.length:0;for(var i=this._stages,n=i.length,o=0;o<n;++o){var a=i[o];this._selectedDirty&&(a.parentSelected=this._combinedSelected),a.update(e,t)}},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)e[i].destroy();return o(this)},a}.apply(t,r))||(e.exports=n)},755:function(e,t,i){var r,n;r=[i(22),i(8),i(14),i(20),i(123),i(103),i(63)],void 0===(n=function(e,t,i,r,n,o,a){"use strict";function s(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function l(e){for(;t(e.length);)e=e.get(e.length-1);return e.name}function u(e,i,r,n,o){if(!n.enabled||!n._isSupported(i))return o;var a=r[n.name]={};t(o)&&(a[l(e.getStageByName(o))]=!0);var s=n.uniforms;if(t(s))for(var u=Object.getOwnPropertyNames(s),c=u.length,d=0;d<c;++d){var h=s[u[d]];if("string"==typeof h){var p=e.getStageByName(h);t(p)&&(a[l(p)]=!0)}}return n.name}function c(e,i,r,n,o){if(t(n.enabled)&&!n.enabled||t(n._isSupported)&&!n._isSupported(i))return o;for(var a,s,d=o,h=!t(n.inputPreviousStageTexture)||n.inputPreviousStageTexture,p=o,m=n.length,f=0;f<m;++f){var _=n.get(f);p=t(_.length)?c(e,i,r,_,o):u(e,i,r,_,o),h&&(o=p)}if(h)for(a=1;a<m;++a)s=l(n.get(a)),t(r[s])||(r[s]={}),r[s][d]=!0;else for(a=1;a<m;++a)for(var g=r[s=l(n.get(a))],v=0;v<a;++v)g[l(n.get(v))]=!0;return p}function d(i,r,n){var o,a,s=i._collection.getStageByName(r),l=s._textureScale,u=s._forcePowerOfTwo,c=s._pixelFormat,d=s._pixelDatatype,h=s._clearColor,p=i._framebuffers,m=p.length;for(o=0;o<m;++o)if(l===(a=p[o]).textureScale&&u===a.forcePowerOfTwo&&c===a.pixelFormat&&d===a.pixelDatatype&&e.equals(h,a.clearColor)){for(var f=a.stages,_=f.length,g=!1,v=0;v<_;++v)if(n[f[v]]){g=!0;break}if(!g)break}return t(a)&&o<m?(a.stages.push(r),a):(a={textureScale:l,forcePowerOfTwo:u,pixelFormat:c,pixelDatatype:d,clearColor:h,stages:[r],buffer:void 0,clear:void 0},p.push(a),a)}function h(e,i){var r=function(e,i){var r={};if(t(e.ambientOcclusion)){var n=e.ambientOcclusion,o=e.bloom,a=e._tonemapping,s=e.fxaa,l=c(e,i,r,n,void 0);l=u(e,i,r,a,l=c(e,i,r,o,l)),u(e,i,r,s,l=c(e,i,r,e,l))}else c(e,i,r,e,void 0);return r}(e._collection,i);for(var n in r)r.hasOwnProperty(n)&&(e._stageNameToFramebuffer[n]=d(e,n,r[n]))}function p(e){for(var t=e._framebuffers,i=t.length,r=0;r<i;++r){var n=t[r];n.buffer=n.buffer&&n.buffer.destroy(),n.buffer=void 0}}return s.prototype.updateDependencies=function(){this._updateDependencies=!0},s.prototype.update=function(e){var r=this._collection,s=this._updateDependencies,l=t(r.ambientOcclusion)&&r.ambientOcclusion.enabled&&r.ambientOcclusion._isSupported(e),u=t(r.bloom)&&r.bloom.enabled&&r.bloom._isSupported(e),c=t(r._tonemapping)&&r._tonemapping.enabled&&r._tonemapping._isSupported(e),d=t(r.fxaa)&&r.fxaa.enabled&&r.fxaa._isSupported(e),m=!t(r._activeStages)||r._activeStages.length>0||l||u||c||d;if((s||!m&&this._framebuffers.length>0)&&(p(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),s||m){0===this._framebuffers.length&&h(this,e);var f=e.drawingBufferWidth,_=e.drawingBufferHeight,g=this._width!==f||this._height!==_;(s||g)&&(this._width=f,this._height=_,this._updateDependencies=!1,p(this),function(e,t){for(var r=e._width,s=e._height,l=e._framebuffers,u=l.length,c=0;c<u;++c){var d=l[c],h=d.textureScale,p=Math.ceil(r*h),m=Math.ceil(s*h),f=Math.min(p,m);d.forcePowerOfTwo&&(i.isPowerOfTwo(f)||(f=i.nextPowerOfTwo(f)),p=f,m=f),d.buffer=new o({context:t,colorTextures:[new a({context:t,width:p,height:m,pixelFormat:d.pixelFormat,pixelDatatype:d.pixelDatatype})]}),d.clear=new n({color:d.clearColor,framebuffer:d.buffer})}}(this,e))}},s.prototype.clear=function(e){for(var t=this._framebuffers,i=0;i<t.length;++i)t[i].clear.execute(e)},s.prototype.getStageByName=function(e){return this._collection.getStageByName(e)},s.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)},s.prototype.getFramebuffer=function(e){var i=this._stageNameToFramebuffer[e];if(t(i))return i.buffer},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return p(this),r(this)},s}.apply(t,r))||(e.exports=n)},756:function(e,t,i){var r,n;r=[i(17)],void 0===(n=function(e){"use strict";return e({LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4})}.apply(t,r))||(e.exports=n)},757:function(e,t,i){var r,n;r=[i(62),i(33),i(326),i(24),i(12),i(49),i(32),i(41),i(22),i(67),i(58),i(236),i(9),i(8),i(10),i(20),i(11),i(48),i(64),i(93),i(14),i(28),i(174),i(193),i(61),i(54),i(437),i(47),i(123),i(83),i(233),i(68),i(103),i(69),i(251),i(66),i(364),i(285),i(55),i(88),i(63),i(96),i(89),i(114),i(362),i(206),i(749),i(74),i(112),i(1910)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w,T,C,E,A,S,P,b,D,O,I,M,N,F,R,L,V,U,z,B,H,k,G,W,Y,j,X,Q,q){"use strict";function Z(e){var i=(e=h(e,h.EMPTY_OBJECT)).context;this._enabled=h(e.enabled,!0),this._softShadows=h(e.softShadows,!1),this._normalOffset=h(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=h(e.fromLightSource,!0),this.darkness=h(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=h(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var a,s=!0;(g.isInternetExplorer()||g.isEdge()||(g.isChrome()||g.isFirefox())&&g.isWindows()&&!i.depthTexture)&&(s=!1),this._polygonOffsetSupported=s,this._terrainBias={polygonOffset:s,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:s,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new w,this._shadowMapTexture=void 0,this._lightDirectionEC=new n,this._lightPositionEC=new o,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new me,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new t,this._isPointLight=h(e.isPointLight,!1),this._pointLightRadius=h(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&h(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?h(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new r,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new T:p(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new o,new o],this._cascadeMatrices=[new w,new w,new w,new w],this._cascadeDistances=new o,a=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(a);for(var u=0;u<a;++u)this._passes[u]=new K(i);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=i.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,$(this),this._clearCommand=new b({depth:1,color:new l}),this._clearPassState=new F(i),this._size=h(e.size,2048),this.size=this._size}function K(e){this.camera=new me,this.passState=new F(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function J(e,t){return U.fromCache({cull:{enabled:!0,face:Y.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function $(e){var t=!e._usesDepthTexture;e._primitiveRenderState=J(t,e._primitiveBias),e._terrainRenderState=J(t,e._terrainBias),e._pointRenderState=J(t,e._pointBias)}function ee(e){for(var t=e._passes.length,i=0;i<t;++i){var r=e._passes[i],n=r.framebuffer;p(n)&&!n.isDestroyed()&&n.destroy(),r.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function te(){return new z({wrapS:G.CLAMP_TO_EDGE,wrapT:G.CLAMP_TO_EDGE,minificationFilter:k.NEAREST,magnificationFilter:H.NEAREST})}function ie(e,t){e._isPointLight?function(e,t){for(var i=new L({context:t,width:e._textureSize.x,height:e._textureSize.y,format:V.DEPTH_COMPONENT16}),r=new O({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:E.RGBA,pixelDatatype:R.UNSIGNED_BYTE,sampler:te()}),n=[r.negativeX,r.negativeY,r.negativeZ,r.positiveX,r.positiveY,r.positiveZ],o=0;o<6;++o){var a=new M({context:t,depthRenderbuffer:i,colorTextures:[n[o]],destroyAttachments:!1}),s=e._passes[o];s.framebuffer=a,s.passState.framebuffer=a}e._shadowMapTexture=r,e._depthAttachment=i,e._colorAttachment=r}(e,t):e._usesDepthTexture?function(e,t){for(var i=new B({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:E.DEPTH_STENCIL,pixelDatatype:R.UNSIGNED_INT_24_8,sampler:te()}),r=new M({context:t,depthStencilTexture:i,destroyAttachments:!1}),n=e._passes.length,o=0;o<n;++o){var a=e._passes[o];a.framebuffer=r,a.passState.framebuffer=r}e._shadowMapTexture=i,e._depthAttachment=i}(e,t):function(e,t){for(var i=new L({context:t,width:e._textureSize.x,height:e._textureSize.y,format:V.DEPTH_COMPONENT16}),r=new B({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:E.RGBA,pixelDatatype:R.UNSIGNED_BYTE,sampler:te()}),n=new M({context:t,depthRenderbuffer:i,colorTextures:[r],destroyAttachments:!1}),o=e._passes.length,a=0;a<o;++a){var s=e._passes[a];s.framebuffer=n,s.passState.framebuffer=n}e._shadowMapTexture=r,e._depthAttachment=i,e._colorAttachment=r}(e,t)}function re(e,t){p(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(ee(e),ie(e,t),function(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==P.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,$(e),ee(e),ie(e,t))}(e,t),ne(e,t))}function ne(e,t,i){i=h(i,0),(e._isPointLight||0===i)&&(e._clearCommand.framebuffer=e._passes[i].framebuffer,e._clearCommand.execute(t,e._clearPassState))}Z.MAXIMUM_DISTANCE=2e4,Z.prototype.debugCreateRenderStates=function(){$(this)},m(Z.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(t){!function(t,i){t._size=i;var r=t._passes,n=r.length,o=t._textureSize;if(t._isPointLight){i=D.maximumCubeMapSize>=i?i:D.maximumCubeMapSize,o.x=i,o.y=i;var a=new e(0,0,i,i);r[0].passState.viewport=a,r[1].passState.viewport=a,r[2].passState.viewport=a,r[3].passState.viewport=a,r[4].passState.viewport=a,r[5].passState.viewport=a}else 1===n?(i=D.maximumTextureSize>=i?i:D.maximumTextureSize,o.x=i,o.y=i,r[0].passState.viewport=new e(0,0,i,i)):4===n&&(i=D.maximumTextureSize>=2*i?i:D.maximumTextureSize/2,o.x=2*i,o.y=2*i,r[0].passState.viewport=new e(0,0,i,i),r[1].passState.viewport=new e(i,0,i,i),r[2].passState.viewport=new e(0,i,i,i),r[3].passState.viewport=new e(i,i,i,i));t._clearPassState.viewport=new e(0,0,o.x,o.y);for(var s=0;s<n;++s){var l=r[s],u=l.passState.viewport,c=u.x/o.x,d=u.y/o.y,h=u.width/o.x,p=u.height/o.y;l.textureOffsets=new w(h,0,0,c,0,p,0,d,0,0,1,0,0,0,0,1)}}(this,t)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var oe=new e;function ae(t,i){var r=i.context,n=i.context.drawingBufferWidth,o=i.context.drawingBufferHeight,a=.3*Math.min(n,o),s=oe;s.x=n-a,s.y=0,s.width=a,s.height=a;var l=t._debugShadowViewCommand;p(l)||(l=function(e,t){var i;i=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var r=t.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return r.pass=N.OVERLAY,r}(t,r),t._debugShadowViewCommand=l),p(l.renderState)&&e.equals(l.renderState.viewport,s)||(l.renderState=U.fromCache({viewport:e.clone(s)})),i.commandList.push(t._debugShadowViewCommand)}var se=new Array(8);se[0]=new o(-1,-1,-1,1),se[1]=new o(1,-1,-1,1),se[2]=new o(1,1,-1,1),se[3]=new o(-1,1,-1,1),se[4]=new o(-1,-1,1,1),se[5]=new o(1,-1,1,1),se[6]=new o(1,1,1,1),se[7]=new o(-1,1,1,1);for(var le=new w,ue=new Array(8),ce=0;ce<8;++ce)ue[ce]=new o;var de=[l.RED,l.GREEN,l.BLUE,l.MAGENTA],he=new n;function pe(e,t){ae(e,t);var r=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(r&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new j({camera:e._sceneCamera,color:l.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){r&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new j({camera:e._shadowMapCamera,color:l.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(var o=0;o<e._numberOfCascades;++o)r&&(e._debugCascadeFrustums[o]=e._debugCascadeFrustums[o]&&e._debugCascadeFrustums[o].destroy(),e._debugCascadeFrustums[o]=new j({camera:e._passes[o].camera,color:de[o],updateOnChange:!1})),e._debugCascadeFrustums[o].update(t)}}else if(e._isPointLight){if(!p(e._debugLightFrustum)||e._needsUpdate){var a=e._shadowMapCamera.positionWC,s=A.IDENTITY,c=2*e._pointLightRadius,d=n.fromElements(c,c,c,he),h=w.fromTranslationQuaternionRotationScale(a,s,d,le);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=function(e,t){var r=new v({geometry:new i({minimum:new n(-.5,-.5,-.5),maximum:new n(.5,.5,.5)}),attributes:{color:u.fromColor(t)}}),o=new v({geometry:new S({radius:.5}),attributes:{color:u.fromColor(t)}});return new Q({geometryInstances:[r,o],appearance:new X({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}(h,l.YELLOW)}e._debugLightFrustum.update(t)}else p(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new j({camera:e._shadowMapCamera,color:l.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function me(){this.viewMatrix=new w,this.inverseViewMatrix=new w,this.frustum=void 0,this.positionCartographic=new a,this.positionWC=new n,this.directionWC=n.clone(n.UNIT_Z),this.upWC=n.clone(n.UNIT_Y),this.rightWC=n.clone(n.UNIT_X),this.viewProjectionMatrix=new w}me.prototype.clone=function(e){w.clone(e.viewMatrix,this.viewMatrix),w.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),a.clone(e.positionCartographic,this.positionCartographic),n.clone(e.positionWC,this.positionWC),n.clone(e.directionWC,this.directionWC),n.clone(e.upWC,this.upWC),n.clone(e.rightWC,this.rightWC)};var fe=new w(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);me.prototype.getViewProjection=function(){var e=this.viewMatrix,t=this.frustum.projectionMatrix;return w.multiply(t,e,this.viewProjectionMatrix),w.multiply(fe,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var _e=new Array(5),ge=new C,ve=new Array(4),ye=new n,xe=new n;var we=new w,Te=new n,Ce=new n,Ee=new n;var Ae=[new n(-1,0,0),new n(0,-1,0),new n(0,0,-1),new n(1,0,0),new n(0,1,0),new n(0,0,1)],Se=[new n(0,-1,0),new n(0,0,-1),new n(0,-1,0),new n(0,-1,0),new n(0,0,1),new n(0,-1,0)],Pe=[new n(0,0,1),new n(1,0,0),new n(-1,0,0),new n(0,0,-1),new n(1,0,0),new n(1,0,0)];var be=new n,De=new n,Oe=new t,Ie=Oe.center;function Me(e,i){var r=i.camera,o=e._lightCamera,a=e._sceneCamera,s=e._shadowMapCamera;e._cascadesEnabled?n.clone(o.directionWC,s.directionWC):e._isPointLight?n.clone(o.positionWC,s.positionWC):s.clone(o);var l,u,c=e._lightDirectionEC;w.multiplyByPointAsVector(r.viewMatrix,s.directionWC,c),n.normalize(c,c),n.negate(c,c),w.multiplyByPoint(r.viewMatrix,s.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(l=Math.min(i.shadowState.nearPlane,e.maximumDistance),u=Math.min(i.shadowState.farPlane,e.maximumDistance+1)):(l=r.frustum.near,u=e.maximumDistance),e._sceneCamera=W.clone(r,a),r.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=l,e._sceneCamera.frustum.far=u,e._distance=u-l,function(e,i){var r=e._sceneCamera,o=e._shadowMapCamera,a=Oe;if(e._cascadesEnabled){if(r.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);var s=i.mapProjection.ellipsoid.geodeticSurfaceNormal(r.positionWC,be),l=n.negate(o.directionWC,De),u=n.dot(s,l),c=x.clamp(u/.1,0,1);if(e._darkness=x.lerp(1,e.darkness,c),u<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)a.center=o.positionWC,a.radius=e._pointLightRadius,e._outOfView=i.cullingVolume.computeVisibility(a)===y.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(a),t.clone(a,e._boundingSphere);else{var d=o.frustum.far/2,h=n.add(o.positionWC,n.multiplyByScalar(o.directionWC,d,Ie),Ie);a.center=h,a.radius=d,e._outOfView=i.cullingVolume.computeVisibility(a)===y.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(a),t.clone(a,e._boundingSphere)}}(e,i),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}Z.prototype.update=function(e){if(Me(this,e),this._needsUpdate)if(re(this,e.context),this._isPointLight&&function(e,t){var i=new C;i.fov=x.PI_OVER_TWO,i.near=1,i.far=e._pointLightRadius,i.aspectRatio=1;for(var r=0;r<6;++r){var n=e._passes[r].camera;n.positionWC=e._shadowMapCamera.positionWC,n.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(n.positionWC,n.positionCartographic),n.directionWC=Ae[r],n.upWC=Se[r],n.rightWC=Pe[r],w.computeView(n.positionWC,n.directionWC,n.upWC,n.rightWC,n.viewMatrix),w.inverse(n.viewMatrix,n.inverseViewMatrix),n.frustum=i}}(this,e),this._cascadesEnabled&&(function(e,t){var i=e._shadowMapCamera,r=e._sceneCamera,a=w.multiply(r.frustum.projectionMatrix,r.viewMatrix,le),s=w.inverse(a,le),l=i.directionWC,u=r.directionWC,c=n.cross(l,u,Te);u=n.cross(c,l,Ce),n.normalize(u,u),n.normalize(c,c);for(var d=n.fromElements(0,0,0,Ee),h=w.computeView(d,l,u,c,we),p=w.multiply(h,s,le),m=n.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,ye),f=n.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,xe),_=0;_<8;++_){var g=o.clone(se[_],ue[_]);w.multiplyByVector(p,g,g),n.divideByScalar(g,g.w,g),n.minimumByComponent(g,m,m),n.maximumByComponent(g,f,f)}f.z+=1e3,m.z-=10;var v=Ee;v.x=-.5*(m.x+f.x),v.y=-.5*(m.y+f.y),v.z=-f.z;var y=w.fromTranslation(v,le);h=w.multiply(y,h,h);var x=.5*(f.x-m.x),T=.5*(f.y-m.y),C=f.z-m.z,E=i.frustum;E.left=-x,E.right=x,E.bottom=-T,E.top=T,E.near=.01,E.far=C,w.clone(h,i.viewMatrix),w.inverse(h,i.inverseViewMatrix),w.getTranslation(i.inverseViewMatrix,i.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),n.clone(l,i.directionWC),n.clone(u,i.upWC),n.clone(c,i.rightWC)}(this,e),this._numberOfCascades>1&&function(e,t){var i,r=e._shadowMapCamera,a=e._sceneCamera,s=a.frustum.near,l=a.frustum.far,u=e._numberOfCascades,c=l-s,d=l/s,h=.9,p=!1;t.shadowState.closestObjectSize<200&&(p=!0,h=.9);var m=ve,f=_e;for(f[0]=s,f[u]=l,i=0;i<u;++i){var _=(i+1)/u,g=s*Math.pow(d,_),v=s+c*_,y=x.lerp(v,g,h);f[i+1]=y,m[i]=y-f[i]}if(p){for(i=0;i<u;++i)m[i]=Math.min(m[i],e._maximumCascadeDistances[i]);var T=f[0];for(i=0;i<u-1;++i)T+=m[i],f[i+1]=T}o.unpack(f,0,e._cascadeSplits[0]),o.unpack(f,1,e._cascadeSplits[1]),o.unpack(m,0,e._cascadeDistances);var C=r.frustum,E=C.left,A=C.right,S=C.bottom,P=C.top,b=C.near,D=C.far,O=r.positionWC,I=r.directionWC,M=r.upWC,N=a.frustum.clone(ge),F=r.getViewProjection();for(i=0;i<u;++i){N.near=f[i],N.far=f[i+1];for(var R=w.multiply(N.projectionMatrix,a.viewMatrix,le),L=w.inverse(R,le),V=w.multiply(F,L,le),U=n.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,ye),z=n.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,xe),B=0;B<8;++B){var H=o.clone(se[B],ue[B]);w.multiplyByVector(V,H,H),n.divideByScalar(H,H.w,H),n.minimumByComponent(H,U,U),n.maximumByComponent(H,z,z)}U.x=Math.max(U.x,0),U.y=Math.max(U.y,0),U.z=0,z.x=Math.min(z.x,1),z.y=Math.min(z.y,1),z.z=Math.min(z.z,1);var k=e._passes[i],G=k.camera;G.clone(r);var W=G.frustum;W.left=E+U.x*(A-E),W.right=E+z.x*(A-E),W.bottom=S+U.y*(P-S),W.top=S+z.y*(P-S),W.near=b+U.z*(D-b),W.far=b+z.z*(D-b),k.cullingVolume=G.frustum.computeCullingVolume(O,I,M);var Y=e._cascadeMatrices[i];w.multiply(G.getViewProjection(),a.inverseViewMatrix,Y),w.multiply(k.textureOffsets,Y,Y)}}(this,e)),this._isPointLight)this._shadowMapCullingVolume=d.fromBoundingSphere(this._boundingSphere);else{var t=this._shadowMapCamera,i=t.positionWC,r=t.directionWC,a=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(i,r,a),1===this._passes.length&&this._passes[0].camera.clone(t)}if(1===this._passes.length){var s=this._sceneCamera.inverseViewMatrix;w.multiply(this._shadowMapCamera.getViewProjection(),s,this._shadowMapMatrix)}this.debugShow&&pe(this,e)},Z.prototype.updatePass=function(e,t){ne(this,e,t)};var Ne=new r;function Fe(e,t,i){var r=e._isPointLight?e._pointBias:i?e._terrainBias:e._primitiveBias,n={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=Ne;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,o.fromElements(t.x,t.y,r.depthBias,r.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return o.fromElements(r.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new o,combinedUniforms2:new o};return c(t,n,!1)}function Re(e,t,i,r,n,o){var a,l,u;if(p(o)&&(a=o.shaderProgram,l=o.renderState,u=o.uniformMap),(o=I.shallowClone(i,o)).castShadows=!0,o.receiveShadows=!1,!p(a)||n!==i.shaderProgram.id||t){var c=i.shaderProgram,d=i.pass===N.GLOBE,h=i.pass!==N.TRANSLUCENT,m=e._isPointLight,f=e._usesDepthTexture,_=q.getShadowCastShaderKeyword(m,d,f,h);if(a=r.shaderCache.getDerivedShaderProgram(c,_),!p(a)){var g=c.vertexShaderSource,v=c.fragmentShaderSource,y=q.createShadowCastVertexShader(g,m,d),x=q.createShadowCastFragmentShader(v,m,f,h);a=r.shaderCache.createDerivedShaderProgram(c,_,{vertexShaderSource:y,fragmentShaderSource:x,attributeLocations:c._attributeLocations})}l=e._primitiveRenderState,m?l=e._pointRenderState:d&&(l=e._terrainRenderState),i.renderState.cull.enabled||((l=s(l,!1)).cull=s(l.cull,!1),l.cull.enabled=!1,l=U.fromCache(l)),u=Fe(e,i.uniformMap,d)}return o.shaderProgram=a,o.renderState=l,o.uniformMap=u,o}return Z.createReceiveDerivedCommand=function(e,t,i,r,n){p(n)||(n={});var o=e.length>0,a=t.shaderProgram,s=a.vertexShaderSource,l=a.fragmentShaderSource,u=t.pass===N.GLOBE,c=!1;if(u&&(c=t.owner.data.renderedMesh.encoding.hasVertexNormals),t.receiveShadows&&o){var d,h;p(n.receiveCommand)&&(d=n.receiveCommand.shaderProgram,h=n.receiveCommand.uniformMap),n.receiveCommand=I.shallowClone(t,n.receiveCommand),n.castShadows=!1,n.receiveShadows=!0;var m=n.receiveShaderCastShadows!==t.castShadows,f=n.receiveShaderProgramId!==t.shaderProgram.id;if(!p(d)||f||i||m){var _=q.getShadowReceiveShaderKeyword(e[0],t.castShadows,u,c);if(d=r.shaderCache.getDerivedShaderProgram(a,_),!p(d)){var g=q.createShadowReceiveVertexShader(s,u,c),v=q.createShadowReceiveFragmentShader(l,e[0],t.castShadows,u,c);d=r.shaderCache.createDerivedShaderProgram(a,_,{vertexShaderSource:g,fragmentShaderSource:v,attributeLocations:a._attributeLocations})}h=Fe(e[0],t.uniformMap,u)}n.receiveCommand.shaderProgram=d,n.receiveCommand.uniformMap=h,n.receiveShaderProgramId=t.shaderProgram.id,n.receiveShaderCastShadows=t.castShadows}return n},Z.createCastDerivedCommand=function(e,t,i,r,n){if(p(n)||(n={}),t.castShadows){var o=n.castCommands;p(o)||(o=n.castCommands=[]);var a=n.castShaderProgramId,s=e.length;o.length=s;for(var l=0;l<s;++l)o[l]=Re(e[l],i,t,r,a,o[l]);n.castShaderProgramId=t.shaderProgram.id}return n},Z.prototype.isDestroyed=function(){return!1},Z.prototype.destroy=function(){ee(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return f(this)},Z}.apply(t,r))||(e.exports=n)},758:function(e,t,i){var r,n;r=[i(22),i(8),i(20),i(61),i(123),i(103),i(66),i(364),i(285),i(55),i(88),i(63),i(96),i(89),i(114)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m){"use strict";function f(){this._colorTexture=void 0,this._idTexture=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._framebuffer=void 0,this._idFramebuffer=void 0,this._idClearColor=new e(0,0,0,0),this._useHdr=void 0,this._clearCommand=new n({color:new e(0,0,0,0),depth:1,owner:this})}function _(e){e._framebuffer=e._framebuffer&&e._framebuffer.destroy(),e._idFramebuffer=e._idFramebuffer&&e._idFramebuffer.destroy(),e._colorTexture=e._colorTexture&&e._colorTexture.destroy(),e._idTexture=e._idTexture&&e._idTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy(),e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&e._depthStencilRenderbuffer.destroy(),e._depthStencilIdTexture=e._depthStencilIdTexture&&e._depthStencilIdTexture.destroy(),e._depthStencilIdRenderbuffer=e._depthStencilIdRenderbuffer&&e._depthStencilIdRenderbuffer.destroy(),e._framebuffer=void 0,e._idFramebuffer=void 0,e._colorTexture=void 0,e._idTexture=void 0,e._depthStencilTexture=void 0,e._depthStencilRenderbuffer=void 0,e._depthStencilIdTexture=void 0,e._depthStencilIdRenderbuffer=void 0}return f.prototype.update=function(e,i,n){var u=i.width,f=i.height,g=this._colorTexture;if(!t(g)||g.width!==u||g.height!==f||n!==this._useHdr){_(this),this._useHdr=n;var v=n?e.halfFloatingPointTexture?a.HALF_FLOAT:a.FLOAT:a.UNSIGNED_BYTE;this._colorTexture=new d({context:e,width:u,height:f,pixelFormat:r.RGBA,pixelDatatype:v,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})}),this._idTexture=new d({context:e,width:u,height:f,pixelFormat:r.RGBA,pixelDatatype:a.UNSIGNED_BYTE,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})}),e.depthTexture?(this._depthStencilTexture=new d({context:e,width:u,height:f,pixelFormat:r.DEPTH_STENCIL,pixelDatatype:a.UNSIGNED_INT_24_8,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})}),this._depthStencilIdTexture=new d({context:e,width:u,height:f,pixelFormat:r.DEPTH_STENCIL,pixelDatatype:a.UNSIGNED_INT_24_8,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})})):(this._depthStencilRenderbuffer=new s({context:e,width:u,height:f,format:l.DEPTH_STENCIL}),this._depthStencilIdRenderbuffer=new s({context:e,width:u,height:f,format:l.DEPTH_STENCIL})),this._framebuffer=new o({context:e,colorTextures:[this._colorTexture],depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}),this._idFramebuffer=new o({context:e,colorTextures:[this._idTexture],depthStencilTexture:this._depthStencilIdTexture,depthStencilRenderbuffer:this._depthStencilIdRenderbuffer,destroyAttachments:!1})}},f.prototype.clear=function(t,i,r){var n=i.framebuffer;i.framebuffer=this._framebuffer,e.clone(r,this._clearCommand.color),this._clearCommand.execute(t,i),i.framebuffer=this._idFramebuffer,e.clone(this._idClearColor,this._clearCommand.color),this._clearCommand.execute(t,i),i.framebuffer=n},f.prototype.getFramebuffer=function(){return this._framebuffer},f.prototype.getIdFramebuffer=function(){return this._idFramebuffer},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return _(this),i(this)},f}.apply(t,r))||(e.exports=n)},759:function(e,t,i){var r,n;r=[i(144),i(33),i(16),i(72),i(9),i(8),i(10),i(20),i(153),i(307),i(170),i(1939),i(500),i(1940),i(90),i(215),i(1941),i(1980),i(1981),i(1982),i(1983),i(1984)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p,m,f,_,g,v,y,x,w){"use strict";function T(e){this._displayID=r(),c.initializeTerrainHeights(),u.initializeTerrainHeights();var t=e.scene,i=e.dataSourceCollection;this._eventHelper=new l,this._eventHelper.add(i.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(i.dataSourceRemoved,this._onDataSourceRemoved,this),this._eventHelper.add(i.dataSourceMoved,this._onDataSourceMoved,this),this._dataSourceCollection=i,this._scene=t,this._visualizersCallback=n(e.visualizersCallback,T.defaultVisualizersCallback);var o=!1,a=new h,s=new h;i.length>0&&(t.primitives.add(a),t.groundPrimitives.add(s),o=!0),this._primitives=a,this._groundPrimitives=s;for(var d=0,p=i.length;d<p;d++)this._onDataSourceAdded(i,i.get(d));var m,_,g=new f;if(this._onDataSourceAdded(void 0,g),this._defaultDataSource=g,!o){var v=this,y=function(){t.primitives.add(a),t.groundPrimitives.add(s),m(),_(),v._removeDefaultDataSoureListener=void 0,v._removeDataSourceCollectionListener=void 0};m=g.entities.collectionChanged.addEventListener(y),_=i.dataSourceAdded.addEventListener(y)}this._removeDefaultDataSoureListener=m,this._removeDataSourceCollectionListener=_,this._ready=!1}T.defaultVisualizersCallback=function(e,t,i){var r=i.entities;return[new p(t,r),new _(e,r,i._primitives,i._groundPrimitives),new g(t,r),new v(e,r),new x(t,r),new y(e,r),new w(e,r,i._primitives,i._groundPrimitives)]},a(T.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}}),T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){this._eventHelper.removeAll();for(var e=this._dataSourceCollection,t=0,i=e.length;t<i;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),o(this._removeDefaultDataSoureListener)?(this._removeDefaultDataSoureListener(),this._removeDataSourceCollectionListener()):(this._scene.primitives.remove(this._primitives),this._scene.groundPrimitives.remove(this._groundPrimitives)),s(this)},T.prototype.update=function(t){if(!e.initialized)return this._ready=!1,!1;var i,r,n,a,s=!0,l=this._dataSourceCollection,u=l.length;for(i=0;i<u;i++){var c=l.get(i);for(o(c.update)&&(s=c.update(t)&&s),a=(n=c._visualizersByDisplayID[this._displayID]).length,r=0;r<a;r++)s=n[r].update(t)&&s}for(a=(n=this._defaultDataSource._visualizersByDisplayID[this._displayID]).length,r=0;r<a;r++)s=n[r].update(t)&&s;return this._ready=s,s};var C=[],E=new t;return T.prototype.getBoundingSphere=function(e,i,r){if(!this._ready)return m.PENDING;var n,a,s=this._defaultDataSource;if(!s.entities.contains(e)){s=void 0;var l=this._dataSourceCollection;for(a=l.length,n=0;n<a;n++){var u=l.get(n);if(u.entities.contains(e)){s=u;break}}}if(!o(s))return m.FAILED;var c=C,d=E,h=0,p=m.DONE,f=s._visualizers,_=f.length;for(n=0;n<_;n++){var g=f[n];if(o(g.getBoundingSphere)){if(p=f[n].getBoundingSphere(e,d),!i&&p===m.PENDING)return m.PENDING;p===m.DONE&&(c[h]=t.clone(d,c[h]),h++)}}return 0===h?m.FAILED:(c.length=h,t.fromBoundingSpheres(c,r),m.DONE)},T.prototype._onDataSourceAdded=function(e,t){var i=this._scene,r=this._primitives,n=this._groundPrimitives,o=r.add(new h),a=n.add(new d);t._primitives=o,t._groundPrimitives=a;var s=t.clustering;s._initialize(i),o.add(s);var l=this._visualizersCallback(i,s,t);t._visualizersByDisplayID=t._visualizersByDisplayID||{},t._visualizersByDisplayID[this._displayID]=l,t._visualizers=t._visualizers||[],t._visualizers=t._visualizers.concat(l)},T.prototype._onDataSourceRemoved=function(e,t){var i=this._primitives,r=this._groundPrimitives,n=t._primitives,a=t._groundPrimitives,s=t.clustering;n.remove(s);var l=t._visualizersByDisplayID[this._displayID];if(o(l)){for(var u=l.length,c=0;c<u;c++){var d=l[c];d.destroy();var h=t._visualizers.indexOf(d);t._visualizers.splice(h,1)}delete t._visualizersByDisplayID[this._displayID],i.remove(n),r.remove(a)}},T.prototype._onDataSourceMoved=function(e,t,i){var r=this._primitives,n=this._groundPrimitives,o=e._primitives,a=e._groundPrimitives;t===i+1?(r.raise(o),n.raise(a)):t===i-1?(r.lower(o),n.lower(a)):0===t?(r.lowerToBottom(o),n.lowerToBottom(a),r.raise(o),n.raise(a)):(r.raiseToTop(o),n.raiseToTop(a))},T}.apply(t,r))||(e.exports=n)},760:function(e,t,i){var r,n;r=[i(12),i(32),i(16),i(8),i(10),i(20),i(25),i(80),i(14),i(71),i(44),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d){"use strict";var h=new e,p=new t;function m(i,n,o,l){this._scene=i,this._heightReference=o,this._extrudedHeightReference=l,this._positionProperty=n,this._position=new e,this._cartographicPosition=new t,this._normal=new e,this._definitionChanged=new a,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;var u=this;if(r(i.globe)&&(this._removeEventListener=i.terrainProviderChanged.addEventListener(function(){u._updateClamping()}),this._removeModeListener=i.morphComplete.addEventListener(function(){u._updateClamping()})),n.isConstant){var c=n.getValue(s.MINIMUM_VALUE,h);if(!r(c)||e.equals(c,e.ZERO)||!r(i.globe))return;this._position=e.clone(c,this._position),this._updateClamping(),this._normal=i.globe.ellipsoid.geodeticSurfaceNormal(c,this._normal)}}return n(m.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),m.prototype._updateClamping=function(){r(this._removeCallbackFunc)&&this._removeCallbackFunc();var t=this._scene,i=t.globe,n=this._position;if(r(i)&&!e.equals(n,e.ZERO)){var o=i.ellipsoid,a=i._surface,s=this,l=o.cartesianToCartographic(n,this._cartographicPosition),u=i.getHeight(l);r(u)?this._terrainHeight=u:this._terrainHeight=0,this._removeCallbackFunc=a.updateHeight(l,function(e){if(t.mode===c.SCENE3D){var i=o.cartesianToCartographic(e,p);s._terrainHeight=i.height}else s._terrainHeight=e.x;s.definitionChanged.raiseEvent()})}else this._terrainHeight=0},m.prototype.getValue=function(t,i){var n=d.getValueOrDefault(this._heightReference,t,u.NONE),o=d.getValueOrDefault(this._extrudedHeightReference,t,u.NONE);if(n===u.NONE&&o!==u.RELATIVE_TO_GROUND)return this._position=e.clone(e.ZERO,this._position),e.clone(e.ZERO,i);if(this._positionProperty.isConstant)return e.multiplyByScalar(this._normal,this._terrainHeight,i);var a=this._scene,s=this._positionProperty.getValue(t,h);if(!r(s)||e.equals(s,e.ZERO)||!r(a.globe))return e.clone(e.ZERO,i);if(e.equalsEpsilon(this._position,s,l.EPSILON10))return e.multiplyByScalar(this._normal,this._terrainHeight,i);this._position=e.clone(s,this._position),this._updateClamping();var c=a.globe.ellipsoid.geodeticSurfaceNormal(s,this._normal);return e.multiplyByScalar(c,this._terrainHeight,i)},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return r(this._removeEventListener)&&this._removeEventListener(),r(this._removeModeListener)&&this._removeModeListener(),r(this._removeCallbackFunc)&&this._removeCallbackFunc(),o(this)},m}.apply(t,r))||(e.exports=n)},761:function(e,t,i){var r,n;r=[i(12),i(197),i(8),i(14),i(43),i(244),i(502),i(54)],void 0===(n=function(e,t,i,r,n,o,a,s){"use strict";var l={},u=new e,c=new e,d=new e,h=new e,p=[new e,new e],m=new e,f=new e,_=new e,g=new e,v=new e,y=new e,x=new e,w=new e,T=new e,C=new e,E=new s,A=new n;function S(i,o,a,l,d){var h,p=e.angleBetween(e.subtract(o,i,u),e.subtract(a,i,c)),m=l===t.BEVELED?1:Math.ceil(p/r.toRadians(5))+1,f=3*m,_=new Array(f);_[f-3]=a.x,_[f-2]=a.y,_[f-1]=a.z,h=d?n.fromQuaternion(s.fromAxisAngle(e.negate(i,u),p/m,E),A):n.fromQuaternion(s.fromAxisAngle(i,p/m,E),A);var g=0;o=e.clone(o,u);for(var v=0;v<m;v++)o=n.multiplyByVector(h,o,o),_[g++]=o.x,_[g++]=o.y,_[g++]=o.z;return _}function P(t,i,r,n){var o=u;return n?o=e.add(t,i,o):(i=e.negate(i,i),o=e.add(t,i,o)),[o.x,o.y,o.z,r.x,r.y,r.z]}function b(t,i,r,n){for(var o=new Array(t.length),a=new Array(t.length),s=e.multiplyByScalar(i,r,u),l=e.negate(s,c),p=0,m=t.length-1,f=0;f<t.length;f+=3){var _=e.fromArray(t,f,d),g=e.add(_,l,h);o[p++]=g.x,o[p++]=g.y,o[p++]=g.z;var v=e.add(_,s,h);a[m--]=v.z,a[m--]=v.y,a[m--]=v.x}return n.push(o,a),n}l.addAttribute=function(e,t,r,n){var o=t.x,a=t.y,s=t.z;i(r)&&(e[r]=o,e[r+1]=a,e[r+2]=s),i(n)&&(e[n]=s,e[n-1]=a,e[n-2]=o)};var D=new e,O=new e;return l.computePositions=function(i){var n=i.granularity,s=i.positions,l=i.ellipsoid,c=i.width/2,d=i.cornerType,h=i.saveAttributes,E=m,A=f,I=_,M=g,N=v,F=y,R=x,L=w,V=T,U=C,z=[],B=h?[]:void 0,H=h?[]:void 0,k=s[0],G=s[1];A=e.normalize(e.subtract(G,k,A),A),E=l.geodeticSurfaceNormal(k,E),M=e.normalize(e.cross(E,A,M),M),h&&(B.push(M.x,M.y,M.z),H.push(E.x,E.y,E.z)),R=e.clone(k,R),k=G,I=e.negate(A,I);var W,Y,j=[],X=s.length;for(W=1;W<X-1;W++){E=l.geodeticSurfaceNormal(k,E),G=s[W+1],A=e.normalize(e.subtract(G,k,A),A),N=e.normalize(e.add(A,I,N),N);var Q=e.multiplyByScalar(E,e.dot(A,E),D);e.subtract(A,Q,Q),e.normalize(Q,Q);var q=e.multiplyByScalar(E,e.dot(I,E),O);if(e.subtract(I,q,q),e.normalize(q,q),!r.equalsEpsilon(Math.abs(e.dot(Q,q)),1,r.EPSILON7)){N=e.cross(N,E,N),N=e.cross(E,N,N),N=e.normalize(N,N);var Z=c/Math.max(.25,e.magnitude(e.cross(N,I,u))),K=a.angleIsGreaterThanPi(A,I,k,l);N=e.multiplyByScalar(N,Z,N),K?(L=e.add(k,N,L),U=e.add(L,e.multiplyByScalar(M,c,U),U),V=e.add(L,e.multiplyByScalar(M,2*c,V),V),p[0]=e.clone(R,p[0]),p[1]=e.clone(U,p[1]),z=b(o.generateArc({positions:p,granularity:n,ellipsoid:l}),M,c,z),h&&(B.push(M.x,M.y,M.z),H.push(E.x,E.y,E.z)),F=e.clone(V,F),M=e.normalize(e.cross(E,A,M),M),V=e.add(L,e.multiplyByScalar(M,2*c,V),V),R=e.add(L,e.multiplyByScalar(M,c,R),R),d===t.ROUNDED||d===t.BEVELED?j.push({leftPositions:S(L,F,V,d,K)}):j.push({leftPositions:P(k,e.negate(N,N),V,K)})):(V=e.add(k,N,V),U=e.add(V,e.negate(e.multiplyByScalar(M,c,U),U),U),L=e.add(V,e.negate(e.multiplyByScalar(M,2*c,L),L),L),p[0]=e.clone(R,p[0]),p[1]=e.clone(U,p[1]),z=b(o.generateArc({positions:p,granularity:n,ellipsoid:l}),M,c,z),h&&(B.push(M.x,M.y,M.z),H.push(E.x,E.y,E.z)),F=e.clone(L,F),M=e.normalize(e.cross(E,A,M),M),L=e.add(V,e.negate(e.multiplyByScalar(M,2*c,L),L),L),R=e.add(V,e.negate(e.multiplyByScalar(M,c,R),R),R),d===t.ROUNDED||d===t.BEVELED?j.push({rightPositions:S(V,F,L,d,K)}):j.push({rightPositions:P(k,N,L,K)})),I=e.negate(A,I)}k=G}return E=l.geodeticSurfaceNormal(k,E),p[0]=e.clone(R,p[0]),p[1]=e.clone(k,p[1]),z=b(o.generateArc({positions:p,granularity:n,ellipsoid:l}),M,c,z),h&&(B.push(M.x,M.y,M.z),H.push(E.x,E.y,E.z)),d===t.ROUNDED&&(Y=function(i){var r=m,n=f,o=_,a=i[1];n=e.fromArray(i[1],a.length-3,n),o=e.fromArray(i[0],0,o);var s=S(r=e.midpoint(n,o,r),n,o,t.ROUNDED,!1),l=i.length-1,u=i[l-1];return a=i[l],n=e.fromArray(u,u.length-3,n),o=e.fromArray(a,0,o),[s,S(r=e.midpoint(n,o,r),n,o,t.ROUNDED,!1)]}(z)),{positions:z,corners:j,lefts:B,normals:H,endPositions:Y}},l}.apply(t,r))||(e.exports=n)},762:function(e,t,i){var r,n;r=[i(14)],void 0===(n=function(e){"use strict";var t={computePositions:function(t,i,r,n,o){var a,s=.5*t,l=-s,u=n+n,c=new Float64Array(3*(o?2*u:u)),d=0,h=0,p=o?3*u:0,m=o?3*(u+n):3*n;for(a=0;a<n;a++){var f=a/n*e.TWO_PI,_=Math.cos(f),g=Math.sin(f),v=_*r,y=g*r,x=_*i,w=g*i;c[h+p]=v,c[h+p+1]=y,c[h+p+2]=l,c[h+m]=x,c[h+m+1]=w,c[h+m+2]=s,h+=3,o&&(c[d++]=v,c[d++]=y,c[d++]=l,c[d++]=x,c[d++]=w,c[d++]=s)}return c}};return t}.apply(t,r))||(e.exports=n)},763:function(e,t,i){var r,n;r=[i(81),i(8),i(90)],void 0===(n=function(e,t,i){"use strict";function r(t,i){this._primitives=t,this._orderedGroundPrimitives=i,this._dynamicUpdaters=new e}return r.prototype.add=function(e,t){this._dynamicUpdaters.set(t.id,t.createDynamicUpdater(this._primitives,this._orderedGroundPrimitives))},r.prototype.remove=function(e){var i=e.id,r=this._dynamicUpdaters.get(i);t(r)&&(this._dynamicUpdaters.remove(i),r.destroy())},r.prototype.update=function(e){for(var t=this._dynamicUpdaters.values,i=0,r=t.length;i<r;i++)t[i].update(e);return!0},r.prototype.removeAllPrimitives=function(){for(var e=this._dynamicUpdaters.values,t=0,i=e.length;t<i;t++)e[t].destroy();this._dynamicUpdaters.removeAll()},r.prototype.getBoundingSphere=function(e,r){return e=this._dynamicUpdaters.get(e.id),t(e)&&t(e.getBoundingSphere)?e.getBoundingSphere(r):i.FAILED},r}.apply(t,r))||(e.exports=n)},764:function(e,t,i){var r,n;r=[i(12),i(14),i(43),i(54)],void 0===(n=function(e,t,i,r){"use strict";var n={},o=new e,a=new e,s=new r,l=new i;function u(t,n,u,c,d,h,p,m,f,_){var g=t+n;e.multiplyByScalar(c,Math.cos(g),o),e.multiplyByScalar(u,Math.sin(g),a),e.add(o,a,o);var v=Math.cos(t);v*=v;var y=Math.sin(t);y*=y;var x=h/Math.sqrt(p*v+d*y)/m;return r.fromAxisAngle(o,x,s),i.fromQuaternion(s,l),i.multiplyByVector(l,f,_),e.normalize(_,_),e.multiplyByScalar(_,m,_),_}var c=new e,d=new e,h=new e,p=new e;n.raisePositionsToHeight=function(t,i,r){for(var n=i.ellipsoid,o=i.height,a=i.extrudedHeight,s=r?t.length/3*2:t.length/3,l=new Float64Array(3*s),u=t.length,m=r?u:0,f=0;f<u;f+=3){var _=f+1,g=f+2,v=e.fromArray(t,f,c);n.scaleToGeodeticSurface(v,v);var y=e.clone(v,d),x=n.geodeticSurfaceNormal(v,p),w=e.multiplyByScalar(x,o,h);e.add(v,w,v),r&&(e.multiplyByScalar(x,a,w),e.add(y,w,y),l[f+m]=y.x,l[_+m]=y.y,l[g+m]=y.z),l[f]=v.x,l[_]=v.y,l[g]=v.z}return l};var m=new e,f=new e,_=new e;return n.computeEllipsePositions=function(i,r,n){var o=i.semiMinorAxis,a=i.semiMajorAxis,s=i.rotation,l=i.center,p=8*i.granularity,g=o*o,v=a*a,y=a*o,x=e.magnitude(l),w=e.normalize(l,m),T=e.cross(e.UNIT_Z,l,f);T=e.normalize(T,T);var C=e.cross(w,T,_),E=1+Math.ceil(t.PI_OVER_TWO/p),A=t.PI_OVER_TWO/(E-1),S=t.PI_OVER_TWO-E*A;S<0&&(E-=Math.ceil(Math.abs(S)/A));var P,b,D,O,I,M=r?new Array(3*(E*(E+2)*2)):void 0,N=0,F=c,R=d,L=4*E*3,V=L-1,U=0,z=n?new Array(L):void 0;for(F=u(S=t.PI_OVER_TWO,s,C,T,g,y,v,x,w,F),r&&(M[N++]=F.x,M[N++]=F.y,M[N++]=F.z),n&&(z[V--]=F.z,z[V--]=F.y,z[V--]=F.x),S=t.PI_OVER_TWO-A,P=1;P<E+1;++P){if(F=u(S,s,C,T,g,y,v,x,w,F),R=u(Math.PI-S,s,C,T,g,y,v,x,w,R),r){for(M[N++]=F.x,M[N++]=F.y,M[N++]=F.z,D=2*P+2,b=1;b<D-1;++b)O=b/(D-1),I=e.lerp(F,R,O,h),M[N++]=I.x,M[N++]=I.y,M[N++]=I.z;M[N++]=R.x,M[N++]=R.y,M[N++]=R.z}n&&(z[V--]=F.z,z[V--]=F.y,z[V--]=F.x,z[U++]=R.x,z[U++]=R.y,z[U++]=R.z),S=t.PI_OVER_TWO-(P+1)*A}for(P=E;P>1;--P){if(F=u(-(S=t.PI_OVER_TWO-(P-1)*A),s,C,T,g,y,v,x,w,F),R=u(S+Math.PI,s,C,T,g,y,v,x,w,R),r){for(M[N++]=F.x,M[N++]=F.y,M[N++]=F.z,D=2*(P-1)+2,b=1;b<D-1;++b)O=b/(D-1),I=e.lerp(F,R,O,h),M[N++]=I.x,M[N++]=I.y,M[N++]=I.z;M[N++]=R.x,M[N++]=R.y,M[N++]=R.z}n&&(z[V--]=F.z,z[V--]=F.y,z[V--]=F.x,z[U++]=R.x,z[U++]=R.y,z[U++]=R.z)}F=u(-(S=t.PI_OVER_TWO),s,C,T,g,y,v,x,w,F);var B={};return r&&(M[N++]=F.x,M[N++]=F.y,M[N++]=F.z,B.positions=M,B.numPts=E),n&&(z[V--]=F.z,z[V--]=F.y,z[V--]=F.x,B.outerPositions=z),B},n}.apply(t,r))||(e.exports=n)},765:function(e,t,i){var r,n;r=[i(8),i(24),i(12),i(16),i(145),i(14),i(43),i(120)],void 0===(n=function(e,t,i,r,n,o,a,s){"use strict";var l={},u=new i,c=new i,d=new i,h=new i,p=new s;function m(e,r,n,o,a){var s=i.subtract(e,r,u),l=i.dot(n,s),c=i.dot(o,s);return t.fromElements(l,c,a)}return l.validOutline=function(e){var t=s.fromPoints(e,p).halfAxes,r=a.getColumn(t,0,c),n=a.getColumn(t,1,d),o=a.getColumn(t,2,h),l=i.magnitude(r),u=i.magnitude(n),m=i.magnitude(o);return!(0===l&&(0===u||0===m)||0===u&&0===m)},l.computeProjectTo2DArguments=function(e,t,r,n){var o,l,u=s.fromPoints(e,p),m=u.halfAxes,f=a.getColumn(m,0,c),_=a.getColumn(m,1,d),g=a.getColumn(m,2,h),v=i.magnitude(f),y=i.magnitude(_),x=i.magnitude(g),w=Math.min(v,y,x);return(0!==v||0!==y&&0!==x)&&(0!==y||0!==x)&&(w!==y&&w!==x||(o=f),w===v?o=_:w===x&&(l=_),w!==v&&w!==y||(l=g),i.normalize(o,r),i.normalize(l,n),i.clone(u.center,t),!0)},l.createProjectPointsTo2DFunction=function(e,t,i){return function(r){for(var n=new Array(r.length),o=0;o<r.length;o++)n[o]=m(r[o],e,t,i);return n}},l.createProjectPointTo2DFunction=function(e,t,i){return function(r,n){return m(r,e,t,i,n)}},l}.apply(t,r))||(e.exports=n)},766:function(e,t,i){var r,n;r=[i(81),i(12),i(22),i(67),i(8),i(84),i(97),i(147),i(91),i(112),i(90),i(75),i(198),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p){"use strict";var m=new i,f=new o,_=new o,g=t.ZERO,v=new t;function y(t,i,r,o,a,s,l){var u;this.translucent=i,this.appearanceType=r,this.depthFailAppearanceType=o,this.depthFailMaterialProperty=a,this.depthFailMaterial=void 0,this.closed=s,this.shadows=l,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.subscriptions=new e,this.showsUpdated=new e,this.itemsToRemove=[],this.invalidated=!1,n(a)&&(u=a.definitionChanged.addEventListener(y.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=u}function x(e,t,i,r,n){this._solidItems=[],this._translucentItems=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=r,this._shadows=n}function w(e,t){for(var i=e.length-1;i>=0;i--){var r=e[i];if(r.remove(t))return 0===r.updaters.length&&(e.splice(i,1),r.destroy()),!0}return!1}function T(e,t,i){for(var r=!1,n=t.length,o=0;o<n;++o){var a=t[o],s=a.itemsToRemove,l=s.length;if(l>0)for(o=0;o<l;o++){var u=s[o];a.remove(u),e.add(i,u),r=!0}}return r}function C(e,t,i,r){var n,o=t.length;for(n=o-1;n>=0;n--){var a=t[n];if(a.invalidated){t.splice(n,1);for(var s=a.updaters.values,l=s.length,u=0;u<l;u++)e.add(i,s[u]);a.destroy()}}for(o=t.length,n=0;n<o;++n)r=t[n].update(i)&&r;return r}function E(e,t,i){for(var r=e.length,n=0;n<r;n++){var o=e[n];if(o.contains(t))return o.getBoundingSphere(t,i)}return c.FAILED}function A(e){for(var t=e.length,i=0;i<t;i++)e[i].destroy();e.length=0}return y.prototype.onMaterialChanged=function(){this.invalidated=!0},y.prototype.isMaterial=function(e){var t=this.depthFailMaterialProperty,i=e.depthFailMaterialProperty;return i===t||!!n(t)&&t.equals(i)},y.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&p.isConstant(e.distanceDisplayConditionProperty)&&p.isConstant(e.terrainOffsetProperty)){var r=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener(function(t,i,n,o){"isShowing"===i&&r.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(i,e)},y.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return n(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},y.prototype.update=function(e){var c,y=!0,x=0,w=this.primitive,T=this.primitives;if(this.createPrimitive){var C=this.geometry.values;if(C.length>0){var E;n(w)&&(n(this.oldPrimitive)?T.remove(w):this.oldPrimitive=w),n(this.depthFailAppearanceType)&&(n(this.depthFailMaterialProperty)&&(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)),E=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),w=new u({show:!1,asynchronous:!0,geometryInstances:C,appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:E,shadows:this.shadows}),T.add(w),y=!1}else{n(w)&&(T.remove(w),w=void 0);var A=this.oldPrimitive;n(A)&&(T.remove(A),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=w,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(n(w)&&w.ready){w.show=!0,n(this.oldPrimitive)&&(T.remove(this.oldPrimitive),this.oldPrimitive=void 0),!n(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof d||(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var S=this.updatersWithAttributes.values,P=S.length,b=this.waitingOnCreate;for(c=0;c<P;c++){var D=S[c],O=this.geometry.get(D.id),I=this.attributes.get(O.id.id);if(n(I)||(I=w.getGeometryInstanceAttributes(O.id),this.attributes.set(O.id.id,I)),!D.fillMaterialProperty.isConstant||b){var M=D.fillMaterialProperty.color,N=p.getValueOrDefault(M,e,i.WHITE,m);i.equals(I._lastColor,N)||(I._lastColor=i.clone(N,I._lastColor),I.color=r.toValue(N,I.color),(this.translucent&&255===I.color[3]||!this.translucent&&255!==I.color[3])&&(this.itemsToRemove[x++]=D))}if(n(this.depthFailAppearanceType)&&D.depthFailMaterialProperty instanceof d&&(!D.depthFailMaterialProperty.isConstant||b)){var F=D.depthFailMaterialProperty.color,R=p.getValueOrDefault(F,e,i.WHITE,m);i.equals(I._lastDepthFailColor,R)||(I._lastDepthFailColor=i.clone(R,I._lastDepthFailColor),I.depthFailColor=r.toValue(R,I.depthFailColor))}var L=D.entity.isShowing&&(D.hasConstantFill||D.isFilled(e));L!==(1===I.show[0])&&(I.show=l.toValue(L,I.show));var V=D.distanceDisplayConditionProperty;if(!p.isConstant(V)){var U=p.getValueOrDefault(V,e,_,f);o.equals(U,I._lastDistanceDisplayCondition)||(I._lastDistanceDisplayCondition=o.clone(U,I._lastDistanceDisplayCondition),I.distanceDisplayCondition=a.toValue(U,I.distanceDisplayCondition))}var z=D.terrainOffsetProperty;if(!p.isConstant(z)){var B=p.getValueOrDefault(z,e,g,v);t.equals(B,I._lastOffset)||(I._lastOffset=t.clone(B,I._lastOffset),I.offset=s.toValue(B,I.offset))}}this.updateShows(w),this.waitingOnCreate=!1}else n(w)&&!w.ready&&(y=!1);return this.itemsToRemove.length=x,y},y.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,r=0;r<i;r++){var o=t[r],a=this.geometry.get(o.id),s=this.attributes.get(a.id.id);n(s)||(s=e.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,s));var u=o.entity.isShowing;u!==(1===s.show[0])&&(s.show=l.toValue(u,s.show),a.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},y.prototype.contains=function(e){return this.updaters.contains(e.id)},y.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return c.PENDING;var r=i.getGeometryInstanceAttributes(e.entity);return!n(r)||!n(r.boundingSphere)||n(r.show)&&0===r.show[0]?c.FAILED:(r.boundingSphere.clone(t),c.DONE)},y.prototype.destroy=function(){var e=this.primitive,t=this.primitives;n(e)&&t.remove(e);var i=this.oldPrimitive;n(i)&&t.remove(i),n(this.removeMaterialSubscription)&&this.removeMaterialSubscription()},x.prototype.add=function(e,t){var i,r,n=t.createFillGeometryInstance(e);255===n.attributes.color.value[3]?(i=this._solidItems,r=!1):(i=this._translucentItems,r=!0);for(var o=i.length,a=0;a<o;a++){var s=i[a];if(s.isMaterial(t))return void s.add(t,n)}var l=new y(this._primitives,r,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);l.add(t,n),i.push(l)},x.prototype.remove=function(e){w(this._solidItems,e)||w(this._translucentItems,e)},x.prototype.update=function(e){var t=C(this,this._solidItems,e,!0);t=C(this,this._translucentItems,e,t)&&t;var i=T(this,this._solidItems,e),r=T(this,this._translucentItems,e);return(i||r)&&(t=C(this,this._solidItems,e,t)&&t,t=C(this,this._translucentItems,e,t)&&t),t},x.prototype.getBoundingSphere=function(e,t){var i=E(this._solidItems,e,t);return i===c.FAILED?E(this._translucentItems,e,t):i},x.prototype.removeAllPrimitives=function(){A(this._solidItems),A(this._translucentItems)},x}.apply(t,r))||(e.exports=n)},767:function(e,t,i){var r,n;r=[i(81),i(12),i(22),i(67),i(8),i(84),i(97),i(147),i(91),i(112),i(90),i(75),i(198),i(38)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,c,d,h,p){"use strict";var m=new o,f=new o,_=t.ZERO,g=new t;function v(t,i,r,n,o,a,s){this.primitives=t,this.appearanceType=i,this.materialProperty=r,this.depthFailAppearanceType=n,this.depthFailMaterialProperty=o,this.closed=a,this.shadows=s,this.updaters=new e,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new e,this.attributes=new e,this.invalidated=!1,this.removeMaterialSubscription=r.definitionChanged.addEventListener(v.prototype.onMaterialChanged,this),this.subscriptions=new e,this.showsUpdated=new e}v.prototype.onMaterialChanged=function(){this.invalidated=!0},v.prototype.isMaterial=function(e){var t=this.materialProperty,i=e.fillMaterialProperty,r=this.depthFailMaterialProperty,o=e.depthFailMaterialProperty;if(i===t&&o===r)return!0;var a=n(t)&&t.equals(i);return a=(!n(r)&&!n(o)||n(r)&&r.equals(o))&&a},v.prototype.add=function(e,t){var i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,t.createFillGeometryInstance(e)),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&p.isConstant(t.distanceDisplayConditionProperty)&&p.isConstant(t.terrainOffsetProperty)){var r=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(e,i,n,o){"isShowing"===i&&r.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(i,t);this.createPrimitive=!0},v.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return n(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};var y=new i;function x(e,t,i,r,n){this._items=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=r,this._shadows=n}return v.prototype.update=function(e){var c,v=!0,x=this.primitive,w=this.primitives,T=this.geometry.values;if(this.createPrimitive){if(T.length>0){var C;n(x)&&(n(this.oldPrimitive)?w.remove(x):this.oldPrimitive=x),this.material=h.getValue(e,this.materialProperty,this.material),n(this.depthFailMaterialProperty)&&(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),C=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),x=new u({show:!1,asynchronous:!0,geometryInstances:T,appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:C,shadows:this.shadows}),w.add(x),v=!1}else{n(x)&&(w.remove(x),x=void 0);var E=this.oldPrimitive;n(E)&&(w.remove(E),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=x,this.createPrimitive=!1}else if(n(x)&&x.ready){x.show=!0,n(this.oldPrimitive)&&(w.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=h.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material,!n(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof d||(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var A=this.updatersWithAttributes.values,S=A.length;for(c=0;c<S;c++){var P=A[c],b=P.entity,D=this.geometry.get(P.id),O=this.attributes.get(D.id.id);if(n(O)||(O=x.getGeometryInstanceAttributes(D.id),this.attributes.set(D.id.id,O)),n(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof d&&!P.depthFailMaterialProperty.isConstant){var I=P.depthFailMaterialProperty.color,M=p.getValueOrDefault(I,e,i.WHITE,y);i.equals(O._lastDepthFailColor,M)||(O._lastDepthFailColor=i.clone(M,O._lastDepthFailColor),O.depthFailColor=r.toValue(M,O.depthFailColor))}var N=b.isShowing&&(P.hasConstantFill||P.isFilled(e));N!==(1===O.show[0])&&(O.show=l.toValue(N,O.show));var F=P.distanceDisplayConditionProperty;if(!p.isConstant(F)){var R=p.getValueOrDefault(F,e,f,m);o.equals(R,O._lastDistanceDisplayCondition)||(O._lastDistanceDisplayCondition=o.clone(R,O._lastDistanceDisplayCondition),O.distanceDisplayCondition=a.toValue(R,O.distanceDisplayCondition))}var L=P.terrainOffsetProperty;if(!p.isConstant(L)){var V=p.getValueOrDefault(L,e,_,g);t.equals(V,O._lastOffset)||(O._lastOffset=t.clone(V,O._lastOffset),O.offset=s.toValue(V,O.offset))}}this.updateShows(x)}else n(x)&&!x.ready&&(v=!1);return v},v.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,r=0;r<i;r++){var o=t[r],a=o.entity,s=this.geometry.get(o.id),u=this.attributes.get(s.id.id);n(u)||(u=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,u));var c=a.isShowing;c!==(1===u.show[0])&&(u.show=l.toValue(c,u.show),s.attributes.show.value[0]=u.show[0])}this.showsUpdated.removeAll()},v.prototype.contains=function(e){return this.updaters.contains(e.id)},v.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return c.PENDING;var r=i.getGeometryInstanceAttributes(e.entity);return!n(r)||!n(r.boundingSphere)||n(r.show)&&0===r.show[0]?c.FAILED:(r.boundingSphere.clone(t),c.DONE)},v.prototype.destroy=function(){var e=this.primitive,t=this.primitives;n(e)&&t.remove(e);var i=this.oldPrimitive;n(i)&&t.remove(i),this.removeMaterialSubscription()},x.prototype.add=function(e,t){for(var i=this._items,r=i.length,n=0;n<r;n++){var o=i[n];if(o.isMaterial(t))return void o.add(e,t)}var a=new v(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);a.add(e,t),i.push(a)},x.prototype.remove=function(e){for(var t=this._items,i=t.length-1;i>=0;i--){var r=t[i];if(r.remove(e)){0===r.updaters.length&&(t.splice(i,1),r.destroy());break}}},x.prototype.update=function(e){var t,i=this._items;for(t=i.length-1;t>=0;t--){var r=i[t];if(r.invalidated){i.splice(t,1);for(var n=r.updaters.values,o=n.length,a=0;a<o;a++)this.add(e,n[a]);r.destroy()}}var s=!0;for(t=0;t<i.length;t++)s=i[t].update(e)&&s;return s},x.prototype.getBoundingSphere=function(e,t){for(var i=this._items,r=i.length,n=0;n<r;n++){var o=i[n];if(o.contains(e))return o.getBoundingSphere(e,t)}return c.FAILED},x.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0},x}.apply(t,r))||(e.exports=n)},768:function(e,t,i){var r,n;r=[i(32),i(8),i(186),i(14),i(130),i(244),i(142)],void 0===(n=function(e,t,i,r,n,o,a){"use strict";var s={};function l(e,t){return r.equalsEpsilon(e.latitude,t.latitude,r.EPSILON14)&&r.equalsEpsilon(e.longitude,t.longitude,r.EPSILON14)}var u=new e,c=new e;var d=new Array(2),h=new Array(2),p={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};return s.computePositions=function(s,m,f,_,g,v){var y=function(i,r,n,o){var a=r.length;if(!(a<2)){var s=t(o),d=t(n),h=!0,p=new Array(a),m=new Array(a),f=new Array(a),_=r[0];p[0]=_;var g=i.cartesianToCartographic(_,u);d&&(g.height=n[0]),h=h&&g.height<=0,m[0]=g.height,f[0]=s?o[0]:0;for(var v=1,y=1;y<a;++y){var x=r[y],w=i.cartesianToCartographic(x,c);d&&(w.height=n[y]),h=h&&w.height<=0,l(g,w)?g.height<w.height&&(m[v-1]=w.height):(p[v]=x,m[v]=w.height,f[v]=s?o[y]:0,e.clone(w,g),++v)}if(!(h||v<2))return p.length=v,m.length=v,f.length=v,{positions:p,topHeights:m,bottomHeights:f}}}(s,m,f,_);if(t(y)){if(m=y.positions,f=y.topHeights,_=y.bottomHeights,m.length>=3){var x=i.fromPoints(m,s).projectPointsOntoPlane(m);n.computeWindingOrder2D(x)===a.CLOCKWISE&&(m.reverse(),f.reverse(),_.reverse())}var w,T,C=m.length,E=C-2,A=r.chordLength(g,s.maximumRadius),S=p;if(S.minDistance=A,S.ellipsoid=s,v){var P,b=0;for(P=0;P<C-1;P++)b+=o.numberOfPoints(m[P],m[P+1],A)+1;w=new Float64Array(3*b),T=new Float64Array(3*b);var D=d,O=h;S.positions=D,S.height=O;var I=0;for(P=0;P<C-1;P++){D[0]=m[P],D[1]=m[P+1],O[0]=f[P],O[1]=f[P+1];var M=o.generateArc(S);w.set(M,I),O[0]=_[P],O[1]=_[P+1],T.set(o.generateArc(S),I),I+=M.length}}else S.positions=m,S.height=f,w=new Float64Array(o.generateArc(S)),S.height=_,T=new Float64Array(o.generateArc(S));return{bottomPositions:T,topPositions:w,numCorners:E}}},s}.apply(t,r))||(e.exports=n)},91:function(e,t,i){var r,n;r=[i(34),i(9),i(8),i(10),i(11)],void 0===(n=function(e,t,i,r,n){"use strict";function o(e){e=t(e,!0),this.value=o.toValue(e)}return r(o.prototype,{componentDatatype:{get:function(){return e.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}}),o.toValue=function(e,t){return i(t)?(t[0]=e,t):new Uint8Array([e])},o}.apply(t,r))||(e.exports=n)},97:function(e,t,i){var r,n;r=[i(34),i(9),i(8),i(10),i(11)],void 0===(n=function(e,t,i,r,n){"use strict";function o(e,i){e=t(e,0),i=t(i,Number.MAX_VALUE),this.value=new Float32Array([e,i])}return r(o.prototype,{componentDatatype:{get:function(){return e.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}}),o.fromDistanceDisplayCondition=function(e){return new o(e.near,e.far)},o.toValue=function(e,t){return i(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])},o}.apply(t,r))||(e.exports=n)}}]);
//# sourceMappingURL=5.TerriaMap.js.map